---
title: "Cron ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚¿ã‚¹ã‚¯ã¨ Webhook | Clawdbot ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«"
sidebarTitle: "AI ã‚’è‡ªå‹•åŒ–ã™ã‚‹"
subtitle: "Cron ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚¿ã‚¹ã‚¯ã¨ Webhook"
description: "Clawdbot ã® Cron ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚¿ã‚¹ã‚¯ã‚·ã‚¹ãƒ†ãƒ ã€Webhook ãƒˆãƒªã‚¬ãƒ¼æ©Ÿèƒ½ã€Gmail Pub/Sub çµ±åˆã‚’å­¦ç¿’ã—ã¾ã™ã€‚è‡ªå‹•åŒ–ã‚¿ã‚¹ã‚¯ã®è¨­å®šã¨å®Ÿè¡Œãƒ•ãƒ­ãƒ¼ã‚’ç¿’å¾—ã—ã¾ã™ã€‚"
tags:
  - "cron"
  - "webhook"
  - "automation"
  - "gmail"
prerequisite:
  - "start-gateway-startup"
  - "advanced-models-auth"
order: 270
---

# Cron ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚¿ã‚¹ã‚¯ã¨ Webhook

## å­¦ç¿’å¾Œã§ãã‚‹ã“ã¨

ã“ã®ãƒ¬ãƒƒã‚¹ãƒ³ã‚’å­¦ç¿’ã™ã‚‹ã¨ã€æ¬¡ã®ã“ã¨ãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼š

- æŒ‡å®šã•ã‚ŒãŸæ™‚é–“ã‚„å‘¨æœŸã§è‡ªå‹•çš„ã« AI ã‚¿ã‚¹ã‚¯ã‚’å®Ÿè¡Œã™ã‚‹ Cron ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚¿ã‚¹ã‚¯ã‚’ä½œæˆã™ã‚‹
- 3 ã¤ã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°æ–¹å¼ï¼ˆatã€everyã€cronï¼‰ã®ä½¿ç”¨ã‚·ãƒŠãƒªã‚ªã‚’ç†è§£ã™ã‚‹
- å¤–éƒ¨ã‚¤ãƒ™ãƒ³ãƒˆãƒˆãƒªã‚¬ãƒ¼ã‚’å—ä¿¡ã™ã‚‹ Webhook ã‚’è¨­å®šã™ã‚‹
- ãƒ¡ãƒ¼ãƒ«ãƒˆãƒªã‚¬ãƒ¼ã§ AI ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’å®Ÿç¾ã™ã‚‹ Gmail Pub/Sub çµ±åˆã‚’è¨­å®šã™ã‚‹
- ã‚¿ã‚¹ã‚¯å®Ÿè¡Œå±¥æ­´ã¨ãƒ­ã‚°ã‚’ç®¡ç†ã™ã‚‹

## ç¾åœ¨ã®èª²é¡Œ

æ¬¡ã®ã‚ˆã†ãªçŠ¶æ³ã«ç›´é¢ã—ã¦ã„ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ï¼š

- ç‰¹å®šã®æ™‚é–“ã«è‡ªåˆ†ã‚’ãƒªãƒã‚¤ãƒ³ãƒ‰ã—ãŸã„
- å®šæœŸçš„ã«ä½œæ¥­é€²æ—ã‚’è¦ç´„ã—ãŸã‚Šãƒ¬ãƒãƒ¼ãƒˆã‚’ç”Ÿæˆã—ãŸã„
- ç‰¹å®šã®ãƒ¡ãƒ¼ãƒ«ã‚’å—ä¿¡ã—ãŸã¨ãã«è‡ªå‹•çš„ã« AI åˆ†æã‚’ãƒˆãƒªã‚¬ãƒ¼ã—ãŸã„
- æ¯å›æ‰‹å‹•ã§ AI ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ã‚ŠãŸããªã„

## ã„ã¤ä½¿ã†ã¹ãã‹

**Cron ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚¿ã‚¹ã‚¯**ã¯æ¬¡ã®ã‚·ãƒŠãƒªã‚ªã«é©ã—ã¦ã„ã¾ã™ï¼š

| ã‚·ãƒŠãƒªã‚ª | ä¾‹ | ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«æ–¹å¼ |
|---------|-----|------------------|
| ä¸€å›é™ã‚Šã®ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼ | ã€Œæ˜æ—¥ã®æœ 9 æ™‚ã«ä¼šè­°ã‚’ãƒªãƒã‚¤ãƒ³ãƒ‰ã—ã¦ã€ | at |
| å®šæœŸãƒã‚§ãƒƒã‚¯ | ã€Œ30 åˆ†ã”ã¨ã«ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ…‹ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¦ã€ | every |
| æ™‚åˆ»æŒ‡å®šå®Ÿè¡Œ | ã€Œæ¯æ—¥åˆå¾Œ 5 æ™‚ã«æ—¥å ±ã‚’ç”Ÿæˆã—ã¦ã€ | cron |
| è¤‡é›‘ãªå‘¨æœŸ | ã€Œæœˆæ›œã‹ã‚‰é‡‘æ›œã®æœ 9 æ™‚ã«ã€ | cron |

**Webhook**ã¯æ¬¡ã®ã‚·ãƒŠãƒªã‚ªã«é©ã—ã¦ã„ã¾ã™ï¼š

- GitHubã€GitLab ã®ãƒ—ãƒƒã‚·ãƒ¥é€šçŸ¥ã‚’å—ä¿¡ã™ã‚‹
- Stripe ã®æ”¯æ‰•ã„æˆåŠŸé€šçŸ¥ã‚’å—ä¿¡ã™ã‚‹
- Twilio ã®ç€ä¿¡é€šçŸ¥ã‚’å—ä¿¡ã™ã‚‹
- HTTP POST ã‚’é€ä¿¡ã§ãã‚‹ã‚µãƒ¼ãƒ“ã‚¹ãªã‚‰ä½•ã§ã‚‚å¯èƒ½

**Gmail Pub/Sub**ã¯æ¬¡ã®ã‚·ãƒŠãƒªã‚ªã«é©ã—ã¦ã„ã¾ã™ï¼š

- é‡è¦ãªãƒ¡ãƒ¼ãƒ«ã‚’å—ä¿¡ã—ãŸã¨ãã«è‡ªå‹•åˆ†æã™ã‚‹
- ãƒ¡ãƒ¼ãƒ«ã®åˆ†é¡ã¨è‡ªå‹•è¿”ä¿¡
- ãƒ¡ãƒ¼ãƒ«ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®æŠ½å‡ºã¨ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–

---

## ã‚³ã‚¢æ¦‚å¿µ

### Cron ã‚¿ã‚¹ã‚¯ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

```mermaid
graph LR
    A[Cron Service] --> B[ã‚¿ã‚¹ã‚¯ã‚’ãƒ­ãƒ¼ãƒ‰]
    B --> C[æ¬¡å›å®Ÿè¡Œæ™‚é–“ã‚’è¨ˆç®—]
    C --> D[ã‚¿ã‚¤ãƒãƒ¼ã‚’è¨­å®š]
    D --> E{æ™‚é–“åˆ°äº†?}
    E -->|ã¯ã„| F[ã‚¿ã‚¹ã‚¯ã‚’å®Ÿè¡Œ]
    E -->|ã„ã„ãˆ| C
    F --> G[å®Ÿè¡Œãƒ­ã‚°ã‚’æ›¸ãè¾¼ã¿]
    G --> C
```

### 3 ã¤ã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°æ–¹å¼ã®æ¯”è¼ƒ

| æ–¹å¼ | ä½¿ç”¨ã‚·ãƒŠãƒªã‚ª | ä¾‹ | ç²¾åº¦ |
|------|------------|-----|------|
| `at` | ä¸€å›é™ã‚Šã®ã‚¿ã‚¹ã‚¯ | 2026-01-27 09:00:00 | ãƒŸãƒªç§’å˜ä½ |
| `every` | å›ºå®šé–“éš” | 30 åˆ†ã”ã¨ | ãƒŸãƒªç§’å˜ä½ |
| `cron` | è¤‡é›‘ãªå‘¨æœŸ | æ¯æœ 9 æ™‚ | åˆ†å˜ä½ |

### 2 ã¤ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ

| ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ | Payload ã‚¿ã‚¤ãƒ— | èª¬æ˜ |
|-------------------|---------------|------|
| `main` | `systemEvent` | ãƒ¡ã‚¤ãƒ³ã‚»ãƒƒã‚·ãƒ§ãƒ³ã«ã‚·ã‚¹ãƒ†ãƒ ã‚¤ãƒ™ãƒ³ãƒˆã‚’æ³¨å…¥ |
| `isolated` | `agentTurn` | åˆ†é›¢ã•ã‚ŒãŸã‚»ãƒƒã‚·ãƒ§ãƒ³ã§ Agent ã‚’å®Ÿè¡Œ |

**é‡è¦ãªåˆ¶ç´„**ï¼š
- `sessionTarget="main"` ã¯ `payload.kind="systemEvent"` ã‚’ä½¿ç”¨ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™
- `sessionTarget="isolated"` ã¯ `payload.kind="agentTurn"` ã‚’ä½¿ç”¨ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™

---

## ğŸ’ é–‹å§‹å‰ã®æº–å‚™

é–‹å§‹ã™ã‚‹å‰ã«ã€æ¬¡ã®ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼š

::: warning äº‹å‰ãƒã‚§ãƒƒã‚¯
- [ ] Gateway ãŒèµ·å‹•ã—ã¦ã„ã‚‹ï¼ˆ[Gateway ã®èµ·å‹•](../../start/gateway-startup/)ï¼‰
- [ ] AI ãƒ¢ãƒ‡ãƒ«ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ï¼ˆ[AI ãƒ¢ãƒ‡ãƒ«ã®è¨­å®š](../models-auth/)ï¼‰
- [ ] Cron å¼ã®åŸºæœ¬çš„ãªæ§‹æ–‡ã‚’ç†è§£ã—ã¦ã„ã‚‹ï¼ˆcron ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã™ã‚‹å ´åˆï¼‰
:::

---

## å®Ÿè·µ

### ã‚¹ãƒ†ãƒƒãƒ— 1ï¼šCron ã‚µãƒ¼ãƒ“ã‚¹ã®çŠ¶æ…‹ã‚’ç¢ºèª

**ãªãœ**ï¼šCron ã‚µãƒ¼ãƒ“ã‚¹ãŒæœ‰åŠ¹ã§å®Ÿè¡Œä¸­ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹ãŸã‚

```bash
## CLI ã§ Cron çŠ¶æ…‹ã‚’ç¢ºèª
clawdbot cron status
```

**æ¬¡ã®ã‚ˆã†ã«è¡¨ç¤ºã•ã‚Œã¾ã™**ï¼š

```
âœ“ Cron enabled
  Store: ~/.clawdbot/cron.json
  Jobs: 0
  Next wake: null
```

`disabled` ã¨è¡¨ç¤ºã•ã‚Œã‚‹å ´åˆã€è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã§æœ‰åŠ¹ã«ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼š

```json
{
  "cron": {
    "enabled": true,
    "store": "~/.clawdbot/cron.json",
    "maxConcurrentRuns": 5
  }
}
```

---

### ã‚¹ãƒ†ãƒƒãƒ— 2ï¼šä¸€å›é™ã‚Šã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚¿ã‚¹ã‚¯ã‚’ä½œæˆ

**ãªãœ**ï¼šæœ€ã‚‚åŸºæœ¬çš„ãª `at` ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°æ–¹å¼ã‚’å­¦ã¶ãŸã‚

cron ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ã¦ 1 åˆ†å¾Œã«å®Ÿè¡Œã™ã‚‹ã‚¿ã‚¹ã‚¯ã‚’è¿½åŠ ã—ã¾ã™ï¼š

```json
{
  "action": "add",
  "job": {
    "name": "ãƒ†ã‚¹ãƒˆãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼",
    "enabled": true,
    "schedule": {
      "kind": "at",
      "atMs": 1738000000000
    },
    "sessionTarget": "main",
    "wakeMode": "next-heartbeat",
    "payload": {
      "kind": "systemEvent",
      "text": "ã“ã‚Œã¯ãƒ†ã‚¹ãƒˆãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼ã§ã™ï¼šä½œæ¥­é€²æ—ã‚’ç¢ºèª"
    }
  }
}
```

**æ¬¡ã®ã‚ˆã†ã«è¡¨ç¤ºã•ã‚Œã¾ã™**ï¼š

```
âœ“ Job added: job_xxx
  Name: ãƒ†ã‚¹ãƒˆãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼
  Next run: 2026-01-27 10:00:00
```

**ãƒ’ãƒ³ãƒˆ**ï¼š`atMs` ã¯ Unix ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ï¼ˆãƒŸãƒªç§’ï¼‰ã§ã™ã€‚JavaScript ã§è¨ˆç®—ã§ãã¾ã™ï¼š

```javascript
Date.now() + 60 * 1000  // 1 åˆ†å¾Œ
```

---

### ã‚¹ãƒ†ãƒƒãƒ— 3ï¼šç¹°ã‚Šè¿”ã—ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒ«ã‚¿ã‚¹ã‚¯ã‚’ä½œæˆ

**ãªãœ**ï¼šå®šæœŸãƒã‚§ãƒƒã‚¯ã«é©ã—ãŸ `every` ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°æ–¹å¼ã‚’å­¦ã¶ãŸã‚

30 åˆ†ã”ã¨ã«å®Ÿè¡Œã™ã‚‹ã‚¿ã‚¹ã‚¯ã‚’ä½œæˆã—ã¾ã™ï¼š

```json
{
  "action": "add",
  "job": {
    "name": "30åˆ†ã”ã¨ã«ã‚·ã‚¹ãƒ†ãƒ ã‚’ãƒã‚§ãƒƒã‚¯",
    "enabled": true,
    "schedule": {
      "kind": "every",
      "everyMs": 1800000
    },
    "sessionTarget": "main",
    "wakeMode": "next-heartbeat",
    "payload": {
      "kind": "systemEvent",
      "text": "ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ…‹ã‚’ãƒã‚§ãƒƒã‚¯ï¼šCPUã€ãƒ¡ãƒ¢ãƒªã€ãƒ‡ã‚£ã‚¹ã‚¯"
    }
  }
}
```

**æ¬¡ã®ã‚ˆã†ã«è¡¨ç¤ºã•ã‚Œã¾ã™**ï¼š

```
âœ“ Job added: job_xxx
  Name: 30åˆ†ã”ã¨ã«ã‚·ã‚¹ãƒ†ãƒ ã‚’ãƒã‚§ãƒƒã‚¯
  Interval: 30 minutes
  Next run: 2026-01-27 10:00:00
```

**ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®èª¬æ˜**ï¼š
- `everyMs`: é–“éš”æ™‚é–“ï¼ˆãƒŸãƒªç§’ï¼‰
  - 1 åˆ† = 60,000 ms
  - 5 åˆ† = 300,000 ms
  - 30 åˆ† = 1,800,000 ms
  - 1 æ™‚é–“ = 3,600,000 ms
- `anchorMs`ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰ï¼šåˆå›å®Ÿè¡Œã®é–‹å§‹æ™‚é–“

---

### ã‚¹ãƒ†ãƒƒãƒ— 4ï¼šCron å¼ã‚¿ã‚¹ã‚¯ã‚’ä½œæˆ

**ãªãœ**ï¼šè¤‡é›‘ãªå‘¨æœŸã«é©ã—ãŸ `cron` ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°æ–¹å¼ã‚’å­¦ã¶ãŸã‚

æ¯æœ 9 æ™‚ã«å®Ÿè¡Œã™ã‚‹ã‚¿ã‚¹ã‚¯ã‚’ä½œæˆã—ã¾ã™ï¼š

```json
{
  "action": "add",
  "job": {
    "name": "æ¯æœ9æ™‚ã«æ—¥å ±",
    "enabled": true,
    "schedule": {
      "kind": "cron",
      "expr": "0 9 * * *",
      "tz": "Asia/Shanghai"
    },
    "sessionTarget": "main",
    "wakeMode": "next-heartbeat",
    "payload": {
      "kind": "systemEvent",
      "text": "æœ¬æ—¥ã®ä½œæ¥­æ—¥å ±ã‚’ç”Ÿæˆ"
    }
  }
}
```

**æ¬¡ã®ã‚ˆã†ã«è¡¨ç¤ºã•ã‚Œã¾ã™**ï¼š

```
âœ“ Job added: job_xxx
  Name: æ¯æœ9æ™‚ã«æ—¥å ±
  Schedule: 0 9 * * * (Asia/Shanghai)
  Next run: 2026-01-27 09:00:00
```

**Cron å¼ã®å½¢å¼**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ åˆ† (0 - 59)
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ æ™‚ (0 - 23)
â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€ æ—¥ (1 - 31)
â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€ æœˆ (1 - 12)
â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€ æ›œæ—¥ (0 - 7, 0 ã¨ 7 ã¯æ—¥æ›œæ—¥)
â”‚ â”‚ â”‚ â”‚ â”‚
* * * * *
```

**ã‚ˆãä½¿ã‚ã‚Œã‚‹å¼**ï¼š

| å¼ | èª¬æ˜ |
|----|------|
| `0 9 * * *` | æ¯æœ 9 æ™‚ |
| `0 9 * * 1-5` | æœˆæ›œã‹ã‚‰é‡‘æ›œã®æœ 9 æ™‚ |
| `0 */6 * * *` | 6 æ™‚é–“ã”ã¨ |
| `0 0 * * 0` | æ¯é€±æ—¥æ›œæ—¥ã®æ·±å¤œ |
| `0 9,17 * * *` | æ¯æ—¥ 9 æ™‚ã¨ 17 æ™‚ |

::: info ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ã®è¨­å®š
Cron å¼ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ UTC ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚`tz` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã§ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ã‚’æŒ‡å®šã™ã‚‹ã¨ï¼ˆä¾‹ï¼š`"Asia/Shanghai"`ï¼‰ã€ã‚¿ã‚¹ã‚¯ãŒæœŸå¾…ã™ã‚‹æ™‚åˆ»ã«å®Ÿè¡Œã•ã‚Œã¾ã™ã€‚
:::

---

### ã‚¹ãƒ†ãƒƒãƒ— 5ï¼šåˆ†é›¢ã‚»ãƒƒã‚·ãƒ§ãƒ³ã§ã‚¿ã‚¹ã‚¯ã‚’å®Ÿè¡Œ

**ãªãœ**ï¼šåˆ†é›¢ã•ã‚ŒãŸç’°å¢ƒã§ AI ã‚¿ã‚¹ã‚¯ã‚’å®Ÿè¡Œã—ã€ãƒ¡ã‚¤ãƒ³ã‚»ãƒƒã‚·ãƒ§ãƒ³ã¸ã®å¹²æ¸‰ã‚’é¿ã‘ã‚‹ãŸã‚

åˆ†é›¢ã•ã‚ŒãŸã‚»ãƒƒã‚·ãƒ§ãƒ³ã§å®Ÿè¡Œã™ã‚‹ã‚¿ã‚¹ã‚¯ã‚’ä½œæˆã—ã¾ã™ï¼š

```json
{
  "action": "add",
  "job": {
    "name": "æ¯æ—¥ã®è¦ç´„",
    "enabled": true,
    "schedule": {
      "kind": "cron",
      "expr": "0 18 * * *",
      "tz": "Asia/Shanghai"
    },
    "sessionTarget": "isolated",
    "wakeMode": "next-heartbeat",
    "payload": {
      "kind": "agentTurn",
      "message": "ä»Šæ—¥ã®ä½œæ¥­ã‚’è¦ç´„ï¼š1. å®Œäº†ã—ãŸã‚¿ã‚¹ã‚¯ 2. ç™ºç”Ÿã—ãŸå•é¡Œ 3. æ˜æ—¥ã®è¨ˆç”»",
      "model": "anthropic/claude-sonnet-4-20250514",
      "thinking": "low"
    }
  }
}
```

**æ¬¡ã®ã‚ˆã†ã«è¡¨ç¤ºã•ã‚Œã¾ã™**ï¼š

```
âœ“ Job added: job_xxx
  Name: æ¯æ—¥ã®è¦ç´„
  Session: isolated
  Next run: 2026-01-27 18:00:00
```

**`agentTurn` Payload ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿**ï¼š

| ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ | ã‚¿ã‚¤ãƒ— | èª¬æ˜ |
|-----------|--------|------|
| `message` | string | Agent ã«é€ä¿¡ã™ã‚‹ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ |
| `model` | string | ä½¿ç”¨ã™ã‚‹ãƒ¢ãƒ‡ãƒ«ã‚’ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰ |
| `thinking` | string | æ€è€ƒãƒ¬ãƒ™ãƒ«ï¼š"off" \| "minimal" \| "low" \| "medium" \| "high" |
| `timeoutSeconds` | number | ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆæ™‚é–“ï¼ˆç§’ï¼‰ |
| `deliver` | boolean | çµæœã‚’ãƒãƒ£ãƒãƒ«ã«é€ä¿¡ã™ã‚‹ã‹ã©ã†ã‹ |
| `channel` | string | ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãƒãƒ£ãƒãƒ«ï¼ˆä¾‹ï¼š`"whatsapp"`ã€`"telegram"`ï¼‰ |
| `to` | string | å—ä¿¡è€…è­˜åˆ¥å­ |
| `bestEffortDeliver` | boolean | æŒ‡å®šã•ã‚ŒãŸãƒãƒ£ãƒãƒ«ã«é€ä¿¡ã§ããªã„å ´åˆã€ä»–ã®ãƒãƒ£ãƒãƒ«ã‚’è©¦ã™ã‹ã©ã†ã‹ |

**åˆ†é›¢ã‚»ãƒƒã‚·ãƒ§ãƒ³è¨­å®š**ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰ï¼š

```json
{
  "isolation": {
    "postToMainPrefix": "ğŸ“Š æ¯æ—¥ã®è¦ç´„:",
    "postToMainMode": "summary",
    "postToMainMaxChars": 8000
  }
}
```

| ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ | èª¬æ˜ |
|-----------|------|
| `postToMainPrefix` | ãƒ¡ã‚¤ãƒ³ã‚»ãƒƒã‚·ãƒ§ãƒ³ã«çµæœã‚’è»¢é€ã™ã‚‹ã¨ãã®ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ |
| `postToMainMode` | "summary"ï¼ˆè¦ç´„ï¼‰ã¾ãŸã¯ "full"ï¼ˆå…¨æ–‡ï¼‰ |
| `postToMainMaxChars` | `postToMainMode="full"` ã®å ´åˆã®æœ€å¤§æ–‡å­—æ•° |

---

### ã‚¹ãƒ†ãƒƒãƒ— 6ï¼šã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆã®è¡¨ç¤ºã¨ç®¡ç†

**ãªãœ**ï¼šã™ã¹ã¦ã®ã‚¿ã‚¹ã‚¯ã‚’è¡¨ç¤ºã—ã¦ãã®çŠ¶æ…‹ã‚’ç®¡ç†ã™ã‚‹ãŸã‚

**ã™ã¹ã¦ã®ã‚¿ã‚¹ã‚¯ã‚’è¡¨ç¤º**ï¼š

```bash
clawdbot cron list
```

**æ¬¡ã®ã‚ˆã†ã«è¡¨ç¤ºã•ã‚Œã¾ã™**ï¼š

```
Jobs: 3
  âœ“ job_xxx: ãƒ†ã‚¹ãƒˆãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼ (enabled, next: 2026-01-27 10:00:00)
  âœ“ job_yyy: 30åˆ†ã”ã¨ã«ã‚·ã‚¹ãƒ†ãƒ ã‚’ãƒã‚§ãƒƒã‚¯ (enabled, next: 2026-01-27 10:00:00)
  âœ“ job_zzz: æ¯æœ9æ™‚ã«æ—¥å ± (enabled, next: 2026-01-27 09:00:00)
```

**ç„¡åŠ¹ãªã‚¿ã‚¹ã‚¯ã‚‚å«ã‚ã‚‹**ï¼š

```bash
clawdbot cron list --include-disabled
```

**ã‚¿ã‚¹ã‚¯ã‚’ç„¡åŠ¹åŒ–**ï¼š

```json
{
  "action": "update",
  "jobId": "job_xxx",
  "patch": {
    "enabled": false
  }
}
```

**ã‚¿ã‚¹ã‚¯ã‚’æœ‰åŠ¹åŒ–**ï¼š

```json
{
  "action": "update",
  "jobId": "job_xxx",
  "patch": {
    "enabled": true
  }
}
```

**ã‚¿ã‚¹ã‚¯ã‚’å‰Šé™¤**ï¼š

```json
{
  "action": "remove",
  "jobId": "job_xxx"
}
```

---

### ã‚¹ãƒ†ãƒƒãƒ— 7ï¼šã‚¿ã‚¹ã‚¯ã‚’å³åº§ã«å®Ÿè¡Œ

**ãªãœ**ï¼šã‚¿ã‚¹ã‚¯ãŒæ­£å¸¸ã«å‹•ä½œã—ã¦ã„ã‚‹ã‹ã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹ãŸã‚ã€ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’å¾…ã¤å¿…è¦ãŒãªã„

```json
{
  "action": "run",
  "jobId": "job_xxx"
}
```

**æ¬¡ã®ã‚ˆã†ã«è¡¨ç¤ºã•ã‚Œã¾ã™**ï¼š

```
âœ“ Job ran: job_xxx
  Status: ok
  Duration: 1234ms
```

**å®Ÿè¡Œå±¥æ­´ã‚’è¡¨ç¤º**ï¼š

```json
{
  "action": "runs",
  "jobId": "job_xxx",
  "limit": 10
}
```

**æ¬¡ã®ã‚ˆã†ã«è¡¨ç¤ºã•ã‚Œã¾ã™**ï¼š

```
Runs for job_xxx (10 most recent):
  2026-01-27 10:00:00 - ok - 1234ms
  2026-01-26 10:00:00 - ok - 1189ms
  2026-01-25 10:00:00 - ok - 1245ms
```

---

### ã‚¹ãƒ†ãƒƒãƒ— 8ï¼šãƒªãƒã‚¤ãƒ³ã‚¿ã‚¹ã‚¯ã«ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’è¿½åŠ 

**ãªãœ**ï¼šAI ã«æœ€è¿‘ã®ä¼šè©±ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’ç†è§£ã•ã›ã€é–¢é€£æ€§ã®é«˜ã„ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼ã‚’æä¾›ã™ã‚‹ãŸã‚

`contextMessages` ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ã—ã¦æœ€è¿‘ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å±¥æ­´ã‚’è¿½åŠ ã—ã¾ã™ï¼š

```json
{
  "action": "add",
  "job": {
    "name": "ã‚¿ã‚¹ã‚¯ãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼",
    "enabled": true,
    "schedule": {
      "kind": "cron",
      "expr": "0 10,16 * * *",
      "tz": "Asia/Shanghai"
    },
    "sessionTarget": "main",
    "wakeMode": "next-heartbeat",
    "payload": {
      "kind": "systemEvent",
      "text": "ã‚¿ã‚¹ã‚¯é€²æ—ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—ï¼š1. ã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆã‚’ç¢ºèª 2. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’æ›´æ–°"
    },
    "contextMessages": 5
  }
}
```

**ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®åˆ¶é™**ï¼š
- æœ€å¤§ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æ•°ï¼š10 ä»¶
- å„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®æœ€å¤§æ–‡å­—æ•°ï¼š220
- ç·æ–‡å­—æ•°åˆ¶é™ï¼š700
- å½¢å¼ï¼š`- User: ...\n- Assistant: ...`

**è‡ªå‹•çš„ã«è¿½åŠ ã•ã‚Œã‚‹ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ**ï¼š

```
ã‚¿ã‚¹ã‚¯é€²æ—ã‚’ãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—ï¼š1. ã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆã‚’ç¢ºèª 2. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’æ›´æ–°

Recent context:
- User: ä»Šæ—¥ä¸­ã«ãƒ¬ãƒãƒ¼ãƒˆã‚’å®Œäº†ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™
- Assistant: åˆ†ã‹ã‚Šã¾ã—ãŸã€‚ã©ã®ã‚ˆã†ãªã‚¿ã‚¤ãƒ—ã®ãƒ¬ãƒãƒ¼ãƒˆã§ã™ã‹ï¼Ÿ
- User: é€±å ±ã§ã€ä»Šé€±ã®ä½œæ¥­è¦ç´„ãŒå«ã¾ã‚Œã¾ã™
```

---

## Webhook è¨­å®š

### Webhook ã®æ¦‚è¦

Webhook ã¯å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ãŒ HTTP POST ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€šã˜ã¦ Clawdbot ã®å†…éƒ¨ã‚¤ãƒ™ãƒ³ãƒˆã‚’ãƒˆãƒªã‚¬ãƒ¼ã™ã‚‹ã“ã¨ã‚’å¯èƒ½ã«ã—ã¾ã™ã€‚ä¸€èˆ¬çš„ãªç”¨é€”ï¼š

- **GitHub/GitLab**: ãƒ—ãƒƒã‚·ãƒ¥é€šçŸ¥ã§ CI/CD ãƒ—ãƒ­ã‚»ã‚¹ã‚’ãƒˆãƒªã‚¬ãƒ¼
- **Stripe**: æ”¯æ‰•ã„æˆåŠŸé€šçŸ¥ã§æ³¨æ–‡å‡¦ç†ã‚’ãƒˆãƒªã‚¬ãƒ¼
- **Twilio**: ç€ä¿¡é€šçŸ¥ã§ AI éŸ³å£°å¿œç­”ã‚’ãƒˆãƒªã‚¬ãƒ¼
- **Jira**: ãƒã‚±ãƒƒãƒˆä½œæˆé€šçŸ¥ã§è‡ªå‹•è¿”ä¿¡ã‚’ãƒˆãƒªã‚¬ãƒ¼

### Webhook ã®è¨­å®š

**Hooks ã‚·ã‚¹ãƒ†ãƒ ã‚’æœ‰åŠ¹åŒ–**ï¼š

```json
{
  "hooks": {
    "enabled": true,
    "path": "/hooks",
    "token": "your-secret-token-here"
  }
}
```

**ãƒãƒƒãƒ”ãƒ³ã‚°ãƒ«ãƒ¼ãƒ«ã‚’è¨­å®š**ï¼š

```json
{
  "hooks": {
    "enabled": true,
    "token": "your-secret-token-here",
    "mappings": [
      {
        "id": "github-push",
        "match": {
          "path": "/hooks/github"
        },
        "action": "wake",
        "wakeMode": "now",
        "sessionKey": "main",
        "messageTemplate": "GitHub ãƒ—ãƒƒã‚·ãƒ¥é€šçŸ¥: {{ repository }} - {{ ref }}"
      }
    ]
  }
}
```

**ãƒãƒƒãƒ”ãƒ³ã‚°è¨­å®šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿**ï¼š

| ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ | èª¬æ˜ |
|-----------|------|
| `match.path` | ä¸€è‡´ã™ã‚‹ URL ãƒ‘ã‚¹ |
| `match.source` | ä¸€è‡´ã™ã‚‹ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚½ãƒ¼ã‚¹ãƒ˜ãƒƒãƒ€ãƒ¼ |
| `action` | `"wake"` ã¾ãŸã¯ `"agent"` |
| `wakeMode` | `"now"` ã¾ãŸã¯ `"next-heartbeat"` |
| `sessionKey` | ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚­ãƒ¼ï¼ˆä¾‹ï¼š`"main"`ï¼‰ |
| `messageTemplate` | Mustache æ§‹æ–‡ã‚’ä½¿ç”¨ã—ãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ |
| `deliver` | ãƒãƒ£ãƒãƒ«ã«é€ä¿¡ã™ã‚‹ã‹ã©ã†ã‹ |
| `channel` | ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãƒãƒ£ãƒãƒ«ï¼ˆä¾‹ï¼š`"whatsapp"`ï¼‰ |
| `to` | å—ä¿¡è€…è­˜åˆ¥å­ |
| `transform` | å¤‰æ›ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼ˆãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£ã‚’å‡¦ç†ï¼‰ |

---

## Gmail Pub/Sub çµ±åˆ

### Gmail Pub/Sub ã®æ¦‚è¦

Gmail Pub/Sub ã¯æ–°ã—ã„ãƒ¡ãƒ¼ãƒ«ã‚’å—ä¿¡ã—ãŸã¨ãã«ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§ Clawdbot ã‚’ãƒˆãƒªã‚¬ãƒ¼ã—ã€ãƒ¡ãƒ¼ãƒ«é§†å‹•å‹ã® AI ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’å®Ÿç¾ã—ã¾ã™ã€‚

### Gmail Pub/Sub ã®è¨­å®š

**åŸºæœ¬è¨­å®š**ï¼š

```json
{
  "hooks": {
    "enabled": true,
    "token": "your-hook-token",
    "gmail": {
      "account": "your-email@gmail.com",
      "label": "INBOX",
      "topic": "projects/your-project-id/topics/gmail-topic",
      "subscription": "gmail-subscription",
      "pushToken": "your-push-token",
      "hookUrl": "http://127.0.0.1:18789/hooks/gmail",
      "includeBody": true,
      "maxBytes": 20000,
      "renewEveryMinutes": 720
    }
  }
}
```

**è¨­å®šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®èª¬æ˜**ï¼š

| ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ | èª¬æ˜ | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ |
|-----------|------|------------|
| `account` | Gmail ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚¢ãƒ‰ãƒ¬ã‚¹ | - |
| `label` | ç›£è¦–ã™ã‚‹ Gmail ãƒ©ãƒ™ãƒ« | `INBOX` |
| `topic` | Google Cloud Pub/Sub ãƒˆãƒ”ãƒƒã‚¯ãƒ‘ã‚¹ | - |
| `subscription` | Pub/Sub ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³å | `gmail-subscription` |
| `pushToken` | Gmail ãƒ—ãƒƒã‚·ãƒ¥ãƒˆãƒ¼ã‚¯ãƒ³ | - |
| `hookUrl` | Webhook å—ä¿¡ URL | è‡ªå‹•ç”Ÿæˆ |
| `includeBody` | ãƒ¡ãƒ¼ãƒ«æœ¬æ–‡ã‚’å«ã‚ã‚‹ã‹ã©ã†ã‹ | `true` |
| `maxBytes` | æœ€å¤§ãƒ¡ãƒ¼ãƒ«ãƒã‚¤ãƒˆæ•° | `20000` |
| `renewEveryMinutes` | ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³æ›´æ–°é–“éš”ï¼ˆåˆ†ï¼‰ | `720`ï¼ˆ12 æ™‚é–“ï¼‰ |

### Tailscale çµ±åˆï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

**Tailscale Serve ã‚’ä½¿ç”¨ã—ã¦ Webhook ã‚’å…¬é–‹**ï¼š

```json
{
  "hooks": {
    "gmail": {
      "tailscale": {
        "mode": "serve",
        "path": "/gmail-pubsub",
        "target": "10000"
      }
    }
  }
}
```

**Tailscale Funnel ã‚’ä½¿ç”¨**ï¼š

```json
{
  "hooks": {
    "gmail": {
      "tailscale": {
        "mode": "funnel",
        "path": "/gmail-pubsub"
      }
    }
  }
}
```

| ãƒ¢ãƒ¼ãƒ‰ | èª¬æ˜ |
|-------|------|
| `off` | Tailscale ã‚’ä½¿ç”¨ã—ãªã„ |
| `serve` | Tailscale Serve ã‚’é€šã˜ã¦ãƒ­ãƒ¼ã‚«ãƒ«ã‚µãƒ¼ãƒ“ã‚¹ã‚’å…¬é–‹ |
| `funnel` | Tailscale Funnel ã‚’é€šã˜ã¦ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ |

### Gmail Watcher ã®èµ·å‹•

**Gmail Watcher ã‚µãƒ¼ãƒ“ã‚¹ã‚’èµ·å‹•**ï¼š

```bash
clawdbot hooks gmail-watch
```

**æ¬¡ã®ã‚ˆã†ã«è¡¨ç¤ºã•ã‚Œã¾ã™**ï¼š

```
âœ“ Gmail watcher started
  Account: your-email@gmail.com
  Label: INBOX
  Watching...
```

**Gmail Watcher ã¯ä»¥ä¸‹ã‚’è¡Œã„ã¾ã™**ï¼š
1. Gmail ã®ãƒ©ãƒ™ãƒ«å¤‰æ›´ã‚’è³¼èª­
2. æ–°ã—ã„ãƒ¡ãƒ¼ãƒ«ãƒ—ãƒƒã‚·ãƒ¥ã‚’å—ä¿¡
3. ãƒ¡ãƒ¼ãƒ«æƒ…å ±ã‚’ Webhook ã«é€ä¿¡
4. Clawdbot ã®å†…éƒ¨ã‚¤ãƒ™ãƒ³ãƒˆã‚’ãƒˆãƒªã‚¬ãƒ¼

---

## ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆ âœ…

**ç†è§£ã§ããŸã“ã¨ã‚’ç¢ºèª**ï¼š

- [ ] 3 ã¤ã®ã‚¿ã‚¤ãƒ—ã® Cron ã‚¿ã‚¹ã‚¯ï¼ˆatã€everyã€cronï¼‰ã‚’ä½œæˆã§ãã‚‹
- [ ] `main` ã¨ `isolated` ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã®é•ã„ã‚’ç†è§£ã§ãã‚‹
- [ ] ã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆã®è¡¨ç¤ºã€æœ‰åŠ¹åŒ–ã€ç„¡åŠ¹åŒ–ã€å‰Šé™¤ãŒã§ãã‚‹
- [ ] ã‚¿ã‚¹ã‚¯ã®å®Ÿè¡Œå±¥æ­´ã‚’è¡¨ç¤ºã§ãã‚‹
- [ ] Webhook ã®è¨­å®šã¨å‹•ä½œåŸç†ã‚’ç†è§£ã§ãã‚‹
- [ ] Gmail Pub/Sub çµ±åˆã‚’è¨­å®šã§ãã‚‹

---

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚¿ã‚¹ã‚¯ãŒå®Ÿè¡Œã•ã‚Œãªã„

**å•é¡Œ**ï¼šã‚¿ã‚¹ã‚¯ã¯è¿½åŠ ã•ã‚ŒãŸãŒå®Ÿè¡Œã•ã‚Œãªã„

**è€ƒãˆã‚‰ã‚Œã‚‹åŸå› **ï¼š

| åŸå›  | è§£æ±ºæ–¹æ³• |
|------|---------|
| Cron ã‚µãƒ¼ãƒ“ã‚¹ãŒæœ‰åŠ¹ã§ãªã„ | `cron.enabled` è¨­å®šã‚’ç¢ºèª |
| æ™‚é–“ãŒã¾ã æ¥ã¦ã„ãªã„ | `clawdbot cron list` ã§æ¬¡å›å®Ÿè¡Œæ™‚é–“ã‚’ç¢ºèª |
| ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ãŒé–“é•ã£ã¦ã„ã‚‹ | `tz` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒæ­£ã—ã„ã‹ç¢ºèª |
| ã‚¿ã‚¹ã‚¯ãŒç„¡åŠ¹åŒ–ã•ã‚Œã¦ã„ã‚‹ | `--include-disabled` ã§ã‚¿ã‚¹ã‚¯çŠ¶æ…‹ã‚’ç¢ºèª |

### Cron å¼ã®ã‚¨ãƒ©ãƒ¼

**å•é¡Œ**ï¼šã‚¿ã‚¹ã‚¯ãŒé–“é•ã£ãŸæ™‚åˆ»ã«å®Ÿè¡Œã•ã‚Œã‚‹

**ã‚ˆãã‚ã‚‹ã‚¨ãƒ©ãƒ¼**ï¼š

| ã‚¨ãƒ©ãƒ¼ | æ­£ã—ã„ | èª¬æ˜ |
|--------|--------|------|
| `9 * * *` | `0 9 * * *` | åˆ†ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒæ¬ ã‘ã¦ã„ã‚‹ |
| `0 9 * * * *` | `0 9 * * *` | ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒ 1 ã¤å¤šã„ |
| `0 9 1-5 * *` | `0 9 * * 1-5` | æ›œæ—¥ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ä½ç½®ãŒé–“é•ã£ã¦ã„ã‚‹ |

**æ¤œè¨¼ãƒ„ãƒ¼ãƒ«**ï¼š[crontab.guru](https://crontab.guru/) ã‚’ä½¿ç”¨ã—ã¦ Cron å¼ã‚’æ¤œè¨¼ã—ã¾ã™ã€‚

### Gmail Pub/Sub ãŒå‹•ä½œã—ãªã„

**å•é¡Œ**ï¼šãƒ¡ãƒ¼ãƒ«ã‚’å—ä¿¡ã—ãŸãŒãƒˆãƒªã‚¬ãƒ¼ã•ã‚Œãªã„

**ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ**ï¼š

- [ ] Gmail Watcher ã‚µãƒ¼ãƒ“ã‚¹ãŒå®Ÿè¡Œä¸­ã‹ã©ã†ã‹
- [ ] `hookUrl` ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‹ã©ã†ã‹ï¼ˆcurl ã§ãƒ†ã‚¹ãƒˆï¼‰
- [ ] `token` ãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ã©ã†ã‹
- [ ] Pub/Sub ãƒˆãƒ”ãƒƒã‚¯ã¨ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãŒæ­£ã—ãä½œæˆã•ã‚Œã¦ã„ã‚‹ã‹ã©ã†ã‹
- [ ] ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šãŒæ­£å¸¸ã‹ã©ã†ã‹ï¼ˆTailscale ä½¿ç”¨æ™‚ï¼‰

### åˆ†é›¢ã‚»ãƒƒã‚·ãƒ§ãƒ³ãŒå¿œç­”ã—ãªã„

**å•é¡Œ**ï¼š`sessionTarget="isolated"` ã®ã‚¿ã‚¹ã‚¯ãŒå‡ºåŠ›ã•ã‚Œãªã„

**è€ƒãˆã‚‰ã‚Œã‚‹åŸå› **ï¼š

- `model` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒæ¬ ã‘ã¦ãŠã‚Šã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ¢ãƒ‡ãƒ«ãŒä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹ãŒè¨­å®šã•ã‚Œã¦ã„ãªã„
- `message` ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãŒä¸æ˜ç¢º
- `timeoutSeconds` ãŒçŸ­ã™ãã¦ã‚¿ã‚¹ã‚¯ãŒã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã™ã‚‹
- `deliver=false` ã ãŒ `postToMainMode` ãŒè¨­å®šã•ã‚Œã¦ã„ãªã„

**è§£æ±ºæ–¹æ³•**ï¼š

1. ãƒ­ã‚°ã®è©³ç´°åº¦ã‚’å¢—ã‚„ã™
2. Gateway ãƒ­ã‚°ã‚’ç¢ºèªã™ã‚‹
3. `bestEffortDeliver=true` ã‚’ä½¿ç”¨ã—ã¦ã€çµæœãŒå°‘ãªãã¨ã‚‚ãƒ¡ã‚¤ãƒ³ã‚»ãƒƒã‚·ãƒ§ãƒ³ã«è»¢é€ã•ã‚Œã‚‹ã‚ˆã†ã«ã™ã‚‹

---

## ãƒ¬ãƒƒã‚¹ãƒ³ã¾ã¨ã‚

Cron ã¨ Webhook ã¯ Clawdbot ã®å¼·åŠ›ãªè‡ªå‹•åŒ–ãƒ„ãƒ¼ãƒ«ã§ã™ï¼š

**Cron ã‚·ã‚¹ãƒ†ãƒ **ï¼š
- 3 ã¤ã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°æ–¹å¼ï¼š`at`ï¼ˆä¸€å›é™ã‚Šï¼‰ã€`every`ï¼ˆé–“éš”ï¼‰ã€`cron`ï¼ˆè¤‡é›‘ãªå‘¨æœŸï¼‰
- 2 ã¤ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚¿ãƒ¼ã‚²ãƒƒãƒˆï¼š`main`ï¼ˆã‚·ã‚¹ãƒ†ãƒ ã‚¤ãƒ™ãƒ³ãƒˆã‚’æ³¨å…¥ï¼‰ã€`isolated`ï¼ˆAgent ã‚’å®Ÿè¡Œï¼‰
- ã‚¿ã‚¹ã‚¯å±¥æ­´ã¨å®Ÿè¡Œãƒ­ã‚°ã‚’ã‚µãƒãƒ¼ãƒˆ
- é–¢é€£æ€§ã®é«˜ã„ãƒªãƒã‚¤ãƒ³ãƒ€ãƒ¼ã‚’æä¾›ã™ã‚‹ãŸã‚ã«ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¿½åŠ å¯èƒ½

**Webhook ã‚·ã‚¹ãƒ†ãƒ **ï¼š
- å¤–éƒ¨ HTTP POST ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å—ä¿¡
- ãƒãƒƒãƒ”ãƒ³ã‚°ãƒ«ãƒ¼ãƒ«ã¨ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ã‚µãƒãƒ¼ãƒˆ
- ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆå…¬é–‹ç”¨ã« Tailscale ã‚’è¨­å®šå¯èƒ½

**Gmail Pub/Sub**ï¼š
- æ–°ã—ã„ãƒ¡ãƒ¼ãƒ«ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§ç›£è¦–
- ãƒ©ãƒ™ãƒ«ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã‚’ã‚µãƒãƒ¼ãƒˆ
- Tailscale Serve/Funnel ã¨çµ±åˆ

ã“ã‚Œã‚‰ã®æ©Ÿèƒ½ã‚’é©åˆ‡ã«è¨­å®šã™ã‚‹ã“ã¨ã§ã€å®Œå…¨ã«è‡ªå‹•åŒ–ã•ã‚ŒãŸ AI ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆã‚’æ§‹ç¯‰ã—ã€é©åˆ‡ãªã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§å¿œç­”ã•ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

---

## æ¬¡ã®ãƒ¬ãƒƒã‚¹ãƒ³ã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼

> æ¬¡ã®ãƒ¬ãƒƒã‚¹ãƒ³ã§ã¯ **[ãƒ¡ãƒ¢ãƒªã‚·ã‚¹ãƒ†ãƒ ã¨ãƒ™ã‚¯ãƒˆãƒ«æ¤œç´¢](../memory-system/)** ã‚’å­¦ç¿’ã—ã¾ã™ã€‚
>
> æ¬¡ã®ã“ã¨ãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼š
> - ãƒ¡ãƒ¢ãƒªã‚·ã‚¹ãƒ†ãƒ ã®ãƒ•ã‚¡ã‚¤ãƒ«æ§‹é€ ã¨ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãƒ¡ã‚«ãƒ‹ã‚ºãƒ 
> - ãƒ™ã‚¯ãƒˆãƒ«æ¤œç´¢ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã®è¨­å®šï¼ˆOpenAIã€Geminiã€ãƒ­ãƒ¼ã‚«ãƒ«ï¼‰
> - ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰æ¤œç´¢ï¼ˆBM25 + ãƒ™ã‚¯ãƒˆãƒ«ï¼‰ã‚’ä½¿ç”¨ã—ã¦æ¤œç´¢ç²¾åº¦ã‚’å‘ä¸Š
> - CLI ã«ã‚ˆã‚‹ãƒ¡ãƒ¢ãƒªã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¨æ¤œç´¢ã®ç®¡ç†

---

## ä»˜éŒ²ï¼šã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹

<details>
<summary><strong>ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®å ´æ‰€ã‚’è¡¨ç¤º</strong></summary>

> æ›´æ–°æ—¥æ™‚ï¼š2026-01-27

| æ©Ÿèƒ½ | ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ | è¡Œç•ªå· |
|------|-----------|--------|
| Cron è¨­å®šå‹å®šç¾© | [`src/config/types.cron.ts`](https://github.com/clawdbot/clawdbot/blob/main/src/config/types.cron.ts#L1-L6) | 1-6 |
| Cron ã‚³ã‚¢å‹å®šç¾© | [`src/cron/types.ts`](https://github.com/clawdbot/clawdbot/blob/main/src/cron/types.ts#L1-L95) | 1-95 |
| Cron Service | [`src/cron/service.ts`](https://github.com/clawdbot/clawdbot/blob/main/src/cron/service.ts#L1-L49) | 1-49 |
| Cron æ“ä½œå®Ÿè£… | [`src/cron/service/ops.ts`](https://github.com/clawdbot/clawdbot/blob/main/src/cron/service/ops.ts#L1-L141) | 1-141 |
| Cron ãƒ„ãƒ¼ãƒ«å®Ÿè£… | [`src/agents/tools/cron-tool.ts`](https://github.com/clawdbot/clawdbot/blob/main/src/agents/tools/cron-tool.ts#L1-L291) | 1-291 |
| Gateway Cron ãƒ¡ã‚½ãƒƒãƒ‰ | [`src/gateway/server-methods/cron.ts`](https://github.com/clawdbot/clawdbot/blob/main/src/gateway/server-methods/cron.ts#L1-L205) | 1-205 |
| Hooks è¨­å®šå‹å®šç¾© | [`src/config/types.hooks.ts`](https://github.com/clawdbot/clawdbot/blob/main/src/config/types.hooks.ts#L1-L125) | 1-125 |
| Hooks Gmail ãƒ„ãƒ¼ãƒ« | [`src/hooks/gmail.ts`](https://github.com/clawdbot/clawdbot/blob/main/src/hooks/gmail.ts#L1-L267) | 1-267 |
| Hooks å†…éƒ¨ã‚¤ãƒ™ãƒ³ãƒˆ | [`src/hooks/hooks.ts`](https://github.com/clawdbot/clawdbot/blob/main/src/hooks/hooks.ts#L1-L15) | 1-15 |
| Hooks CLI ã‚³ãƒãƒ³ãƒ‰ | [`src/cli/hooks-cli.ts`](https://github.com/clawdbot/clawdbot/blob/main/src/cli/hooks-cli.ts#L1-L839) | 1-839 |

**é‡è¦ãªå®šæ•°**ï¼š
- `DEFAULT_GMAIL_LABEL = "INBOX"`: Gmail ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ©ãƒ™ãƒ«
- `DEFAULT_GMAIL_TOPIC = "gog-gmail-watch"`: Gmail ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒˆãƒ”ãƒƒã‚¯å
- `DEFAULT_GMAIL_SUBSCRIPTION = "gog-gmail-watch-push"`: Gmail ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³å
- `DEFAULT_GMAIL_MAX_BYTES = 20000`: Gmail ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆæœ€å¤§ãƒ¡ãƒ¼ãƒ«ãƒã‚¤ãƒˆæ•°
- `DEFAULT_GMAIL_RENEW_MINUTES = 720`: Gmail ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆæ›´æ–°é–“éš”ï¼ˆ12 æ™‚é–“ï¼‰

**é‡è¦ãªé–¢æ•°**ï¼š
- `CronService.start()`: Cron ã‚µãƒ¼ãƒ“ã‚¹ã‚’èµ·å‹•
- `CronService.add()`: ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚¿ã‚¹ã‚¯ã‚’è¿½åŠ 
- `CronService.update()`: ã‚¿ã‚¹ã‚¯ã‚’æ›´æ–°
- `CronService.remove()`: ã‚¿ã‚¹ã‚¯ã‚’å‰Šé™¤
- `CronService.run()`: ã‚¿ã‚¹ã‚¯ã‚’å³åº§ã«å®Ÿè¡Œ
- `createCronTool()`: Cron ãƒ„ãƒ¼ãƒ«ã‚’ä½œæˆ
- `resolveGmailHookRuntimeConfig()`: Gmail Hook è¨­å®šã‚’è§£æ
- `buildGogWatchStartArgs()`: Gmail Watch èµ·å‹•ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æ§‹ç¯‰
- `buildGogWatchServeArgs()`: Gmail Watch ã‚µãƒ¼ãƒ“ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æ§‹ç¯‰

</details>
