---
title: "429ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°: ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã¨ã‚¨ãƒ©ãƒ¼å‡¦ç† | Antigravity-Manager"
sidebarTitle: "429ã‚¨ãƒ©ãƒ¼ï¼šè‡ªå‹•ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³"
subtitle: "429ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°: ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã¨ã‚¨ãƒ©ãƒ¼å‡¦ç†"
description: "Antigravity Tools ã® 429 ã‚¨ãƒ©ãƒ¼ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°æ–¹æ³•ã‚’å­¦ã³ã¾ã™ã€‚QUOTA_EXHAUSTEDã€RATE_LIMIT_EXCEEDED ãªã©ã®ã‚¨ãƒ©ãƒ¼ã®è­˜åˆ¥ã¨å‡¦ç†ã‚’ãƒã‚¹ã‚¿ãƒ¼ã—ã€Monitor ã¨ X-Account-Email ã‚’ä½¿ã£ã¦å•é¡Œã‚’ç´ æ—©ãç‰¹å®šã—ã¾ã™ã€‚"
tags:
  - "FAQ"
  - "ã‚¨ãƒ©ãƒ¼ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°"
  - "ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°"
  - "429ã‚¨ãƒ©ãƒ¼"
prerequisite:
  - "start-getting-started"
  - "advanced-scheduling"
order: 3
---
# 429/å®¹é‡ã‚¨ãƒ©ãƒ¼ï¼šã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã®æ­£ã—ã„æœŸå¾…ã¨ãƒ¢ãƒ‡ãƒ«å®¹é‡æ¯æ¸‡ã®èª¤è§£

## å­¦ã‚“ã å¾Œã§ãã‚‹ã“ã¨

- ã€Œã‚¯ã‚©ãƒ¼ã‚¿ä¸è¶³ã€ã¨ã€Œã‚¢ãƒƒãƒ—ã‚¹ãƒˆãƒªãƒ¼ãƒ ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã€ã‚’æ­£ã—ãåŒºåˆ¥ã—ã€èª¤åˆ¤ã‚’é¿ã‘ã‚‰ã‚Œã‚‹
- Antigravity Tools ã®è‡ªå‹•ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã¨æœŸå¾…ã•ã‚Œã‚‹å‹•ä½œã‚’ç†è§£ã§ãã‚‹
- 429 ã‚¨ãƒ©ãƒ¼ã«é­é‡ã—ãŸã¨ãã€å•é¡Œã‚’ç´ æ—©ãç‰¹å®šã—ã€è¨­å®šã‚’æœ€é©åŒ–ã§ãã‚‹

## ç¾åœ¨ã®æ‚©ã¿

- 429 ã‚¨ãƒ©ãƒ¼ãŒè¿”ã£ã¦ãã‚‹ã¨ã€èª¤ã£ã¦ã€Œãƒ¢ãƒ‡ãƒ«ã«å®¹é‡ãŒãªã„ã€ã¨æ€ã†
- è¤‡æ•°ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’è¨­å®šã—ã¦ã„ã‚‹ã®ã«ã€ä¾ç„¶ã¨ã—ã¦é »ç¹ã« 429 ã«é­é‡ã—ã€è¨­å®šå•é¡Œã‹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆå•é¡Œã‹ã‚ã‹ã‚‰ãªã„
- ã‚·ã‚¹ãƒ†ãƒ ãŒã„ã¤è‡ªå‹•çš„ã«ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹ã®ã‹ã€ã„ã¤ã€Œè©°ã¾ã‚‹ã€ã®ã‹ãŒä¸æ˜ç¢º

## ã‚³ã‚¢ã‚³ãƒ³ã‚»ãƒ—ãƒˆ

### 429 ã‚¨ãƒ©ãƒ¼ã¨ã¯ï¼Ÿ

**429 Too Many Requests** ã¯ HTTP ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã§ã™ã€‚Antigravity Tools ã§ã¯ã€429 ã¯ã€Œãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒå¤šã™ãã‚‹ã€ã ã‘ã§ãªãã€ã‚¯ã‚©ãƒ¼ã‚¿æ¯æ¸‡ã€ãƒ¢ãƒ‡ãƒ«ã®ä¸€æ™‚çš„ãªéè² è·ãªã©ã€Œã‚ãªãŸãŒä¸€æ™‚çš„ã«ä½¿ç”¨ã§ããªã„ã€ä¿¡å·ã®ã‚«ãƒ†ã‚´ãƒªã‚’è¡¨ã—ã¾ã™ã€‚

::: info ãƒ—ãƒ­ã‚­ã‚·ã¯ 429 ã®åŸå› ã‚’è­˜åˆ¥ã—ã‚ˆã†ã¨ã—ã¾ã™

ãƒ—ãƒ­ã‚­ã‚·ã¯ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒœãƒ‡ã‚£ã‹ã‚‰ `error.details[0].reason` ã¾ãŸã¯ `error.message` ã‚’è§£æã—ã€429 ã‚’å¤§ã¾ã‹ã«ã„ãã¤ã‹ã®ã‚¿ã‚¤ãƒ—ã«åˆ†ã‘ã¾ã™ï¼ˆå®Ÿéš›ã¯è¿”ã‚Šå€¤ã«ä¾å­˜ã—ã¾ã™ï¼‰ï¼š

| ãƒ—ãƒ­ã‚­ã‚·è­˜åˆ¥ã‚¿ã‚¤ãƒ— | ä¸€èˆ¬çš„ãª reason / æ‰‹ãŒã‹ã‚Š | å…¸å‹çš„ãªç‰¹å¾´ |
|--- | --- | ---|
| **ã‚¯ã‚©ãƒ¼ã‚¿æ¯æ¸‡** | `QUOTA_EXHAUSTED` / ãƒ†ã‚­ã‚¹ãƒˆã« `exhausted`ã€`quota` ã‚’å«ã‚€ | ã‚¯ã‚©ãƒ¼ã‚¿ãŒæ›´æ–°ã•ã‚Œã‚‹ã¾ã§å¾…ã¤å¿…è¦ãŒã‚ã‚‹å¯èƒ½æ€§ |
| **ãƒ¬ãƒ¼ãƒˆåˆ¶é™** | `RATE_LIMIT_EXCEEDED` / ãƒ†ã‚­ã‚¹ãƒˆã« `per minute`ã€`rate limit`ã€`too many requests` ã‚’å«ã‚€ | é€šå¸¸ã¯æ•°åç§’ãƒ¬ãƒ™ãƒ«ã®ã‚¯ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³ |
| **ãƒ¢ãƒ‡ãƒ«å®¹é‡ä¸è¶³** | `MODEL_CAPACITY_EXHAUSTED` / ãƒ†ã‚­ã‚¹ãƒˆã« `model_capacity` ã‚’å«ã‚€ | ä¸€èˆ¬çš„ã«ã¯ä¸€æ™‚çš„ãªéè² è·ã§ã€å¾Œã§å›å¾©å¯èƒ½ |
| **ä¸æ˜** | è§£æä¸èƒ½ | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚¯ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³æˆ¦ç•¥ã«å¾“ã†

:::

### Antigravity Tools ã®è‡ªå‹•å‡¦ç†

ä¸€å›ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§ 429ï¼ˆãŠã‚ˆã³ä¸€éƒ¨ã® 5xx/éè² è·çŠ¶æ…‹ï¼‰ã«é­é‡ã—ãŸã¨ãã€ãƒ—ãƒ­ã‚­ã‚·ã¯é€šå¸¸ã‚µãƒ¼ãƒãƒ¼å´ã§ 2 ã¤ã®ã“ã¨ã‚’è¡Œã„ã¾ã™ï¼š

1. **ã‚¯ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³æ™‚é–“ã‚’è¨˜éŒ²**ï¼šã“ã®ã‚¨ãƒ©ãƒ¼ã‚’ `RateLimitTracker` ã«æ›¸ãè¾¼ã¿ã€å¾Œç¶šã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆé¸æŠæ™‚ã«ã€Œã¾ã ã‚¯ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³ä¸­ã€ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ç©æ¥µçš„ã«å›é¿ã™ã‚‹
2. **å†è©¦è¡Œå†…ã§ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³**ï¼šHandlers ã¯å˜ä¸€ãƒªã‚¯ã‚¨ã‚¹ãƒˆå†…ã§è¤‡æ•°å›ã®è©¦è¡Œã‚’è¡Œã„ã€å†è©¦è¡Œæ™‚ã« `force_rotate=true` ã¨ãªã‚Šã€TokenManager ãŒæ¬¡ã®åˆ©ç”¨å¯èƒ½ãªã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’é¸æŠã™ã‚‹ã‚ˆã†ã«ãƒˆãƒªã‚¬ãƒ¼ã™ã‚‹

::: tip ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’åˆ‡ã‚Šæ›¿ãˆãŸã‹ã©ã†ã‹ã‚’ã©ã†çŸ¥ã‚‹ã‹
ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£ãŒå¤‰ã‚ã‚‰ãªãã¦ã‚‚ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã«ã¯é€šå¸¸ `X-Account-Email`ï¼ˆãŠã‚ˆã³ `X-Mapped-Model`ï¼‰ãŒå«ã¾ã‚Œã¾ã™ã€‚ã“ã‚Œã‚’ä½¿ã£ã¦ã€Œä»Šå›ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒã©ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½¿ã£ãŸã‹ã€ã‚’æ¤œè¨¼ã§ãã¾ã™ã€‚
:::

## ã„ã¤ 429 ã‚¨ãƒ©ãƒ¼ã«é­é‡ã™ã‚‹ã‹

### ã‚·ãƒŠãƒªã‚ª 1ï¼šå˜ä¸€ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒé€Ÿã™ãã‚‹

**ç¾è±¡**ï¼šã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒ 1 ã¤ã ã‘ã§ã‚‚ã€çŸ­æ™‚é–“ã«å¤§é‡ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ã‚‹ã¨ 429 ãŒãƒˆãƒªã‚¬ãƒ¼ã•ã‚Œã‚‹

**åŸå› **ï¼šå„ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã«ã¯ç‹¬è‡ªã®ãƒ¬ãƒ¼ãƒˆåˆ¶é™ï¼ˆRPM/TPMï¼‰ãŒã‚ã‚Šã€è¶…ãˆã‚‹ã¨åˆ¶é™ã•ã‚Œã‚‹

**è§£æ±º**ï¼š
- ã‚¢ã‚«ã‚¦ãƒ³ãƒˆæ•°ã‚’å¢—ã‚„ã™
- ãƒªã‚¯ã‚¨ã‚¹ãƒˆé »åº¦ã‚’ä¸‹ã’ã‚‹
- å›ºå®šã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ¢ãƒ¼ãƒ‰ã‚’ä½¿ã£ã¦åˆ†æ•£ã•ã›ã‚‹ï¼ˆã€Œå›ºå®šã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ¢ãƒ¼ãƒ‰ã€ã‚’å‚ç…§ï¼‰

### ã‚·ãƒŠãƒªã‚ª 2ï¼šã™ã¹ã¦ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒåŒæ™‚ã«ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã•ã‚Œã‚‹

**ç¾è±¡**ï¼šè¤‡æ•°ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒã‚ã‚‹ã®ã«ã€ã™ã¹ã¦ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒ 429 ã‚’è¿”ã™

**åŸå› **ï¼š
- ã‚¢ã‚«ã‚¦ãƒ³ãƒˆç·æ•°ãŒã‚ãªãŸã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆé »åº¦ã‚’æ”¯ãˆã‚‹ã®ã«ä¸ååˆ†
- ã™ã¹ã¦ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒã»ã¼åŒæ™‚ã«ãƒ¬ãƒ¼ãƒˆåˆ¶é™/éè² è·ã‚’ãƒˆãƒªã‚¬ãƒ¼ã—ãŸ

**è§£æ±º**ï¼š
- ã•ã‚‰ã«ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’è¿½åŠ 
- ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°ãƒ¢ãƒ¼ãƒ‰ã‚’ã€Œãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å„ªå…ˆã€ã«èª¿æ•´ï¼ˆã‚¹ãƒ†ã‚£ãƒƒã‚­ãƒ¼ã‚»ãƒƒã‚·ãƒ§ãƒ³ã¨ 60 ç§’ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦å†åˆ©ç”¨ã‚’ã‚¹ã‚­ãƒƒãƒ—ï¼‰
- ã‚¯ã‚©ãƒ¼ã‚¿ä¿è­·ãŒåˆ©ç”¨å¯èƒ½ãªã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’èª¤ã£ã¦é™¤å¤–ã—ã¦ã„ãªã„ã‹ç¢ºèª

### ã‚·ãƒŠãƒªã‚ª 3ï¼šã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒã‚¯ã‚©ãƒ¼ã‚¿ä¿è­·ã§èª¤åˆ¤å®šã•ã‚Œã‚‹

**ç¾è±¡**ï¼šã‚ã‚‹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ã‚¯ã‚©ãƒ¼ã‚¿ã¯ååˆ†ã«ã‚ã‚‹ã®ã«ã€ã‚·ã‚¹ãƒ†ãƒ ãŒãšã£ã¨ãã‚Œã‚’ã‚¹ã‚­ãƒƒãƒ—ã™ã‚‹

**åŸå› **ï¼š
- **ã‚¯ã‚©ãƒ¼ã‚¿ä¿è­·**ãŒæœ‰åŠ¹ã§ã€é–¾å€¤ãŒé«˜ã™ãã‚‹
- ãã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ç‰¹å®šãƒ¢ãƒ‡ãƒ«ã‚¯ã‚©ãƒ¼ã‚¿ãŒé–¾å€¤ã‚ˆã‚Šä½ã„
- ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒæ‰‹å‹•ã§ `proxy_disabled` ã¨ãƒãƒ¼ã‚¯ã•ã‚Œã¦ã„ã‚‹

**è§£æ±º**ï¼š
- ã‚¯ã‚©ãƒ¼ã‚¿ä¿è­·è¨­å®šã‚’ç¢ºèªï¼ˆSettings â†’ Quota Protectionï¼‰ã€ä½¿ç”¨å¼·åº¦ã«å¿œã˜ã¦é–¾å€¤ã¨ç›£è¦–ãƒ¢ãƒ‡ãƒ«ã‚’èª¿æ•´
- ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ‡ãƒ¼ã‚¿ã§ `protected_models` ã‚’ç¢ºèªã—ã€ä¿è­·æˆ¦ç•¥ã§ã‚¹ã‚­ãƒƒãƒ—ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª

## æ‰‹é †é€šã‚Šã«é€²ã‚ã‚‹

### ç¬¬ 1 ã‚¹ãƒ†ãƒƒãƒ—ï¼š429 ã‚¨ãƒ©ãƒ¼ã‚¿ã‚¤ãƒ—ã‚’è­˜åˆ¥

**ãªãœã‹**ï¼šç•°ãªã‚‹ã‚¿ã‚¤ãƒ—ã® 429 ã‚¨ãƒ©ãƒ¼ã¯ç•°ãªã‚‹å‡¦ç†æ–¹æ³•ãŒå¿…è¦

Proxy Monitor ã§ 429 ã‚¨ãƒ©ãƒ¼ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒœãƒ‡ã‚£ã‚’ç¢ºèªã—ã€2 ç¨®é¡ã®æƒ…å ±ã«ç„¦ç‚¹ã‚’å½“ã¦ã‚‹ï¼š

- **åŸå› **ï¼š`error.details[0].reason`ï¼ˆä¾‹ï¼š`RATE_LIMIT_EXCEEDED`ã€`QUOTA_EXHAUSTED`ï¼‰ã¾ãŸã¯ `error.message`
- **å¾…ã¡æ™‚é–“**ï¼š`RetryInfo.retryDelay` ã¾ãŸã¯ `details[0].metadata.quotaResetDelay`ï¼ˆå­˜åœ¨ã™ã‚‹å ´åˆï¼‰

```json
{
  "error": {
    "details": [
      {
        "reason": "RATE_LIMIT_EXCEEDED",
        "metadata": {
          "quotaResetDelay": "42s"
        }
      }
    ]
  }
}
```

**è¡¨ç¤ºã•ã‚Œã‚‹ã¹ãã‚‚ã®**ï¼š
- ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒœãƒ‡ã‚£ã«å¾…ã¡æ™‚é–“ãŒè¦‹ã¤ã‹ã‚‹å ´åˆï¼ˆä¾‹ï¼š`RetryInfo.retryDelay` ã¾ãŸã¯ `quotaResetDelay`ï¼‰ã€ãƒ—ãƒ­ã‚­ã‚·ã¯é€šå¸¸ã—ã°ã‚‰ãå¾…ã£ã¦ã‹ã‚‰å†è©¦è¡Œã—ã¾ã™
- å¾…ã¡æ™‚é–“ãŒãªã„å ´åˆã€ãƒ—ãƒ­ã‚­ã‚·ã¯çµ„ã¿è¾¼ã¿æˆ¦ç•¥ã«å¾“ã£ã¦ãã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã«ã€Œã‚¯ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³æœŸé–“ã€ã‚’è¿½åŠ ã—ã€å†è©¦è¡Œæ™‚ã«ç›´æ¥æ¬¡ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã«åˆ‡ã‚Šæ›¿ãˆã¾ã™

### ç¬¬ 2 ã‚¹ãƒ†ãƒƒãƒ—ï¼šã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°è¨­å®šã‚’ç¢ºèª

**ãªãœã‹**ï¼šã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°è¨­å®šã¯ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³é »åº¦ã¨å„ªå…ˆåº¦ã«ç›´æ¥å½±éŸ¿ã—ã¾ã™

**API Proxy** ãƒšãƒ¼ã‚¸ã«å…¥ã‚Šã€ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°æˆ¦ç•¥ã‚’ç¢ºèªï¼š

| è¨­å®šé …ç›® | èª¬æ˜ | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ/æ¨å¥¨ |
|--- | --- | ---|
| **Scheduling Mode** | ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°ãƒ¢ãƒ¼ãƒ‰ | `Balance`ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰ |
| **Preferred Account** | å›ºå®šã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ¢ãƒ¼ãƒ‰ | æœªé¸æŠï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰ |

**ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°ãƒ¢ãƒ¼ãƒ‰æ¯”è¼ƒ**ï¼š

| ãƒ¢ãƒ¼ãƒ‰ | ã‚¢ã‚«ã‚¦ãƒ³ãƒˆå†åˆ©ç”¨æˆ¦ç•¥ | ãƒ¬ãƒ¼ãƒˆåˆ¶é™å‡¦ç† | é©ç”¨ã‚·ãƒŠãƒªã‚ª |
|--- | --- | --- | ---|
| **CacheFirst** | ã‚¹ãƒ†ã‚£ãƒƒã‚­ãƒ¼ã‚»ãƒƒã‚·ãƒ§ãƒ³ã¨ 60 ç§’ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦å†åˆ©ç”¨ã‚’æœ‰åŠ¹ | **å„ªå…ˆçš„ã«å¾…æ©Ÿ**ã€Prompt Caching ãƒ’ãƒƒãƒˆç‡ã‚’å¤§å¹…ã«å‘ä¸Š | ä¼šè©±å‹/é«˜ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆç‡ãŒå¿…è¦ |
| **Balance** | ã‚¹ãƒ†ã‚£ãƒƒã‚­ãƒ¼ã‚»ãƒƒã‚·ãƒ§ãƒ³ã¨ 60 ç§’ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦å†åˆ©ç”¨ã‚’æœ‰åŠ¹ | **ç›´ã¡ã«åˆ‡ã‚Šæ›¿ãˆ**ã¦ä»£æ›¿ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã€æˆåŠŸç‡ã¨ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’ä¸¡ç«‹ | ä¸€èˆ¬çš„ãªã‚·ãƒŠãƒªã‚ªã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ |
| **PerformanceFirst** | ã‚¹ãƒ†ã‚£ãƒƒã‚­ãƒ¼ã‚»ãƒƒã‚·ãƒ§ãƒ³ã¨ 60 ç§’ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦å†åˆ©ç”¨ã‚’ã‚¹ã‚­ãƒƒãƒ—ã€ç´”ç²‹ãªãƒ©ã‚¦ãƒ³ãƒ‰ãƒ­ãƒ“ãƒ³ãƒ¢ãƒ¼ãƒ‰ | ç›´ã¡ã«åˆ‡ã‚Šæ›¿ãˆã€ã‚¢ã‚«ã‚¦ãƒ³ãƒˆè² è·ãŒæœ€ã‚‚å‡ç­‰ | é«˜ä¸¦åˆ—ã€ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¬ã‚¹ãƒªã‚¯ã‚¨ã‚¹ãƒˆ |

::: tip ã‚­ãƒ£ãƒƒã‚·ãƒ¥å„ªå…ˆ vs ãƒãƒ©ãƒ³ã‚¹ãƒ¢ãƒ¼ãƒ‰
Prompt Caching ã‚’ä½¿ç”¨ã—ã¦ã„ã¦ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆç‡ã‚’ä¸Šã’ãŸã„å ´åˆã€`CacheFirst` ã‚’é¸æŠã—ã¦ãã ã•ã„ â€” ãƒ¬ãƒ¼ãƒˆåˆ¶é™æ™‚ã«å„ªå…ˆçš„ã«å¾…æ©Ÿã—ã¦ã™ãã«ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’åˆ‡ã‚Šæ›¿ãˆã¾ã›ã‚“ã€‚æˆåŠŸç‡ã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚ˆã‚Šé‡è¦–ã™ã‚‹å ´åˆã€`Balance` ã‚’é¸æŠã—ã¦ãã ã•ã„ â€” ãƒ¬ãƒ¼ãƒˆåˆ¶é™æ™‚ã«ã™ãã«ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’åˆ‡ã‚Šæ›¿ãˆã¾ã™ã€‚
:::

::: tip ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å„ªå…ˆãƒ¢ãƒ¼ãƒ‰
ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒã‚¹ãƒ†ãƒ¼ãƒˆãƒ¬ã‚¹ï¼ˆç”»åƒç”Ÿæˆã€ç‹¬ç«‹ã‚¯ã‚¨ãƒªãªã©ï¼‰ã®å ´åˆã€`PerformanceFirst` ã‚’è©¦ã—ã¦ãã ã•ã„ã€‚ã‚¹ãƒ†ã‚£ãƒƒã‚­ãƒ¼ã‚»ãƒƒã‚·ãƒ§ãƒ³ã¨ 60 ç§’ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦å†åˆ©ç”¨ã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ã€é€£ç¶šãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒç•°ãªã‚‹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã«è½ã¡ã‚„ã™ãã—ã¾ã™ã€‚
:::

### ç¬¬ 3 ã‚¹ãƒ†ãƒƒãƒ—ï¼šã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ãŒæ­£å¸¸ã«å‹•ä½œã—ã¦ã„ã‚‹ã‹æ¤œè¨¼

**ãªãœã‹**ï¼šã‚·ã‚¹ãƒ†ãƒ ãŒè‡ªå‹•çš„ã«ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’åˆ‡ã‚Šæ›¿ãˆã‚‰ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª

**æ–¹æ³• 1ï¼šãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’è¦‹ã‚‹**

curl ã¾ãŸã¯è‡ªåˆ†ã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã§ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ˜ãƒƒãƒ€ãƒ¼ã‚’å°åˆ·ã—ã€`X-Account-Email` ãŒå¤‰åŒ–ã™ã‚‹ã‹è¦³å¯Ÿ

**æ–¹æ³• 2ï¼šãƒ­ã‚°ã‚’ç¢ºèª**

ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆã‚·ã‚¹ãƒ†ãƒ ã®å ´æ‰€ã«å¿œã˜ã¦ï¼‰ã‚’é–‹ãã€`ğŸ”„ [Token Rotation]` ã‚’æ¤œç´¢ï¼š

```
ğŸ”„ [Token Rotation] Accounts: [
  "account1@example.com(protected=[])",
  "account2@example.com(protected=[])",
  "account3@example.com(protected=[])"
]
```

**æ–¹æ³• 3ï¼šProxy Monitor ã‚’ä½¿ç”¨**

**Monitor** ãƒšãƒ¼ã‚¸ã§ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ­ã‚°ã‚’ç¢ºèªã—ã€ä»¥ä¸‹ã«æ³¨ç›®ï¼š
- **Account** ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒç•°ãªã‚‹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆé–“ã§åˆ‡ã‚Šæ›¿ã‚ã£ã¦ã„ã‚‹ã‹
- **Status** ãŒ 429 ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å¾Œã€ç•°ãªã‚‹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½¿ã£ãŸæˆåŠŸã—ãŸãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒã‚ã‚‹ã‹

**è¡¨ç¤ºã•ã‚Œã‚‹ã¹ãã‚‚ã®**ï¼š
- ã‚ã‚‹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒ 429 ã‚’è¿”ã—ãŸå¾Œã€å¾Œç¶šãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒè‡ªå‹•çš„ã«ä»–ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã«åˆ‡ã‚Šæ›¿ã‚ã‚‹
- è¤‡æ•°ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒåŒã˜ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½¿ã£ã¦ã™ã¹ã¦å¤±æ•—ã—ã¦ã„ã‚‹å ´åˆã€ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°è¨­å®šã®å•é¡Œã®å¯èƒ½æ€§ãŒã‚ã‚‹

### ç¬¬ 4 ã‚¹ãƒ†ãƒƒãƒ—ï¼šã‚¢ã‚«ã‚¦ãƒ³ãƒˆå„ªå…ˆåº¦ã‚’æœ€é©åŒ–

**ãªãœã‹**ï¼šã‚·ã‚¹ãƒ†ãƒ ãŒå„ªå…ˆçš„ã«é«˜ã‚¯ã‚©ãƒ¼ã‚¿/é«˜ãƒ©ãƒ³ã‚¯ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½¿ã†ã‚ˆã†ã«ã—ã€429 ç¢ºç‡ã‚’æ¸›ã‚‰ã™

TokenManager ã§ã¯ã€ã‚¢ã‚«ã‚¦ãƒ³ãƒˆé¸æŠå‰ã«ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ—ãƒ¼ãƒ«ã‚’ä¸€åº¦ã‚½ãƒ¼ãƒˆã—ã¾ã™ï¼ˆ`ğŸ”„ [Token Rotation] Accounts: ...` ã¨å°åˆ·ã•ã‚Œã¾ã™ï¼‰ï¼š

1. **ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ©ãƒ³ã‚¯å„ªå…ˆ**ï¼šULTRA > PRO > FREE
2. **ã‚¯ã‚©ãƒ¼ã‚¿ãƒ‘ãƒ¼ã‚»ãƒ³ãƒ†ãƒ¼ã‚¸å„ªå…ˆ**ï¼šåŒãƒ©ãƒ³ã‚¯å†…ã§ã€ã‚¯ã‚©ãƒ¼ã‚¿ãŒé«˜ã„ã‚‚ã®ãŒå‰
3. **ã‚½ãƒ¼ãƒˆã‚¨ãƒ³ãƒˆãƒªãƒ¼**ï¼šã“ã®ã‚½ãƒ¼ãƒˆã¯ãƒ—ãƒ­ã‚­ã‚·å´ã§è¡Œã‚ã‚Œã€æœ€çµ‚çš„ã«ã©ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½¿ã†ã‹ã¯ãƒ—ãƒ­ã‚­ã‚·å´ã‚½ãƒ¼ãƒˆ + å¯ç”¨æ€§åˆ¤æ–­ãŒåŸºæº–

::: info ã‚¤ãƒ³ãƒ†ãƒªã‚¸ã‚§ãƒ³ãƒˆã‚½ãƒ¼ãƒˆåŸç†ï¼ˆãƒ—ãƒ­ã‚­ã‚·å´ï¼‰
å„ªå…ˆåº¦ã¯ `ULTRA > PRO > FREE`ï¼›åŒä¸€ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ©ãƒ³ã‚¯å†…ã§ã¯ `remaining_quota`ï¼ˆã‚¢ã‚«ã‚¦ãƒ³ãƒˆæœ€å¤§æ®‹ã‚Šã‚¯ã‚©ãƒ¼ã‚¿ãƒ‘ãƒ¼ã‚»ãƒ³ãƒ†ãƒ¼ã‚¸ï¼‰é™é †ã€‚
:::

**æ“ä½œ**ï¼š
- ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ãƒ‰ãƒ©ãƒƒã‚°ã—ã¦è¡¨ç¤ºé †åºã‚’èª¿æ•´ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
- ã‚¯ã‚©ãƒ¼ã‚¿ã‚’ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ï¼ˆAccounts â†’ ã™ã¹ã¦ã®ã‚¯ã‚©ãƒ¼ã‚¿ã‚’ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ï¼‰
- ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ãƒ©ãƒ³ã‚¯ã¨ã‚¯ã‚©ãƒ¼ã‚¿ã‚’ç¢ºèª

## ç½ ã®è­¦å‘Š

### âŒ é–“é•ã„ 1ï¼š429 ã‚’ã€Œãƒ¢ãƒ‡ãƒ«ã«å®¹é‡ãŒãªã„ã€ã¨èª¤è§£

**ç¾è±¡**ï¼š429 ã‚¨ãƒ©ãƒ¼ã‚’è¦‹ã‚‹ã¨ã€ãƒ¢ãƒ‡ãƒ«ã«å®¹é‡ãŒãªã„ã¨æ€ã†

**æ­£ã—ã„ç†è§£**ï¼š
- 429 ã¯**ãƒ¬ãƒ¼ãƒˆåˆ¶é™**ã§ã€å®¹é‡å•é¡Œã§ã¯ãªã„
- ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’å¢—ã‚„ã™ã¨ 429 ç¢ºç‡ã‚’ä¸‹ã’ã‚‰ã‚Œã‚‹
- ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°ãƒ¢ãƒ¼ãƒ‰ã‚’èª¿æ•´ã™ã‚‹ã¨åˆ‡ã‚Šæ›¿ãˆé€Ÿåº¦ã‚’ä¸Šã’ã‚‰ã‚Œã‚‹

### âŒ é–“é•ã„ 2ï¼šã‚¯ã‚©ãƒ¼ã‚¿ä¿è­·é–¾å€¤ã‚’é«˜ã™ãã‚‹

**ç¾è±¡**ï¼šã‚¯ã‚©ãƒ¼ã‚¿ã¯ååˆ†ãªã®ã«ã€ã‚·ã‚¹ãƒ†ãƒ ãŒãšã£ã¨ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ã‚¹ã‚­ãƒƒãƒ—ã™ã‚‹

**åŸå› **ï¼šQuota Protection ã¯é–¾å€¤ã‚ˆã‚Šä½ã„ãƒ¢ãƒ‡ãƒ«ã‚’ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã® `protected_models` ã«è¿½åŠ ã—ã€ãƒ—ãƒ­ã‚­ã‚·ã¯ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°æ™‚ã«ã€Œä¿è­·ã•ã‚ŒãŸãƒ¢ãƒ‡ãƒ«ã€ã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ã¾ã™ã€‚é–¾å€¤ãŒé«˜ã™ãã‚‹ã¨ã€åˆ©ç”¨å¯èƒ½ãªã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒéåº¦ã«é™¤å¤–ã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

**ä¿®æ­£**ï¼š
- **Settings â†’ Quota Protection** ã«æˆ»ã‚Šã€ç›£è¦–ãƒ¢ãƒ‡ãƒ«ã¨é–¾å€¤ã‚’èª¿æ•´
- ã©ã®ãƒ¢ãƒ‡ãƒ«ãŒä¿è­·ã•ã‚ŒãŸã®ã‹ã‚’ã¯ã£ãã‚Šã•ã›ãŸã„å ´åˆã€ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ‡ãƒ¼ã‚¿ã§ `protected_models` ã‚’è¦‹ã‚‹

### âŒ é–“é•ã„ 3ï¼šå›ºå®šã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ¢ãƒ¼ãƒ‰ã§ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã§ããªã„

**ç¾è±¡**ï¼š`Preferred Account` ã‚’è¨­å®šã—ãŸãŒã€ãã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒãƒ¬ãƒ¼ãƒˆåˆ¶é™ã•ã‚Œã‚‹ã¨ã‚·ã‚¹ãƒ†ãƒ ãŒã€Œè©°ã¾ã‚‹ã€

**åŸå› **ï¼šå›ºå®šã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ¢ãƒ¼ãƒ‰ã§ã¯ã€ã‚·ã‚¹ãƒ†ãƒ ã¯æŒ‡å®šã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’å„ªå…ˆçš„ã«ä½¿ç”¨ã—ã€ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒåˆ©ç”¨ä¸å¯ã®å ´åˆã®ã¿ãƒ©ã‚¦ãƒ³ãƒ‰ãƒ­ãƒ“ãƒ³ã«ãƒ€ã‚¦ãƒ³ã‚°ãƒ¬ãƒ¼ãƒ‰ã—ã¾ã™ã€‚

**ä¿®æ­£**ï¼š
- å›ºå®šã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒå¿…è¦ãªã„å ´åˆã€`Preferred Account` ã‚’ã‚¯ãƒªã‚¢
- ã¾ãŸã¯å›ºå®šã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ã‚¯ã‚©ãƒ¼ã‚¿ãŒååˆ†ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã€ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã‚’é¿ã‘ã‚‹

## ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆ âœ…

- [ ] ã‚¯ã‚©ãƒ¼ã‚¿ä¸è¶³ã¨ã‚¢ãƒƒãƒ—ã‚¹ãƒˆãƒªãƒ¼ãƒ ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã‚’åŒºåˆ¥ã§ãã‚‹
- [ ] Proxy Monitor ã§ 429 ã‚¨ãƒ©ãƒ¼è©³ç´°ã‚’ç¢ºèªã™ã‚‹æ–¹æ³•ã‚’çŸ¥ã£ã¦ã„ã‚‹
- [ ] 3 ã¤ã®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°ãƒ¢ãƒ¼ãƒ‰ã®é•ã„ã¨é©ç”¨ã‚·ãƒŠãƒªã‚ªã‚’ç†è§£ã—ã¦ã„ã‚‹
- [ ] ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ãŒæ­£å¸¸ã«å‹•ä½œã—ã¦ã„ã‚‹ã‹ç¢ºèªã™ã‚‹æ–¹æ³•ã‚’çŸ¥ã£ã¦ã„ã‚‹
- [ ] ã‚¢ã‚«ã‚¦ãƒ³ãƒˆå„ªå…ˆåº¦ã‚’æœ€é©åŒ–ã—ã€ã‚¯ã‚©ãƒ¼ã‚¿ä¿è­·æˆ¦ç•¥ã‚’ç¢ºèªã§ãã‚‹

## ã‚ˆãã‚ã‚‹è³ªå•

### Q1ï¼šè¤‡æ•°ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒã‚ã‚‹ã®ã«ã€ä¾ç„¶ã¨ã—ã¦ 429 ã«é­é‡ã™ã‚‹ã®ã¯ãªãœï¼Ÿ

Aï¼šå¯èƒ½ãªåŸå› ï¼š
1. ã™ã¹ã¦ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒåŒæ™‚ã«ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã‚’ãƒˆãƒªã‚¬ãƒ¼ï¼ˆãƒªã‚¯ã‚¨ã‚¹ãƒˆé »åº¦ãŒé«˜ã™ãã‚‹ï¼‰
2. é€£ç¶šãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒã€Œ60 ç§’ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦å†åˆ©ç”¨ã€ã§åŒã˜ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ç¹°ã‚Šè¿”ã—å†åˆ©ç”¨ã—ã€å˜ä¸€ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã«æ‰“ã¡è¾¼ã¿ã‚„ã™ã„
3. ã‚¯ã‚©ãƒ¼ã‚¿ä¿è­·ãŒåˆ©ç”¨å¯èƒ½ãªã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’èª¤ã£ã¦é™¤å¤–
4. ã‚¢ã‚«ã‚¦ãƒ³ãƒˆç·æ•°ãŒã‚ãªãŸã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆé »åº¦ã‚’æ”¯ãˆã‚‹ã®ã«ä¸ååˆ†

**è§£æ±º**ï¼š
- ã•ã‚‰ã«ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’è¿½åŠ 
- `PerformanceFirst` ãƒ¢ãƒ¼ãƒ‰ã‚’ä½¿ç”¨
- Quota Protection ãŒã‚ãªãŸãŒä½¿ã„ãŸã„ãƒ¢ãƒ‡ãƒ«ã‚’ `protected_models` ã«è¿½åŠ ã—ã¦ã„ãªã„ã‹ç¢ºèªï¼ˆå¿…è¦ãªã‚‰ç›£è¦–ãƒ¢ãƒ‡ãƒ«ã¨é–¾å€¤ã‚’èª¿æ•´ï¼‰
- ãƒªã‚¯ã‚¨ã‚¹ãƒˆé »åº¦ã‚’ä¸‹ã’ã‚‹

### Q2ï¼š429 ã‚¨ãƒ©ãƒ¼ã¯è‡ªå‹•çš„ã«å†è©¦è¡Œã•ã‚Œã¾ã™ã‹ï¼Ÿ

Aï¼šå˜ä¸€ãƒªã‚¯ã‚¨ã‚¹ãƒˆå†…ã§è‡ªå‹•å†è©¦è¡Œã•ã‚Œã¾ã™ã€‚**å†è©¦è¡Œå›æ•°ã®ä¸Šé™ã¯é€šå¸¸ 3 å›**ã§ã€å…·ä½“çš„ãªè¨ˆç®—æ–¹æ³•ã¯ `min(3, ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ—ãƒ¼ãƒ«ã‚µã‚¤ã‚º)` ã§ã‚ã‚Šã€å°‘ãªãã¨ã‚‚ 1 å›è©¦è¡Œã—ã¾ã™ã€‚

**å†è©¦è¡Œå›æ•°ã®ä¾‹**ï¼š
- ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ—ãƒ¼ãƒ« 1 ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ â†’ 1 å›è©¦è¡Œï¼ˆå†è©¦è¡Œãªã—ï¼‰
- ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ—ãƒ¼ãƒ« 2 ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ â†’ 2 å›è©¦è¡Œï¼ˆå†è©¦è¡Œ 1 å›ï¼‰
- ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ—ãƒ¼ãƒ« 3 ã¤ä»¥ä¸Šã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ â†’ 3 å›è©¦è¡Œï¼ˆå†è©¦è¡Œ 2 å›ï¼‰

**å¤§ã¾ã‹ãªæµã‚Œ**ï¼š
1. ãƒ¬ãƒ¼ãƒˆåˆ¶é™/éè² è·æƒ…å ±ã‚’è¨˜éŒ²ï¼ˆ`RateLimitTracker` ã«é€²å…¥ï¼‰
2. å¾…ã¡æ™‚é–“ã‚’è§£æã§ãã‚‹å ´åˆï¼ˆä¾‹ï¼š`RetryInfo.retryDelay` / `quotaResetDelay`ï¼‰ã€ã—ã°ã‚‰ãå¾…ã£ã¦ã‹ã‚‰ç¶šè¡Œ
3. å†è©¦è¡Œæ™‚ã«å¼·åˆ¶çš„ã«ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆ`attempt > 0` ã®æ™‚ `force_rotate=true`ï¼‰ã€æ¬¡ã®åˆ©ç”¨å¯èƒ½ãªã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ã‚¢ãƒƒãƒ—ã‚¹ãƒˆãƒªãƒ¼ãƒ ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è©¦è¡Œ

ã™ã¹ã¦ã®è©¦è¡ŒãŒå¤±æ•—ã™ã‚‹ã¨ã€ãƒ—ãƒ­ã‚­ã‚·ã¯ã‚¨ãƒ©ãƒ¼ã‚’ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«è¿”ã—ã¾ã™ã€‚åŒæ™‚ã«ã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ˜ãƒƒãƒ€ãƒ¼ï¼ˆä¾‹ï¼š`X-Account-Email`ï¼‰ã¾ãŸã¯ Proxy Monitor ã‹ã‚‰å®Ÿéš›ã«ä½¿ç”¨ã•ã‚ŒãŸã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ç¢ºèªã§ãã¾ã™ã€‚

### Q3ï¼šã‚ã‚‹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒã©ã®ãã‚‰ã„ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã™ã‚‹ã«ã¯ï¼Ÿ

Aï¼š2 ã¤ã®æ–¹æ³•ãŒã‚ã‚Šã¾ã™ï¼š

**æ–¹æ³• 1**ï¼šãƒ­ã‚°ã‚’ç¢ºèªã—ã€`rate-limited` ã‚’æ¤œç´¢

```
ğŸ”’ [FIX #820] Preferred account xxx@gmail.com is rate-limited, falling back to round-robin
```

**æ–¹æ³• 2**ï¼šãƒ­ã‚°ã«æ®‹ã‚Šå¾…ã¡æ™‚é–“ãŒè¡¨ç¤ºã•ã‚Œã¾ã™

```
All accounts are currently limited. Please wait 30s.
```

### Q4ï¼šã‚¯ã‚©ãƒ¼ã‚¿ä¿è­·ã¨ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã¯åŒã˜ã§ã™ã‹ï¼Ÿ

Aï¼šé•ã„ã¾ã™ã€‚

| ç‰¹æ€§ | ã‚¯ã‚©ãƒ¼ã‚¿ä¿è­· | ãƒ¬ãƒ¼ãƒˆåˆ¶é™è¿½è·¡ |
|--- | --- | ---|
| **ãƒˆãƒªã‚¬ãƒ¼æ¡ä»¶** | ãƒ¢ãƒ‡ãƒ«ã‚¯ã‚©ãƒ¼ã‚¿ãŒé–¾å€¤ã‚ˆã‚Šä½ã„ | 429 ã‚¨ãƒ©ãƒ¼ã‚’å—ä¿¡ |
| **é©ç”¨ç¯„å›²** | ç‰¹å®šã®ãƒ¢ãƒ‡ãƒ« | ã‚¢ã‚«ã‚¦ãƒ³ãƒˆå…¨ä½“ |
| **æŒç¶šæ™‚é–“** | ã‚¯ã‚©ãƒ¼ã‚¿ãŒå›å¾©ã™ã‚‹ã¾ã§ | ã‚¢ãƒƒãƒ—ã‚¹ãƒˆãƒªãƒ¼ãƒ ãŒæ±ºå®šï¼ˆé€šå¸¸æ•°ç§’ã‹ã‚‰æ•°åˆ†ï¼‰ |
| **å‹•ä½œ** | ãã®ãƒ¢ãƒ‡ãƒ«ã‚’ã‚¹ã‚­ãƒƒãƒ— | ãã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ã‚¹ã‚­ãƒƒãƒ— |

### Q5ï¼šã©ã®ã‚ˆã†ã«ã—ã¦ã™ãã«ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹ã“ã¨ã‚’å¼·åˆ¶ã§ãã¾ã™ã‹ï¼Ÿ

Aï¼šã€Œæ¬¡å›ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’åˆ‡ã‚Šæ›¿ãˆã‚„ã™ãã™ã‚‹ã€ã¨ã„ã†è¦³ç‚¹ã‹ã‚‰ç€æ‰‹ã§ãã¾ã™ï¼š

1. **ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°å±¤**ï¼š`PerformanceFirst` ã«åˆ‡ã‚Šæ›¿ãˆã€ã‚¹ãƒ†ã‚£ãƒƒã‚­ãƒ¼ã‚»ãƒƒã‚·ãƒ§ãƒ³ã¨ 60 ç§’ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦å†åˆ©ç”¨ã‚’ã‚¹ã‚­ãƒƒãƒ—
2. **å›ºå®šã‚¢ã‚«ã‚¦ãƒ³ãƒˆ**ï¼š`Preferred Account` ãŒæœ‰åŠ¹ã®å ´åˆã€å…ˆã«ã‚¯ãƒªã‚¢ã€‚ãã†ã—ãªã„ã¨å„ªå…ˆçš„ã«å›ºå®šã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½¿ã†ï¼ˆãƒ¬ãƒ¼ãƒˆåˆ¶é™/ä¿è­·ã•ã‚Œã‚‹ã¾ã§ï¼‰
3. **ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ—ãƒ¼ãƒ«**ï¼šã‚¢ã‚«ã‚¦ãƒ³ãƒˆæ•°ã‚’å¢—ã‚„ã—ã€å˜ä¸€ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒãƒ¬ãƒ¼ãƒˆåˆ¶é™ã•ã‚ŒãŸã¨ãã«ä»£æ›¿ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’è¦‹ã¤ã‘ã‚„ã™ãã™ã‚‹

å˜ä¸€ãƒªã‚¯ã‚¨ã‚¹ãƒˆå†…ã§ã¯ã€ãƒ—ãƒ­ã‚­ã‚·è‡ªä½“ã‚‚å†è©¦è¡Œæ™‚ã«å¼·åˆ¶çš„ã«ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã—ã¾ã™ï¼ˆ`attempt > 0` ã¯ `force_rotate=true` ã‚’ãƒˆãƒªã‚¬ãƒ¼ï¼‰ã€ãŸã ã—å†è©¦è¡Œå›æ•°ã¯ä¸Šé™åˆ¶å¾¡ã‚’å—ã‘ã¾ã™ã€‚

## ãƒ¬ãƒƒã‚¹ãƒ³ã¾ã¨ã‚

- 429 ã¯ Antigravity Tools ã§ã¯ã€Œã‚¢ãƒƒãƒ—ã‚¹ãƒˆãƒªãƒ¼ãƒ ãŒä¸€æ™‚çš„ã«åˆ©ç”¨ä¸å¯ã€ã®ä¿¡å·ã®ã‚«ãƒ†ã‚´ãƒªã§ã‚ã‚Šã€ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã€ã‚¯ã‚©ãƒ¼ã‚¿æ¯æ¸‡ã€ãƒ¢ãƒ‡ãƒ«å®¹é‡ä¸è¶³ãªã©ãŒåŸå› ã®å¯èƒ½æ€§ãŒã‚ã‚‹
- ãƒ—ãƒ­ã‚­ã‚·ã¯ã‚¯ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³æ™‚é–“ã‚’è¨˜éŒ²ã—ã€å˜ä¸€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å†è©¦è¡Œã§ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è©¦ã¿ã‚‹ï¼ˆãŸã ã—å†è©¦è¡Œå›æ•°ã¯é™å®šçš„ï¼‰
- ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°ãƒ¢ãƒ¼ãƒ‰ã€Quota Protectionã€ã‚¢ã‚«ã‚¦ãƒ³ãƒˆæ•°ã¯ã™ã¹ã¦ã‚ãªãŸãŒé­é‡ã™ã‚‹ 429 ã®ç¢ºç‡ã¨å›å¾©é€Ÿåº¦ã«å½±éŸ¿ã™ã‚‹
- Proxy Monitorã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ˜ãƒƒãƒ€ãƒ¼ `X-Account-Email` ã¨ãƒ­ã‚°ã‚’ä½¿ã£ã¦å•é¡Œã‚’ç´ æ—©ãç‰¹å®šã§ãã‚‹

## æ¬¡ã®ãƒ¬ãƒƒã‚¹ãƒ³äºˆå‘Š

> æ¬¡ã®ãƒ¬ãƒƒã‚¹ãƒ³ã§ã¯ **[404/ãƒ‘ã‚¹äº’æ›æ€§ï¼šBase URLã€/v1 ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ã¨ã€Œé‡ãªã‚Šãƒ‘ã‚¹ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ](../404-base-url/)** ã‚’å­¦ã³ã¾ã™
>
> å­¦ã¹ã‚‹ã“ã¨ï¼š
> - æœ€ã‚‚ä¸€èˆ¬çš„ãªæ¥ç¶šã‚¨ãƒ©ãƒ¼ï¼ˆ404ï¼‰ãŒã©ã®ã‚ˆã†ã«ç™ºç”Ÿã™ã‚‹ã‹
> - ç•°ãªã‚‹ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã® base_url é€£çµã®é•ã„
> - 404 å•é¡Œã‚’ç´ æ—©ãä¿®æ­£ã™ã‚‹æ–¹æ³•

---

## ä»˜éŒ²ï¼šã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰å‚ç…§

<details>
<summary><strong>ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®å ´æ‰€ã‚’å±•é–‹</strong></summary>

> æ›´æ–°æ™‚é–“ï¼š2026-01-23

| æ©Ÿèƒ½ | ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ | è¡Œç•ªå· |
|--- | --- | ---|
| 429 å†è©¦è¡Œé…å»¶è§£æï¼ˆRetryInfo / quotaResetDelayï¼‰ | [`src-tauri/src/proxy/upstream/retry.rs`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src-tauri/src/proxy/upstream/retry.rs#L38-L67) | 38-67 |
| Duration è§£æãƒ„ãƒ¼ãƒ« | [`src-tauri/src/proxy/upstream/retry.rs`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src-tauri/src/proxy/upstream/retry.rs#L11-L35) | 11-35 |
| ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°ãƒ¢ãƒ¼ãƒ‰åˆ—æŒ™ï¼ˆCacheFirst/Balance/PerformanceFirstï¼‰ | [`src-tauri/src/proxy/sticky_config.rs`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src-tauri/src/proxy/sticky_config.rs#L3-L12) | 3-12 |
| ãƒ¬ãƒ¼ãƒˆåˆ¶é™åŸå› è§£æã¨ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚¯ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³æˆ¦ç•¥ | [`src-tauri/src/proxy/rate_limit.rs`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src-tauri/src/proxy/rate_limit.rs#L5-L258) | 5-258 |
| MAX_RETRY_ATTEMPTS å®šæ•°å®šç¾©ï¼ˆOpenAI handlerï¼‰ | [`src-tauri/src/proxy/handlers/openai.rs`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src-tauri/src/proxy/handlers/openai.rs#L14) | 14 |
| å†è©¦è¡Œå›æ•°è¨ˆç®—ï¼ˆmax_attempts = min(MAX_RETRY_ATTEMPTS, pool_size)ï¼‰ | [`src-tauri/src/proxy/handlers/openai.rs`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src-tauri/src/proxy/handlers/openai.rs#L830) | 830 |
| OpenAI handlerï¼š429/5xx æ™‚ã«ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã‚’ãƒãƒ¼ã‚¯ã—å†è©¦è¡Œ/ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ | [`src-tauri/src/proxy/handlers/openai.rs`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src-tauri/src/proxy/handlers/openai.rs#L349-L389) | 349-389 |
| ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚½ãƒ¼ãƒˆå„ªå…ˆåº¦ï¼ˆULTRA > PRO > FREE + remaining_quotaï¼‰ | [`src-tauri/src/proxy/token_manager.rs`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src-tauri/src/proxy/token_manager.rs#L504-L538) | 504-538 |
| 60 ç§’ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦å†åˆ©ç”¨ + ãƒ¬ãƒ¼ãƒˆåˆ¶é™/ã‚¯ã‚©ãƒ¼ã‚¿ä¿è­·å›é¿ | [`src-tauri/src/proxy/token_manager.rs`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src-tauri/src/proxy/token_manager.rs#L624-L739) | 624-739 |
| ãƒ¬ãƒ¼ãƒˆåˆ¶é™è¨˜éŒ²ã‚¨ãƒ³ãƒˆãƒªãƒ¼ï¼ˆmark_rate_limitedï¼‰ | [`src-tauri/src/proxy/token_manager.rs`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src-tauri/src/proxy/token_manager.rs#L1089-L1113) | 1089-1113 |
| 429 ç²¾å¯†ãƒ­ãƒƒã‚¯/ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚¯ã‚©ãƒ¼ã‚¿ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥/ãƒ€ã‚¦ãƒ³ã‚°ãƒ¬ãƒ¼ãƒ‰æˆ¦ç•¥ï¼ˆmark_rate_limited_asyncï¼‰ | [`src-tauri/src/proxy/token_manager.rs`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src-tauri/src/proxy/token_manager.rs#L1258-L1417) | 1258-1417 |

**é‡è¦ãªå®šæ•°**ï¼š
- `MAX_RETRY_ATTEMPTS = 3`ï¼šå˜ä¸€ãƒªã‚¯ã‚¨ã‚¹ãƒˆå†…æœ€å¤§å†è©¦è¡Œå›æ•°ï¼ˆOpenAI/Gemini handlerï¼‰
- `60`ï¼š60 ç§’ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦å†åˆ©ç”¨ï¼ˆ`PerformanceFirst` ä»¥å¤–ã®ãƒ¢ãƒ¼ãƒ‰ã§ã®ã¿æœ‰åŠ¹ï¼‰
- `5`ï¼šToken å–å¾—ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆæ™‚é–“ï¼ˆç§’ï¼‰
- `300`ï¼šToken äº‹å‰ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥é–¾å€¤ï¼ˆç§’ã€5 åˆ†ï¼‰

**é‡è¦ãªé–¢æ•°**ï¼š
- `parse_retry_delay()`ï¼š429 ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‹ã‚‰å†è©¦è¡Œé…å»¶ã‚’æŠ½å‡º
- `get_token_internal()`ï¼šã‚¢ã‚«ã‚¦ãƒ³ãƒˆé¸æŠã¨ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚³ã‚¢ãƒ­ã‚¸ãƒƒã‚¯
- `mark_rate_limited()`ï¼šã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ãƒ¬ãƒ¼ãƒˆåˆ¶é™çŠ¶æ…‹ã«ãƒãƒ¼ã‚¯

</details>
