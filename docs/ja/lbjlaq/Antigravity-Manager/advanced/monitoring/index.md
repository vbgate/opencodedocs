---
title: "ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°: ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ­ã‚°åˆ†æ | Antigravity-Manager"
sidebarTitle: "ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ­ã‚°ã§ãƒ‡ãƒãƒƒã‚°"
subtitle: "ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°: ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ­ã‚°åˆ†æ"
description: "Antigravity Tools ã® Proxy Monitor ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚’å­¦ã³ã¾ã™ã€‚ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ­ã‚°ã€ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã€è©³ç´°å¾©å…ƒæ©Ÿèƒ½ã§ 401/429/5xx ã‚¨ãƒ©ãƒ¼ã¨ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ä¸­æ–­å•é¡Œã‚’ç‰¹å®šã—ã¾ã™ã€‚"
tags:
  - "é«˜åº¦"
  - "ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°"
  - "ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°"
  - "Proxy"
  - "ãƒ­ã‚°"
prerequisite:
  - "start-proxy-and-first-client"
  - "start-first-run-data"
  - "advanced-config"
order: 6
---

# Proxy Monitorï¼šãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ­ã‚°ã€ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã€è©³ç´°å¾©å…ƒã¨ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ

ãƒ­ãƒ¼ã‚«ãƒ«ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·ã¯èµ·å‹•ã—ã¾ã—ãŸãŒã€401/429/500ã€ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ä¸­æ–­ã€ã‚ã‚‹ã„ã¯ã€Œãªãœçªç„¶ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ/ãƒ¢ãƒ‡ãƒ«ãŒå¤‰ã‚ã£ãŸã€ãŒç™ºç”Ÿã™ã‚‹ã¨ã€ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã¯ã™ãã«å½“ã¦ãšã£ã½ã†ã«ãªã‚ŠãŒã¡ã§ã™ã€‚

ã“ã®ãƒ¬ãƒƒã‚¹ãƒ³ã§ã¯ 1 ã¤ã®ã“ã¨ã ã‘ã‚’è§£èª¬ã—ã¾ã™ï¼š**Proxy Monitor** ã‚’ä½¿ã£ã¦å„å‘¼ã³å‡ºã—ã‚’ã€Œå†ç¾å¯èƒ½ãªè¨¼æ‹ ã€ã«å¾©å…ƒã—ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒã©ã“ã‹ã‚‰æ¥ãŸã‹ã€ã©ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã«æ‰“ãŸã‚ŒãŸã‹ã€ã©ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½¿ç”¨ã—ãŸã‹ã€ãƒ¢ãƒ‡ãƒ«ãŒãƒãƒƒãƒ”ãƒ³ã‚°ã•ã‚ŒãŸã‹ã€ãã—ã¦ Token æ¶ˆè²»ãŒã©ã‚Œãã‚‰ã„ã‹ã‚’çŸ¥ã‚‹ã“ã¨ã§ã™ã€‚

## ã“ã®ãƒ¬ãƒƒã‚¹ãƒ³ã§ã§ãã‚‹ã“ã¨

- `/monitor` ãƒšãƒ¼ã‚¸ã§éŒ²ç”»ã‚’é–‹å§‹/ä¸€æ™‚åœæ­¢ã—ã€Token Stats ã«å½±éŸ¿ã™ã‚‹ã‹ã©ã†ã‹ã‚’ç†è§£
- æ¤œç´¢ãƒœãƒƒã‚¯ã‚¹ã€ã‚¯ã‚¤ãƒƒã‚¯ãƒ•ã‚£ãƒ«ã‚¿ã€ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ•ã‚£ãƒ«ã‚¿ã‚’ä½¿ã£ã¦ 1 ã¤ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆè¨˜éŒ²ã‚’è¿…é€Ÿã«ç‰¹å®š
- è©³ç´°ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ã§ Request/Response ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç¢ºèªã—ã¦ã‚³ãƒ”ãƒ¼ã—ã€å¤±æ•—åŸå› ã‚’å†æ¤œè¨
- Proxy Monitor ã®ãƒ‡ãƒ¼ã‚¿ä¿å­˜å ´æ‰€ï¼ˆ`proxy_logs.db`ï¼‰ã¨ã‚¯ãƒªã‚¢å‹•ä½œã‚’çŸ¥ã‚‹
- ç¾åœ¨ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ã€Œãƒ­ã‚°ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã€ã®å®Ÿéš›ã®èƒ½åŠ›å¢ƒç•Œï¼ˆGUI vs ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚³ãƒãƒ³ãƒ‰ï¼‰ã‚’ç†è§£

## ç¾åœ¨ã®æ‚©ã¿

- ã€Œå‘¼ã³å‡ºã—å¤±æ•—/ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã€ã—ã‹è¦‹ãˆãªã„ãŒã€ã‚¢ãƒƒãƒ—ã‚¹ãƒˆãƒªãƒ¼ãƒ ã€ãƒ—ãƒ­ã‚­ã‚·ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆè¨­å®šã®ã©ã“ã§å¤±æ•—ã—ãŸã‹ã‚ã‹ã‚‰ãªã„
- ãƒ¢ãƒ‡ãƒ«ãƒãƒƒãƒ”ãƒ³ã‚°ã¾ãŸã¯ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ãŒãƒˆãƒªã‚¬ãƒ¼ã•ã‚ŒãŸã¨ç–‘ã†ãŒã€è¨¼æ‹ ãƒã‚§ãƒ¼ãƒ³ãŒãªã„
- 1 ã¤ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®å®Œå…¨ãª payloadï¼ˆç‰¹ã«ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°/Thinkingï¼‰ã‚’å†æ¤œè¨ã—ãŸã„ãŒã€ãƒ­ã‚°ã«è¦‹ãˆãªã„

## ã“ã®æ–¹æ³•ã‚’ã„ã¤ä½¿ã†ã‹

- ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãŒå¿…è¦ï¼š401 èªè¨¼å¤±æ•—ã€429 ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã€5xx ã‚¢ãƒƒãƒ—ã‚¹ãƒˆãƒªãƒ¼ãƒ ã‚¨ãƒ©ãƒ¼ã€ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ä¸­æ–­
- ç¢ºèªã—ãŸã„ï¼šã‚ã‚‹ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒå®Ÿéš›ã«ã©ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½¿ç”¨ã—ãŸã‹ï¼ˆ`X-Account-Email`ï¼‰
- ãƒ¢ãƒ‡ãƒ«ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°æˆ¦ç•¥ã‚’ç­–å®šä¸­ã€ã€Œã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒ¢ãƒ‡ãƒ«å â†’ å®Ÿéš›ãƒãƒƒãƒ”ãƒ³ã‚°ãƒ¢ãƒ‡ãƒ«åã€ã‚’æ¤œè¨¼ã—ãŸã„

## ğŸ’ å§‹ã‚ã‚‹å‰ã®æº–å‚™

::: warning å‰ææ¡ä»¶
Proxy Monitor ãŒè¨˜éŒ²ã™ã‚‹ã®ã¯ã€Œãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒ“ã‚¹ãŒå—ä¿¡ã—ãŸãƒªã‚¯ã‚¨ã‚¹ãƒˆã€ã§ã™ã€‚ã—ãŸãŒã£ã¦ã€å°‘ãªãã¨ã‚‚ã¾ãšæ¬¡ã®ã“ã¨ã‚’å®Œäº†ã•ã›ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼š

- ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒ“ã‚¹ãŒèµ·å‹•ã—ã€`/healthz` ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹
- ç¾åœ¨ã®ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·ã® Base URL ã¨ãƒãƒ¼ãƒˆã‚’çŸ¥ã£ã¦ã„ã‚‹

ã¾ã å‹•ã‹ãªã„å ´åˆã¯ã€ã¾ãš **[ãƒ­ãƒ¼ã‚«ãƒ«ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·ã‚’èµ·å‹•ã—ã¦æœ€åˆã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’æ¥ç¶šã™ã‚‹](/ja/lbjlaq/Antigravity-Manager/start/proxy-and-first-client/)** ã‚’è¦‹ã¦ãã ã•ã„ã€‚
:::

## Proxy Monitor ã¨ã¯ï¼Ÿ

**Proxy Monitor** ã¯ Antigravity Tools å†…è”µã®ã€Œãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ­ã‚°ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã€ã§ã™ã€‚å„ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒãƒ­ãƒ¼ã‚«ãƒ«ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·ã«å…¥ã‚‹ã¨ã€æ™‚é–“ã€ãƒ‘ã‚¹ã€ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ã€æ‰€è¦æ™‚é–“ã€ãƒ¢ãƒ‡ãƒ«ã¨ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’è¨˜éŒ²ã—ã€å¯èƒ½ãªé™ã‚Šãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‹ã‚‰ Token ä½¿ç”¨é‡ã‚’æŠ½å‡ºã—ã¾ã™ã€‚ã¾ãŸã€å˜ä¸€ã®è¨˜éŒ²ã‚’é–‹ã„ã¦ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¨ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç¢ºèªã—ã€å¤±æ•—åŸå› ã¨ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°/ã‚¢ã‚«ã‚¦ãƒ³ãƒˆé¸æŠçµæœã‚’å†æ¤œè¨ã§ãã¾ã™ã€‚

::: info ãƒ‡ãƒ¼ã‚¿ä¿å­˜å ´æ‰€
Proxy Monitor ã®ãƒ­ã‚°ã¯ãƒ‡ãƒ¼ã‚¿ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä»¥ä¸‹ã® SQLite ã«æ›¸ãè¾¼ã¾ã‚Œã¾ã™ï¼š`proxy_logs.db`ã€‚ãƒ‡ãƒ¼ã‚¿ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®æ¢ã—æ–¹ã¨ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æ–¹æ³•ã¯ã€å…ˆã« **[åˆå›èµ·å‹•æ™‚ã®å¿…çŸ¥äº‹é …ï¼šãƒ‡ãƒ¼ã‚¿ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã€ãƒ­ã‚°ã€ãƒˆãƒ¬ã‚¤ã€è‡ªå‹•èµ·å‹•](/ja/lbjlaq/Antigravity-Manager/start/first-run-data/)** ã‚’å¾©ç¿’ã—ã¦ãã ã•ã„ã€‚
:::

## ã‚³ã‚¢ã‚³ãƒ³ã‚»ãƒ—ãƒˆï¼šæ³¨æ„ã™ã¹ã 6 ã¤ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰

Proxy Monitor ã® 1 ã¤ã®è¨˜éŒ²ï¼ˆãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰æ§‹é€ ä½“ `ProxyRequestLog`ï¼‰ã§ã€æœ€ã‚‚å®Ÿç”¨çš„ãªã®ã¯ä»¥ä¸‹ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã§ã™ï¼š

| ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ | ãã‚Œã§ä½•ã®è³ªå•ã«ç­”ãˆã‚‹ã‹ |
| --- | --- |
| `status` | ä»Šå›ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯æˆåŠŸã‹å¤±æ•—ã‹ï¼ˆ200-399 vs ãã®ä»–ï¼‰ |
| `url` / `method` | ã©ã®ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã«æ‰“ãŸã‚ŒãŸã‹ï¼ˆä¾‹ï¼š`/v1/messages`ã€`/v1/chat/completions`ï¼‰ |
| `protocol` | ã“ã‚Œã¯ OpenAI / Claude(Anthropic) / Gemini ã®ã©ã®ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‹ |
| `account_email` | ä»Šå›ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã§æœ€çµ‚çš„ã«ã©ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒä½¿ã‚ã‚ŒãŸã‹ï¼ˆ`X-Account-Email` ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ˜ãƒƒãƒ€ã‹ã‚‰ï¼‰ |
| `model` / `mapped_model` | ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒãƒªã‚¯ã‚¨ã‚¹ãƒˆã—ãŸãƒ¢ãƒ‡ãƒ«åãŒåˆ¥ã®ãƒ¢ãƒ‡ãƒ«ã«ã€Œãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°/ãƒãƒƒãƒ”ãƒ³ã‚°ã€ã•ã‚ŒãŸã‹ |
| `input_tokens` / `output_tokens` | ä»Šå›ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã® Token ä½¿ç”¨é‡ï¼ˆæŠ½å‡ºã§ããŸå ´åˆã®ã¿ï¼‰ |

::: tip ã¾ãšã€Œæ¦‚è¦ã€ã‚’ä½¿ã„ã€å¿…è¦ã«å¿œã˜ã¦ã€Œè©³ç´°ã€ã‚’é–‹ã
ãƒªã‚¹ãƒˆãƒšãƒ¼ã‚¸ã¯æ¦‚è¦ã®ã¿ã‚’è¡¨ç¤ºï¼ˆrequest/response body ãªã—ï¼‰ã€‚1 ã¤ã®è¨˜éŒ²ã‚’é–‹ãã¨ã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‹ã‚‰å®Œå…¨ãªè©³ç´°ã‚’èª­ã¿è¾¼ã¿ã¾ã™ã€‚ã“ã‚Œã§ãƒªã‚¹ãƒˆãŒä¸€åº¦ã«å¤§ããªãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’å¼•ãã™ãã‚‹ã“ã¨ã‚’é¿ã‘ã¾ã™ã€‚
:::

## ã•ã‚ã€ä¸€ç·’ã«ã‚„ã£ã¦ã¿ã‚ˆã†ï¼š1 å›ã®å‘¼ã³å‡ºã—ã§ã€Œãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°ãƒ«ãƒ¼ãƒ—ã€ã‚’å®Œæˆ

### ã‚¹ãƒ†ãƒƒãƒ— 1ï¼šã¾ãšã€Œå¿…ãšç¾ã‚Œã‚‹ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ä½œæˆ

**ãªãœ**
Proxy Monitor ã¯ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·ã‚µãƒ¼ãƒ“ã‚¹ãŒå—ä¿¡ã—ãŸãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ã¿ã‚’è¨˜éŒ²ã—ã¾ã™ã€‚ã¾ãšæœ€ã‚‚ã‚·ãƒ³ãƒ—ãƒ«ãªãƒªã‚¯ã‚¨ã‚¹ãƒˆã§ã€Œè¨˜éŒ²ãŒã‚ã‚‹ã‹ã€ã‚’æ¤œè¨¼ã—ã€ãã®å¾Œãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã¨è©³ç´°ã«ã¤ã„ã¦è©±ã—ã¾ã™ã€‚

::: code-group

```bash [macOS/Linux]
## 1) ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ï¼ˆå¿…ãšå­˜åœ¨ã™ã‚‹ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆï¼‰
curl "http://127.0.0.1:PORT/healthz"

## 2) ã‚‚ã†ä¸€åº¦ models ã‚’ãƒªã‚¯ã‚¨ã‚¹ãƒˆï¼ˆèªè¨¼ã‚’æœ‰åŠ¹ã«ã—ãŸå ´åˆã€header ã‚’å¿˜ã‚Œãšã«ï¼‰
curl "http://127.0.0.1:PORT/v1/models"
```

```powershell [Windows]
## 1) ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ï¼ˆå¿…ãšå­˜åœ¨ã™ã‚‹ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆï¼‰
curl "http://127.0.0.1:PORT/healthz"

## 2) ã‚‚ã†ä¸€åº¦ models ã‚’ãƒªã‚¯ã‚¨ã‚¹ãƒˆï¼ˆèªè¨¼ã‚’æœ‰åŠ¹ã«ã—ãŸå ´åˆã€header ã‚’å¿˜ã‚Œãšã«ï¼‰
curl "http://127.0.0.1:PORT/v1/models"
```

:::

**æœŸå¾…ã•ã‚Œã‚‹çµæœ**ï¼šç«¯æœ«ã‹ã‚‰ `{"status":"ok"}`ï¼ˆã¾ãŸã¯é¡ä¼¼ã® JSONï¼‰ã¨ `/v1/models` ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ï¼ˆæˆåŠŸã§ã‚‚ 401 ã§ã‚‚å¯ï¼‰ãŒè¿”ã•ã‚Œã‚‹ã€‚

### ã‚¹ãƒ†ãƒƒãƒ— 2ï¼šMonitor ãƒšãƒ¼ã‚¸ã‚’é–‹ã„ã¦ã€ŒéŒ²ç”»çŠ¶æ…‹ã€ã‚’ç¢ºèª

**ãªãœ**
Proxy Monitor ã«ã¯ã€ŒéŒ²ç”»/ä¸€æ™‚åœæ­¢ã€ã‚¹ã‚¤ãƒƒãƒãŒã‚ã‚Šã¾ã™ã€‚ç¾åœ¨ã®çŠ¶æ…‹ã‚’ã¾ãšç¢ºèªã—ãªã„ã¨ã€ãšã£ã¨ãƒªã‚¯ã‚¨ã‚¹ãƒˆã—ã¦ã„ã‚‹ãŒãƒªã‚¹ãƒˆãŒãšã£ã¨ç©ºã¨ã„ã†ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚

Antigravity Tools ã§ã‚µã‚¤ãƒ‰ãƒãƒ¼ã® **API ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰**ï¼ˆãƒ«ãƒ¼ãƒˆã¯ `/monitor`ï¼‰ã‚’é–‹ãã€‚

ãƒšãƒ¼ã‚¸ä¸Šéƒ¨ã«ãƒ‰ãƒƒãƒˆä»˜ããƒœã‚¿ãƒ³ãŒã‚ã‚‹ã¯ãšã§ã™ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â— éŒ²ç”»ä¸­   [æ¤œç´¢ãƒœãƒƒã‚¯ã‚¹]  [æ›´æ–°] [ã‚¯ãƒªã‚¢]      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

ã€Œä¸€æ™‚åœæ­¢ä¸­ã€ãŒè¦‹ãˆãŸã‚‰ã€ä¸€åº¦ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã€ŒéŒ²ç”»ä¸­ã€ã«åˆ‡ã‚Šæ›¿ãˆã‚‹ã€‚

**æœŸå¾…ã•ã‚Œã‚‹çµæœ**ï¼šãƒœã‚¿ãƒ³çŠ¶æ…‹ãŒã€ŒéŒ²ç”»ä¸­ã€ã«å¤‰ã‚ã‚‹ï¼›ãƒªã‚¹ãƒˆã«ç›´å‰ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆè¨˜éŒ²ãŒç¾ã‚Œå§‹ã‚ã‚‹ã€‚

### ã‚¹ãƒ†ãƒƒãƒ— 3ï¼šã€Œæ¤œç´¢ + ã‚¯ã‚¤ãƒƒã‚¯ãƒ•ã‚£ãƒ«ã‚¿ã€ã§ 1 ã¤ã®è¨˜éŒ²ã‚’ç‰¹å®š

**ãªãœ**
å®Ÿéš›ã®ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã§ã¯ã€é€šå¸¸ 1 ã¤ã®ãƒ•ãƒ©ã‚°ãƒ¡ãƒ³ãƒˆã—ã‹è¦šãˆã¦ã„ã¾ã›ã‚“ï¼šãƒ‘ã‚¹ã« `messages` ãŒã‚ã‚‹ã€ã¾ãŸã¯ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰ãŒ `401` ã§ã‚ã‚‹ã€ã¾ãŸã¯ãƒ¢ãƒ‡ãƒ«åã« `gemini` ãŒã‚ã‚‹ã€‚æ¤œç´¢ãƒœãƒƒã‚¯ã‚¹ã¯ã“ã®ã‚ˆã†ãªè¨˜æ†¶ã®ãŸã‚ã«è¨­è¨ˆã•ã‚Œã¦ã„ã¾ã™ã€‚

Proxy Monitor ã®æ¤œç´¢ã¯ã€ã‚ãªãŸã®å…¥åŠ›ã‚’ã€Œãƒ•ã‚¡ã‚¸ãƒ¼ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã€ã¨ã—ã¦æ‰±ã„ã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã§ SQL `LIKE` ã§ã“ã‚Œã‚‰ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«ãƒãƒƒãƒã—ã¾ã™ï¼š

- `url`
- `method`
- `model`
- `status`
- `account_email`

ã„ãã¤ã‹ã®å…¸å‹çš„ãªã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’è©¦ã™ã“ã¨ãŒã§ãã¾ã™ï¼š

- `healthz`
- `models`
- `401`ï¼ˆã¡ã‚‡ã†ã© 401 ã‚’ä½œæˆã—ãŸå ´åˆï¼‰

ã¾ãŸã€Œã‚¯ã‚¤ãƒƒã‚¯ãƒ•ã‚£ãƒ«ã‚¿ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ï¼š**ã‚¨ãƒ©ãƒ¼ã®ã¿ / Chat / Gemini / Claude / ç”»åƒç”Ÿæˆ**ã€‚

**æœŸå¾…ã•ã‚Œã‚‹çµæœ**ï¼šãƒªã‚¹ãƒˆã«ã‚ãªãŸãŒæœŸå¾…ã—ãŸç¨®é¡ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®ã¿ãŒæ®‹ã‚‹ã€‚

### ã‚¹ãƒ†ãƒƒãƒ— 4ï¼šè©³ç´°ã‚’é–‹ã„ã¦ã€Œãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ + ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€ã‚’å¾©å…ƒ

**ãªãœ**
ãƒªã‚¹ãƒˆã¯ã€Œä½•ãŒèµ·ããŸã‹ã€ã«ç­”ãˆã‚‹ã«ã¯ååˆ†ã§ã™ãŒã€ã€Œãªãœã€ã«ç­”ãˆã‚‹ã«ã¯ã€é€šå¸¸å®Œå…¨ãªãƒªã‚¯ã‚¨ã‚¹ãƒˆ/ãƒ¬ã‚¹ãƒãƒ³ã‚¹ payload ã‚’è¦‹ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

ä»»æ„ã®è¨˜éŒ²ã‚’é–‹ãã¨ã€è©³ç´°ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãŒãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ã—ã¾ã™ã€‚ä»¥ä¸‹ã‚’é‡ç‚¹çš„ã«ç¢ºèªã§ãã¾ã™ï¼š

- `ãƒ—ãƒ­ãƒˆã‚³ãƒ«`ï¼ˆOpenAI/Claude/Geminiï¼‰
- `ä½¿ç”¨ãƒ¢ãƒ‡ãƒ«` ã¨ `ãƒãƒƒãƒ”ãƒ³ã‚°ãƒ¢ãƒ‡ãƒ«`
- `ä½¿ç”¨ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ`
- `Token æ¶ˆè²» (å…¥åŠ›/å‡ºåŠ›)`

ãã®å¾Œãƒœã‚¿ãƒ³ã§ã‚³ãƒ”ãƒ¼ï¼š

- `ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ (Request)`
- `ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ (Response)`

**æœŸå¾…ã•ã‚Œã‚‹çµæœ**ï¼šè©³ç´°ã« 2 ã¤ã® JSONï¼ˆã¾ãŸã¯ãƒ†ã‚­ã‚¹ãƒˆï¼‰ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒã‚ã‚‹ï¼›ã‚³ãƒ”ãƒ¼å¾Œã€ãƒã‚±ãƒƒãƒˆ/ãƒ¡ãƒ¢ã«è²¼ã‚Šä»˜ã‘ã¦å†æ¤œè¨ã§ãã¾ã™ã€‚

### ã‚¹ãƒ†ãƒƒãƒ— 5ï¼šã€Œã‚¼ãƒ­ã‹ã‚‰å†ç¾ã€ãŒå¿…è¦ãªå ´åˆã€ãƒ­ã‚°ã‚’ã‚¯ãƒªã‚¢

**ãªãœ**
ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°æ™‚ã€æœ€ã‚‚æ€–ã„ã®ã¯ã€Œå¤ã„ãƒ‡ãƒ¼ã‚¿ãŒåˆ¤æ–­ã‚’å¹²æ¸‰ã™ã‚‹ã€ã“ã¨ã§ã™ã€‚ã‚¯ãƒªã‚¢å¾Œã«ã‚‚ã†ä¸€åº¦å†ç¾ã™ã‚‹ã¨ã€æˆåŠŸ/å¤±æ•—ãŒéå¸¸ã«æ˜ç¢ºã«ãªã‚Šã¾ã™ã€‚

ä¸Šéƒ¨ã®ã€Œã‚¯ãƒªã‚¢ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã€ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãŒãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ã—ã¾ã™ã€‚

::: danger ã“ã‚Œã¯ä¸å¯é€†æ“ä½œ
ã‚¯ãƒªã‚¢ã¯ `proxy_logs.db` å†…ã®ã™ã¹ã¦ã®è¨˜éŒ²ã‚’å‰Šé™¤ã—ã¾ã™ã€‚
:::

**æœŸå¾…ã•ã‚Œã‚‹çµæœ**ï¼šç¢ºèªå¾Œãƒªã‚¹ãƒˆãŒã‚¯ãƒªã‚¢ã•ã‚Œã€çµ±è¨ˆæ•°å­—ãŒ 0 ã«æˆ»ã‚‹ã€‚

## ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆ âœ…

- [ ] `/monitor` ã§è‡ªåˆ†ãŒé€ã£ãŸã°ã‹ã‚Šã® `/healthz` ã¾ãŸã¯ `/v1/models` è¨˜éŒ²ãŒè¦‹ãˆã‚‹
- [ ] æ¤œç´¢ãƒœãƒƒã‚¯ã‚¹ã§ 1 ã¤ã®è¨˜éŒ²ã‚’ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã§ãã‚‹ï¼ˆä¾‹ï¼š`healthz` ã‚’å…¥åŠ›ï¼‰
- [ ] 1 ã¤ã®è¨˜éŒ²ã‚’é–‹ã„ã¦ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¦‹ã¦ã‚³ãƒ”ãƒ¼ã§ãã‚‹
- [ ] ãƒ­ã‚°ã‚’ã‚¯ãƒªã‚¢ã™ã‚‹ã¨ã™ã¹ã¦ã®å±¥æ­´è¨˜éŒ²ãŒç›´æ¥å‰Šé™¤ã•ã‚Œã‚‹ã“ã¨ã‚’çŸ¥ã£ã¦ã„ã‚‹

## ã‚ˆãã‚ã‚‹è½ã¨ã—ç©´

| ã‚·ãƒŠãƒªã‚ª | ã‚ãªãŸãŒç†è§£ã™ã‚‹ã‹ã‚‚ã—ã‚Œãªã„ã“ã¨ï¼ˆâŒï¼‰ | å®Ÿéš›ã®æŒ™å‹•ï¼ˆâœ“ï¼‰ |
| --- | --- | --- |
| ã€Œä¸€æ™‚åœæ­¢ä¸­ã€= ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰ãŒå®Œå…¨ã«ãªã„ | ä¸€æ™‚åœæ­¢å¾Œãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒè§£æã•ã‚Œãªã„ã¨æ€ã£ã¦ã„ã‚‹ | ä¸€æ™‚åœæ­¢ã¯ã€ŒProxy Monitor ãƒ­ã‚°ã«æ›¸ãè¾¼ã‚€ã‹ã©ã†ã‹ã€ã®ã¿ã«å½±éŸ¿ã€‚ã—ã‹ã—ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/ãƒ¬ã‚¹ãƒãƒ³ã‚¹è§£æï¼ˆã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ã® SSE è§£æã‚’å«ã‚€ï¼‰ã¯ä¾ç„¶ã¨ã—ã¦ç™ºç”Ÿã—ã€è§£æå¾Œã®ãƒ‡ãƒ¼ã‚¿ã¯ä¿å­˜ã•ã‚Œãªã„ã ã‘ã€‚Token Stats ã‚‚ä¾ç„¶ã¨ã—ã¦è¨˜éŒ²ï¼ˆãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°ãŒæœ‰åŠ¹ã‹ã©ã†ã‹ã«ã‹ã‹ã‚ã‚‰ãšï¼‰ã€‚ |
| ãƒã‚¤ãƒŠãƒª/å¤§ããªãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ãƒ­ã‚°ãŒç©º | ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°ãŒå£Šã‚ŒãŸã¨æ€ã£ã¦ã„ã‚‹ | ãƒã‚¤ãƒŠãƒªãƒªã‚¯ã‚¨ã‚¹ãƒˆ/ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã¯ `[Binary Request Data]` / `[Binary Response Data]` ã¨è¡¨ç¤ºã•ã‚Œã‚‹ã€‚ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒœãƒ‡ã‚£ãŒ 100MB ã‚’è¶…ãˆã‚‹ã¨ `[Response too large (>100MB)]` ã¨ãƒãƒ¼ã‚¯ï¼›ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£ãŒåˆ¶é™ã‚’è¶…ãˆã‚‹ã¨è¨˜éŒ²ã•ã‚Œãªã„ã€‚ |
| Monitor ã§ã€Œèª°ãŒãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é–‹å§‹ã—ãŸã‹ã€ã‚’è¦‹ã¤ã‘ãŸã„ | ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒ—ãƒ­ã‚»ã‚¹ã¾ã§è¿½è·¡ã§ãã‚‹ã¨æ€ã£ã¦ã„ã‚‹ | Monitor ã¯ HTTP å±¤æƒ…å ±ï¼ˆãƒ¡ã‚½ãƒƒãƒ‰/ãƒ‘ã‚¹/ãƒ¢ãƒ‡ãƒ«/ã‚¢ã‚«ã‚¦ãƒ³ãƒˆï¼‰ã‚’è¨˜éŒ²ã—ã€ã€Œå‘¼ã³å‡ºã—å…ƒãƒ—ãƒ­ã‚»ã‚¹åã€ã¯å«ã¾ãªã„ã€‚ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆè‡ªèº«ã®ãƒ­ã‚°ã¾ãŸã¯ã‚·ã‚¹ãƒ†ãƒ ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚­ãƒ£ãƒ—ãƒãƒ£ã¨çµ„ã¿åˆã‚ã›ã¦ã‚½ãƒ¼ã‚¹ã‚’ç‰¹å®šã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ |
| ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°æœ‰åŠ¹æ™‚ã« Token Stats ãƒ‡ãƒ¼ã‚¿ãŒç•°å¸¸ | çµ±è¨ˆã‚¨ãƒ©ãƒ¼ã ã¨æ€ã£ã¦ã„ã‚‹ | ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°æœ‰åŠ¹æ™‚ã€Token Stats ãŒ 2 å›è¨˜éŒ²ã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ï¼ˆ1 å›ã¯ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°é–¢æ•°ã®å…ˆé ­ã€1 å›ã¯éåŒæœŸã§ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«æ›¸ãè¾¼ã‚€æ™‚ï¼‰ã€‚ã“ã‚Œã¯ç¾åœ¨ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®æŒ™å‹•ã§ã™ã€‚ |

## ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã¨é•·æœŸä¿å­˜ï¼šã¾ãšèƒ½åŠ›å¢ƒç•Œã‚’æ˜ç¢ºã«

### 1) GUI ã§ç¾åœ¨ä½•ãŒã§ãã‚‹ã‹

ç¾åœ¨ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã® Monitor UIï¼ˆ`ProxyMonitor.tsx`ï¼‰ã§ã¯ã€ä»¥ä¸‹ãŒã§ãã¾ã™ï¼š

- æ¤œç´¢/ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°/ãƒšãƒ¼ã‚¸ãƒ³ã‚°å‚ç…§
- è©³ç´°ã‚’é–‹ã„ã¦ payload ã‚’ç¢ºèªã—ã¦ã‚³ãƒ”ãƒ¼
- ã™ã¹ã¦ã®ãƒ­ã‚°ã‚’ã‚¯ãƒªã‚¢

ã—ã‹ã— **ã€Œã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆãƒœã‚¿ãƒ³ã€ã¯è¦‹ã¤ã‹ã‚‰ãªã„**ï¼ˆã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã«è©²å½“ã™ã‚‹ UI ãŒè¦‹ã¤ã‹ã‚‰ãªã„ï¼‰ã€‚

### 2) ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã«ã©ã®ã‚ˆã†ãªã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆèƒ½åŠ›ãŒã‚ã‚‹ã‹ï¼ˆäºŒæ¬¡é–‹ç™ºå‘ã‘ï¼‰

ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ Tauri ã‚³ãƒãƒ³ãƒ‰ã¯ 2 ç¨®é¡ã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆæ–¹å¼ã‚’æä¾›ã—ã¾ã™ï¼š

- `export_proxy_logs(file_path)`ï¼šãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å†…ã®ã€Œã™ã¹ã¦ã®ãƒ­ã‚°ã€ã‚’ JSON ãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
- `export_proxy_logs_json(file_path, json_data)`ï¼šã‚ãªãŸãŒå…¥åŠ›ã—ãŸ JSON é…åˆ—ã‚’æ•´å½¢ã—ã¦ãƒ•ã‚¡ã‚¤ãƒ«ã«æ›¸ãè¾¼ã¿ï¼ˆå…¥åŠ›ã¯é…åˆ—å½¢å¼ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚‹ï¼‰

GUI ã‚’äºŒæ¬¡é–‹ç™ºã—ãŸã„å ´åˆã€ã¾ãŸã¯è‡ªåˆ†ã®å‘¼ã³å‡ºã—ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’æ›¸ããŸã„å ´åˆã€ã“ã‚Œã‚‰ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ç›´æ¥å†åˆ©ç”¨ã§ãã¾ã™ã€‚

### 3) æœ€ã‚‚ã‚·ãƒ³ãƒ—ãƒ«ãªã€Œã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã€ï¼š`proxy_logs.db` ã‚’ç›´æ¥ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—

Proxy Monitor ã¯æœ¬è³ªçš„ã« SQLite ãªã®ã§ã€`proxy_logs.db` ã‚’ã€Œãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°è¨¼æ‹ ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã€ã¨ã—ã¦ä¸€ç·’ã«ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ï¼ˆä¾‹ï¼š`token_stats.db` ã¨ä¸€ç·’ã«ï¼‰ã€‚ãƒ‡ãƒ¼ã‚¿ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½ç½®ã¯ **[åˆå›èµ·å‹•æ™‚ã®å¿…çŸ¥äº‹é …](/ja/lbjlaq/Antigravity-Manager/start/first-run-data/)** ã‚’å‚ç…§ã€‚

## ãŠã™ã™ã‚é–¢é€£è¨˜äº‹

- ãƒ¢ãƒ‡ãƒ«ãƒãƒƒãƒ”ãƒ³ã‚°ã‚’æ˜ç¢ºã«ã—ãŸã„å ´åˆï¼š**[ãƒ¢ãƒ‡ãƒ«ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ï¼šã‚«ã‚¹ã‚¿ãƒ ãƒãƒƒãƒ”ãƒ³ã‚°ã€ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰å„ªå…ˆé †ä½ã¨ãƒ—ãƒªã‚»ãƒƒãƒˆæˆ¦ç•¥](/ja/lbjlaq/Antigravity-Manager/advanced/model-router/)**
- èªè¨¼å•é¡Œã‚’ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã—ãŸã„å ´åˆï¼š**[401/èªè¨¼å¤±æ•—ï¼šauth_modeã€Header äº’æ›æ€§ã¨ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆè¨­å®šãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ](/ja/lbjlaq/Antigravity-Manager/faq/auth-401/)**
- Monitor ã¨ã‚³ã‚¹ãƒˆçµ±è¨ˆã‚’çµ„ã¿åˆã‚ã›ãŸã„å ´åˆï¼šæ¬¡ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ Token Statsï¼ˆ`token_stats.db`ï¼‰ã‚’è§£èª¬

## ã“ã®ãƒ¬ãƒƒã‚¹ãƒ³ã®ã¾ã¨ã‚

- Proxy Monitor ã®ä¾¡å€¤ã¯ã€Œå†ç¾å¯èƒ½ã€ï¼šã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰/ãƒ‘ã‚¹/ãƒ—ãƒ­ãƒˆã‚³ãƒ«/ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ/ãƒ¢ãƒ‡ãƒ«ãƒãƒƒãƒ”ãƒ³ã‚°/Token ä½¿ç”¨é‡ã‚’è¨˜éŒ²ã—ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆè©³ç´°ã‚’æä¾›
- æ¤œç´¢ã¨ã‚¯ã‚¤ãƒƒã‚¯ãƒ•ã‚£ãƒ«ã‚¿ãŒãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚¨ãƒ³ãƒˆãƒªï¼šã¾ãšç¯„å›²ã‚’ç¸®å°ã—ã€ãã®å¾Œè©³ç´°ã‚’é–‹ã„ã¦ payload ã‚’è¦‹ã‚‹
- ãƒ­ã‚°ã‚’ã‚¯ãƒªã‚¢ã™ã‚‹ã“ã¨ã¯ä¸å¯é€†æ“ä½œï¼›ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã¯ç¾åœ¨ã€ŒäºŒæ¬¡é–‹ç™ºèƒ½åŠ›ã€ã¨ã€Œãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã€ã«å‚¾ã„ã¦ã„ã‚‹

## æ¬¡ã®ãƒ¬ãƒƒã‚¹ãƒ³äºˆå‘Š

> æ¬¡ã®ãƒ¬ãƒƒã‚¹ãƒ³ã§ã¯ **[Token Statsï¼šã‚³ã‚¹ãƒˆè¦–ç‚¹ã®çµ±è¨ˆæŒ‡æ¨™ã¨ãƒãƒ£ãƒ¼ãƒˆè§£èª¬](/ja/lbjlaq/Antigravity-Manager/advanced/token-stats/)** ã‚’å­¦ã³ã¾ã™ã€‚ã€Œé«˜ã„æ°—ãŒã™ã‚‹ã€ã‚’å®šé‡åŒ–å¯èƒ½ãªæœ€é©åŒ–ã«å¤‰ãˆã¾ã™ã€‚

---

## ä»˜éŒ²ï¼šã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰å‚è€ƒ

<details>
<summary><strong>ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®ä½ç½®ã‚’å±•é–‹</strong></summary>

> æ›´æ–°æ—¥æ™‚ï¼š2026-01-23

| æ©Ÿèƒ½ | ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ | è¡Œç•ªå· |
| --- | --- | --- |
| Monitor ãƒšãƒ¼ã‚¸ã‚¨ãƒ³ãƒˆãƒªï¼ˆProxyMonitor ã‚’ãƒã‚¦ãƒ³ãƒˆï¼‰ | [`src/pages/Monitor.tsx`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src/pages/Monitor.tsx#L1-L12) | 1-12 |
| Monitor UIï¼šãƒ†ãƒ¼ãƒ–ãƒ«/ãƒ•ã‚£ãƒ«ã‚¿/è©³ç´°ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ— | [`src/components/proxy/ProxyMonitor.tsx`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src/components/proxy/ProxyMonitor.tsx#L13-L713) | 13-713 |
| UIï¼šè¨­å®šã‚’èª­ã¿è¾¼ã¿ enable_logging ã‚’åŒæœŸ | [`src/components/proxy/ProxyMonitor.tsx`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src/components/proxy/ProxyMonitor.tsx#L174-L243) | 174-243 |
| UIï¼šéŒ²ç”»åˆ‡ã‚Šæ›¿ãˆï¼ˆconfig æ›¸ãè¾¼ã¿ + set_proxy_monitor_enabledï¼‰ | [`src/components/proxy/ProxyMonitor.tsx`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src/components/proxy/ProxyMonitor.tsx#L254-L267) | 254-267 |
| UIï¼šãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚¤ãƒ™ãƒ³ãƒˆç›£è¦–ï¼ˆproxy://requestï¼‰ã¨é‡è¤‡æ’é™¤ | [`src/components/proxy/ProxyMonitor.tsx`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src/components/proxy/ProxyMonitor.tsx#L273-L355) | 273-355 |
| UIï¼šãƒ­ã‚°ã‚¯ãƒªã‚¢ï¼ˆclear_proxy_logsï¼‰ | [`src/components/proxy/ProxyMonitor.tsx`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src/components/proxy/ProxyMonitor.tsx#L389-L403) | 389-403 |
| UIï¼šå˜ä¸€è©³ç´°ãƒ­ãƒ¼ãƒ‰ï¼ˆget_proxy_log_detailï¼‰ | [`src/components/proxy/ProxyMonitor.tsx`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src/components/proxy/ProxyMonitor.tsx#L505-L519) | 505-519 |
| ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ï¼šãƒªã‚¯ã‚¨ã‚¹ãƒˆ/ãƒ¬ã‚¹ãƒãƒ³ã‚¹å–å¾—ã€token è§£æã€monitor ã«æ›¸ãè¾¼ã¿ | [`src-tauri/src/proxy/middleware/monitor.rs`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src-tauri/src/proxy/middleware/monitor.rs#L13-L337) | 13-337 |
| ProxyMonitorï¼šenabled ã‚¹ã‚¤ãƒƒãƒã€DB æ›¸ãè¾¼ã¿ã€ã‚¤ãƒ™ãƒ³ãƒˆé€ä¿¡ | [`src-tauri/src/proxy/monitor.rs`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src-tauri/src/proxy/monitor.rs#L33-L194) | 33-194 |
| ã‚µãƒ¼ãƒãƒ¼å´ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ãƒã‚¦ãƒ³ãƒˆï¼ˆlayerï¼‰ | [`src-tauri/src/proxy/server.rs`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src-tauri/src/proxy/server.rs#L183-L194) | 183-194 |
| Tauri ã‚³ãƒãƒ³ãƒ‰ï¼šget/count/filter/detail/clear/export | [`src-tauri/src/commands/proxy.rs`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src-tauri/src/commands/proxy.rs#L180-L314) | 180-314 |
| SQLiteï¼šproxy_logs.db ãƒ‘ã‚¹ã€ãƒ†ãƒ¼ãƒ–ãƒ«æ§‹é€ ã¨ãƒ•ã‚£ãƒ«ã‚¿ SQL | [`src-tauri/src/modules/proxy_db.rs`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src-tauri/src/modules/proxy_db.rs#L1-L416) | 1-416 |
| ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°è¨­è¨ˆèª¬æ˜ï¼ˆå®Ÿè£…ã¨ç•°ãªã‚‹å¯èƒ½æ€§ã‚ã‚Šã€ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’å„ªå…ˆï¼‰ | [`docs/proxy-monitor-technical.md`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/docs/proxy-monitor-technical.md#L1-L53) | 1-53 |

**ã‚­ãƒ¼å®šæ•°**ï¼š
- `MAX_REQUEST_LOG_SIZE = 100 * 1024 * 1024`ï¼šãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ãŒèª­ã¿å–ã‚Œã‚‹æœ€å¤§ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£ï¼ˆè¶…ãˆã‚‹ã¨èª­ã¿å–ã‚Šå¤±æ•—ï¼‰
- `MAX_RESPONSE_LOG_SIZE = 100 * 1024 * 1024`ï¼šãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ãŒèª­ã¿å–ã‚Œã‚‹æœ€å¤§ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒœãƒ‡ã‚£ï¼ˆç”»åƒãªã©å¤§ããªãƒ¬ã‚¹ãƒãƒ³ã‚¹ç”¨ï¼‰

**ã‚­ãƒ¼é–¢æ•°/ã‚³ãƒãƒ³ãƒ‰**ï¼š
- `monitor_middleware(...)`ï¼šHTTP å±¤ã§ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¨ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’åé›†ã—ã€`monitor.log_request(...)` ã‚’å‘¼ã³å‡ºã™
- `ProxyMonitor::log_request(...)`ï¼šãƒ¡ãƒ¢ãƒª + SQLite ã«æ›¸ãè¾¼ã¿ã€`proxy://request` ã‚¤ãƒ™ãƒ³ãƒˆã§æ¦‚è¦ã‚’ãƒ—ãƒƒã‚·ãƒ¥
- `get_proxy_logs_count_filtered(filter, errors_only)` / `get_proxy_logs_filtered(...)`ï¼šãƒªã‚¹ãƒˆãƒšãƒ¼ã‚¸ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã¨ãƒšãƒ¼ã‚¸ãƒ³ã‚°
- `get_proxy_log_detail(log_id)`ï¼šå˜ä¸€ãƒ­ã‚°ã®å®Œå…¨ãª request/response body ã‚’ãƒ­ãƒ¼ãƒ‰
- `export_proxy_logs(file_path)`ï¼šå…¨é‡ãƒ­ã‚°ã‚’ JSON ãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆï¼ˆç¾åœ¨ UI ã¯ãƒœã‚¿ãƒ³ã‚’å…¬é–‹ã—ã¦ã„ãªã„ï¼‰

</details>
