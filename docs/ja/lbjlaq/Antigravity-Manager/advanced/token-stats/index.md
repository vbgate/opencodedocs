---
title: "Token çµ±è¨ˆ: ã‚³ã‚¹ãƒˆç›£è¦–ã¨ãƒ‡ãƒ¼ã‚¿åˆ†æ | Antigravity Manager"
sidebarTitle: "ä¸€ç•ªé«˜ã„ã®ã¯èª°ã‹ä¸€ç›®ã§ã‚ã‹ã‚‹"
subtitle: "Token çµ±è¨ˆ: ã‚³ã‚¹ãƒˆç›£è¦–ã¨ãƒ‡ãƒ¼ã‚¿åˆ†æ"
description: "Token Stats çµ±è¨ˆæ©Ÿèƒ½ã®ä½¿ç”¨æ–¹æ³•ã‚’å­¦ã³ã¾ã™ã€‚ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‹ã‚‰ token ãƒ‡ãƒ¼ã‚¿ã‚’æŠ½å‡ºã™ã‚‹æ–¹æ³•ã€ãƒ¢ãƒ‡ãƒ«ã¨ã‚¢ã‚«ã‚¦ãƒ³ãƒˆåˆ¥ã«ä½¿ç”¨é‡ã‚’åˆ†æã™ã‚‹æ–¹æ³•ã€Top ãƒªã‚¹ãƒˆã§æœ€ã‚‚é«˜ã„ãƒ¢ãƒ‡ãƒ«ã¨ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ç‰¹å®šã™ã‚‹æ–¹æ³•ã€çµ±è¨ˆæ¬ æå•é¡Œã‚’ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã™ã‚‹æ–¹æ³•ã‚’ç†è§£ã—ã¾ã™ã€‚"
tags:
  - "Token Stats"
  - "ã‚³ã‚¹ãƒˆ"
  - "ç›£è¦–"
  - "SQLite"
  - "ä½¿ç”¨é‡çµ±è¨ˆ"
prerequisite:
  - "start-proxy-and-first-client"
  - "advanced-model-router"
order: 7
---
# Token Statsï¼šã‚³ã‚¹ãƒˆè¦–ç‚¹ã®çµ±è¨ˆå£å¾„ã¨ã‚°ãƒ©ãƒ•è§£é‡ˆ

ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’ Antigravity Tools ã«æ¥ç¶šã—ã¾ã—ãŸãŒã€ã€Œèª°ãŒãŠé‡‘ã‚’ä½¿ã£ã¦ã„ã‚‹ã‹ã€ã©ã“ãŒé«˜ã„ã‹ã€ã‚ã‚‹ãƒ¢ãƒ‡ãƒ«ãŒæ€¥ã«è·³ã­ä¸ŠãŒã£ãŸã®ã‹ã€ã¯ç›´æ„Ÿã§åˆ¤æ–­ã™ã‚‹ã®ãŒé›£ã—ã„ã“ã¨ãŒã‚ˆãã‚ã‚Šã¾ã™ã€‚ã“ã®ãƒ¬ãƒƒã‚¹ãƒ³ã§ã¯ 1 ã¤ã®ã“ã¨ã ã‘ã‚’ã—ã¾ã™ï¼šToken Stats ãƒšãƒ¼ã‚¸ã®ãƒ‡ãƒ¼ã‚¿å£å¾„ã‚’æ˜ç¢ºã«ã—ã€ã‚°ãƒ©ãƒ•ã§ã‚³ã‚¹ãƒˆå•é¡Œã‚’ç´ æ—©ãç‰¹å®šã™ã‚‹æ–¹æ³•ã‚’æ•™ãˆã¾ã™ã€‚

## å­¦ã‚“ã å¾Œã§ãã‚‹ã“ã¨

- Token Stats ã®ãƒ‡ãƒ¼ã‚¿ãŒã©ã“ã‹ã‚‰æ¥ã‚‹ã‹ã‚’æ˜ç¢ºã«èª¬æ˜ã§ãã‚‹ï¼ˆã„ã¤è¨˜éŒ²ã•ã‚Œã‚‹ã‹ã€ã©ã®ã‚ˆã†ãªå ´åˆã«æ¬ æã™ã‚‹ã‹ï¼‰
- æ™‚é–“/æ—¥/é€±ã§è¦³å¯Ÿã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’åˆ‡ã‚Šæ›¿ãˆã€ã€Œ1 æ—¥ã ã‘è¦‹ã‚‹ã€ã§èª¤åˆ¤æ–­ã‚’å›é¿ã™ã‚‹
- ã€Œãƒ¢ãƒ‡ãƒ«åˆ¥/ã‚¢ã‚«ã‚¦ãƒ³ãƒˆåˆ¥ã€2 ç¨®é¡ã®ãƒ“ãƒ¥ãƒ¼ã§ã€ãƒˆãƒ¬ãƒ³ãƒ‰ã‚°ãƒ©ãƒ•ã§ç•°å¸¸ãªãƒ”ãƒ¼ã‚¯ã‚’è¦‹ã¤ã‘ã‚‹
- Top ãƒªã‚¹ãƒˆã§æœ€ã‚‚é«˜ã„ãƒ¢ãƒ‡ãƒ«/ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ãƒ­ãƒƒã‚¯ã—ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ­ã‚°ã«æˆ»ã£ã¦æ ¹æœ¬åŸå› ã‚’è¿½è·¡ã™ã‚‹

## ç¾åœ¨ã®æ‚©ã¿

- å‘¼ã³å‡ºã—ãŒé«˜ããªã£ãŸã¨æ„Ÿã˜ã‚‹ãŒã€ãƒ¢ãƒ‡ãƒ«ãŒå¤‰ã‚ã£ãŸã®ã‹ã€ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒå¤‰ã‚ã£ãŸã®ã‹ã€ã‚ã‚‹æ—¥çªç„¶é‡ãŒå¢—ãˆãŸã®ã‹ãŒã‚ã‹ã‚‰ãªã„
- `X-Mapped-Model` ã‚’è¦‹ãŸãŒã€çµ±è¨ˆãŒã©ã®ãƒ¢ãƒ‡ãƒ«å£å¾„ã§è¨ˆç®—ã•ã‚Œã¦ã„ã‚‹ã‹ãŒä¸æ˜
- Token Stats ã«æ™‚ã€… 0 ã¾ãŸã¯ã€Œãƒ‡ãƒ¼ã‚¿ãªã—ã€ãŒè¡¨ç¤ºã•ã‚Œã€ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ãŒãªã„ã®ã‹çµ±è¨ˆã•ã‚Œã¦ã„ãªã„ã®ã‹ãŒã‚ã‹ã‚‰ãªã„

## ã“ã®æ–¹æ³•ã‚’ã„ã¤ä½¿ã†ã‹

- ã‚³ã‚¹ãƒˆæœ€é©åŒ–ã‚’è¡Œã†å ´åˆï¼šã¾ãšã€Œèª°ãŒé«˜ã„ã‹ã€ã‚’é‡åŒ–ã™ã‚‹
- çªç„¶ã®ãƒ¬ãƒ¼ãƒˆåˆ¶é™/ç•°å¸¸ã‚’ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã™ã‚‹å ´åˆï¼šãƒ”ãƒ¼ã‚¯æ™‚é–“ç‚¹ã‚’ä½¿ã£ã¦ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ­ã‚°ã¨ç…§åˆã™ã‚‹
- ãƒ¢ãƒ‡ãƒ«ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°/ã‚¯ã‚©ãƒ¼ã‚¿ã‚¬ãƒãƒŠãƒ³ã‚¹è¨­å®šå¤‰æ›´å¾Œã€ã‚³ã‚¹ãƒˆãŒæœŸå¾…é€šã‚Šä½ä¸‹ã—ãŸã‹ã‚’æ¤œè¨¼ã™ã‚‹å ´åˆ

## Token Stats ã¨ã¯ï¼Ÿ

**Token Stats**ã¯ Antigravity Tools ã®ãƒ­ãƒ¼ã‚«ãƒ«ä½¿ç”¨é‡çµ±è¨ˆãƒšãƒ¼ã‚¸ã§ã™ï¼šãƒ—ãƒ­ã‚­ã‚·ã¯ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’è»¢é€ã—ãŸå¾Œã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ JSON ã¾ãŸã¯ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ `usage/usageMetadata` ã® token æ•°ã‚’æŠ½å‡ºã—ã‚ˆã†ã¨ã—ã€å„ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¨ãƒ¢ãƒ‡ãƒ«åˆ¥ã«ãƒ­ãƒ¼ã‚«ãƒ« SQLiteï¼ˆ`token_stats.db`ï¼‰ã«æ›¸ãè¾¼ã¿ã€æœ€å¾Œã« UI ã§æ™‚é–“/ãƒ¢ãƒ‡ãƒ«/ã‚¢ã‚«ã‚¦ãƒ³ãƒˆåˆ¥ã«é›†ç´„ã—ã¦è¡¨ç¤ºã—ã¾ã™ã€‚

::: info ã‚ˆãè¸ã‚€ç‚¹ã‚’å…ˆã«èª¬æ˜
Token Stats ã®ã€Œãƒ¢ãƒ‡ãƒ«ã€å£å¾„ã¯ãƒªã‚¯ã‚¨ã‚¹ãƒˆå†…ã® `model` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ï¼ˆã¾ãŸã¯ Gemini ã® `/v1beta/models/<model>` ãƒ‘ã‚¹è§£æï¼‰ã‹ã‚‰æ¥ã‚‹ã‚‚ã®ã§ã€ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°å¾Œã® `X-Mapped-Model` ã¨åŒã˜ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚
:::

## ğŸ’ å§‹ã‚ã‚‹å‰ã®æº–å‚™

- ã™ã§ã« 1 å›ãƒ—ãƒ­ã‚­ã‚·å‘¼ã³å‡ºã—ã‚’å®Ÿè¡Œã—ã¦ã„ã‚‹ã“ã¨ï¼ˆ`/healthz` ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã ã‘ã«ç•™ã¾ã£ã¦ã„ãªã„ï¼‰
- ä¸Šæµãƒ¬ã‚¹ãƒãƒ³ã‚¹ãŒè§£æå¯èƒ½ãª token ä½¿ç”¨é‡ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’è¿”ã™ã“ã¨ï¼ˆãã†ã§ãªã„å ´åˆã€çµ±è¨ˆãŒæ¬ æã—ã¾ã™ï¼‰

::: tip æ¨å¥¨èª­ã¿åˆã‚ã›
ãƒ¢ãƒ‡ãƒ«ãƒãƒƒãƒ”ãƒ³ã‚°ã‚’ä½¿ã£ã¦ `model` ã‚’åˆ¥ã®ç‰©ç†ãƒ¢ãƒ‡ãƒ«ã«ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã—ã¦ã„ã‚‹å ´åˆã€å…ˆã« **[ãƒ¢ãƒ‡ãƒ«ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ï¼šã‚«ã‚¹ã‚¿ãƒ ãƒãƒƒãƒ”ãƒ³ã‚°ã€ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰å„ªå…ˆé †ä½ã¨ãƒ—ãƒªã‚»ãƒƒãƒˆæˆ¦ç•¥](/ja/lbjlaq/Antigravity-Manager/advanced/model-router/)** ã‚’å‚ç…§ã—ã€ã€Œçµ±è¨ˆå£å¾„ã€ã«æˆ»ã‚‹ã¨ã‚ˆã‚Šç›´æ„Ÿçš„ã«ãªã‚Šã¾ã™ã€‚
:::

## ã‚³ã‚¢ã‚³ãƒ³ã‚»ãƒ—ãƒˆ

Token Stats ã®ãƒ‡ãƒ¼ã‚¿ãƒã‚§ãƒ¼ãƒ³ã¯ 3 ã¤ã®éƒ¨åˆ†ã«åˆ†å‰²ã§ãã¾ã™ï¼š

1. ãƒ—ãƒ­ã‚­ã‚·ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ãŒãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‹ã‚‰ token ä½¿ç”¨é‡ã‚’æŠ½å‡ºã—ã‚ˆã†ã¨ã™ã‚‹ï¼ˆ`usage`/`usageMetadata` ã«äº’æ›ã€ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ã‚‚è§£æï¼‰
2. åŒæ™‚ã« `account_email + input_tokens + output_tokens` ã‚’å–å¾—ã—ãŸå ´åˆã€ãƒ­ãƒ¼ã‚«ãƒ« SQLiteï¼ˆ`token_stats.db`ï¼‰ã«æ›¸ãè¾¼ã‚€
3. UI ãŒ Tauri `invoke(get_token_stats_*)` ã‚’é€šã˜ã¦é›†ç´„ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã€æ™‚é–“/æ—¥/é€±ã§è¡¨ç¤º

## ã•ã‚ã‚„ã£ã¦ã¿ã‚ˆã†

### ã‚¹ãƒ†ãƒƒãƒ— 1ï¼šã¾ãšã€Œãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ãŒã‚ã‚‹ã€ã“ã¨ã‚’ç¢ºèªã™ã‚‹

**ç†ç”±**
Token Stats çµ±è¨ˆã¯å®Ÿéš›ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‹ã‚‰æ¥ã¾ã™ã€‚ãƒ—ãƒ­ã‚­ã‚·ã‚’èµ·å‹•ã—ãŸã ã‘ã§ã¯ãƒ¢ãƒ‡ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ 1 å›ã‚‚é€ã£ã¦ã„ãªã„å ´åˆã€ãƒšãƒ¼ã‚¸ã«ã€Œãƒ‡ãƒ¼ã‚¿ãªã—ã€ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

æ–¹æ³•ï¼š**[ãƒ­ãƒ¼ã‚«ãƒ«ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·ã‚’èµ·å‹•ã—ã¦æœ€åˆã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’æ¥ç¶š](/ja/lbjlaq/Antigravity-Manager/start/proxy-and-first-client/)** ã§ã™ã§ã«æ¤œè¨¼æˆåŠŸã—ãŸå‘¼ã³å‡ºã—æ–¹æ³•ã‚’å†åˆ©ç”¨ã—ã€1-2 å›ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ã£ã¦ãã ã•ã„ã€‚

**ç¢ºèªã™ã¹ãã‚‚ã®**ï¼šToken Stats ãƒšãƒ¼ã‚¸ãŒã€Œèª­ã¿è¾¼ã¿ä¸­/ãƒ‡ãƒ¼ã‚¿ãªã—ã€ã‹ã‚‰ã‚°ãƒ©ãƒ•ã¾ãŸã¯ãƒªã‚¹ãƒˆã«å¤‰ã‚ã‚‹ã“ã¨ã€‚

### ã‚¹ãƒ†ãƒƒãƒ— 2ï¼šé©åˆ‡ãªæ™‚é–“ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’é¸æŠã™ã‚‹ï¼ˆæ™‚é–“/æ—¥/é€±ï¼‰

**ç†ç”±**
åŒã˜ãƒ‡ãƒ¼ã‚¿ã§ã‚‚ã€ç•°ãªã‚‹ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§è¦‹ã‚‹ã€Œãƒ”ãƒ¼ã‚¯/ãƒˆãƒ¬ãƒ³ãƒ‰ã€ã¯å®Œå…¨ã«ç•°ãªã‚Šã¾ã™ã€‚UI ã§ 3 ç¨®é¡ã®ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã«å¯¾å¿œã™ã‚‹å–å¾—ç¯„å›²ã‚‚ç•°ãªã‚Šã¾ã™ï¼š

- æ™‚é–“ï¼šç›´è¿‘ 24 æ™‚é–“
- æ—¥ï¼šç›´è¿‘ 7 æ—¥
- é€±ï¼šç›´è¿‘ 4 é€±é–“ï¼ˆãƒˆãƒ¬ãƒ³ãƒ‰ãƒ“ãƒ¥ãƒ¼ã¯ç›´è¿‘ 30 æ—¥ã§é›†ç´„ï¼‰

**ç¢ºèªã™ã¹ãã‚‚ã®**ï¼šåˆ‡ã‚Šæ›¿ãˆå¾Œã€ãƒˆãƒ¬ãƒ³ãƒ‰ã‚°ãƒ©ãƒ•ã®æ¨ªè»¸ç²’åº¦ãŒå¤‰ã‚ã‚‹ï¼ˆæ™‚é–“ã¯ã€Œæ™‚ã€ã¾ã§è¡¨ç¤ºã€æ—¥ã¯ã€Œæœˆ/æ—¥ã€ã¾ã§è¡¨ç¤ºã€é€±ã¯ã€Œå¹´-Wé€±å·ã€ã¾ã§è¡¨ç¤ºï¼‰ã€‚

### ã‚¹ãƒ†ãƒƒãƒ— 3ï¼šã¾ãšãƒˆãƒƒãƒ—ç·è¦§ã‚’è¦‹ã¦ã€ã€Œã‚³ã‚¹ãƒˆè¦æ¨¡ã€ã‚’ç¢ºå®šã™ã‚‹

**ç†ç”±**
ç·è¦§ã‚«ãƒ¼ãƒ‰ã¯æœ€åˆã« 3 ã¤ã®è³ªå•ã«ç­”ãˆã‚‰ã‚Œã¾ã™ï¼šç·é‡ãŒå¤§ãã„ã‹ã©ã†ã‹ã€å…¥åŠ›/å‡ºåŠ›ã®æ¯”ç‡ãŒç•°å¸¸ã‹ã€å‚åŠ ã™ã‚‹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ/ãƒ¢ãƒ‡ãƒ«ãŒçªç„¶å¢—ãˆãŸã‹ã©ã†ã‹ã€‚

ã“ã‚Œã‚‰ã®é …ç›®ã«é‡ç‚¹ã‚’ç½®ã„ã¦ãã ã•ã„ï¼š

- ç· Tokenï¼ˆ`total_tokens`ï¼‰
- å…¥åŠ›/å‡ºåŠ› Tokenï¼ˆ`total_input_tokens` / `total_output_tokens`ï¼‰
- ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚¢ã‚«ã‚¦ãƒ³ãƒˆæ•°ï¼ˆ`unique_accounts`ï¼‰
- ä½¿ç”¨ãƒ¢ãƒ‡ãƒ«æ•°ï¼ˆUI ã¯ç›´æ¥ã€Œãƒ¢ãƒ‡ãƒ«åˆ¥çµ±è¨ˆãƒªã‚¹ãƒˆã€ã®é•·ã•ã‚’ä½¿ç”¨ï¼‰

**ç¢ºèªã™ã¹ãã‚‚ã®**ï¼šã€Œã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã‚¢ã‚«ã‚¦ãƒ³ãƒˆæ•°ã€ãŒçªç„¶è·³ã­ä¸ŠãŒã‚‹ã¨ã€é€šå¸¸ã€çŸ­æ™‚é–“ã§ã‚ˆã‚Šå¤šãã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’å®Ÿè¡Œã—ã¦ã„ã‚‹ã“ã¨ã‚’æ„å‘³ã—ã¾ã™ï¼ˆä¾‹ï¼šãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³æˆ¦ç•¥ã«åˆ‡ã‚Šæ›¿ãˆã‚‹ï¼‰ã€‚

### ã‚¹ãƒ†ãƒƒãƒ— 4ï¼šã€Œãƒ¢ãƒ‡ãƒ«åˆ¥/ã‚¢ã‚«ã‚¦ãƒ³ãƒˆåˆ¥ä½¿ç”¨ãƒˆãƒ¬ãƒ³ãƒ‰ã€ã§ç•°å¸¸ãªãƒ”ãƒ¼ã‚¯ã‚’æ•æ‰ã™ã‚‹

**ç†ç”±**
ãƒˆãƒ¬ãƒ³ãƒ‰ã‚°ãƒ©ãƒ•ã¯ã€Œçªç„¶é«˜ããªã£ãŸã€ã‚’æ•æ‰ã™ã‚‹ã®ã«æœ€ã‚‚é©ã—ãŸå…¥ã‚Šå£ã§ã™ã€‚åŸå› ã‚’å…ˆã«çŸ¥ã‚‹å¿…è¦ã¯ãªãã€ã€Œã©ã®æ—¥/ã©ã®æ™‚é–“ãŒè·³ã­ä¸ŠãŒã£ãŸã‹ã€ã‚’å…ˆã«ä¸¸ã§å›²ã¿ã¾ã™ã€‚

æ–¹æ³•ï¼š

1. ãƒˆãƒ¬ãƒ³ãƒ‰ã‚°ãƒ©ãƒ•ã®å³ä¸Šéš…ã§ã€Œãƒ¢ãƒ‡ãƒ«åˆ¥ / ã‚¢ã‚«ã‚¦ãƒ³ãƒˆåˆ¥ã€ã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹
2. ãƒã‚¦ã‚¹ã‚’ãƒ›ãƒãƒ¼ï¼ˆTooltipï¼‰ã—ã¦ Top å€¤ã‚’è¦‹ã‚‹ã€ã€Œçªç„¶ 1 ä½ã«ãªã£ãŸã‚‚ã®ã€ã‚’å„ªå…ˆçš„ã«æ³¨ç›®ã™ã‚‹

**ç¢ºèªã™ã¹ãã‚‚ã®**ï¼š

- ãƒ¢ãƒ‡ãƒ«åˆ¥ï¼šã‚ã‚‹ãƒ¢ãƒ‡ãƒ«ãŒç‰¹å®šã®æ™‚é–“å¸¯ã§çªç„¶ä¸Šæ˜‡
- ã‚¢ã‚«ã‚¦ãƒ³ãƒˆåˆ¥ï¼šã‚ã‚‹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒç‰¹å®šã®æ™‚é–“å¸¯ã§çªç„¶ä¸Šæ˜‡

### ã‚¹ãƒ†ãƒƒãƒ— 5ï¼šTop ãƒªã‚¹ãƒˆã§ã€Œæœ€ã‚‚é«˜ã„ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã€ã‚’ãƒ­ãƒƒã‚¯ã™ã‚‹

**ç†ç”±**
ãƒˆãƒ¬ãƒ³ãƒ‰ã‚°ãƒ©ãƒ•ã¯ã€Œã„ã¤ç•°å¸¸ã‹ã€ã‚’æ•™ãˆã¦ãã‚Œã€Top ãƒªã‚¹ãƒˆã¯ã€Œèª°ãŒé«˜ã„ã‹ã€ã‚’æ•™ãˆã¦ãã‚Œã¾ã™ã€‚ã“ã‚Œã‚‰ã‚’äº¤å·®ã•ã›ã‚‹ã¨ã€ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ç¯„å›²ã‚’ç´ æ—©ãç‰¹å®šã§ãã¾ã™ã€‚

æ–¹æ³•ï¼š

- ã€Œãƒ¢ãƒ‡ãƒ«åˆ¥ã€ãƒ“ãƒ¥ãƒ¼ã§ã€ã€Œãƒ¢ãƒ‡ãƒ«åˆ¥è©³ç´°çµ±è¨ˆã€ãƒ†ãƒ¼ãƒ–ãƒ«ã® `total_tokens / request_count / æ¯”ç‡` ã‚’è¦‹ã‚‹
- ã€Œã‚¢ã‚«ã‚¦ãƒ³ãƒˆåˆ¥ã€ãƒ“ãƒ¥ãƒ¼ã§ã€ã€Œã‚¢ã‚«ã‚¦ãƒ³ãƒˆè©³ç´°çµ±è¨ˆã€ãƒ†ãƒ¼ãƒ–ãƒ«ã® `total_tokens / request_count` ã‚’è¦‹ã‚‹

**ç¢ºèªã™ã¹ãã‚‚ã®**ï¼šæœ€ã‚‚é«˜ã„ãƒ¢ãƒ‡ãƒ«/ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒå…ˆé ­ã«ä¸¦ã³ã€`request_count` ãŒã€Œ1 å›ç‰¹ã«é«˜ã„ã€ã‹ã€Œå›æ•°ãŒç‰¹ã«å¤šã„ã€ã‹ã‚’åŒºåˆ¥ã§ãã‚‹ã€‚

### ã‚¹ãƒ†ãƒƒãƒ— 6ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰ï¼š`token_stats.db` ã‚’è¦‹ã¤ã‘ã€ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—/ç…§åˆã‚’è¡Œã†

**ç†ç”±**
ã€Œçµ±è¨ˆæ¬ æã€ã‚’ç–‘ã†å ´åˆã€ã¾ãŸã¯ã‚ªãƒ•ãƒ©ã‚¤ãƒ³åˆ†æã‚’è¡Œã„ãŸã„å ´åˆã€SQLite ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç›´æ¥å–å¾—ã™ã‚‹ã®ãŒæœ€ã‚‚ä¿¡é ¼ã§ãã¾ã™ã€‚

æ–¹æ³•ï¼šSettings ã® Advanced é ˜åŸŸã§ã€ŒOpen Data Directoryã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã€ãƒ‡ãƒ¼ã‚¿ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã§ `token_stats.db` ã‚’è¦‹ã¤ã‘ã¾ã™ã€‚

**ç¢ºèªã™ã¹ãã‚‚ã®**ï¼šãƒ•ã‚¡ã‚¤ãƒ«ãƒªã‚¹ãƒˆã« `token_stats.db` ãŒã‚ã‚‹ã“ã¨ï¼ˆãƒ•ã‚¡ã‚¤ãƒ«åã¯ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã§å›ºå®šã•ã‚Œã¦ã„ã¾ã™ï¼‰ã€‚

## ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆ âœ…

- Token Stats çµ±è¨ˆãŒã€Œãƒ¬ã‚¹ãƒãƒ³ã‚¹å†…ã® usage/usageMetadata ã‹ã‚‰æŠ½å‡ºã—ã¦ãƒ­ãƒ¼ã‚«ãƒ« SQLite ã«è½ã¨ã—è¾¼ã‚€ã€ã§ã‚ã‚‹ã“ã¨ã‚’æ˜ç¢ºã«èª¬æ˜ã§ãã‚‹ã€ã‚¯ãƒ©ã‚¦ãƒ‰èª²é‡‘ã§ã¯ãªã„
- ã€Œãƒ¢ãƒ‡ãƒ«åˆ¥/ã‚¢ã‚«ã‚¦ãƒ³ãƒˆåˆ¥ã€2 ç¨®é¡ã®ãƒˆãƒ¬ãƒ³ãƒ‰ãƒ“ãƒ¥ãƒ¼ã§ã€å…·ä½“çš„ãªãƒ”ãƒ¼ã‚¯æ™‚é–“å¸¯ã‚’æŒ‡æ‘˜ã§ãã‚‹
- Top ãƒªã‚¹ãƒˆã§å®Ÿè¡Œå¯èƒ½ãªãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°çµè«–ã‚’å‡ºã›ã‚‹ï¼šã¾ãšã©ã®ãƒ¢ãƒ‡ãƒ«ã¾ãŸã¯ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ç¢ºèªã™ã‚‹ã‹

## ã‚ˆãã‚ã‚‹è½ã¨ã—ç©´

| ç¾è±¡ | ã‚ˆãã‚ã‚‹åŸå›  | å¯¾å‡¦æ³• |
| --- | --- | --- |
| Token Stats ã«ã€Œãƒ‡ãƒ¼ã‚¿ãªã—ã€ãŒè¡¨ç¤ºã•ã‚Œã‚‹ | ãƒ¢ãƒ‡ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å®Ÿéš›ã«ç”Ÿæˆã—ã¦ã„ãªã„ï¼›ã¾ãŸã¯ä¸Šæµãƒ¬ã‚¹ãƒãƒ³ã‚¹ãŒè§£æå¯èƒ½ãª token ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’æŒã£ã¦ã„ãªã„ | ã¾ãšæ¤œè¨¼æ¸ˆã¿ã®åˆ©ç”¨å¯èƒ½ãªã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã§ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ã‚‹ï¼›ãã®å¾Œã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã« `usage/usageMetadata` ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã‹ã‚’ç¢ºèª |
| çµ±è¨ˆãŒã€Œãƒ¢ãƒ‡ãƒ«ã€ã§è¦‹ã¦é–“é•ã£ã¦ã„ã‚‹ | çµ±è¨ˆå£å¾„ã¯ãƒªã‚¯ã‚¨ã‚¹ãƒˆå†…ã® `model` ã‚’ä½¿ç”¨ã—ã€`X-Mapped-Model` ã§ã¯ãªã„ | ãƒ¢ãƒ‡ãƒ«ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚’ã€Œãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ¢ãƒ‡ãƒ« -> ãƒãƒƒãƒ”ãƒ³ã‚°ãƒ¢ãƒ‡ãƒ«ã€ã¨è¦‹ã‚‹ï¼›çµ±è¨ˆã¯ã€Œãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ¢ãƒ‡ãƒ«ã€ã‚’è¦‹ã‚‹ |
| ã‚¢ã‚«ã‚¦ãƒ³ãƒˆæ¬¡å…ƒãŒæ¬ æã—ã¦ã„ã‚‹ | `X-Account-Email` ã‚’å–å¾—ã—ã€token ä½¿ç”¨é‡ã‚’è§£æã—ãŸå ´åˆã®ã¿æ›¸ãè¾¼ã¾ã‚Œã‚‹ | ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒå®Ÿéš›ã«ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ—ãƒ¼ãƒ«ã«åˆ°é”ã—ãŸã“ã¨ã‚’ç¢ºèªï¼›ãã®å¾Œã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ­ã‚°/ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ˜ãƒƒãƒ€ãƒ¼ã¨ç…§åˆ |
| Proxy Monitor ã‚’æœ‰åŠ¹ã«ã™ã‚‹ã¨çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ãŒå¤§ãããªã‚‹ | Proxy Monitor ãŒæœ‰åŠ¹ãªå ´åˆã€å„ãƒªã‚¯ã‚¨ã‚¹ãƒˆã® token ãŒ 2 å›è¨˜éŒ²ã•ã‚Œã‚‹ | ã“ã‚Œã¯æ—¢çŸ¥ã®å®Ÿè£…è©³ç´°ã§ã‚ã‚Šã€ç›¸å¯¾ãƒˆãƒ¬ãƒ³ãƒ‰åˆ†æã«ã¯å½±éŸ¿ã—ãªã„ï¼›æ­£ç¢ºãªå€¤ãŒå¿…è¦ãªå ´åˆã€Monitor ã‚’ä¸€æ™‚çš„ã«ç„¡åŠ¹ã«ã—ã¦å†æ¸¬å®š |

## ã“ã®ãƒ¬ãƒƒã‚¹ãƒ³ã®ã¾ã¨ã‚

- Token Stats ã®ã‚³ã‚¢ä¾¡å€¤ã¯ã€Œã‚³ã‚¹ãƒˆå•é¡Œã‚’é‡åŒ–ã™ã‚‹ã€ã“ã¨ã€ã¾ãšç‰¹å®šã—ã€æ¬¡ã«æœ€é©åŒ–ã™ã‚‹
- çµ±è¨ˆæ›¸ãè¾¼ã¿æ™‚ã€ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¨ token ä½¿ç”¨é‡ã¯å¿…é ˆï¼›ãƒ¢ãƒ‡ãƒ«ãŒæ¬ æã—ã¦ã„ã‚‹å ´åˆã€`"unknown"` ã¨ã—ã¦è¨˜éŒ²ã•ã‚Œã‚‹ï¼ˆæ›¸ãè¾¼ã¿ã‚’é˜»æ­¢ã—ãªã„ï¼‰
- ã‚ˆã‚Šç²¾å¯†ãªã‚³ã‚¹ãƒˆåˆ¶å¾¡ã‚’è¡Œã„ãŸã„å ´åˆã€æ¬¡ã¯é€šå¸¸ãƒ¢ãƒ‡ãƒ«ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã¾ãŸã¯ã‚¯ã‚©ãƒ¼ã‚¿ã‚¬ãƒãƒŠãƒ³ã‚¹ã«æˆ»ã‚‹

## æ¬¡ã®ãƒ¬ãƒƒã‚¹ãƒ³ã®äºˆå‘Š

> æ¬¡ã®ãƒ¬ãƒƒã‚¹ãƒ³ã§ã¯é•·ã„ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®ã€Œéš ã‚ŒãŸå®‰å®šæ€§å•é¡Œã€ã‚’è§£æ±ºã—ã¾ã™ï¼š**[é•·ã„ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®å®‰å®šæ€§ï¼šã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆåœ§ç¸®ã€ç½²åã‚­ãƒ£ãƒƒã‚·ãƒ¥ã¨ãƒ„ãƒ¼ãƒ«çµæœåœ§ç¸®](/ja/lbjlaq/Antigravity-Manager/advanced/context-compression/)**ã€‚

å­¦ã¹ã‚‹ã“ã¨ï¼š

- 3 å±¤ã®æ¼¸é€²çš„ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆåœ§ç¸®ãŒãã‚Œãã‚Œä½•ã‚’ã™ã‚‹ã‹
- ãªãœã€Œç½²åã‚­ãƒ£ãƒƒã‚·ãƒ¥ã€ãŒ 400 ç½²åã‚¨ãƒ©ãƒ¼ã‚’æ¸›ã‚‰ã›ã‚‹ã®ã‹
- ãƒ„ãƒ¼ãƒ«çµæœåœ§ç¸®ã¯ä½•ã‚’å‰Šé™¤ã—ã€ä½•ã‚’æ®‹ã™ã®ã‹

---

## ä»˜éŒ²ï¼šã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰å‚è€ƒ

<details>
<summary><strong>ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®å ´æ‰€ã‚’å±•é–‹</strong></summary>

> æ›´æ–°æ—¥æ™‚ï¼š2026-01-23

| æ©Ÿèƒ½ | ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ | è¡Œç•ªå· |
| --- | --- | --- |
| Token Stats ãƒšãƒ¼ã‚¸ãƒ«ãƒ¼ãƒˆ `/token-stats` | [`src/App.tsx`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src/App.tsx#L19-L47) | 19-47 |
| Token Stats UIï¼šæ™‚é–“ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦/ãƒ“ãƒ¥ãƒ¼åˆ‡ã‚Šæ›¿ãˆã¨ãƒ‡ãƒ¼ã‚¿å–å¾— | [`src/pages/TokenStats.tsx`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src/pages/TokenStats.tsx#L49-L166) | 49-166 |
| Token Stats UIï¼šç©ºãƒ‡ãƒ¼ã‚¿ãƒ’ãƒ³ãƒˆï¼ˆã€Œãƒ‡ãƒ¼ã‚¿ãªã—ã€ï¼‰ | [`src/pages/TokenStats.tsx`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src/pages/TokenStats.tsx#L458-L507) | 458-507 |
| Token ä½¿ç”¨é‡æŠ½å‡ºï¼šãƒªã‚¯ã‚¨ã‚¹ãƒˆã‹ã‚‰ model è§£æã€ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‹ã‚‰ usage/usageMetadata è§£æ | [`src-tauri/src/proxy/middleware/monitor.rs`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src-tauri/src/proxy/middleware/monitor.rs#L32-L120) | 32-120 |
| Token ä½¿ç”¨é‡æŠ½å‡ºï¼šã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ã¨ JSON ãƒ¬ã‚¹ãƒãƒ³ã‚¹ usage ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰è§£æ | [`src-tauri/src/proxy/middleware/monitor.rs`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src-tauri/src/proxy/middleware/monitor.rs#L122-L336) | 122-336 |
| Token Stats æ›¸ãè¾¼ã¿ç‚¹ï¼šã‚¢ã‚«ã‚¦ãƒ³ãƒˆ+token å–å¾—å¾Œ SQLite ã«æ›¸ãè¾¼ã¿ | [`src-tauri/src/proxy/monitor.rs`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src-tauri/src/proxy/monitor.rs#L79-L136) | 79-136 |
| ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«åã¨ãƒ†ãƒ¼ãƒ–ãƒ«æ§‹é€ ï¼š`token_stats.db` / `token_usage` / `token_stats_hourly` | [`src-tauri/src/modules/token_stats.rs`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src-tauri/src/modules/token_stats.rs#L58-L126) | 58-126 |
| æ›¸ãè¾¼ã¿ãƒ­ã‚¸ãƒƒã‚¯ï¼š`record_usage(account_email, model, input, output)` | [`src-tauri/src/modules/token_stats.rs`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src-tauri/src/modules/token_stats.rs#L128-L159) | 128-159 |
| ã‚¯ã‚¨ãƒªãƒ­ã‚¸ãƒƒã‚¯ï¼šæ™‚é–“/æ—¥/é€±ã€ã‚¢ã‚«ã‚¦ãƒ³ãƒˆåˆ¥/ãƒ¢ãƒ‡ãƒ«åˆ¥ã€ãƒˆãƒ¬ãƒ³ãƒ‰ã¨ç·è¦§ | [`src-tauri/src/modules/token_stats.rs`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src-tauri/src/modules/token_stats.rs#L161-L555) | 161-555 |
| Tauri ã‚³ãƒãƒ³ãƒ‰ï¼š`get_token_stats_*` ã‚’ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã«å…¬é–‹ | [`src-tauri/src/commands/mod.rs`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src-tauri/src/commands/mod.rs#L791-L847) | 791-847 |
| ã‚¢ãƒ—ãƒªèµ·å‹•æ™‚ã« Token Stats DB ã‚’åˆæœŸåŒ– | [`src-tauri/src/lib.rs`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src-tauri/src/lib.rs#L50-L56) | 50-56 |
| è¨­å®šãƒšãƒ¼ã‚¸ï¼šãƒ‡ãƒ¼ã‚¿ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å–å¾—/ã‚ªãƒ¼ãƒ—ãƒ³ï¼ˆ`token_stats.db` ã‚’è¦‹ã¤ã‘ã‚‹ãŸã‚ï¼‰ | [`src/pages/Settings.tsx`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src/pages/Settings.tsx#L76-L143) | 76-143 |

</details>
