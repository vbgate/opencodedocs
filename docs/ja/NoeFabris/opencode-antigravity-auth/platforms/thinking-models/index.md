---
title: "Thinking ãƒ¢ãƒ‡ãƒ«è¨­å®š | opencode-antigravity-auth"
sidebarTitle: "AI ã«æ·±ãè€ƒãˆã•ã›ã‚‹"
subtitle: "Thinking ãƒ¢ãƒ‡ãƒ«ï¼šClaude ã¨ Gemini 3 ã®æ€è€ƒèƒ½åŠ›"
description: "Claude ã¨ Gemini 3 Thinking ãƒ¢ãƒ‡ãƒ«ã®è¨­å®šã‚’å­¦ã¶ã€‚thinking budgetã€thinking levelã€variant ã®è¨­å®šæ–¹æ³•ã‚’ç¿’å¾—ã™ã‚‹ã€‚"
tags:
  - "Thinking ãƒ¢ãƒ‡ãƒ«"
  - "Claude Opus 4.5"
  - "Claude Sonnet 4.5"
  - "Gemini 3 Pro"
  - "Gemini 3 Flash"
  - "variant è¨­å®š"
prerequisite:
  - "start-quick-install"
  - "start-first-request"
order: 4
---

# Thinking ãƒ¢ãƒ‡ãƒ«ï¼šClaude ã¨ Gemini 3 ã®æ€è€ƒèƒ½åŠ›

## å­¦ç¿’å¾Œã«ã§ãã‚‹ã“ã¨

- Claude Opus 4.5ã€Sonnet 4.5 Thinking ãƒ¢ãƒ‡ãƒ«ã® thinking budget ã‚’è¨­å®šã™ã‚‹
- Gemini 3 Pro/Flash ã® thinking levelï¼ˆminimal/low/medium/highï¼‰ã‚’ä½¿ç”¨ã™ã‚‹
- OpenCode variant ã‚·ã‚¹ãƒ†ãƒ ã‚’ä½¿ã£ã¦æ€è€ƒå¼·åº¦ã‚’æŸ”è»Ÿã«èª¿æ•´ã™ã‚‹
- interleaved thinkingï¼ˆãƒ„ãƒ¼ãƒ«å‘¼ã³å‡ºã—æ™‚ã®æ€è€ƒãƒ¡ã‚«ãƒ‹ã‚ºãƒ ï¼‰ã‚’ç†è§£ã™ã‚‹
- æ€è€ƒãƒ–ãƒ­ãƒƒã‚¯ä¿æŒæˆ¦ç•¥ï¼ˆkeep_thinking è¨­å®šï¼‰ã‚’ç¿’å¾—ã™ã‚‹

## ç¾åœ¨ã®èª²é¡Œ

AI ãƒ¢ãƒ‡ãƒ«ã«è¤‡é›‘ãªã‚¿ã‚¹ã‚¯ã§ã‚ˆã‚Šè‰¯ã„ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’ç™ºæ®ã•ã›ãŸã„â€”â€”ä¾‹ãˆã°ã€å¤šæ®µéšæ¨è«–ã€ã‚³ãƒ¼ãƒ‰ãƒ‡ãƒãƒƒã‚°ã€ã¾ãŸã¯ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆã€‚ã§ã‚‚ä»¥ä¸‹ã®å•é¡ŒãŒã‚ã‚‹ï¼š

- é€šå¸¸ãƒ¢ãƒ‡ãƒ«ã®å›ç­”ã¯é€Ÿã™ãã¦ã€ååˆ†ã«æ·±ãè€ƒãˆã¦ã„ãªã„
- Claude ã®å…¬å¼åˆ¶é™ã§ thinking æ©Ÿèƒ½ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ãŒå›°é›£
- Gemini 3 ã® thinking level è¨­å®šãŒä¸æ˜ç­
- ã©ã®ç¨‹åº¦ã® thinking ãŒååˆ†ã‹ã‚ã‹ã‚‰ãªã„ï¼ˆbudget ã¯ã©ã‚Œãã‚‰ã„ã«ã™ã¹ãã‹ï¼‰
- æ€è€ƒãƒ–ãƒ­ãƒƒã‚¯å†…å®¹ã‚’èª­ã‚€éš›ã«ç½²åã‚¨ãƒ©ãƒ¼ã«é­é‡ã™ã‚‹

## ã„ã¤ã“ã®æ©Ÿèƒ½ã‚’ä½¿ã†ã‹

**é©ç”¨ã‚·ãƒ¼ãƒ³**ï¼š
- å¤šæ®µéšæ¨è«–ãŒå¿…è¦ãªè¤‡é›‘ãªå•é¡Œï¼ˆã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ è¨­è¨ˆã€ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ï¼‰
- æ…é‡ã«è€ƒãˆã‚‹å¿…è¦ãŒã‚ã‚‹ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚„ãƒ‡ãƒãƒƒã‚°
- æ·±ã„åˆ†æãŒå¿…è¦ãªé•·ã„ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚„ã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹
- ãƒ„ãƒ¼ãƒ«å‘¼ã³å‡ºã—ãŒå¯†é›†ã™ã‚‹ã‚¿ã‚¹ã‚¯ï¼ˆinterleaved thinking ãŒå¿…è¦ï¼‰

**éé©ç”¨ã‚·ãƒ¼ãƒ³**ï¼š
- ç°¡å˜ãª Q&Aï¼ˆthinking quota ã®æµªè²»ï¼‰
- é«˜é€Ÿãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—æ¤œè¨¼ï¼ˆé€Ÿåº¦å„ªå…ˆï¼‰
- äº‹å®Ÿæ¤œç´¢ï¼ˆæ¨è«–ãŒä¸è¦ï¼‰

## ğŸ’ å§‹ã‚ã‚‹å‰ã®æº–å‚™

::: warning å‰ææ¡ä»¶ãƒã‚§ãƒƒã‚¯

 1. **ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¨èªè¨¼ãŒå®Œäº†ã—ã¦ã„ã‚‹ã“ã¨**ï¼š[ã‚¯ã‚¤ãƒƒã‚¯ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«](../../start/quick-install/) ã¨ [åˆå›èªè¨¼](../../start/first-auth-login/) ã‚’å‚ç…§
 2. **åŸºæœ¬çš„ãªãƒ¢ãƒ‡ãƒ«ã®ä½¿ç”¨ã‚’ç†è§£ã—ã¦ã„ã‚‹ã“ã¨**ï¼š[åˆå›ãƒªã‚¯ã‚¨ã‚¹ãƒˆ](../../start/first-request/) ã‚’å‚ç…§
 3. **åˆ©ç”¨å¯èƒ½ãª Thinking ãƒ¢ãƒ‡ãƒ«ãŒã‚ã‚‹ã“ã¨**ï¼šClaude Opus 4.5/Sonnet 4.5 Thinking ã¾ãŸã¯ Gemini 3 Pro/Flash ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ãŒã‚ã‚‹ã“ã¨ã‚’ç¢ºèª

 :::

---

## æ ¸å¿ƒã‚¢ã‚¤ãƒ‡ã‚¢

### Thinking ãƒ¢ãƒ‡ãƒ«ã¨ã¯

**Thinking ãƒ¢ãƒ‡ãƒ«**ã¯ã€æœ€çµ‚çš„ãªå›ç­”ã‚’ç”Ÿæˆã™ã‚‹å‰ã«ã€å†…éƒ¨æ¨è«–ï¼ˆthinking blocksï¼‰ã‚’è¡Œã„ã¾ã™ã€‚ã“ã‚Œã‚‰ã®æ€è€ƒå†…å®¹ã¯ï¼š

- **èª²é‡‘å¯¾è±¡å¤–**ï¼šThinking tokens ã¯é€šå¸¸ã®å‡ºåŠ›ã‚¯ã‚©ãƒ¼ã‚¿ã«ã‚«ã‚¦ãƒ³ãƒˆã•ã‚Œã¾ã›ã‚“ï¼ˆå…·ä½“çš„ãªèª²é‡‘ãƒ«ãƒ¼ãƒ«ã¯ Antigravity å…¬å¼ã‚’å‚ç…§ï¼‰
- **æ¨è«–å“è³ªã®å‘ä¸Š**ï¼šã‚ˆã‚Šå¤šãã®æ€è€ƒ â†’ ã‚ˆã‚Šæ­£ç¢ºã§è«–ç†çš„ãªå›ç­”
- **æ™‚é–“ã®æ¶ˆè²»**ï¼šThinking ã¯å¿œç­”é…å»¶ã‚’å¢—åŠ ã•ã›ã¾ã™ãŒã€ã‚ˆã‚Šè‰¯ã„çµæœã‚’ã‚‚ãŸã‚‰ã—ã¾ã™

**é‡è¦ãªé•ã„**ï¼š

| é€šå¸¸ãƒ¢ãƒ‡ãƒ« | Thinking ãƒ¢ãƒ‡ãƒ« |
|---|---|
| ç›´æ¥å›ç­”ã‚’ç”Ÿæˆ | å…ˆã«æ€è€ƒ â†’ ãã®å¾Œå›ç­”ã‚’ç”Ÿæˆ |
| é€Ÿã„ãŒæµ…ã„å¯èƒ½æ€§ãŒã‚ã‚‹ | é…ã„ãŒã‚ˆã‚Šæ·±ã„ |
| ç°¡å˜ãªã‚¿ã‚¹ã‚¯ã«é©ã—ã¦ã„ã‚‹ | è¤‡é›‘ãªã‚¿ã‚¹ã‚¯ã«é©ã—ã¦ã„ã‚‹ |

### 2 ç¨®é¡ã® Thinking å®Ÿè£…

Antigravity Auth ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¯ 2 ç¨®é¡ã® Thinking å®Ÿè£…ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¾ã™ï¼š

#### Claude Thinkingï¼ˆOpus 4.5ã€Sonnet 4.5ï¼‰

- **Token-based budget**ï¼šæ•°å­—ã§æ€è€ƒé‡ã‚’åˆ¶å¾¡ï¼ˆä¾‹ï¼š8192ã€32768ï¼‰
- **Interleaved thinking**ï¼šãƒ„ãƒ¼ãƒ«å‘¼ã³å‡ºã—ã®å‰å¾Œã§æ€è€ƒã§ãã‚‹
- **Snake_case keys**ï¼š`include_thoughts`ã€`thinking_budget` ã‚’ä½¿ç”¨

#### Gemini 3 Thinkingï¼ˆProã€Flashï¼‰

- **Level-based**ï¼šæ–‡å­—åˆ—ã§æ€è€ƒå¼·åº¦ã‚’åˆ¶å¾¡ï¼ˆminimal/low/medium/highï¼‰
- **CamelCase keys**ï¼š`includeThoughts`ã€`thinkingLevel` ã‚’ä½¿ç”¨
- **ãƒ¢ãƒ‡ãƒ«å·®ç•°**ï¼šFlash ã¯ 4 ã¤ã® levels ã‚’ã‚µãƒãƒ¼ãƒˆã€Pro ã¯ low/high ã®ã¿ã‚µãƒãƒ¼ãƒˆ

---

## å®Ÿè·µæ‰‹é †

### ã‚¹ãƒ†ãƒƒãƒ— 1ï¼šVariant ã§ Thinking ãƒ¢ãƒ‡ãƒ«ã‚’è¨­å®š

OpenCode ã® variant ã‚·ã‚¹ãƒ†ãƒ ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€ãƒ¢ãƒ‡ãƒ«ã‚»ãƒ¬ã‚¯ã‚¿ãƒ¼ã§ç›´æ¥ thinking å¼·åº¦ã‚’é¸æŠã§ãã€è¤‡é›‘ãªãƒ¢ãƒ‡ãƒ«åã‚’è¦šãˆã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã›ã‚“ã€‚

#### æ—¢å­˜è¨­å®šã®ç¢ºèª

ãƒ¢ãƒ‡ãƒ«è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆé€šå¸¸ã¯ `.opencode/models.json` ã¾ãŸã¯ã‚·ã‚¹ãƒ†ãƒ è¨­å®šãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼‰ã‚’ç¢ºèªã—ã¾ã™ï¼š

```bash
## ãƒ¢ãƒ‡ãƒ«è¨­å®šã‚’ç¢ºèª
cat ~/.opencode/models.json
```

#### Claude Thinking ãƒ¢ãƒ‡ãƒ«ã®è¨­å®š

`antigravity-claude-sonnet-4-5-thinking` ã¾ãŸã¯ `antigravity-claude-opus-4-5-thinking` ã‚’è¦‹ã¤ã‘ã¦ã€variants ã‚’è¿½åŠ ã—ã¾ã™ï¼š

```json
{
  "antigravity-claude-sonnet-4-5-thinking": {
    "name": "Claude Sonnet 4.5 Thinking",
    "limit": { "context": 200000, "output": 64000 },
    "modalities": { "input": ["text", "image", "pdf"], "output": ["text"] },
    "variants": {
      "low": { "thinkingConfig": { "thinkingBudget": 8192 } },
      "medium": { "thinkingConfig": { "thinkingBudget": 16384 } },
      "max": { "thinkingConfig": { "thinkingBudget": 32768 } }
    }
  }
}
```

**è¨­å®šèª¬æ˜**ï¼š
- `low`ï¼š8192 tokens - è»½é‡æ€è€ƒã€ä¸­ç¨‹åº¦ã®è¤‡é›‘ã•ã®ã‚¿ã‚¹ã‚¯ã«é©ã—ã¦ã„ã‚‹
- `medium`ï¼š16384 tokens - æ€è€ƒã¨é€Ÿåº¦ã®ãƒãƒ©ãƒ³ã‚¹
- `max`ï¼š32768 tokens - æœ€å¤§æ€è€ƒã€æœ€ã‚‚è¤‡é›‘ãªã‚¿ã‚¹ã‚¯ã«é©ã—ã¦ã„ã‚‹

#### Gemini 3 Thinking ãƒ¢ãƒ‡ãƒ«ã®è¨­å®š

**Gemini 3 Pro**ï¼ˆlow/high ã®ã¿ã‚µãƒãƒ¼ãƒˆï¼‰ï¼š

```json
{
  "antigravity-gemini-3-pro": {
    "name": "Gemini 3 Pro (Antigravity)",
    "limit": { "context": 1048576, "output": 65535 },
    "modalities": { "input": ["text", "image", "pdf"], "output": ["text"] },
    "variants": {
      "low": { "thinkingLevel": "low" },
      "high": { "thinkingLevel": "high" }
    }
  }
}
```

**Gemini 3 Flash**ï¼ˆ4 ã¤ã® levels ã‚’ã‚µãƒãƒ¼ãƒˆï¼‰ï¼š

```json
{
  "antigravity-gemini-3-flash": {
    "name": "Gemini 3 Flash (Antigravity)",
    "limit": { "context": 1048576, "output": 65536 },
    "modalities": { "input": ["text", "image", "pdf"], "output": ["text"] },
    "variants": {
      "minimal": { "thinkingLevel": "minimal" },
      "low": { "thinkingLevel": "low" },
      "medium": { "thinkingLevel": "medium" },
      "high": { "thinkingLevel": "high" }
    }
  }
}
```

**è¨­å®šèª¬æ˜**ï¼š
- `minimal`ï¼šæœ€ä½æ€è€ƒã€æœ€é€Ÿå¿œç­”ï¼ˆFlash ã®ã¿ï¼‰
- `low`ï¼šè»½é‡æ€è€ƒ
- `medium`ï¼šãƒãƒ©ãƒ³ã‚¹æ€è€ƒï¼ˆFlash ã®ã¿ï¼‰
- `high`ï¼šæœ€å¤§æ€è€ƒï¼ˆæœ€ã‚‚é…ã„ãŒæœ€ã‚‚æ·±ã„ï¼‰

**ç¢ºèªãƒã‚¤ãƒ³ãƒˆ**ï¼šOpenCode ã®ãƒ¢ãƒ‡ãƒ«ã‚»ãƒ¬ã‚¯ã‚¿ãƒ¼ã§ã€Thinking ãƒ¢ãƒ‡ãƒ«ã‚’é¸æŠã™ã‚‹ã¨ variant ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã€‚

### ã‚¹ãƒ†ãƒƒãƒ— 2ï¼šThinking ãƒ¢ãƒ‡ãƒ«ã‚’ä½¿ç”¨ã—ã¦ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡

è¨­å®šãŒå®Œäº†ã—ãŸã‚‰ã€OpenCode ã§ãƒ¢ãƒ‡ãƒ«ã¨ variant ã‚’é¸æŠã§ãã¾ã™ï¼š

```bash
## Claude Sonnet 4.5 Thinking (max) ã‚’ä½¿ç”¨
opencode run "åˆ†æ•£ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚·ã‚¹ãƒ†ãƒ ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’è¨­è¨ˆã—ã¦ãã ã•ã„" \
  --model=google/antigravity-claude-sonnet-4-5-thinking \
  --variant=max

## Gemini 3 Pro (high) ã‚’ä½¿ç”¨
opencode run "ã“ã®ã‚³ãƒ¼ãƒ‰ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒœãƒˆãƒ«ãƒãƒƒã‚¯ã‚’åˆ†æã—ã¦ãã ã•ã„" \
  --model=google/antigravity-gemini-3-pro \
  --variant=high

## Gemini 3 Flash (minimal - æœ€é€Ÿ) ã‚’ä½¿ç”¨
opencode run "ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ã‚’ç´ æ—©ãè¦ç´„ã—ã¦ãã ã•ã„" \
  --model=google/antigravity-gemini-3-flash \
  --variant=minimal
```

**ç¢ºèªãƒã‚¤ãƒ³ãƒˆ**ï¼šãƒ¢ãƒ‡ãƒ«ã¯å…ˆã« thinking blocksï¼ˆæ€è€ƒå†…å®¹ï¼‰ã‚’å‡ºåŠ›ã—ã€ãã®å¾Œã«æœ€çµ‚çš„ãªå›ç­”ã‚’ç”Ÿæˆã™ã‚‹ã€‚

### ã‚¹ãƒ†ãƒƒãƒ— 3ï¼šInterleaved Thinking ã‚’ç†è§£ã™ã‚‹

Interleaved thinking ã¯ã€Claude ãƒ¢ãƒ‡ãƒ«ã®ç‰¹åˆ¥ãªèƒ½åŠ›ã§ã‚ã‚Šã€ãƒ„ãƒ¼ãƒ«å‘¼ã³å‡ºã—ã®å‰å¾Œã§æ€è€ƒã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

**ã‚·ãƒ¼ãƒ³ä¾‹**ï¼šAI ã«ãƒ„ãƒ¼ãƒ«ï¼ˆãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¯ã‚¨ãƒªãªã©ï¼‰ã‚’ä½¿ç”¨ã—ã¦ã‚¿ã‚¹ã‚¯ã‚’å®Œäº†ã•ã›ã‚‹å ´åˆï¼š

```
Thinking: ã¾ãšè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿å–ã‚‹å¿…è¦ãŒã‚ã‚‹ã€ãã®å¾Œã€å†…å®¹ã«åŸºã¥ã„ã¦æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ã‚’æ±ºå®šã™ã‚‹...

[ãƒ„ãƒ¼ãƒ«å‘¼ã³å‡ºã—: read_file("config.json")]

Tool Result: { "port": 8080, "mode": "production" }

Thinking: ãƒãƒ¼ãƒˆã¯ 8080ã€æœ¬ç•ªãƒ¢ãƒ¼ãƒ‰ã€‚è¨­å®šãŒæ­£ã—ã„ã‹æ¤œè¨¼ã™ã‚‹å¿…è¦ãŒã‚ã‚‹...

[ãƒ„ãƒ¼ãƒ«å‘¼ã³å‡ºã—: validate_config({ "port": 8080, "mode": "production" })]

Tool Result: { "valid": true }

Thinking: è¨­å®šã¯æœ‰åŠ¹ã€‚ã“ã‚Œã§ã‚µãƒ¼ãƒ“ã‚¹ã‚’èµ·å‹•ã§ãã‚‹ã€‚

[æœ€çµ‚å›ç­”ã‚’ç”Ÿæˆ]
```

**ãªãœé‡è¦ã‹**ï¼š
- ãƒ„ãƒ¼ãƒ«å‘¼ã³å‡ºã—å‰å¾Œã«æ€è€ƒãŒã‚ã‚‹ â†’ ã‚ˆã‚Šã‚¹ãƒãƒ¼ãƒˆãªæ„æ€æ±ºå®š
- ãƒ„ãƒ¼ãƒ«è¿”å´çµæœã«é©å¿œã™ã‚‹ â†’ å‹•çš„ã«æˆ¦ç•¥ã‚’èª¿æ•´
- ç›²ç›®ãªå®Ÿè¡Œã‚’é¿ã‘ã‚‹ â†’ èª¤ã£ãŸæ“ä½œã‚’æ¸›ã‚‰ã™

::: tip ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒè‡ªå‹•å‡¦ç†

Interleaved thinking ã‚’æ‰‹å‹•ã§è¨­å®šã™ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚Antigravity Auth ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¯ Claude Thinking ãƒ¢ãƒ‡ãƒ«ã‚’è‡ªå‹•æ¤œå‡ºã—ã€ã‚·ã‚¹ãƒ†ãƒ å‘½ä»¤ã«æ³¨å…¥ã—ã¾ã™ï¼š
- "Interleaved thinking is enabled. You may think between tool calls and after receiving tool results before deciding on next action or final answer."

:::

### ã‚¹ãƒ†ãƒƒãƒ— 4ï¼šæ€è€ƒãƒ–ãƒ­ãƒƒã‚¯ä¿æŒæˆ¦ç•¥ã‚’åˆ¶å¾¡ã™ã‚‹

ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã€ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¯ä¿¡é ¼æ€§ã‚’å‘ä¸Šã•ã›ã‚‹ãŸã‚ã«**æ€è€ƒãƒ–ãƒ­ãƒƒã‚¯ã‚’å‰Šé™¤**ã—ã¾ã™ï¼ˆç½²åã‚¨ãƒ©ãƒ¼ã‚’å›é¿ï¼‰ã€‚æ€è€ƒå†…å®¹ã‚’èª­ã¿ãŸã„å ´åˆã¯ã€`keep_thinking` ã‚’è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

#### ãªãœãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§å‰Šé™¤ã™ã‚‹ã‹

**ç½²åã‚¨ãƒ©ãƒ¼å•é¡Œ**ï¼š
- Thinking blocks ã¯å¤šè½®ä¼šè©±ã§ç½²åã®ä¸€è‡´ãŒå¿…è¦
- ã™ã¹ã¦ã®æ€è€ƒãƒ–ãƒ­ãƒƒã‚¯ã‚’ä¿æŒã™ã‚‹ã¨ç½²åã®ç«¶åˆãŒç™ºç”Ÿã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹
- æ€è€ƒãƒ–ãƒ­ãƒƒã‚¯ã®å‰Šé™¤ã¯ã‚ˆã‚Šå®‰å®šã—ãŸã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆãŸã ã—æ€è€ƒå†…å®¹ã‚’å¤±ã†ï¼‰

#### æ€è€ƒãƒ–ãƒ­ãƒƒã‚¯ä¿æŒã‚’æœ‰åŠ¹åŒ–

è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã¾ãŸã¯ç·¨é›†ï¼š

**Linux/macOS**ï¼š`~/.config/opencode/antigravity.json`

**Windows**ï¼š`%APPDATA%\opencode\antigravity.json`

```json
{
  "$schema": "https://raw.githubusercontent.com/NoeFabris/opencode-antigravity-auth/main/assets/antigravity.schema.json",
  "keep_thinking": true
}
```

ã¾ãŸã¯ç’°å¢ƒå¤‰æ•°ã‚’ä½¿ç”¨ï¼š

```bash
export OPENCODE_ANTIGRAVITY_KEEP_THINKING=1
```

**ç¢ºèªãƒã‚¤ãƒ³ãƒˆ**ï¼š
- `keep_thinking: false`ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰ï¼šæœ€çµ‚å›ç­”ã®ã¿è¡¨ç¤ºã•ã‚Œã€æ€è€ƒãƒ–ãƒ­ãƒƒã‚¯ã¯éè¡¨ç¤º
- `keep_thinking: true`ï¼šå®Œå…¨ãªæ€è€ƒãƒ—ãƒ­ã‚»ã‚¹ã‚’è¡¨ç¤ºï¼ˆä¸€éƒ¨ã®å¤šè½®ä¼šè©±ã§ç½²åã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ï¼‰

::: warning æ¨å¥¨ä½œæ³•

- **æœ¬ç•ªç’°å¢ƒ**ï¼šãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã® `keep_thinking: false` ã‚’ä½¿ç”¨ã—ã€å®‰å®šæ€§ã‚’ç¢ºä¿
- **ãƒ‡ãƒãƒƒã‚°/å­¦ç¿’**ï¼šä¸€æ™‚çš„ã« `keep_thinking: true` ã‚’æœ‰åŠ¹åŒ–ã—ã€æ€è€ƒãƒ—ãƒ­ã‚»ã‚¹ã‚’è¦³å¯Ÿ
- **ç½²åã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆ**ï¼š`keep_thinking` ã‚’ã‚ªãƒ•ã«ã—ã€ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒè‡ªå‹•çš„ã«å›å¾©ã™ã‚‹

:::

### ã‚¹ãƒ†ãƒƒãƒ— 5ï¼šMax Output Tokens ã‚’ãƒã‚§ãƒƒã‚¯

Claude Thinking ãƒ¢ãƒ‡ãƒ«ã¯ã€thinking budget ã‚’å®Œå…¨ã«ä½¿ç”¨ã™ã‚‹ãŸã‚ã«ã€ã‚ˆã‚Šå¤§ããªå‡ºåŠ›ãƒˆãƒ¼ã‚¯ãƒ³åˆ¶é™ï¼ˆmaxOutputTokensï¼‰ãŒå¿…è¦ã§ã™ã€‚

**ãƒ—ãƒ©ã‚°ã‚¤ãƒ³è‡ªå‹•å‡¦ç†**ï¼š
- thinking budget ã‚’è¨­å®šã™ã‚‹ã¨ã€ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¯è‡ªå‹•çš„ã« `maxOutputTokens` ã‚’ 64,000 ã«èª¿æ•´
- ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ä½ç½®ï¼š`src/plugin/transform/claude.ts:78-90`

**æ‰‹å‹•è¨­å®šï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰**ï¼š

`maxOutputTokens` ã‚’æ‰‹å‹•ã§è¨­å®šã™ã‚‹å ´åˆã€thinking budget ã‚ˆã‚Šå¤§ãã„ã“ã¨ã‚’ç¢ºèªï¼š

```json
{
  "antigravity-claude-sonnet-4-5-thinking": {
    "variants": {
      "max": {
        "thinkingConfig": { "thinkingBudget": 32768 },
        "maxOutputTokens": 64000  // thinkingBudget ä»¥ä¸Šã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚‹
      }
    }
  }
}
```

**ç¢ºèªãƒã‚¤ãƒ³ãƒˆ**ï¼š
- `maxOutputTokens` ãŒå°ã•ã™ãã‚‹å ´åˆã€ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¯è‡ªå‹•çš„ã« 64,000 ã«èª¿æ•´
- ãƒ‡ãƒãƒƒã‚°ãƒ­ã‚°ã« "Adjusted maxOutputTokens for thinking model" ã¨è¡¨ç¤º

---

## ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆ âœ…

è¨­å®šãŒæ­£ã—ã„ã‹ç¢ºèªï¼š

### 1. Variant å¯è¦–æ€§ã‚’æ¤œè¨¼

OpenCode ã§ï¼š

1. ãƒ¢ãƒ‡ãƒ«ã‚»ãƒ¬ã‚¯ã‚¿ãƒ¼ã‚’é–‹ã
2. `Claude Sonnet 4.5 Thinking` ã‚’é¸æŠ
3. variant ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼ï¼ˆlow/medium/maxï¼‰ãŒã‚ã‚‹ã‹ç¢ºèª

**æœŸå¾…çµæœ**ï¼š3 ã¤ã® variant ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã€‚

### 2. Thinking å†…å®¹å‡ºåŠ›ã‚’æ¤œè¨¼

```bash
opencode run "3 ã‚¹ãƒ†ãƒƒãƒ—ã§è€ƒãˆã‚‹ï¼š1+1=ï¼Ÿãªãœï¼Ÿ" \
  --model=google/antigravity-claude-sonnet-4-5-thinking \
  --variant=max
```

**æœŸå¾…çµæœ**ï¼š
- `keep_thinking: true` ã®å ´åˆï¼šè©³ç´°ãªæ€è€ƒãƒ—ãƒ­ã‚»ã‚¹ãŒè¡¨ç¤ºã•ã‚Œã‚‹
- `keep_thinking: false`ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰ã®å ´åˆï¼šå›ç­” "2" ãŒç›´æ¥è¡¨ç¤ºã•ã‚Œã‚‹

### 3. Interleaved Thinking ã‚’æ¤œè¨¼ï¼ˆãƒ„ãƒ¼ãƒ«å‘¼ã³å‡ºã—ãŒå¿…è¦ï¼‰

```bash
## ãƒ„ãƒ¼ãƒ«å‘¼ã³å‡ºã—ãŒå¿…è¦ãªã‚¿ã‚¹ã‚¯ã‚’ä½¿ç”¨
opencode run "ç¾åœ¨ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ãƒ•ã‚¡ã‚¤ãƒ«ãƒªã‚¹ãƒˆã‚’èª­ã¿å–ã‚Šã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚¿ã‚¤ãƒ—ã‚’è¦ç´„ã—ã¦ãã ã•ã„" \
  --model=google/antigravity-claude-sonnet-4-5-thinking \
  --variant=medium
```

**æœŸå¾…çµæœ**ï¼š
- ãƒ„ãƒ¼ãƒ«å‘¼ã³å‡ºã—ã®å‰å¾Œã«æ€è€ƒå†…å®¹ãŒè¡¨ç¤ºã•ã‚Œã‚‹
- AI ã¯ãƒ„ãƒ¼ãƒ«è¿”å´çµæœã«åŸºã¥ã„ã¦æˆ¦ç•¥ã‚’èª¿æ•´ã™ã‚‹

---

## ã‚ˆãã‚ã‚‹å¤±æ•—

### âŒ ã‚¨ãƒ©ãƒ¼ 1ï¼šThinking Budget ãŒ Max Output Tokens ã‚’è¶…é

**å•é¡Œ**ï¼š`thinkingBudget: 32768` ã‚’è¨­å®šã—ãŸãŒã€`maxOutputTokens: 20000`

**ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸**ï¼š
```
Invalid argument: max_output_tokens must be greater than or equal to thinking_budget
```

**è§£æ±ºæ–¹æ³•**ï¼š
- ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã«è‡ªå‹•å‡¦ç†ã•ã›ã‚‹ï¼ˆæ¨å¥¨ï¼‰
- ã¾ãŸã¯æ‰‹å‹•ã§ `maxOutputTokens >= thinkingBudget` ã‚’è¨­å®š

### âŒ ã‚¨ãƒ©ãƒ¼ 2ï¼šGemini 3 Pro ã§ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ãªã„ level ã‚’ä½¿ç”¨

**å•é¡Œ**ï¼šGemini 3 Pro ã¯ low/high ã®ã¿ã‚µãƒãƒ¼ãƒˆã™ã‚‹ãŒã€`minimal` ã‚’ä½¿ç”¨ã—ã‚ˆã†ã¨ã—ãŸ

**ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸**ï¼š
```
Invalid argument: thinking_level "minimal" not supported for gemini-3-pro
```

**è§£æ±ºæ–¹æ³•**ï¼šPro ãŒã‚µãƒãƒ¼ãƒˆã™ã‚‹ levelsï¼ˆlow/highï¼‰ã®ã¿ã‚’ä½¿ç”¨

### âŒ ã‚¨ãƒ©ãƒ¼ 3ï¼šå¤šè½®ä¼šè©±ã§ã®ç½²åã‚¨ãƒ©ãƒ¼ï¼ˆkeep_thinking: trueï¼‰

**å•é¡Œ**ï¼š`keep_thinking: true` ã‚’æœ‰åŠ¹åŒ–å¾Œã€å¤šè½®ä¼šè©±ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿ

**ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸**ï¼š
```
Signature mismatch in thinking blocks
```

**è§£æ±ºæ–¹æ³•**ï¼š
- ä¸€æ™‚çš„ã« `keep_thinking` ã‚’ã‚ªãƒ•ï¼š`export OPENCODE_ANTIGRAVITY_KEEP_THINKING=0`
- ã¾ãŸã¯ä¼šè©±ã‚’æœ€åˆã‹ã‚‰ã‚„ã‚Šç›´ã™

### âŒ ã‚¨ãƒ©ãƒ¼ 4ï¼šVariant ãŒè¡¨ç¤ºã•ã‚Œãªã„

**å•é¡Œ**ï¼švariants ã‚’è¨­å®šã—ãŸãŒã€OpenCode ãƒ¢ãƒ‡ãƒ«ã‚»ãƒ¬ã‚¯ã‚¿ãƒ¼ã«è¡¨ç¤ºã•ã‚Œãªã„

**è€ƒãˆã‚‰ã‚Œã‚‹åŸå› **ï¼š
- è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ãŒé–“é•ã£ã¦ã„ã‚‹
- JSON æ§‹æ–‡ã‚¨ãƒ©ãƒ¼ï¼ˆã‚«ãƒ³ãƒã€å¼•ç”¨ç¬¦ã®æ¬ è½ï¼‰
- ãƒ¢ãƒ‡ãƒ« ID ãŒä¸€è‡´ã—ã¦ã„ãªã„

**è§£æ±ºæ–¹æ³•**ï¼š
1. è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã‚’ç¢ºèªï¼š`~/.opencode/models.json` ã¾ãŸã¯ `~/.config/opencode/models.json`
2. JSON æ§‹æ–‡ã‚’æ¤œè¨¼ï¼š`cat ~/.opencode/models.json | python -m json.tool`
3. ãƒ¢ãƒ‡ãƒ« ID ãŒãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒè¿”ã™ã‚‚ã®ã¨ä¸€è‡´ã—ã¦ã„ã‚‹ã‹ç¢ºèª

---

## æœ¬èª²ã®ã¾ã¨ã‚

Thinking ãƒ¢ãƒ‡ãƒ«ã¯ã€æœ€çµ‚çš„ãªå›ç­”ã‚’ç”Ÿæˆã™ã‚‹å‰ã«å†…éƒ¨æ¨è«–ã‚’è¡Œã†ã“ã¨ã§ã€è¤‡é›‘ãªã‚¿ã‚¹ã‚¯ã®å›ç­”å“è³ªã‚’å‘ä¸Šã•ã›ã¾ã™ï¼š

| æ©Ÿèƒ½ | Claude Thinking | Gemini 3 Thinking |
|---|---|---|
| **è¨­å®šæ–¹æ³•** | `thinkingBudget`ï¼ˆæ•°å­—ï¼‰ | `thinkingLevel`ï¼ˆæ–‡å­—åˆ—ï¼‰ |
| **Levels** | ã‚«ã‚¹ã‚¿ãƒ  budget | minimal/low/medium/high |
| **Keys** | snake_caseï¼ˆ`include_thoughts`ï¼‰ | camelCaseï¼ˆ`includeThoughts`ï¼‰ |
| **Interleaved** | âœ… ã‚µãƒãƒ¼ãƒˆ | âŒ ã‚µãƒãƒ¼ãƒˆãªã— |
| **Max Output** | è‡ªå‹•çš„ã« 64,000 ã«èª¿æ•´ | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’ä½¿ç”¨ |

**é‡è¦ãªè¨­å®š**ï¼š
- **Variant ã‚·ã‚¹ãƒ†ãƒ **ï¼š`thinkingConfig.thinkingBudget`ï¼ˆClaudeï¼‰ã¾ãŸã¯ `thinkingLevel`ï¼ˆGemini 3ï¼‰ã§è¨­å®š
- **keep_thinking**ï¼šãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯ falseï¼ˆå®‰å®šæ€§ï¼‰ã€trueï¼ˆæ€è€ƒå†…å®¹ãŒèª­ã‚ã‚‹ï¼‰
- **Interleaved thinking**ï¼šè‡ªå‹•çš„ã«æœ‰åŠ¹åŒ–ã€æ‰‹å‹•è¨­å®šã¯ä¸è¦

---

## æ¬¡èª²ã®äºˆå‘Š

> æ¬¡ã®èª²ã§ã¯ **[Google Search Grounding](../google-search-grounding/)** ã‚’å­¦ã³ã¾ã™ã€‚
>
> å­¦ã¶ã“ã¨ï¼š
> - Gemini ãƒ¢ãƒ‡ãƒ«ã§ Google Search æ¤œç´¢ã‚’æœ‰åŠ¹åŒ–ã™ã‚‹
> - å‹•çš„æ¤œç´¢ã—ãã„å€¤ã‚’è¨­å®šã™ã‚‹
> - äº‹å®Ÿã®æ­£ç¢ºæ€§ã‚’å‘ä¸Šã•ã›ã€å¹»è¦šã‚’æ¸›ã‚‰ã™

---

## ä»˜éŒ²ï¼šã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰å‚ç…§

<details>
<summary><strong>ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®å ´æ‰€ã‚’è¡¨ç¤º</strong></summary>

> æ›´æ–°æ—¥ï¼š2026-01-23

| æ©Ÿèƒ½ | ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ | è¡Œç•ªå· |
|---|---|---|
| Claude Thinking è¨­å®šæ§‹ç¯‰ | [`src/plugin/transform/claude.ts`](https://github.com/NoeFabris/opencode-antigravity-auth/blob/main/src/plugin/transform/claude.ts) | 62-72 |
| Gemini 3 Thinking è¨­å®šæ§‹ç¯‰ | [`src/plugin/transform/gemini.ts`](https://github.com/NoeFabris/opencode-antigravity-auth/blob/main/src/plugin/transform/gemini.ts) | 163-171 |
| Gemini 2.5 Thinking è¨­å®šæ§‹ç¯‰ | [`src/plugin/transform/gemini.ts`](https://github.com/NoeFabris/opencode-antigravity-auth/blob/main/src/plugin/transform/gemini.ts) | 176-184 |
| Claude Thinking ãƒ¢ãƒ‡ãƒ«æ¤œå‡º | [`src/plugin/transform/claude.ts`](https://github.com/NoeFabris/opencode-antigravity-auth/blob/main/src/plugin/transform/claude.ts) | 34-37 |
| Gemini 3 ãƒ¢ãƒ‡ãƒ«æ¤œå‡º | [`src/plugin/transform/gemini.ts`](https://github.com/NoeFabris/opencode-antigravity-auth/blob/main/src/plugin/transform/gemini.ts) | 137-139 |
| Interleaved Thinking Hint æ³¨å…¥ | [`src/plugin/transform/claude.ts`](https://github.com/NoeFabris/opencode-antigravity-auth/blob/main/src/plugin/transform/claude.ts) | 96-138 |
| Max Output Tokens è‡ªå‹•èª¿æ•´ | [`src/plugin/transform/claude.ts`](https://github.com/NoeFabris/opencode-antigravity-auth/blob/main/src/plugin/transform/claude.ts) | 78-90 |
| keep_thinking è¨­å®š Schema | [`src/plugin/config/schema.ts`](https://github.com/NoeFabris/opencode-antigravity-auth/blob/main/src/plugin/config/schema.ts) | 78-87 |
| Claude Thinking é©ç”¨å¤‰æ› | [`src/plugin/transform/claude.ts`](https://github.com/NoeFabris/opencode-antigravity-auth/blob/main/src/plugin/transform/claude.ts) | 324-366 |
| Gemini Thinking é©ç”¨å¤‰æ› | [`src/plugin/transform/gemini.ts`](https://github.com/NoeFabris/opencode-antigravity-auth/blob/main/src/plugin/transform/gemini.ts) | 372-434 |

**é‡è¦ãªå®šæ•°**ï¼š
- `CLAUDE_THINKING_MAX_OUTPUT_TOKENS = 64_000`ï¼šClaude Thinking ãƒ¢ãƒ‡ãƒ«ã®æœ€å¤§å‡ºåŠ›ãƒˆãƒ¼ã‚¯ãƒ³æ•°
- `CLAUDE_INTERLEAVED_THINKING_HINT`ï¼šã‚·ã‚¹ãƒ†ãƒ å‘½ä»¤ã«æ³¨å…¥ã•ã‚Œã‚‹ interleaved thinking ãƒ’ãƒ³ãƒˆ

**é‡è¦ãªé–¢æ•°**ï¼š
- `buildClaudeThinkingConfig(includeThoughts, thinkingBudget)`ï¼šClaude Thinking è¨­å®šã‚’æ§‹ç¯‰ï¼ˆsnake_case keysï¼‰
- `buildGemini3ThinkingConfig(includeThoughts, thinkingLevel)`ï¼šGemini 3 Thinking è¨­å®šã‚’æ§‹ç¯‰ï¼ˆlevel stringï¼‰
- `buildGemini25ThinkingConfig(includeThoughts, thinkingBudget)`ï¼šGemini 2.5 Thinking è¨­å®šã‚’æ§‹ç¯‰ï¼ˆnumeric budgetï¼‰
- `ensureClaudeMaxOutputTokens(generationConfig, thinkingBudget)`ï¼šmaxOutputTokens ãŒååˆ†å¤§ãã„ã“ã¨ã‚’ä¿è¨¼
- `appendClaudeThinkingHint(payload, hint)`ï¼šinterleaved thinking hint ã‚’æ³¨å…¥
- `isClaudeThinkingModel(model)`ï¼šClaude Thinking ãƒ¢ãƒ‡ãƒ«ã‹ã©ã†ã‹ã‚’æ¤œå‡º
- `isGemini3Model(model)`ï¼šGemini 3 ãƒ¢ãƒ‡ãƒ«ã‹ã©ã†ã‹ã‚’æ¤œå‡º

</details>
