---
title: "ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼š5åˆ†ã§å§‹ã‚ã‚‹ | opencode-dcp"
sidebarTitle: "5åˆ†ã§å§‹ã‚ã‚‹"
subtitle: "ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼š5åˆ†ã§å§‹ã‚ã‚‹"
description: "DCPãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ–¹æ³•ã‚’å­¦ã³ã¾ã™ã€‚5åˆ†ã§è¨­å®šã‚’å®Œäº†ã—ã€è‡ªå‹•çš„ãªãƒˆãƒªãƒŸãƒ³ã‚°ã§é•·ã„ä¼šè©±ã®Tokenæ¶ˆè²»ã‚’å¤§å¹…ã«å‰Šæ¸›ã—ã€AIå¿œç­”ã®å“è³ªã‚’å‘ä¸Šã•ã›ã¾ã™ã€‚"
tags:
  - "ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«"
  - "ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ"
  - "DCP"
prerequisite:
  - "OpenCodeãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿"
order: 1
---

# ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¨ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

## ã“ã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã§ã§ãã‚‹ã“ã¨

- âœ… 5åˆ†ä»¥å†…ã«DCPãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
- âœ… ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’è¨­å®šã—ã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’æ¤œè¨¼
- âœ… åˆå›ã®è‡ªå‹•ãƒˆãƒªãƒŸãƒ³ã‚°åŠ¹æœã‚’ç¢ºèª

## ç¾åœ¨ã®èª²é¡Œ

OpenCodeã‚’é•·æœŸé–“ä½¿ç”¨ã™ã‚‹ã¨ã€ä¼šè©±ãŒã©ã‚“ã©ã‚“é•·ããªã‚Šã¾ã™ï¼š
- AIãŒåŒã˜ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½•åº¦ã‚‚èª­ã¿å–ã‚‹
- ãƒ„ãƒ¼ãƒ«å‘¼ã³å‡ºã—ã®ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’åŸ‹ã‚å°½ãã™
- å„ä¼šè©±ã§å¤§é‡ã®Tokenã‚’æ¶ˆè²»ã™ã‚‹
- **ä¼šè©±ãŒé•·ããªã‚‹ã»ã©ã€AIã®å¿œç­”ãŒé…ããªã‚‹**

ä¼šè©±å†…ã®é‡è¤‡ã—ãŸã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’è‡ªå‹•çš„ã«ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã—ãŸã„ãŒã€æ‰‹å‹•æ“ä½œã¯ã—ãŸããªã„ã€‚

## ã‚³ã‚¢ã‚³ãƒ³ã‚»ãƒ—ãƒˆ

**DCPï¼ˆDynamic Context Pruningï¼‰**ã¯OpenCodeã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã§ã€ä¼šè©±å±¥æ­´ã‹ã‚‰é‡è¤‡ã—ãŸãƒ„ãƒ¼ãƒ«å‘¼ã³å‡ºã—ã‚’è‡ªå‹•çš„ã«å‰Šé™¤ã—ã€Tokenæ¶ˆè²»ã‚’å‰Šæ¸›ã—ã¾ã™ã€‚

ãã®å‹•ä½œï¼š
1. **è‡ªå‹•æ¤œå‡º**ï¼šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡ã”ã¨ã«ä¼šè©±å±¥æ­´ã‚’è‡ªå‹•çš„ã«åˆ†æ
2. **ã‚¹ãƒãƒ¼ãƒˆã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—**ï¼šé‡è¤‡ã—ãŸãƒ„ãƒ¼ãƒ«å‘¼ã³å‡ºã—ã€æœŸé™åˆ‡ã‚Œã®ã‚¨ãƒ©ãƒ¼ã€ä¸Šæ›¸ãã•ã‚ŒãŸæ›¸ãè¾¼ã¿ã‚’å‰Šé™¤
3. **AIé§†å‹•**ï¼šAIã¯`discard`ãŠã‚ˆã³`extract`ãƒ„ãƒ¼ãƒ«ã‚’å‘¼ã³å‡ºã—ã¦ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’æœ€é©åŒ–
4. **é€æ˜ã§åˆ¶å¾¡å¯èƒ½**ï¼š`/dcp`ã‚³ãƒãƒ³ãƒ‰ã§ãƒˆãƒªãƒŸãƒ³ã‚°çµ±è¨ˆã‚’è¡¨ç¤ºã—ã€æ‰‹å‹•ã§ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã‚’å®Ÿè¡Œ

::: tip æ ¸å¿ƒãƒ¡ãƒªãƒƒãƒˆ
- **ã‚¼ãƒ­ã‚³ã‚¹ãƒˆ**ï¼šè‡ªå‹•æˆ¦ç•¥ã¯LLMå‘¼ã³å‡ºã—ã‚’å¿…è¦ã¨ã—ã¾ã›ã‚“
- **ã‚¼ãƒ­è¨­å®š**ï¼šã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã ã‘ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®šã¯ã™ã§ã«æœ€é©åŒ–æ¸ˆã¿
- **ã‚¼ãƒ­ãƒªã‚¹ã‚¯**ï¼šLLMã«é€ä¿¡ã•ã‚Œã‚‹ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã®ã¿ã‚’å¤‰æ›´ã—ã€ä¼šè©±å±¥æ­´ã«ã¯å½±éŸ¿ã—ã¾ã›ã‚“
:::

## ğŸ’ é–‹å§‹å‰ã®æº–å‚™

ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’é–‹å§‹ã™ã‚‹å‰ã«ã€ç¢ºèªã—ã¦ãã ã•ã„ï¼š

- [ ] **OpenCode**ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿ï¼ˆãƒ—ãƒ©ã‚°ã‚¤ãƒ³æ©Ÿèƒ½ã‚’ã‚µãƒãƒ¼ãƒˆï¼‰
- [ ] **OpenCodeè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«**ã‚’ç·¨é›†ã™ã‚‹æ–¹æ³•ã‚’çŸ¥ã£ã¦ã„ã‚‹
- [ ] åŸºæœ¬çš„ãª**JSONCæ§‹æ–‡**ã‚’ç†è§£ã—ã¦ã„ã‚‹ï¼ˆã‚³ãƒ¡ãƒ³ãƒˆã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹JSONï¼‰

::: warning é‡è¦ãªãƒ’ãƒ³ãƒˆ
DCPã¯LLMã«é€ä¿¡ã•ã‚Œã‚‹ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã®å†…å®¹ã‚’å¤‰æ›´ã—ã¾ã™ãŒã€ä¼šè©±å±¥æ­´ã«ã¯å½±éŸ¿ã—ã¾ã›ã‚“ã€‚è¨­å®šã§ã„ã¤ã§ã‚‚ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ç„¡åŠ¹ã«ã§ãã¾ã™ã€‚
:::

## é€²ã‚æ–¹

### ã‚¹ãƒ†ãƒƒãƒ—1ï¼šOpenCodeè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†

**ç†ç”±**
OpenCodeè¨­å®šã§DCPãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’å®£è¨€ã™ã‚‹ã¨ã€OpenCodeã®èµ·å‹•æ™‚ã«è‡ªå‹•çš„ã«èª­ã¿è¾¼ã¾ã‚Œã¾ã™ã€‚

OpenCodeè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«`opencode.jsonc`ã‚’é–‹ãã€`plugin`ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«DCPã‚’è¿½åŠ ï¼š

```jsonc
// opencode.jsonc
{
    "plugin": ["@tarquinen/opencode-dcp@latest"],
}
```

**æœŸå¾…ã•ã‚Œã‚‹çµæœ**ï¼šè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã«ä»–ã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒã™ã§ã«ã‚ã‚‹å ´åˆï¼ˆã‚‚ã—ã‚ã‚Œã°ï¼‰ã€é…åˆ—ã®æœ«å°¾ã«DCPã‚’è¿½åŠ ã™ã‚‹ã ã‘ã§ã™ã€‚

::: info ãƒ’ãƒ³ãƒˆ
`@latest`ã‚¿ã‚°ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€OpenCodeã¯èµ·å‹•æ™‚ã«æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’è‡ªå‹•çš„ã«ç¢ºèªã—ã¦å–å¾—ã—ã¾ã™ã€‚
:::

### ã‚¹ãƒ†ãƒƒãƒ—2ï¼šOpenCodeã‚’å†èµ·å‹•

**ç†ç”±**
ãƒ—ãƒ©ã‚°ã‚¤ãƒ³è¨­å®šã®å¤‰æ›´å¾Œã€æœ‰åŠ¹ã«ã™ã‚‹ã«ã¯å†èµ·å‹•ãŒå¿…è¦ã§ã™ã€‚

OpenCodeã‚’å®Œå…¨ã«é–‰ã˜ã¦ã€å†èµ·å‹•ã—ã¦ãã ã•ã„ã€‚

**æœŸå¾…ã•ã‚Œã‚‹çµæœ**ï¼šOpenCodeãŒæ­£å¸¸ã«èµ·å‹•ã—ã€ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã¾ã›ã‚“ã€‚

### ã‚¹ãƒ†ãƒƒãƒ—3ï¼šãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’ç¢ºèª

**ç†ç”±**
DCPãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒæ­£ã—ãèª­ã¿è¾¼ã¾ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®šã‚’ç¢ºèªã—ã¾ã™ã€‚

OpenCodeã®ä¼šè©±ã§å…¥åŠ›ï¼š

```
/dcp
```

**æœŸå¾…ã•ã‚Œã‚‹çµæœ**ï¼šDCPã‚³ãƒãƒ³ãƒ‰ãƒ˜ãƒ«ãƒ—ãŒè¡¨ç¤ºã•ã‚Œã€ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒæ­£å¸¸ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚ŒãŸã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚

```
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚                      DCP Commands                         â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

  /dcp context      Show token usage breakdown for current session
  /dcp stats        Show DCP pruning statistics
  /dcp sweep [n]    Prune tools since last user message, or last n tools
```

### ã‚¹ãƒ†ãƒƒãƒ—4ï¼šãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®šã‚’ç¢ºèª

**ç†ç”±**
DCPã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®šã‚’ç†è§£ã—ã€ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒæœŸå¾…é€šã‚Šã«å‹•ä½œã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã™ã€‚

DCPã¯åˆå›å®Ÿè¡Œæ™‚ã«è‡ªå‹•çš„ã«è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ï¼š

```bash
# ã‚°ãƒ­ãƒ¼ãƒãƒ«è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¡¨ç¤º
cat ~/.config/opencode/dcp.jsonc
```

**æœŸå¾…ã•ã‚Œã‚‹çµæœ**ï¼šè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ãŒä½œæˆã•ã‚Œã€åˆæœŸçŠ¶æ…‹ã§ã¯`$schema`ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ã¿å«ã¿ã¾ã™ï¼š

```jsonc
{
    "$schema": "https://raw.githubusercontent.com/Opencode-DCP/opencode-dynamic-context-pruning/master/dcp.schema.json"
}
```

è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã¯åˆæœŸçŠ¶æ…‹ã§`$schema`ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ã¿ã‚’å«ã¿ã€ãã®ä»–ã®ã™ã¹ã¦ã®è¨­å®šé …ç›®ã¯ã‚³ãƒ¼ãƒ‰å†…ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚æ‰‹å‹•ã§è¨­å®šã™ã‚‹å¿…è¦ãªãä½¿ç”¨ã§ãã¾ã™ã€‚

::: tip ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®šã®èª¬æ˜
DCPã®ã‚³ãƒ¼ãƒ‰ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ï¼ˆè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã«æ›¸ãè¾¼ã‚€å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ï¼‰ï¼š

- **deduplication**ï¼šè‡ªå‹•é‡è¤‡æ’é™¤ã€é‡è¤‡ã—ãŸãƒ„ãƒ¼ãƒ«å‘¼ã³å‡ºã—ã‚’å‰Šé™¤
- **purgeErrors**ï¼š4ã‚¿ãƒ¼ãƒ³å‰ã®ã‚¨ãƒ©ãƒ¼ãƒ„ãƒ¼ãƒ«å…¥åŠ›ã‚’è‡ªå‹•çš„ã«ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
- **discard/extract**ï¼šAIãŒå‘¼ã³å‡ºã›ã‚‹ãƒˆãƒªãƒŸãƒ³ã‚°ãƒ„ãƒ¼ãƒ«
- **pruneNotification**ï¼šè©³ç´°ãªãƒˆãƒªãƒŸãƒ³ã‚°é€šçŸ¥ã‚’è¡¨ç¤º

ã‚«ã‚¹ã‚¿ãƒ è¨­å®šãŒå¿…è¦ãªå ´åˆã¯ã€ã“ã‚Œã‚‰ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’æ‰‹å‹•ã§è¿½åŠ ã§ãã¾ã™ã€‚è©³ç´°ãªè¨­å®šèª¬æ˜ã¯[è¨­å®šã‚¬ã‚¤ãƒ‰](../configuration/)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚
:::

### ã‚¹ãƒ†ãƒƒãƒ—5ï¼šè‡ªå‹•ãƒˆãƒªãƒŸãƒ³ã‚°åŠ¹æœã‚’ä½“é¨“

**ç†ç”±**
å®Ÿéš›ã«DCPã‚’ä½¿ç”¨ã—ã€è‡ªå‹•ãƒˆãƒªãƒŸãƒ³ã‚°ã®åŠ¹æœã‚’ç¢ºèªã—ã¾ã™ã€‚

OpenCodeã§ä¼šè©±ã‚’è¡Œã„ã€AIã«åŒã˜ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¤‡æ•°å›èª­ã¿å–ã‚‰ã›ãŸã‚Šã€å¤±æ•—ã™ã‚‹ãƒ„ãƒ¼ãƒ«å‘¼ã³å‡ºã—ã‚’å®Ÿè¡Œã—ãŸã‚Šã—ã¾ã™ã€‚

**æœŸå¾…ã•ã‚Œã‚‹çµæœ**ï¼š

1. ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡ã™ã‚‹ãŸã³ã«ã€DCPã¯ä¼šè©±å±¥æ­´ã‚’è‡ªå‹•çš„ã«åˆ†æ
2. é‡è¤‡ã—ãŸãƒ„ãƒ¼ãƒ«å‘¼ã³å‡ºã—ãŒã‚ã‚‹å ´åˆã€DCPã¯è‡ªå‹•çš„ã«ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
3. AIå¿œç­”å¾Œã€ãƒˆãƒªãƒŸãƒ³ã‚°é€šçŸ¥ãŒè¡¨ç¤ºã•ã‚Œã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ï¼ˆ`pruneNotification`è¨­å®šã«ã‚ˆã‚Šã¾ã™ï¼‰

ãƒˆãƒªãƒŸãƒ³ã‚°é€šçŸ¥ã®ä¾‹ï¼š

```
â–£ DCP | ~12.5K tokens saved total

â–£ Pruning (~12.5K tokens)
â†’ read: src/config.ts
â†’ write: package.json
```

`/dcp context`ã‚’å…¥åŠ›ã—ã¦ç¾åœ¨ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®Tokenä½¿ç”¨çŠ¶æ³ã‚’ç¢ºèªï¼š

```
Session Context Breakdown:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

System         15.2% â”‚â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â”‚  25.1K tokens
User            5.1% â”‚â–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â–’â”‚   8.4K tokens
Assistant       35.8% â”‚â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–’â–’â–’â–’â–’â–’â–’â”‚  59.2K tokens
Tools (45)      43.9% â”‚â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ”‚  72.6K tokens

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Summary:
  Pruned:          12 tools (~15.2K tokens)
  Current context: ~165.3K tokens
  Without DCP:     ~180.5K tokens
```

## ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆ âœ…

ä¸Šè¨˜ã®ã‚¹ãƒ†ãƒƒãƒ—ã‚’å®Œäº†ã™ã‚‹ã¨ã€æ¬¡ã®ã“ã¨ãŒã§ãã‚‹ã¯ãšã§ã™ï¼š

- [ ] `opencode.jsonc`ã«DCPãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒè¿½åŠ æ¸ˆã¿
- [ ] OpenCodeå†èµ·å‹•å¾Œã€æ­£å¸¸ã«å®Ÿè¡Œã§ãã‚‹
- [ ] `/dcp`ã‚³ãƒãƒ³ãƒ‰ã§ãƒ˜ãƒ«ãƒ—ãŒè¡¨ç¤ºã•ã‚Œã‚‹
- [ ] è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«`~/.config/opencode/dcp.jsonc`ãŒä½œæˆæ¸ˆã¿
- [ ] ä¼šè©±ã§ãƒˆãƒªãƒŸãƒ³ã‚°é€šçŸ¥ãŒè¦‹ãˆã‚‹ã€ã¾ãŸã¯`/dcp context`ã§ãƒˆãƒªãƒŸãƒ³ã‚°çµ±è¨ˆãŒè¦‹ãˆã‚‹

**ã‚ã‚‹ã‚¹ãƒ†ãƒƒãƒ—ã§å¤±æ•—ã—ãŸå ´åˆ**ï¼š
- `opencode.jsonc`ã®æ§‹æ–‡ãŒæ­£ã—ã„ã‹ç¢ºèªï¼ˆJSONCå½¢å¼ï¼‰
- OpenCodeãƒ­ã‚°ã§ãƒ—ãƒ©ã‚°ã‚¤ãƒ³èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼ãŒãªã„ã‹ç¢ºèª
- OpenCodeãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒãƒ—ãƒ©ã‚°ã‚¤ãƒ³æ©Ÿèƒ½ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã‚‹ã‹ç¢ºèª

## è½ã¨ã—ç©´ã®ãƒ’ãƒ³ãƒˆ

### å•é¡Œ1ï¼šãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒæœ‰åŠ¹ã«ãªã‚‰ãªã„

**ç—‡çŠ¶**ï¼šè¨­å®šã¯è¿½åŠ ã—ãŸãŒã€ãƒˆãƒªãƒŸãƒ³ã‚°åŠ¹æœãŒè¦‹ãˆãªã„

**åŸå› **ï¼šOpenCodeãŒå†èµ·å‹•ã•ã‚Œã¦ã„ãªã„ã‹ã€è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ãŒé–“é•ã£ã¦ã„ã‚‹

**è§£æ±ºç­–**ï¼š
1. OpenCodeã‚’å®Œå…¨ã«é–‰ã˜ã¦ã‹ã‚‰å†èµ·å‹•
2. `opencode.jsonc`ã®ä½ç½®ãŒæ­£ã—ã„ã‹ç¢ºèª
3. ãƒ­ã‚°ã‚’ç¢ºèªï¼š`~/.config/opencode/logs/dcp/daily/`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«

### å•é¡Œ2ï¼šè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ãŒä½œæˆã•ã‚Œãªã„

**ç—‡çŠ¶**ï¼š`~/.config/opencode/dcp.jsonc`ãŒå­˜åœ¨ã—ãªã„

**åŸå› **ï¼šOpenCodeãŒDCPãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’å‘¼ã³å‡ºã—ã¦ã„ãªã„ã‹ã€è¨­å®šãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®æ¨©é™ã®å•é¡Œ

**è§£æ±ºç­–**ï¼š
1. OpenCodeãŒå†èµ·å‹•æ¸ˆã¿ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèª
2. è¨­å®šãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’æ‰‹å‹•ã§ä½œæˆï¼š`mkdir -p ~/.config/opencode`
3. `opencode.jsonc`ã§ãƒ—ãƒ©ã‚°ã‚¤ãƒ³åãŒæ­£ã—ã„ã‹ç¢ºèªï¼š`@tarquinen/opencode-dcp@latest`

### å•é¡Œ3ï¼šãƒˆãƒªãƒŸãƒ³ã‚°é€šçŸ¥ãŒè¡¨ç¤ºã•ã‚Œãªã„

**ç—‡çŠ¶**ï¼šãƒˆãƒªãƒŸãƒ³ã‚°é€šçŸ¥ãŒè¦‹ãˆãªã„ãŒã€`/dcp stats`ã«ã¯ãƒˆãƒªãƒŸãƒ³ã‚°ãŒè¡¨ç¤ºã•ã‚Œã‚‹

**åŸå› **ï¼š`pruneNotification`ãŒ`"off"`ã¾ãŸã¯`"minimal"`ã«è¨­å®šã•ã‚Œã¦ã„ã‚‹

**è§£æ±ºç­–**ï¼šè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’å¤‰æ›´ï¼š
```jsonc
"pruneNotification": "detailed"  // ã¾ãŸã¯ "minimal"
```

## ã¾ã¨ã‚

DCPãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¯éå¸¸ã«ç°¡å˜ã§ã™ï¼š
1. `opencode.jsonc`ã«ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’è¿½åŠ 
2. OpenCodeã‚’å†èµ·å‹•
3. `/dcp`ã‚³ãƒãƒ³ãƒ‰ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’ç¢ºèª
4. ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®šã§ä½¿ç”¨å¯èƒ½ã€è¿½åŠ ã®èª¿æ•´ã¯ä¸è¦

**DCPã§ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§æœ‰åŠ¹ãªæ©Ÿèƒ½**ï¼š
- âœ… è‡ªå‹•é‡è¤‡æ’é™¤æˆ¦ç•¥ï¼ˆé‡è¤‡ã—ãŸãƒ„ãƒ¼ãƒ«å‘¼ã³å‡ºã—ã‚’å‰Šé™¤ï¼‰
- âœ… ã‚¨ãƒ©ãƒ¼å‰Šé™¤æˆ¦ç•¥ï¼ˆæœŸé™åˆ‡ã‚Œã®ã‚¨ãƒ©ãƒ¼å…¥åŠ›ã‚’ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ï¼‰
- âœ… AIé§†å‹•ãƒ„ãƒ¼ãƒ«ï¼ˆ`discard`ã¨`extract`ï¼‰
- âœ… è©³ç´°ãªãƒˆãƒªãƒŸãƒ³ã‚°é€šçŸ¥

**æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—**ï¼šè¨­å®šã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã™ã‚‹æ–¹æ³•ã‚’å­¦ã³ã€ãƒˆãƒªãƒŸãƒ³ã‚°æˆ¦ç•¥ã‚’èª¿æ•´ã—ã¦ã•ã¾ã–ã¾ãªã‚·ãƒŠãƒªã‚ªã®ãƒ‹ãƒ¼ã‚ºã«å¯¾å¿œã—ã¾ã™ã€‚

---

## æ¬¡ã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã®äºˆå‘Š

> æ¬¡ã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã§ã¯**[è¨­å®šã‚¬ã‚¤ãƒ‰](../configuration/)**ã‚’å­¦ã³ã¾ã™
>
> å­¦ç¿’å†…å®¹ï¼š
> - å¤šéšå±¤è¨­å®šã‚·ã‚¹ãƒ†ãƒ ï¼ˆã‚°ãƒ­ãƒ¼ãƒãƒ«ã€ç’°å¢ƒå¤‰æ•°ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ¬ãƒ™ãƒ«ï¼‰
> - ã™ã¹ã¦ã®è¨­å®šé …ç›®ã®ç›®çš„ã¨æ¨å¥¨è¨­å®š
> - ã‚¿ãƒ¼ãƒ³ä¿è­·ã€ä¿è­·ã•ã‚ŒãŸãƒ„ãƒ¼ãƒ«ã€ä¿è­·ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¿ãƒ¼ãƒ³
> - ã•ã¾ã–ã¾ãªãƒˆãƒªãƒŸãƒ³ã‚°æˆ¦ç•¥ã‚’æœ‰åŠ¹åŒ–/ç„¡åŠ¹åŒ–ã™ã‚‹æ–¹æ³•

---

## ä»˜éŒ²ï¼šã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰å‚ç…§

<details>
<summary><strong>ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®å ´æ‰€ã‚’è¡¨ç¤º</strong></summary>

> æ›´æ–°æ™‚é–“ï¼š2026-01-23

| æ©Ÿèƒ½        | ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹                                                                                    | è¡Œå·    |
| --- | --- | --- |
| ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆ    | [`index.ts`](https://github.com/Opencode-DCP/opencode-dynamic-context-pruning/blob/main/index.ts) | 12-102  |
| è¨­å®šç®¡ç†    | [`lib/config.ts`](https://github.com/Opencode-DCP/opencode-dynamic-context-pruning/blob/main/lib/config.ts) | 669-794 |
| ã‚³ãƒãƒ³ãƒ‰å‡¦ç†    | [`lib/commands/help.ts`](https://github.com/Opencode-DCP/opencode-dynamic-context-pruning/blob/main/lib/commands/help.ts) | 1-40    |
| Token è¨ˆç®—  | [`lib/commands/context.ts`](https://github.com/Opencode-DCP/opencode-dynamic-context-pruning/blob/main/lib/commands/context.ts) | 68-174  |

**é‡è¦ãªå®šæ•°**ï¼š
- `MAX_TOOL_CACHE_SIZE = 1000`ï¼šãƒ„ãƒ¼ãƒ«ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã®æœ€å¤§ã‚¨ãƒ³ãƒˆãƒªæ•°

**é‡è¦ãªé–¢æ•°**ï¼š
- `Plugin()`ï¼šãƒ—ãƒ©ã‚°ã‚¤ãƒ³ç™»éŒ²ã¨ãƒ•ãƒƒã‚¯è¨­å®š
- `getConfig()`ï¼šå¤šéšå±¤è¨­å®šã®èª­ã¿è¾¼ã¿ã¨ãƒãƒ¼ã‚¸
- `handleContextCommand()`ï¼šç¾åœ¨ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®Tokenä½¿ç”¨çŠ¶æ³ã‚’åˆ†æ

</details>
