---
title: "Telegram æ¸ é“é…ç½®ä¸ä½¿ç”¨ | Clawdbot æ•™ç¨‹"
sidebarTitle: "5 åˆ†é’Ÿè¿ä¸Š Telegram"
subtitle: "Telegram æ¸ é“é…ç½®ä¸ä½¿ç”¨"
description: "å­¦ä¹ å¦‚ä½•åœ¨ Clawdbot ä¸­é…ç½®å’Œä½¿ç”¨ Telegram æ¸ é“ï¼ŒåŒ…æ‹¬ Bot Token è·å–ã€åŸºç¡€é…ç½®ã€DM å’Œç¾¤ç»„è®¿é—®æ§åˆ¶ã€Webhook è®¾ç½®ç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚æœ¬æ•™ç¨‹æ¶µç›–ä»åˆ›å»º Telegram Bot åˆ°é«˜çº§åŠŸèƒ½é…ç½®çš„å®Œæ•´æµç¨‹ã€‚"
tags:
  - "platforms"
  - "telegram"
  - "channels"
prerequisite:
  - "start-getting-started"
order: 80
---

# Telegram æ¸ é“é…ç½®ä¸ä½¿ç”¨

## å­¦å®Œä½ èƒ½åšä»€ä¹ˆ

- ğŸ¤– åœ¨ Telegram ä¸­åˆ›å»º Bot å¹¶è·å– Bot Token
- âš™ï¸ é…ç½® Telegram æ¸ é“è¿æ¥åˆ° Clawdbot
- ğŸ”’ æ§åˆ¶ DM å’Œç¾¤ç»„çš„è®¿é—®æƒé™ï¼ˆé…å¯¹æœºåˆ¶å’Œç™½åå•ï¼‰
- ğŸ“¡ è®¾ç½®ç¾¤ç»„æåŠè§„åˆ™å’Œå“åº”ç­–ç•¥
- ğŸ”Œ é…ç½® Webhook æ¨¡å¼ï¼ˆå¯é€‰ï¼‰
- ğŸ¯ ä½¿ç”¨ Telegram Bot API ç‰¹æ€§ï¼ˆå†…è”æŒ‰é’®ã€ä¸»é¢˜ã€å›å¤ï¼‰

## ä½ ç°åœ¨çš„å›°å¢ƒ

ä½ å·²ç»åœ¨ Telegram ä¸Šä½¿ç”¨ Clawdbotï¼Œä½†é‡åˆ°äº†è¿™äº›é—®é¢˜ï¼š

- âŒ ä¸æ¸…æ¥šå¦‚ä½•æ­£ç¡®é…ç½® Bot Token
- âŒ é™Œç”Ÿäººç»™ Bot å‘æ¶ˆæ¯åï¼ŒBot æ²¡æœ‰å“åº”
- âŒ åœ¨ç¾¤ç»„ä¸­ï¼ŒBot ä¸å“åº”éæåŠæ¶ˆæ¯
- âŒ æƒ³è¦ç²¾ç»†æ§åˆ¶è°èƒ½è®¿é—® Botï¼Œä½†ä¸çŸ¥é“å¦‚ä½•é…ç½®
- âŒ å¬è¯´è¿‡ Webhook å’Œ Long-polling çš„åŒºåˆ«ï¼Œä¸çŸ¥é“é€‰å“ªä¸ª

è¿™æ•™ç¨‹ä¼šå¸®ä½ ä¸€æ­¥æ­¥è§£å†³è¿™äº›é—®é¢˜ã€‚

## ä»€ä¹ˆæ—¶å€™ç”¨è¿™ä¸€æ‹›

é€‚åˆä½¿ç”¨ Telegram æ¸ é“çš„åœºæ™¯ï¼š

- âœ… ä½ å·²ç»åœ¨ä½¿ç”¨ Telegramï¼Œå¸Œæœ›åœ¨è¿™ä¸ªå¹³å°ä¸ AI åŠ©æ‰‹å¯¹è¯
- âœ… ä½ éœ€è¦ Bot åœ¨ç¾¤ç»„ä¸­å“åº”ç‰¹å®šç”¨æˆ·æˆ–å‘½ä»¤
- âœ… ä½ å¸Œæœ›ä½¿ç”¨ Telegram Bot API çš„ç‰¹æ®ŠåŠŸèƒ½ï¼ˆå†…è”æŒ‰é’®ã€Forum ä¸»é¢˜ï¼‰
- âœ… ä½ çš„æœåŠ¡å™¨ç½‘ç»œç¯å¢ƒé€‚åˆä½¿ç”¨ Long-polling æˆ– Webhook

**å¦‚æœä¸»è¦ä½¿ç”¨ WhatsApp æˆ–å…¶ä»–æ¸ é“**ï¼šè¿™è¯¾å¯ä»¥è·³è¿‡ï¼Œä¸“æ³¨äºä½ ä½¿ç”¨çš„æ¸ é“ã€‚

## ğŸ’ å¼€å§‹å‰çš„å‡†å¤‡

åœ¨å¼€å§‹ä¹‹å‰ï¼Œç¡®ä¿ä½ å·²ç»ï¼š

- [ ] å®Œæˆäº† [å¿«é€Ÿå¼€å§‹](../../start/getting-started/) æ•™ç¨‹ï¼ŒClawdbot å·²å®‰è£…å¹¶å¯ä»¥å¯åŠ¨
- [ ] æœ‰ä¸€ä¸ª Telegram è´¦æˆ·ï¼ˆä¸éœ€è¦æ˜¯ Premium ç”¨æˆ·ï¼‰
- [ ] äº†è§£åŸºæœ¬çš„ Telegram Bot æ¦‚å¿µï¼ˆBotã€Tokenã€éšç§æ¨¡å¼ï¼‰

::: info é…ç½®æ–‡ä»¶ä½ç½®
é»˜è®¤æƒ…å†µä¸‹ï¼ŒClawdbot çš„é…ç½®æ–‡ä»¶ä½äºï¼š
- **Linux/macOS**: `~/.clawdbot/clawdbot.json`
- **Windows**: `%USERPROFILE%\.clawdbot\clawdbot.json`
:::

## æ ¸å¿ƒæ€è·¯

### Telegram Bot API vs å…¶ä»–æ¸ é“

ä¸å…¶ä»–å³æ—¶é€šè®¯å¹³å°ä¸åŒï¼ŒTelegram ä½¿ç”¨**Bot API** æ¶æ„ï¼š

| ç‰¹æ€§ | Telegram | WhatsApp | Slack |
|--- | --- | --- | ---|
| è¿æ¥æ–¹å¼ | Bot APIï¼ˆHTTPï¼‰ | Web Client | Bot API + WebSocket |
| æ¶ˆæ¯æ¨¡å¼ | æ¨é€ï¼ˆBot ä¸»åŠ¨å‘é€ï¼‰ | æ‹‰å–ï¼ˆç›‘å¬ Web Clientï¼‰ | æ‹‰å–ï¼ˆç›‘å¬ WebSocketï¼‰ |
| éšç§æ¨¡å¼ | **æ”¯æŒ**ï¼ˆBot å¯é€‰æ‹©ï¼‰ | N/A | N/A |
| ç¾¤ç»„æ”¯æŒ | SuperGroup + Forum | Groups | Channels + Workspace |
| ç‰¹æ®ŠåŠŸèƒ½ | Forum ä¸»é¢˜ã€å†…è”æŒ‰é’® | - | - |

### Clawdbot çš„é›†æˆæ–¹å¼

Clawdbot ä½¿ç”¨ [grammY](https://grammy.dev/) Bot API æ¡†æ¶é›†æˆ Telegramï¼š

```mermaid
graph LR
    A[ç”¨æˆ·æ¶ˆæ¯] --> B[Telegram Bot API]
    B --> C[grammY æ¡†æ¶]
    C --> D[Clawdbot Gateway]
    D --> E[Agent å¤„ç†]
    E --> D
    D --> F[å“åº”å‘é€]
    F --> B
    B --> G[ç”¨æˆ·æ”¶åˆ°å›å¤]
```

**å…³é”®ç‚¹**ï¼š
- **Long-polling**ï¼šé»˜è®¤æ¨¡å¼ï¼ŒClawdbot ä¸»åŠ¨æ‹‰å– Telegram æ›´æ–°
- **Webhook**ï¼šå¯é€‰æ¨¡å¼ï¼ŒTelegram æ¨é€æ›´æ–°åˆ°ä½ çš„æœåŠ¡å™¨
- **DM é…å¯¹**ï¼šé»˜è®¤å¯ç”¨ï¼Œé™Œç”Ÿäººéœ€è¦å…ˆé…å¯¹æ‰èƒ½å‘é€æ¶ˆæ¯
- **ç¾¤ç»„æåŠ**ï¼šé»˜è®¤å¯ç”¨ï¼ŒBot åªå“åº” `@botname` æˆ–é…ç½®çš„æåŠæ¨¡å¼

### è®¿é—®æ§åˆ¶æœºåˆ¶

Clawdbot æä¾›ä¸‰å±‚è®¿é—®æ§åˆ¶ï¼š

1. **DM å±‚é¢**ï¼ˆ`dmPolicy`ï¼‰
   - `pairing`ï¼šé™Œç”Ÿç”¨æˆ·æ”¶åˆ°é…å¯¹ç ï¼Œå¿…é¡»å…ˆæ‰¹å‡†
   - `allowlist`ï¼šåªå…è®¸ç™½åå•ä¸­çš„ç”¨æˆ·
   - `open`ï¼šå…è®¸æ‰€æœ‰ DMï¼ˆéœ€é…ç½® `allowFrom: ["*"]`ï¼‰

2. **ç¾¤ç»„å±‚é¢**ï¼ˆ`groups` + `groupPolicy`ï¼‰
   - åˆ—å‡ºå“ªäº›ç¾¤ç»„å¯ä»¥è®¿é—® Bot
   - è®¾ç½®æ¯ä¸ªç¾¤ç»„çš„ `requireMention` è§„åˆ™

3. **å‘é€è€…å±‚é¢**ï¼ˆ`allowFrom` + `groupAllowFrom`ï¼‰
   - åœ¨å·²å…è®¸çš„ DM/ç¾¤ç»„ä¸­ï¼Œè¿›ä¸€æ­¥é™åˆ¶è°å¯ä»¥å‘é€æ¶ˆæ¯

::: warning å®‰å…¨é»˜è®¤
é»˜è®¤ DM ç­–ç•¥æ˜¯ `pairing`ï¼Œè¿™æ˜¯æœ€å®‰å…¨çš„é»˜è®¤å€¼ã€‚é™Œç”Ÿäººå‘é€çš„æ¶ˆæ¯ä¼šè¢«å¿½ç•¥ï¼Œç›´åˆ°ä½ æ‰¹å‡†é…å¯¹ç ã€‚
:::

## è·Ÿæˆ‘åš

### ç¬¬ 1 æ­¥ï¼šåˆ›å»º Telegram Bot å¹¶è·å– Token

**ä¸ºä»€ä¹ˆ**
Telegram Bot éœ€è¦ Bot Token æ‰èƒ½é€šè¿‡ Bot API è®¿é—®å’Œå‘é€æ¶ˆæ¯ã€‚è¿™ä¸ª Token ç›¸å½“äº Bot çš„"èº«ä»½å‡­è¯"ã€‚

**æ“ä½œ**

1. åœ¨ Telegram ä¸­æœç´¢å¹¶æ‰“å¼€ **@BotFather**
2. å‘é€å‘½ä»¤ `/newbot`
3. æŒ‰ç…§æç¤ºæ“ä½œï¼š
   - è¾“å…¥ Bot åç§°ï¼ˆä¾‹å¦‚ï¼š`My Clawdbot Assistant`ï¼‰
   - è¾“å…¥ Bot ç”¨æˆ·åï¼ˆå¿…é¡»ä»¥ `bot` ç»“å°¾ï¼Œä¾‹å¦‚ï¼š`my_clawdbot_bot`ï¼‰
4. BotFather ä¼šè¿”å› Bot Tokenï¼Œæ ¼å¼å¦‚ï¼š`123456:ABC-DEF123456`

**ä½ åº”è¯¥çœ‹åˆ°**ï¼š
```
Done! Congratulations on your new bot.

You can find it at t.me/my_clawdbot_bot. You can now add a description,
about section and profile picture for it, see /help for a list of commands.

Use this token to access the HTTP API:
123456:ABC-DEF1234567890

Keep your token secure and store it safely, it can be used by anyone
to control your bot.
```

::: tip å®‰å…¨å»ºè®®
- ğŸ” ç«‹å³å°† Token å¤åˆ¶å¹¶ä¿å­˜åˆ°å®‰å…¨çš„åœ°æ–¹ï¼ˆå¦‚å¯†ç ç®¡ç†å™¨ï¼‰
- âš ï¸ **ç»ä¸è¦**åœ¨å…¬å¼€ä»“åº“ã€ç¤¾äº¤åª’ä½“æˆ–ä¸ä»–äººåˆ†äº« Token
- ğŸ”„ å¦‚æœ Token æ³„éœ²ï¼Œç«‹å³åœ¨ @BotFather ä¸­ä½¿ç”¨ `/revoke` å‘½ä»¤æ’¤é”€
:::

**å¯é€‰ BotFather é…ç½®**ï¼ˆæ¨èï¼‰

1. è®¾ç½®ç¾¤ç»„æƒé™ï¼š
   - `/setjoingroups` â†’ é€‰æ‹©æ˜¯å¦å…è®¸ Bot è¢«æ·»åŠ åˆ°ç¾¤ç»„
   - `/setprivacy` â†’ æ§åˆ¶æ˜¯å¦çœ‹åˆ°æ‰€æœ‰ç¾¤ç»„æ¶ˆæ¯

2. è®¾ç½® Bot ä¿¡æ¯ï¼š
   - `/setdescription` â†’ æ·»åŠ æè¿°
   - `/setabouttext` â†’ æ·»åŠ å…³äºæ–‡æœ¬
   - `/setuserpic` â†’ ä¸Šä¼ å¤´åƒ

### ç¬¬ 2 æ­¥ï¼šé…ç½® Telegram æ¸ é“

**ä¸ºä»€ä¹ˆ**
é…ç½®æ–‡ä»¶å‘Šè¯‰ Clawdbot å¦‚ä½•è¿æ¥åˆ° Telegram Bot APIï¼Œä»¥åŠå¦‚ä½•å¤„ç†æ¶ˆæ¯å’Œæƒé™ã€‚

**æ“ä½œ**

åˆ›å»ºæˆ–ç¼–è¾‘ `~/.clawdbot/clawdbot.json`ï¼š

```json5
{
  "channels": {
    "telegram": {
      "enabled": true,
      "botToken": "123456:ABC-DEF1234567890",
      "dmPolicy": "pairing"
    }
  }
}
```

**é…ç½®å­—æ®µè¯´æ˜**ï¼š

| å­—æ®µ | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|--- | --- | --- | ---|
| `enabled` | boolean | `true` | æ˜¯å¦å¯åŠ¨ Telegram æ¸ é“ |
| `botToken` | string | - | Bot Tokenï¼ˆå¿…éœ€ï¼‰ |
| `dmPolicy` | string | `"pairing"` | DM è®¿é—®ç­–ç•¥ |
| `allowFrom` | array | `[]` | DM ç™½åå•ï¼ˆç”¨æˆ· ID æˆ– @ç”¨æˆ·åï¼‰ |
| `groupPolicy` | string | `"allowlist"` | ç¾¤ç»„è®¿é—®ç­–ç•¥ |
| `groupAllowFrom` | array | `[]` | ç¾¤ç»„å‘é€è€…ç™½åå• |
| `groups` | object | `{}` | ç¾¤ç»„è¯¦ç»†é…ç½® |

**ç¯å¢ƒå˜é‡æ–¹å¼**ï¼ˆå¯é€‰ï¼‰

ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ç¯å¢ƒå˜é‡ï¼ˆé€‚ç”¨äºé»˜è®¤è´¦æˆ·ï¼‰ï¼š

```bash
export TELEGRAM_BOT_TOKEN="123456:ABC-DEF1234567890"
```

::: tip ç¯å¢ƒå˜é‡ä¼˜å…ˆçº§
å¦‚æœåŒæ—¶é…ç½®äº†ç¯å¢ƒå˜é‡å’Œé…ç½®æ–‡ä»¶ï¼š
- **é…ç½®æ–‡ä»¶ä¼˜å…ˆ**ï¼ˆ`channels.telegram.botToken`ï¼‰
- ç¯å¢ƒå˜é‡ä½œä¸º**é»˜è®¤è´¦æˆ·çš„åå¤‡**
:::

### ç¬¬ 3 æ­¥ï¼šå¯åŠ¨ Gateway å¹¶éªŒè¯è¿æ¥

**ä¸ºä»€ä¹ˆ**
å¯åŠ¨ Gateway è®©å®ƒæ ¹æ®é…ç½®è¿æ¥åˆ° Telegram Bot APIï¼Œå¹¶å¼€å§‹ç›‘å¬æ¶ˆæ¯ã€‚

**æ“ä½œ**

1. åœ¨ç»ˆç«¯ä¸­å¯åŠ¨ Gatewayï¼š

```bash
# æ–¹å¼ 1ï¼šç›´æ¥å¯åŠ¨
clawdbot gateway --verbose

# æ–¹å¼ 2ï¼šä½¿ç”¨å®ˆæŠ¤è¿›ç¨‹
clawdbot gateway --port 18789 --verbose
```

2. è§‚å¯Ÿ Gateway çš„å¯åŠ¨æ—¥å¿—ï¼ŒæŸ¥æ‰¾ Telegram ç›¸å…³ä¿¡æ¯

**ä½ åº”è¯¥çœ‹åˆ°**ï¼š
```
[INFO] Starting Gateway...
[INFO] Loading config from ~/.clawdbot/clawdbot.json
[INFO] Starting channels...
[INFO] Starting Telegram channel...
[INFO] Telegram bot connected: @my_clawdbot_bot
[INFO] Listening for updates (long-polling)...
```

::: tip æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
ä½¿ç”¨ `--verbose` æ ‡å¿—å¯ä»¥çœ‹åˆ°æ›´è¯¦ç»†çš„æ—¥å¿—ï¼ŒåŒ…æ‹¬ï¼š
- æ¥æ”¶åˆ°çš„æ¯æ¡æ¶ˆæ¯
- ä¼šè¯è·¯ç”±å†³ç­–
- æƒé™æ£€æŸ¥ç»“æœ
:::

**æ£€æŸ¥ç‚¹ âœ…**

- [ ] Gateway æˆåŠŸå¯åŠ¨ä¸”æ²¡æœ‰æŠ¥é”™
- [ ] æ—¥å¿—æ˜¾ç¤º "Telegram bot connected"
- [ ] æ²¡æœ‰å‡ºç° "Authentication failed" æˆ– "Invalid token" é”™è¯¯

### ç¬¬ 4 æ­¥ï¼šåœ¨ Telegram ä¸­æµ‹è¯• Bot

**ä¸ºä»€ä¹ˆ**
å‘é€ç¬¬ä¸€æ¡æ¶ˆæ¯éªŒè¯ Bot æ­£ç¡®è¿æ¥ã€é…ç½®ç”Ÿæ•ˆã€å¯ä»¥æ¥æ”¶å’Œå›å¤æ¶ˆæ¯ã€‚

**æ“ä½œ**

1. åœ¨ Telegram ä¸­æœç´¢ä½ çš„ Bot ç”¨æˆ·åï¼ˆå¦‚ `@my_clawdbot_bot`ï¼‰
2. ç‚¹å‡»"Start"æŒ‰é’®æˆ–å‘é€ `/start` å‘½ä»¤
3. å¦‚æœæ˜¯ç¬¬ä¸€æ¬¡ DM è”ç³»ï¼Œä½ åº”è¯¥æ”¶åˆ°é…å¯¹ç 

**ä½ åº”è¯¥çœ‹åˆ°**ï¼š
```
ğŸ‘‹ Hi! I'm your Clawdbot assistant.

To get started, please approve this pairing code:
CLAW-ABC123

Run this command in your terminal:
clawdbot pairing approve telegram CLAW-ABC123
```

**å¦‚æœ Bot æ²¡æœ‰å“åº”**ï¼š

| é—®é¢˜ | å¯èƒ½åŸå›  | è§£å†³æ–¹æ³• |
|--- | --- | ---|
| Bot æ— å“åº” | Bot Token é”™è¯¯ | æ£€æŸ¥ `clawdbot.json` ä¸­çš„ `botToken` å€¼ |
| Bot æ— å“åº” | Gateway æœªå¯åŠ¨ | è¿è¡Œ `clawdbot gateway --verbose` æŸ¥çœ‹é”™è¯¯ |
| Bot æ— å“åº” | ç½‘ç»œé—®é¢˜ | æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦èƒ½è®¿é—® `api.telegram.org` |
| Bot æ— å“åº” | Bot è¢«å°ç¦ | åœ¨ @BotFather ä¸­æ£€æŸ¥ Bot çŠ¶æ€ |

### ç¬¬ 5 æ­¥ï¼šæ‰¹å‡† DM é…å¯¹ï¼ˆå¦‚æœé€‚ç”¨ï¼‰

**ä¸ºä»€ä¹ˆ**
é»˜è®¤ DM ç­–ç•¥æ˜¯ `pairing`ï¼Œé™Œç”Ÿäººéœ€è¦ä½ æ‰¹å‡†åæ‰èƒ½å‘é€æ¶ˆæ¯ç»™ Botã€‚è¿™ä¿è¯äº†å®‰å…¨æ€§ã€‚

**æ“ä½œ**

1. åœ¨ç»ˆç«¯ä¸­è¿è¡Œé…å¯¹å‘½ä»¤ï¼š

```bash
# æŸ¥çœ‹å¾…æ‰¹å‡†çš„é…å¯¹
clawdbot pairing list telegram

# æ‰¹å‡†é…å¯¹ç 
clawdbot pairing approve telegram CLAW-ABC123
```

2. é…å¯¹æˆåŠŸåï¼Œç”¨æˆ·å¯ä»¥æ­£å¸¸å‘é€æ¶ˆæ¯ç»™ Bot

**ä½ åº”è¯¥çœ‹åˆ°**ï¼š
```
âœ… Pairing approved: telegram:user:123456789

User @username can now send messages to the bot.
```

::: tip é…å¯¹ç è¿‡æœŸ
é…å¯¹ç åœ¨ 1 å°æ—¶åè¿‡æœŸã€‚ç”¨æˆ·éœ€è¦é‡æ–°å‘é€ `/start` å‘½ä»¤è·å–æ–°ç ã€‚
:::

## ç¾¤ç»„é…ç½®

### è·å–ç¾¤ç»„ Chat ID

è¦é…ç½®ç¾¤ç»„è®¿é—®æ§åˆ¶ï¼Œé¦–å…ˆéœ€è¦çŸ¥é“ç¾¤ç»„çš„ Chat IDã€‚

**æ–¹æ³• 1ï¼šä½¿ç”¨ç¬¬ä¸‰æ–¹ Botï¼ˆå¿«é€Ÿä½†ä¸æ¨èï¼‰**

1. å°†ä½ çš„ Bot æ·»åŠ åˆ°ç¾¤ç»„
2. åœ¨ç¾¤ç»„ä¸­è½¬å‘ä»»æ„æ¶ˆæ¯åˆ° `@userinfobot`
3. Bot ä¼šè¿”å›ç¾¤ç»„ä¿¡æ¯ï¼ŒåŒ…æ‹¬ Chat ID

**æ–¹æ³• 2ï¼šä½¿ç”¨ Gateway æ—¥å¿—ï¼ˆæ¨èï¼‰**

1. åœ¨ç¾¤ç»„ä¸­å‘é€ä»»æ„æ¶ˆæ¯ç»™ Bot
2. è¿è¡Œï¼š

```bash
clawdbot logs --follow
```

3. åœ¨æ—¥å¿—ä¸­æŸ¥æ‰¾ `chat.id` å­—æ®µï¼Œç¾¤ç»„ ID é€šå¸¸æ˜¯è´Ÿæ•°ï¼ˆå¦‚ `-1001234567890`ï¼‰

**ä½ åº”è¯¥çœ‹åˆ°**ï¼š
```
[INFO] Received message from chat: -1001234567890
```

### é…ç½®ç¾¤ç»„è®¿é—®

**æ–¹å¼ 1ï¼šå…è®¸æ‰€æœ‰ç¾¤ç»„**

```json5
{
  "channels": {
    "telegram": {
      "groups": {
        "*": {
          "requireMention": true
        }
      }
    }
  }
}
```

**æ–¹å¼ 2ï¼šä»…å…è®¸ç‰¹å®šç¾¤ç»„**

```json5
{
  "channels": {
    "telegram": {
      "groups": {
        "-1001234567890": {
          "requireMention": false
        },
        "-1009876543210": {
          "requireMention": true
        }
      }
    }
  }
}
```

**æ–¹å¼ 3ï¼šç¾¤ç»„ä¸­å§‹ç»ˆå“åº”ï¼ˆä¸è¦æ±‚æåŠï¼‰**

```json5
{
  "channels": {
    "telegram": {
      "groups": {
        "-1001234567890": {
          "requireMention": false
        }
      }
    }
  }
}
```

### Telegram éšç§æ¨¡å¼è®¾ç½®

å¦‚æœç¾¤ç»„ä¸­ Bot **ä¸å“åº”éæåŠæ¶ˆæ¯**ï¼Œå¯èƒ½æ˜¯éšç§æ¨¡å¼é™åˆ¶ã€‚

**æ£€æŸ¥æ­¥éª¤**ï¼š

1. åœ¨ @BotFather ä¸­è¿è¡Œ `/setprivacy`
2. é€‰æ‹© **Disable**ï¼ˆå…³é—­éšç§æ¨¡å¼ï¼‰
3. **é‡è¦**ï¼šTelegram è¦æ±‚ä½ ä»ç¾¤ç»„ä¸­ç§»é™¤å¹¶é‡æ–°æ·»åŠ  Botï¼Œè®¾ç½®æ‰ä¼šç”Ÿæ•ˆ
4. é‡æ–°æ·»åŠ  Bot åˆ°ç¾¤ç»„

::: warning éšç§æ¨¡å¼å½±å“
- âœ… **éšç§æ¨¡å¼ OFF**ï¼šBot å¯ä»¥çœ‹åˆ°æ‰€æœ‰ç¾¤ç»„æ¶ˆæ¯ï¼ˆéœ€è¦ `requireMention: false` æ‰ä¼šå“åº”æ‰€æœ‰æ¶ˆæ¯ï¼‰
- âš ï¸ **éšç§æ¨¡å¼ ON**ï¼šBot åªçœ‹åˆ° @æåŠ æˆ– Bot è¢«å›å¤çš„æ¶ˆæ¯ï¼ˆé»˜è®¤ï¼‰
- ğŸ›¡ï¸ **Bot æ˜¯ç®¡ç†å‘˜**ï¼šç®¡ç†å‘˜ Bot å¯ä»¥çœ‹åˆ°æ‰€æœ‰æ¶ˆæ¯ï¼Œæ— è®ºéšç§æ¨¡å¼å¦‚ä½•
:::

### ä¼šè¯å†…ç¾¤ç»„æ¿€æ´»

ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨å‘½ä»¤åŠ¨æ€åˆ‡æ¢ç¾¤ç»„å“åº”è¡Œä¸ºï¼ˆä¼šè¯çº§åˆ«ï¼Œé‡å¯åå¤±æ•ˆï¼‰ï¼š

- `/activation always` â€” ç¾¤ç»„ä¸­å“åº”æ‰€æœ‰æ¶ˆæ¯
- `/activation mention` â€” åªå“åº”æåŠï¼ˆé»˜è®¤ï¼‰

::: tip æ¨èä½¿ç”¨é…ç½®
ä¸ºäº†æŒä¹…åŒ–è¡Œä¸ºï¼Œæ¨èåœ¨ `clawdbot.json` ä¸­é…ç½® `groups.requireMention`ï¼Œè€Œä¸æ˜¯ä¾èµ–å‘½ä»¤ã€‚
:::

## é«˜çº§é…ç½®

### Webhook æ¨¡å¼ï¼ˆå¯é€‰ï¼‰

é»˜è®¤ä½¿ç”¨ **Long-polling**ï¼ˆä¸»åŠ¨æ‹‰å–æ›´æ–°ï¼‰ã€‚å¦‚æœä½ æœ‰å…¬å…±æœåŠ¡å™¨ï¼Œå¯ä»¥ä½¿ç”¨ Webhook æ¨¡å¼ã€‚

**é…ç½® Webhook**ï¼š

```json5
{
  "channels": {
    "telegram": {
      "webhookUrl": "https://your-domain.com/telegram-webhook",
      "webhookSecret": "your-secret-token"
    }
  }
}
```

**Webhook vs Long-polling**ï¼š

| ç‰¹æ€§ | Long-polling | Webhook |
|--- | --- | ---|
| ç½‘ç»œè¦æ±‚ | éœ€è¦ä¸»åŠ¨è®¿é—® `api.telegram.org` | éœ€è¦å…¬å…± HTTPS ç«¯ç‚¹ |
| å»¶è¿Ÿ | ~1-3 ç§’è½®è¯¢é—´éš” | è¿‘ä¹å®æ—¶æ¨é€ |
| æœåŠ¡å™¨èµ„æº | è¾ƒé«˜ï¼ˆæŒç»­è½®è¯¢ï¼‰ | è¾ƒä½ï¼ˆè¢«åŠ¨æ¥æ”¶ï¼‰ |
| é€‚ç”¨åœºæ™¯ | å®¶åº­æœåŠ¡å™¨ã€æ— å…¬å…± IP | VPSã€æœ‰åŸŸå |

::: tip æœ¬åœ° Webhook æµ‹è¯•
å¦‚æœä½ æƒ³åœ¨æœ¬åœ°æµ‹è¯• Webhookï¼š
- ä½¿ç”¨ `ngrok` æˆ– `localtunnel` åˆ›å»ºä¸´æ—¶éš§é“
- å°†éš§é“ URL é…ç½®ä¸º `webhookUrl`
- Gateway ä¼šåœ¨ `0.0.0.0:8787` ç›‘å¬ `/telegram-webhook`
:::

### åª’ä½“å¤§å°é™åˆ¶

æ§åˆ¶ Telegram ä¸­å‘é€å’Œæ¥æ”¶çš„åª’ä½“æ–‡ä»¶å¤§å°ï¼š

```json5
{
  "channels": {
    "telegram": {
      "mediaMaxMb": 10
    }
  }
}
```

- é»˜è®¤ï¼š5MB
- è¶…å‡ºé™åˆ¶çš„åª’ä½“ä¼šè¢«æ‹’ç»

### æ¶ˆæ¯åˆ†å—é…ç½®

Telegram å¯¹å•æ¡æ¶ˆæ¯çš„æ–‡æœ¬é•¿åº¦æœ‰é™åˆ¶ï¼ˆçº¦ 4096 å­—ç¬¦ï¼‰ã€‚Clawdbot ä¼šè‡ªåŠ¨åˆ†å—é•¿æ¶ˆæ¯ã€‚

```json5
{
  "channels": {
    "telegram": {
      "textChunkLimit": 4000,
      "chunkMode": "length"
    }
  }
}
```

**åˆ†å—æ¨¡å¼**ï¼š

- `"length"`ï¼šæŒ‰å­—ç¬¦æ•°åˆ†å—ï¼ˆé»˜è®¤ï¼‰
- `"newline"`ï¼šå…ˆæŒ‰ç©ºè¡Œåˆ†å‰²ï¼ˆä¿ç•™æ®µè½ï¼‰ï¼Œå†æŒ‰é•¿åº¦åˆ†å—

### Forum ä¸»é¢˜æ”¯æŒ

Telegram Forum è¶…çº§ç¾¤æ”¯æŒä¸»é¢˜ã€‚Clawdbot ä¼šä¸ºæ¯ä¸ªä¸»é¢˜åˆ›å»ºç‹¬ç«‹ä¼šè¯ã€‚

```json5
{
  "channels": {
    "telegram": {
      "groups": {
        "-1001234567890": {
          "topics": {
            "12345": {
              "requireMention": false,
              "systemPrompt": "You are a specialist in this topic."
            }
          }
        }
      }
    }
  }
}
```

**ä¸»é¢˜ä¼šè¯é”®æ ¼å¼**ï¼š
```
agent:main:telegram:group:-1001234567890:topic:12345
```

### å†…è”æŒ‰é’®

Telegram æ”¯æŒäº¤äº’å¼æŒ‰é’®ï¼ˆInline Buttonsï¼‰ã€‚

**å¯ç”¨æŒ‰é’®**ï¼š

```json5
{
  "channels": {
    "telegram": {
      "capabilities": {
        "inlineButtons": "allowlist"
      }
    }
  }
}
```

**æŒ‰é’®ä½œç”¨åŸŸ**ï¼š

- `"off"`ï¼šç¦ç”¨æŒ‰é’®
- `"dm"`ï¼šä»…åœ¨ DM ä¸­å…è®¸
- `"group"`ï¼šä»…åœ¨ç¾¤ç»„ä¸­å…è®¸
- `"all"`ï¼šDM + ç¾¤ç»„
- `"allowlist"`ï¼šDM + ç¾¤ç»„ï¼Œä½†åªå…è®¸ `allowFrom` ä¸­çš„å‘é€è€…

**é€šè¿‡ Agent å‘é€æŒ‰é’®**ï¼š

ä½¿ç”¨ `telegram` å·¥å…·çš„ `sendMessage` æ“ä½œï¼š

```json5
{
  "action": "send",
  "channel": "telegram",
  "to": "123456789",
  "message": "Choose an option:",
  "buttons": [
    [
      {"text": "Yes", "callback_data": "yes"},
      {"text": "No", "callback_data": "no"}
    ],
    [
      {"text": "Cancel", "callback_data": "cancel"}
    ]
  ]
}
```

**æŒ‰é’®å›è°ƒå¤„ç†**ï¼š

å½“ç”¨æˆ·ç‚¹å‡»æŒ‰é’®æ—¶ï¼ŒAgent ä¼šæ”¶åˆ°æ ¼å¼å¦‚ `callback_data: value` çš„æ¶ˆæ¯ã€‚

### ååº”é€šçŸ¥

æ§åˆ¶ Agent æ˜¯å¦æ¥æ”¶ç”¨æˆ·å¯¹æ¶ˆæ¯çš„ååº”ï¼ˆemojiï¼‰ã€‚

```json5
{
  "channels": {
    "telegram": {
      "reactionNotifications": "all",
      "reactionLevel": "minimal"
    }
  }
}
```

**ååº”é€šçŸ¥æ¨¡å¼**ï¼š

- `"off"`ï¼šå¿½ç•¥æ‰€æœ‰ååº”
- `"own"`ï¼šåªé€šçŸ¥ç”¨æˆ·å¯¹ Bot æ¶ˆæ¯çš„ååº”ï¼ˆé»˜è®¤ï¼‰
- `"all"`ï¼šé€šçŸ¥æ‰€æœ‰ååº”

**Agent ååº”çº§åˆ«**ï¼š

- `"off"`ï¼šAgent ä¸èƒ½å‘é€ååº”
- `"ack"`ï¼šå¤„ç†æ—¶å‘é€ç¡®è®¤ååº” ğŸ‘€
- `"minimal"`ï¼šè°¨æ…ä½¿ç”¨ååº”ï¼ˆæ¯ 5-10 æ¬¡äº¤æ¢ 1 æ¬¡ï¼Œé»˜è®¤ï¼‰
- `"extensive"`ï¼šè‡ªç”±ä½¿ç”¨ååº”

## è¸©å‘æé†’

### å¸¸è§é…ç½®é”™è¯¯

| é”™è¯¯ | ç—‡çŠ¶ | åŸå›  | è§£å†³æ–¹æ³• |
|--- | --- | --- | ---|
| Token æ ¼å¼é”™è¯¯ | "Invalid token" é”™è¯¯ | å¤åˆ¶äº†ä¸å®Œæ•´çš„ Token | æ£€æŸ¥ Token æ˜¯å¦å®Œæ•´ï¼ˆåŒ…å«å†’å·ï¼‰ |
| ç¯å¢ƒå˜é‡å†²çª | Bot ä½¿ç”¨ä¸åŒçš„ Token | ç¯å¢ƒå˜é‡è¦†ç›–äº†é…ç½®æ–‡ä»¶ | ä¼˜å…ˆä½¿ç”¨ `channels.telegram.botToken` |
| ç¾¤ç»„ä¸å“åº” | Bot ä¸å¤„ç†ç¾¤ç»„æ¶ˆæ¯ | éšç§æ¨¡å¼æœªå…³é—­ | åœ¨ @BotFather ä¸­è¿è¡Œ `/setprivacy` |
| Webhook å¤±è´¥ | "Webhook setup failed" | URL æ— æ³•è®¿é—®æˆ– HTTPS ä¸æ­£ç¡® | æ£€æŸ¥æœåŠ¡å™¨å’Œè¯ä¹¦ |

### ç½‘ç»œé—®é¢˜

**IPv6 è·¯ç”±é—®é¢˜**ï¼š

ä¸€äº›æœåŠ¡å™¨ä¼˜å…ˆä½¿ç”¨ IPv6 è§£æ `api.telegram.org`ï¼Œå¦‚æœ IPv6 ç½‘ç»œæœ‰é—®é¢˜ä¼šå¯¼è‡´è¯·æ±‚å¤±è´¥ã€‚

**ç—‡çŠ¶**ï¼š
- Bot å¯åŠ¨ä½†å¾ˆå¿«åœæ­¢å“åº”
- æ—¥å¿—æ˜¾ç¤º "HttpError: Network request failed"

**è§£å†³æ–¹æ³•**ï¼š

1. æ£€æŸ¥ DNS è§£æï¼š

```bash
dig +short api.telegram.org A    # IPv4
dig +short api.telegram.org AAAA # IPv6
```

2. å¼ºåˆ¶ä½¿ç”¨ IPv4ï¼ˆæ·»åŠ åˆ° `/etc/hosts` æˆ–ä¿®æ”¹ DNS é…ç½®ï¼‰

```bash
# /etc/hosts ç¤ºä¾‹
123.45.67.89 api.telegram.org
```

3. é‡å¯ Gateway

### éšç§æ¨¡å¼é™·é˜±

**é—®é¢˜**ï¼š
- å…³é—­éšç§æ¨¡å¼åï¼ŒBot ä»ç„¶çœ‹ä¸åˆ°ç¾¤ç»„æ¶ˆæ¯

**åŸå› **ï¼š
- Telegram è¦æ±‚ä½ ä»ç¾¤ç»„ä¸­**ç§»é™¤å¹¶é‡æ–°æ·»åŠ ** Bot

**è§£å†³æ–¹æ³•**ï¼š
1. åœ¨ç¾¤ç»„ä¸­ç§»é™¤ Bot
2. é‡æ–°æ·»åŠ  Bot åˆ°ç¾¤ç»„
3. ç­‰å¾… 30 ç§’åæµ‹è¯•

## æœ¬è¯¾å°ç»“

æœ¬è¯¾ä½ å­¦ä¼šäº†ï¼š

- âœ… åœ¨ Telegram ä¸­åˆ›å»º Bot å¹¶è·å– Token
- âœ… é…ç½® Clawdbot è¿æ¥åˆ° Telegram Bot API
- âœ… ç†è§£å’Œä½¿ç”¨ DM é…å¯¹æœºåˆ¶
- âœ… é…ç½®ç¾¤ç»„è®¿é—®æ§åˆ¶ï¼ˆç™½åå• + æåŠè§„åˆ™ï¼‰
- âœ… äº†è§£ Webhook vs Long-polling çš„åŒºåˆ«
- âœ… é…ç½®é«˜çº§åŠŸèƒ½ï¼ˆåª’ä½“é™åˆ¶ã€åˆ†å—ã€Forum ä¸»é¢˜ã€å†…è”æŒ‰é’®ï¼‰
- âœ… å¤„ç†å¸¸è§ç½‘ç»œå’Œé…ç½®é—®é¢˜

**å…³é”®é…ç½®å­—æ®µå›é¡¾**ï¼š

| å­—æ®µ | æ¨èå€¼ | è¯´æ˜ |
|--- | --- | ---|
| `dmPolicy` | `"pairing"` | æœ€å®‰å…¨çš„é»˜è®¤ DM ç­–ç•¥ |
| `groups.*.requireMention` | `true` | ç¾¤ç»„é»˜è®¤è¦æ±‚æåŠ |
| `reactionNotifications` | `"own"` | åªå“åº” Bot æ¶ˆæ¯çš„ååº” |
| `streamMode` | `"partial"` | å¯ç”¨è‰ç¨¿æµå¼æ›´æ–° |

## ä¸‹ä¸€è¯¾é¢„å‘Š

> ä¸‹ä¸€è¯¾æˆ‘ä»¬å­¦ä¹  **[Slack æ¸ é“](../../platforms/slack/)**ã€‚
>
> ä½ ä¼šå­¦åˆ°ï¼š
> - å¦‚ä½•åˆ›å»º Slack App å¹¶è·å– Bot Token
> - é…ç½® Slack Bot Token å’Œ App Token
> - ç†è§£ Slack çš„ Workspace å’Œ Channel æ¦‚å¿µ
> - è®¾ç½® Slack ç‰¹æœ‰çš„åŠŸèƒ½ï¼ˆçº¿ç¨‹ã€å¿«æ·æ–¹å¼ã€App Homeï¼‰

---

## é™„å½•ï¼šæºç å‚è€ƒ

<details>
<summary><strong>ç‚¹å‡»å±•å¼€æŸ¥çœ‹æºç ä½ç½®</strong></summary>

> æ›´æ–°æ—¶é—´ï¼š2026-01-27

| åŠŸèƒ½ | æ–‡ä»¶è·¯å¾„ | è¡Œå· |
|--- | --- | ---|
| Telegram Bot åˆ›å»º | [`src/telegram/bot.ts`](https://github.com/clawdbot/clawdbot/blob/main/src/telegram/bot.ts) | 106-452 |
| é…ç½®ç±»å‹å®šä¹‰ | [`src/config/types.telegram.ts`](https://github.com/clawdbot/clawdbot/blob/main/src/config/types.telegram.ts) | 14-157 |
| Telegram æ–‡æ¡£ | [`docs/channels/telegram.md`](https://github.com/clawdbot/clawdbot/blob/main/docs/channels/telegram.md) | 1-547 |
| Bot æ¶ˆæ¯å¤„ç†å™¨ | [`src/telegram/bot-message.ts`](https://github.com/clawdbot/clawdbot/blob/main/src/telegram/bot-message.ts) | å…¨æ–‡ä»¶ |
| Bot å‘½ä»¤å¤„ç†å™¨ | [`src/telegram/bot-handlers.ts`](https://github.com/clawdbot/clawdbot/blob/main/src/telegram/bot-handlers.ts) | å…¨æ–‡ä»¶ |
| åŸç”Ÿå‘½ä»¤æ³¨å†Œ | [`src/telegram/bot-native-commands.ts`](https://github.com/clawdbot/clawdbot/blob/main/src/telegram/bot-native-commands.ts) | å…¨æ–‡ä»¶ |

**å…³é”®é…ç½®å­—æ®µ**ï¼š

- `dmPolicy`: DM è®¿é—®ç­–ç•¥ï¼ˆ`"pairing"` | `"allowlist"` | `"open"` | `"disabled"`ï¼‰
- `groupPolicy`: ç¾¤ç»„ç­–ç•¥ï¼ˆ`"open"` | `"allowlist"` | `"disabled"`ï¼‰
- `requireMention`: ç¾¤ç»„æ˜¯å¦è¦æ±‚æåŠï¼ˆ`boolean`ï¼‰
- `reactionNotifications`: ååº”é€šçŸ¥æ¨¡å¼ï¼ˆ`"off"` | `"own"` | `"all"`ï¼‰
- `reactionLevel`: Agent ååº”çº§åˆ«ï¼ˆ`"off"` | `"ack"` | `"minimal"` | `"extensive"`ï¼‰

**å…³é”®å‡½æ•°**ï¼š

- `createTelegramBot()`: åˆ›å»º Telegram Bot å®ä¾‹å¹¶é…ç½® grammY æ¡†æ¶
- `createTelegramWebhookCallback()`: åˆ›å»º Webhook å›è°ƒå¤„ç†å™¨
- `getTelegramSequentialKey()`: ç”Ÿæˆä¼šè¯é”®ï¼Œæ”¯æŒ Forum ä¸»é¢˜å’Œæ™®é€šç¾¤ç»„

**ä¾èµ–åº“**ï¼š

- [grammY](https://grammy.dev/): Telegram Bot API æ¡†æ¶
- @grammyjs/runner: é¡ºåºåŒ–æ›´æ–°å¤„ç†
- @grammyjs/transformer-throttler: API èŠ‚æµé™åˆ¶

</details>
