---
title: "URL åˆ†äº«: æ— åç«¯åä½œ | Plannotator"
sidebarTitle: "åˆ†äº«ç»™å›¢é˜Ÿçœ‹"
subtitle: "URL åˆ†äº«: æ— åç«¯åä½œ"
description: "å­¦ä¹  Plannotator çš„ URL åˆ†äº«åŠŸèƒ½ã€‚é€šè¿‡ deflate å‹ç¼©å’Œ Base64 ç¼–ç å®ç°æ— åç«¯åä½œï¼Œé…ç½®ç¯å¢ƒå˜é‡å¹¶è§£å†³å¸¸è§åˆ†äº«é—®é¢˜ã€‚"
tags:
  - "URL åˆ†äº«"
  - "å›¢é˜Ÿåä½œ"
  - "æ— åç«¯"
  - "deflate å‹ç¼©"
  - "Base64 ç¼–ç "
  - "å®‰å…¨"
prerequisite:
  - "start-getting-started"
  - "platforms-plan-review-basics"
order: 1
---

# URL åˆ†äº«ï¼šæ— åç«¯çš„è®¡åˆ’åä½œ

## å­¦å®Œä½ èƒ½åšä»€ä¹ˆ

- âœ… é€šè¿‡ URL åˆ†äº«è®¡åˆ’å’Œæ³¨é‡Šï¼Œæ— éœ€ç™»å½•è´¦å·æˆ–éƒ¨ç½²æœåŠ¡å™¨
- âœ… ç†è§£ deflate å‹ç¼©å’Œ Base64 ç¼–ç å¦‚ä½•å°†æ•°æ®åµŒå…¥ URL hash
- âœ… åŒºåˆ†åˆ†äº«æ¨¡å¼ï¼ˆåªè¯»ï¼‰å’Œæœ¬åœ°æ¨¡å¼ï¼ˆå¯ç¼–è¾‘ï¼‰
- âœ… é…ç½® `PLANNOTATOR_SHARE` ç¯å¢ƒå˜é‡æ§åˆ¶åˆ†äº«åŠŸèƒ½
- âœ… å¤„ç† URL é•¿åº¦é™åˆ¶å’Œåˆ†äº«å¤±è´¥çš„æƒ…å†µ

## ä½ ç°åœ¨çš„å›°å¢ƒ

**é—®é¢˜ 1**ï¼šæƒ³è¯·å›¢é˜Ÿæˆå‘˜å¸®å¿™è¯„å®¡ AI ç”Ÿæˆçš„è®¡åˆ’ï¼Œä½†æ²¡æœ‰åä½œå¹³å°ã€‚

**é—®é¢˜ 2**ï¼šä½¿ç”¨æˆªå›¾æˆ–å¤åˆ¶æ–‡æœ¬çš„æ–¹å¼åˆ†äº«è¯„å®¡å†…å®¹ï¼Œå¯¹æ–¹æ— æ³•ç›´æ¥çœ‹åˆ°ä½ çš„æ³¨é‡Šã€‚

**é—®é¢˜ 3**ï¼šéƒ¨ç½²åœ¨çº¿åä½œæœåŠ¡å™¨æˆæœ¬é«˜ï¼Œæˆ–å…¬å¸å®‰å…¨æ”¿ç­–ä¸å…è®¸ã€‚

**é—®é¢˜ 4**ï¼šéœ€è¦ä¸€ä¸ªç®€å•å¿«æ·çš„åˆ†äº«æ–¹å¼ï¼Œä½†ä¸çŸ¥é“å¦‚ä½•ä¿è¯æ•°æ®éšç§ã€‚

**Plannotator èƒ½å¸®ä½ **ï¼š
- æ— éœ€åç«¯æœåŠ¡å™¨ï¼Œæ‰€æœ‰æ•°æ®å‹ç¼©åœ¨ URL ä¸­
- åˆ†äº«é“¾æ¥åŒ…å«å®Œæ•´è®¡åˆ’å’Œæ³¨é‡Šï¼Œæ¥æ”¶æ–¹å¯æŸ¥çœ‹
- æ•°æ®ä¸ç¦»å¼€æœ¬åœ°è®¾å¤‡ï¼Œéšç§å®‰å…¨
- ç”Ÿæˆçš„ URL å¯å¤åˆ¶åˆ°ä»»ä½•é€šè®¯å·¥å…·

## ä»€ä¹ˆæ—¶å€™ç”¨è¿™ä¸€æ‹›

**ä½¿ç”¨åœºæ™¯**ï¼š
- éœ€è¦å›¢é˜Ÿæˆå‘˜è¯„å®¡ AI ç”Ÿæˆçš„å®æ–½è®¡åˆ’
- æƒ³åˆ†äº«ä»£ç è¯„å®¡ç»“æœç»™åŒäº‹
- éœ€è¦ä¿å­˜è¯„å®¡å†…å®¹åˆ°ç¬”è®°ï¼ˆç»“åˆ Obsidian/Bear é›†æˆï¼‰
- å¿«é€Ÿè·å–ä»–äººå¯¹è®¡åˆ’çš„åé¦ˆ

**ä¸é€‚ç”¨åœºæ™¯**ï¼š
- éœ€è¦å®æ—¶åä½œç¼–è¾‘ï¼ˆPlannotator åˆ†äº«æ˜¯åªè¯»çš„ï¼‰
- è®¡åˆ’å†…å®¹è¶…è¿‡ URL é•¿åº¦é™åˆ¶ï¼ˆé€šå¸¸æ•°åƒè¡Œï¼‰
- åˆ†äº«å†…å®¹åŒ…å«æ•æ„Ÿä¿¡æ¯ï¼ˆURL æœ¬èº«ä¸åŠ å¯†ï¼‰

::: warning å®‰å…¨æç¤º
åˆ†äº« URL åŒ…å«å®Œæ•´è®¡åˆ’å’Œæ³¨é‡Šï¼Œè¯·å‹¿åˆ†äº«åŒ…å«æ•æ„Ÿä¿¡æ¯çš„å†…å®¹ï¼ˆå¦‚ API å¯†é’¥ã€å¯†ç ç­‰ï¼‰ã€‚åˆ†äº« URL æœ¬èº«å¯è¢«ä»»ä½•äººè®¿é—®ï¼Œä¸ä¼šè‡ªåŠ¨è¿‡æœŸã€‚
:::

## æ ¸å¿ƒæ€è·¯

### URL åˆ†äº«æ˜¯ä»€ä¹ˆ

**URL åˆ†äº«**æ˜¯ Plannotator æä¾›çš„ä¸€ç§æ— åç«¯åä½œæ–¹å¼ï¼Œé€šè¿‡å°†è®¡åˆ’å’Œæ³¨é‡Šå‹ç¼©åˆ° URL hash ä¸­ï¼Œå®ç°æ— éœ€æœåŠ¡å™¨çš„åˆ†äº«åŠŸèƒ½ã€‚

::: info ä¸ºä»€ä¹ˆå«ã€Œæ— åç«¯ã€ï¼Ÿ
ä¼ ç»Ÿåä½œæ–¹æ¡ˆéœ€è¦åç«¯æœåŠ¡å™¨å­˜å‚¨è®¡åˆ’å’Œæ³¨é‡Šï¼Œç”¨æˆ·é€šè¿‡ ID æˆ– token è®¿é—®ã€‚Plannotator çš„ URL åˆ†äº«ä¸ä¾èµ–ä»»ä½•åç«¯â€”â€”æ‰€æœ‰æ•°æ®éƒ½åœ¨ URL ä¸­ï¼Œæ¥æ”¶æ–¹æ‰“å¼€é“¾æ¥å³å¯è§£æå†…å®¹ã€‚è¿™ä¿è¯äº†éšç§ï¼ˆæ•°æ®ä¸ä¸Šä¼ ï¼‰å’Œç®€æ´æ€§ï¼ˆæ— éœ€éƒ¨ç½²æœåŠ¡ï¼‰ã€‚
:::

### å·¥ä½œåŸç†

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”¨æˆ· Aï¼ˆåˆ†äº«è€…ï¼‰                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  1. å®¡è¯„è®¡åˆ’ï¼Œæ·»åŠ æ³¨é‡Š                                 â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚     â”‚ Plan: å®æ–½è®¡åˆ’       â”‚                           â”‚
â”‚     â”‚ Annotations: [       â”‚                           â”‚
â”‚     â”‚   {type: 'REPLACE'},â”‚                           â”‚
â”‚     â”‚   {type: 'COMMENT'}  â”‚                           â”‚
â”‚     â”‚ ]                   â”‚                           â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚              â”‚                                         â”‚
â”‚              â–¼                                         â”‚
â”‚  2. ç‚¹å‡» Export â†’ Share                                â”‚
â”‚              â”‚                                         â”‚
â”‚              â–¼                                         â”‚
â”‚  3. å‹ç¼©æ•°æ®                                          â”‚
â”‚     JSON â†’ deflate â†’ Base64 â†’ URL å®‰å…¨å­—ç¬¦               â”‚
â”‚     â†“                                                â”‚
â”‚     https://share.plannotator.ai/#eJyrVkrLz1...       â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”‚ å¤åˆ¶ URL
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”¨æˆ· Bï¼ˆæ¥æ”¶è€…ï¼‰                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  1. æ‰“å¼€åˆ†äº« URL                                       â”‚
â”‚     https://share.plannotator.ai/#eJyrVkrLz1...       â”‚
â”‚              â”‚                                         â”‚
â”‚              â–¼                                         â”‚
â”‚  2. æµè§ˆå™¨è§£æ hash                                   â”‚
â”‚     URL å®‰å…¨å­—ç¬¦ â†’ Base64 è§£ç  â†’ deflate è§£å‹ â†’ JSON     â”‚
â”‚              â”‚                                         â”‚
â”‚              â–¼                                         â”‚
â”‚  3. æ¢å¤è®¡åˆ’å’Œæ³¨é‡Š                                     â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚     â”‚ Plan: å®æ–½è®¡åˆ’       â”‚  âœ… åªè¯»æ¨¡å¼             â”‚
â”‚     â”‚ Annotations: [       â”‚  ï¼ˆæ— æ³•æäº¤å†³ç­–ï¼‰        â”‚
â”‚     â”‚   {type: 'REPLACE'},â”‚                           â”‚
â”‚     â”‚   {type: 'COMMENT'}  â”‚                           â”‚
â”‚     â”‚ ]                   â”‚                           â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å‹ç¼©ç®—æ³•è¯¦è§£

**æ­¥éª¤ 1ï¼šJSON åºåˆ—åŒ–**
```json
{
  "p": "# Plan\n\nStep 1...",
  "a": [
    ["R", "old text", "new text", null, null],
    ["C", "context", "comment text", null, null]
  ],
  "g": ["image1.png", "image2.png"]
}
```

**æ­¥éª¤ 2ï¼šDeflate-raw å‹ç¼©**
- ä½¿ç”¨åŸç”Ÿ `CompressionStream('deflate-raw')` API
- å‹ç¼©ç‡å…¸å‹å€¼ä¸º 60-80%ï¼ˆå–å†³äºæ–‡æœ¬é‡å¤åº¦ï¼Œéæºç å®šä¹‰ï¼‰
- æºç ä½ç½®ï¼š`packages/ui/utils/sharing.ts:34`

**æ­¥éª¤ 3ï¼šBase64 ç¼–ç **
```typescript
const base64 = btoa(String.fromCharCode(...compressed));
```

**æ­¥éª¤ 4ï¼šURL å®‰å…¨å­—ç¬¦æ›¿æ¢**
```typescript
base64
  .replace(/\+/g, '-')   // + â†’ -
  .replace(/\//g, '_')   // / â†’ _
  .replace(/=/g, '');    // = â†’ ''ï¼ˆç§»é™¤å¡«å……ï¼‰
```

::: tip ä¸ºä»€ä¹ˆæ›¿æ¢ç‰¹æ®Šå­—ç¬¦ï¼Ÿ
URL ä¸­æŸäº›å­—ç¬¦æœ‰ç‰¹æ®Šå«ä¹‰ï¼ˆå¦‚ `+` è¡¨ç¤ºç©ºæ ¼ï¼Œ`/` æ˜¯è·¯å¾„åˆ†éš”ç¬¦ï¼‰ã€‚Base64 ç¼–ç åå¯èƒ½åŒ…å«è¿™äº›å­—ç¬¦ï¼Œä¼šå¯¼è‡´ URL è§£æé”™è¯¯ã€‚æ›¿æ¢ä¸º `-` å’Œ `_` åï¼ŒURL å˜å¾—å®‰å…¨ä¸”å¯å¤åˆ¶ã€‚
:::

### æ³¨é‡Šæ ¼å¼ä¼˜åŒ–

ä¸ºå‹ç¼©æ•ˆç‡ï¼ŒPlannotator ä½¿ç”¨ç²¾ç®€çš„æ³¨é‡Šæ ¼å¼ï¼ˆ`ShareableAnnotation`ï¼‰ï¼š

| åŸå§‹ Annotation | ç²¾ç®€æ ¼å¼ | è¯´æ˜ |
|--- | --- | ---|
| `{type: 'DELETION', originalText: '...', text: undefined, ...}` | `['D', 'old text', null, images?]` | D = Deletionï¼Œnull è¡¨ç¤ºæ—  text |
| `{type: 'REPLACEMENT', originalText: '...', text: 'new...', ...}` | `['R', 'old text', 'new text', null, images?]` | R = Replacement |
| `{type: 'COMMENT', originalText: '...', text: 'comment...', ...}` | `['C', 'old text', 'comment text', null, images?]` | C = Comment |
| `{type: 'INSERTION', originalText: '...', text: 'new...', ...}` | `['I', 'context', 'new text', null, images?]` | I = Insertion |
| `{type: 'GLOBAL_COMMENT', text: '...', ...}` | `['G', 'comment text', null, images?]` | G = Global comment |

å­—æ®µé¡ºåºå›ºå®šï¼Œçœç•¥é”®åï¼Œæ˜¾è‘—å‡å°‘æ•°æ®é‡ã€‚æºç ä½ç½®ï¼š`packages/ui/utils/sharing.ts:76`

### åˆ†äº« URL ç»“æ„

```
https://share.plannotator.ai/#<compressed_data>
                            â†‘
                        hash éƒ¨åˆ†
```

- **åŸºç¡€åŸŸå**ï¼š`share.plannotator.ai`ï¼ˆç‹¬ç«‹åˆ†äº«é¡µé¢ï¼‰
- **Hash åˆ†éš”ç¬¦**ï¼š`#`ï¼ˆä¸ä¼šå‘é€åˆ°æœåŠ¡å™¨ï¼Œå®Œå…¨ç”±å‰ç«¯è§£æï¼‰
- **å‹ç¼©æ•°æ®**ï¼šBase64url ç¼–ç çš„å‹ç¼© JSON

## ğŸ’ å¼€å§‹å‰çš„å‡†å¤‡

**å‰ç½®æ¡ä»¶**ï¼š
- âœ… å·²å®Œæˆ [è®¡åˆ’è¯„å®¡åŸºç¡€](../../platforms/plan-review-basics/)ï¼Œäº†è§£å¦‚ä½•æ·»åŠ æ³¨é‡Š
- âœ… å·²å®Œæˆ [è®¡åˆ’æ³¨é‡Šæ•™ç¨‹](../../platforms/plan-review-annotations/)ï¼Œäº†è§£æ³¨é‡Šç±»å‹
- âœ… æµè§ˆå™¨æ”¯æŒ `CompressionStream` APIï¼ˆç°ä»£æµè§ˆå™¨å‡æ”¯æŒï¼‰

**æ£€æŸ¥åˆ†äº«åŠŸèƒ½æ˜¯å¦å¯ç”¨**ï¼š
```bash
# é»˜è®¤å¯ç”¨
echo $PLANNOTATOR_SHARE

# å¦‚éœ€ç¦ç”¨åˆ†äº«ï¼ˆä¾‹å¦‚ä¼ä¸šå®‰å…¨ç­–ç•¥ï¼‰
export PLANNOTATOR_SHARE=disabled
```

::: info ç¯å¢ƒå˜é‡è¯´æ˜
`PLANNOTATOR_SHARE` æ§åˆ¶åˆ†äº«åŠŸèƒ½çš„å¯ç”¨çŠ¶æ€ï¼š
- **æœªè®¾ç½®æˆ–é "disabled"**ï¼šå¯ç”¨åˆ†äº«åŠŸèƒ½
- **è®¾ç½®ä¸º "disabled"**ï¼šç¦ç”¨åˆ†äº«ï¼ˆExport Modal åªæ˜¾ç¤º Raw Diff æ ‡ç­¾ï¼‰

æºç ä½ç½®ï¼š`apps/hook/server/index.ts:44`ã€`apps/opencode-plugin/index.ts:50`
:::

**æ£€æŸ¥æµè§ˆå™¨å…¼å®¹æ€§**ï¼š
```bash
# åœ¨æµè§ˆå™¨æ§åˆ¶å°è¿è¡Œ
const stream = new CompressionStream('deflate-raw');
console.log('CompressionStream supported');
```

å¦‚æœè¾“å‡º `CompressionStream supported`ï¼Œè¯´æ˜æµè§ˆå™¨æ”¯æŒã€‚ç°ä»£æµè§ˆå™¨ï¼ˆChrome 80+ã€Firefox 113+ã€Safari 16.4+ï¼‰å‡æ”¯æŒã€‚

## è·Ÿæˆ‘åš

### ç¬¬ 1 æ­¥ï¼šå®Œæˆè®¡åˆ’è¯„å®¡

**ä¸ºä»€ä¹ˆ**
åˆ†äº«å‰éœ€è¦å…ˆå®Œæˆè¯„å®¡ï¼ŒåŒ…æ‹¬æ·»åŠ æ³¨é‡Šã€‚

**æ“ä½œ**ï¼š
1. åœ¨ Claude Code æˆ– OpenCode ä¸­è§¦å‘è®¡åˆ’è¯„å®¡
2. æŸ¥çœ‹è®¡åˆ’å†…å®¹ï¼Œé€‰ä¸­éœ€è¦ä¿®æ”¹çš„æ–‡æœ¬
3. æ·»åŠ æ³¨é‡Šï¼ˆåˆ é™¤ã€æ›¿æ¢ã€è¯„è®ºç­‰ï¼‰
4. ï¼ˆå¯é€‰ï¼‰ä¸Šä¼ å›¾ç‰‡é™„ä»¶

**ä½ åº”è¯¥çœ‹åˆ°**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Plan Review                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                           â”‚
â”‚  # Implementation Plan                                    â”‚
â”‚                                                           â”‚
â”‚  ## Phase 1: Setup                                      â”‚
â”‚  Set up WebSocket server on port 8080                    â”‚
â”‚                                                           â”‚
â”‚  ## Phase 2: Authentication                             â”‚
â”‚  Implement JWT authentication middleware                   â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”‚ Replace: "implement" â”‚               â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                           â”‚
â”‚  Annotation Panel                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ REPLACE: "implement" â†’ "add"                      â”‚  â”‚
â”‚  â”‚ JWT is overkill, use simple session tokens         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                           â”‚
â”‚  [Approve] [Request Changes] [Export]                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ç¬¬ 2 æ­¥ï¼šæ‰“å¼€ Export Modal

**ä¸ºä»€ä¹ˆ**
Export Modal æä¾›äº†åˆ†äº« URL çš„ç”Ÿæˆå…¥å£ã€‚

**æ“ä½œ**ï¼š
1. ç‚¹å‡»å³ä¸Šè§’çš„ **Export** æŒ‰é’®
2. ç­‰å¾… Export Modal æ‰“å¼€

**ä½ åº”è¯¥çœ‹åˆ°**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Export                                     Ã—             â”‚
â”‚  1 annotation                          Share | Raw Diff   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                           â”‚
â”‚  Shareable URL                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ https://share.plannotator.ai/#eJyrVkrLz1...        â”‚ â”‚
â”‚  â”‚                                              [Copy] â”‚ â”‚
â”‚  â”‚                                           3.2 KB    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                           â”‚
â”‚  This URL contains full plan and all annotations.          â”‚
â”‚  Anyone with this link can view and add to your annotations.â”‚
â”‚                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

::: tip URL å¤§å°æç¤º
å³ä¸‹è§’æ˜¾ç¤º URL çš„å­—èŠ‚æ•°ï¼ˆå¦‚ 3.2 KBï¼‰ã€‚å¦‚æœ URL è¿‡é•¿ï¼ˆè¶…è¿‡ 8 KBï¼‰ï¼Œè€ƒè™‘å‡å°‘æ³¨é‡Šæ•°é‡æˆ–å›¾ç‰‡é™„ä»¶ã€‚
:::

### ç¬¬ 3 æ­¥ï¼šå¤åˆ¶åˆ†äº« URL

**ä¸ºä»€ä¹ˆ**
å¤åˆ¶ URL åå¯ä»¥ç²˜è´´åˆ°ä»»ä½•é€šè®¯å·¥å…·ï¼ˆSlackã€Emailã€å¾®ä¿¡ç­‰ï¼‰ã€‚

**æ“ä½œ**ï¼š
1. ç‚¹å‡» **Copy** æŒ‰é’®
2. ç­‰å¾…æŒ‰é’®å˜ä¸º **Copied!**
3. URL å·²å¤åˆ¶åˆ°å‰ªè´´æ¿

**ä½ åº”è¯¥çœ‹åˆ°**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Shareable URL                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ https://share.plannotator.ai/#eJyrVkrLz1...        â”‚ â”‚
â”‚  â”‚                                    âœ“ Copied         â”‚ â”‚
â”‚  â”‚                                           3.2 KB    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

::: tip è‡ªåŠ¨é€‰æ‹©
ç‚¹å‡» URL è¾“å…¥æ¡†ä¼šè‡ªåŠ¨é€‰ä¸­å…¨éƒ¨å†…å®¹ï¼Œæ–¹ä¾¿æ‰‹åŠ¨å¤åˆ¶ï¼ˆå¦‚æœä¸ä½¿ç”¨ Copy æŒ‰é’®ï¼‰ã€‚
:::

### ç¬¬ 4 æ­¥ï¼šåˆ†äº« URL ç»™åä½œè€…

**ä¸ºä»€ä¹ˆ**
åä½œè€…é€šè¿‡æ‰“å¼€ URL å¯ä»¥æŸ¥çœ‹è®¡åˆ’å’Œæ³¨é‡Šã€‚

**æ“ä½œ**ï¼š
1. å°† URL ç²˜è´´åˆ°é€šè®¯å·¥å…·ï¼ˆSlackã€Email ç­‰ï¼‰
2. å‘é€ç»™å›¢é˜Ÿæˆå‘˜

**ç¤ºä¾‹æ¶ˆæ¯**ï¼š
```
Hi @å›¢é˜Ÿï¼Œ

è¯·å¸®å¿™è¯„å®¡è¿™ä¸ªå®æ–½è®¡åˆ’ï¼š
https://share.plannotator.ai/#eJyrVkrLz1...

æˆ‘åœ¨ç¬¬ 2 é˜¶æ®µæ·»åŠ äº†ä¸€ä¸ªæ›¿æ¢æ³¨é‡Šï¼Œè®¤ä¸º JWT è¿‡äºå¤æ‚ã€‚

è¯·ç»™å‡ºä½ çš„åé¦ˆï¼Œè°¢è°¢ï¼
```

### ç¬¬ 5 æ­¥ï¼šåä½œè€…æ‰“å¼€åˆ†äº« URLï¼ˆæ¥æ”¶æ–¹ï¼‰

**ä¸ºä»€ä¹ˆ**
åä½œè€…éœ€è¦åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ URL æŸ¥çœ‹å†…å®¹ã€‚

**æ“ä½œ**ï¼ˆåä½œè€…æ‰§è¡Œï¼‰ï¼š
1. ç‚¹å‡»åˆ†äº« URL
2. ç­‰å¾…é¡µé¢åŠ è½½

**ä½ åº”è¯¥çœ‹åˆ°**ï¼ˆåä½œè€…è§†è§’ï¼‰ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Plan Review                               Read-only     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                           â”‚
â”‚  # Implementation Plan                                    â”‚
â”‚                                                           â”‚
â”‚  ## Phase 1: Setup                                      â”‚
â”‚  Set up WebSocket server on port 8080                    â”‚
â”‚                                                           â”‚
â”‚  ## Phase 2: Authentication                             â”‚
â”‚  Implement JWT authentication middleware                   â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”‚ Replace: "implement" â”‚               â”‚
â”‚  â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚  â”‚ This annotation was shared by [Your Name]             â”‚
â”‚                                                           â”‚
â”‚  Annotation Panel                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ REPLACE: "implement" â†’ "add"                      â”‚  â”‚
â”‚  â”‚ JWT is overkill, use simple session tokens         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                           â”‚
â”‚  [View Only Mode - Approve and Deny disabled]            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

::: warning åªè¯»æ¨¡å¼
åˆ†äº« URL æ‰“å¼€åï¼Œç•Œé¢å³ä¸Šè§’æ˜¾ç¤º "Read-only" æ ‡ç­¾ï¼ŒApprove å’Œ Deny æŒ‰é’®è¢«ç¦ç”¨ã€‚åä½œè€…å¯ä»¥æŸ¥çœ‹è®¡åˆ’å’Œæ³¨é‡Šï¼Œä½†æ— æ³•æäº¤å†³ç­–ã€‚
:::

::: info è§£å‹è¿‡ç¨‹
åä½œè€…æ‰“å¼€ URL æ—¶ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼ˆç”± `useSharing` Hook è§¦å‘ï¼‰ï¼š
1. ä» `window.location.hash` æå–å‹ç¼©æ•°æ®
2. åå‘æ‰§è¡Œ Base64 è§£ç  â†’ deflate è§£å‹ â†’ JSON è§£æ
3. æ¢å¤è®¡åˆ’å’Œæ³¨é‡Š
4. æ¸…é™¤ URL hashï¼ˆé¿å…åˆ·æ–°æ—¶é‡æ–°åŠ è½½ï¼‰

æºç ä½ç½®ï¼š`packages/ui/hooks/useSharing.ts:67`
:::

### æ£€æŸ¥ç‚¹ âœ…

**éªŒè¯åˆ†äº« URL æ˜¯å¦æœ‰æ•ˆ**ï¼š
1. å¤åˆ¶åˆ†äº« URL
2. åœ¨æ–°æ ‡ç­¾é¡µæˆ–æ— ç—•æ¨¡å¼æ‰“å¼€
3. ç¡®è®¤æ˜¾ç¤ºç›¸åŒçš„è®¡åˆ’å’Œæ³¨é‡Š

**éªŒè¯åªè¯»æ¨¡å¼**ï¼š
1. åä½œè€…æ‰“å¼€åˆ†äº« URL
2. æ£€æŸ¥å³ä¸Šè§’æ˜¯å¦æœ‰ "Read-only" æ ‡ç­¾
3. ç¡®è®¤ Approve å’Œ Deny æŒ‰é’®è¢«ç¦ç”¨

**éªŒè¯ URL é•¿åº¦**ï¼š
1. æŸ¥çœ‹ Export Modal ä¸­çš„ URL å¤§å°
2. ç¡®è®¤ä¸è¶…è¿‡ 8 KBï¼ˆå¦‚è¶…è¿‡ï¼Œè€ƒè™‘å‡å°‘æ³¨é‡Šï¼‰

## è¸©å‘æé†’

### é—®é¢˜ 1ï¼šURL åˆ†äº«æŒ‰é’®ä¸æ˜¾ç¤º

**ç°è±¡**ï¼šExport Modal ä¸­æ²¡æœ‰ Share æ ‡ç­¾ï¼Œåªæœ‰ Raw Diffã€‚

**åŸå› **ï¼š`PLANNOTATOR_SHARE` ç¯å¢ƒå˜é‡è®¾ç½®ä¸º "disabled"ã€‚

**è§£å†³æ–¹æ³•**ï¼š
```bash
# æ£€æŸ¥å½“å‰å€¼
echo $PLANNOTATOR_SHARE

# ç§»é™¤æˆ–è®¾ç½®ä¸ºå…¶ä»–å€¼
unset PLANNOTATOR_SHARE
# æˆ–
export PLANNOTATOR_SHARE=enabled
```

æºç ä½ç½®ï¼š`apps/hook/server/index.ts:44`

### é—®é¢˜ 2ï¼šåˆ†äº« URL æ‰“å¼€åæ˜¾ç¤ºç©ºç™½é¡µé¢

**ç°è±¡**ï¼šåä½œè€…æ‰“å¼€ URLï¼Œé¡µé¢æ— å†…å®¹ã€‚

**åŸå› **ï¼šURL hash åœ¨å¤åˆ¶è¿‡ç¨‹ä¸­ä¸¢å¤±æˆ–è¢«æˆªæ–­ã€‚

**è§£å†³æ–¹æ³•**ï¼š
1. ç¡®ä¿å¤åˆ¶å®Œæ•´çš„ URLï¼ˆåŒ…æ‹¬ `#` åŠåé¢çš„æ‰€æœ‰å­—ç¬¦ï¼‰
2. ä¸è¦ä½¿ç”¨çŸ­é“¾æ¥æœåŠ¡ï¼ˆå¯èƒ½ä¼šæˆªæ–­ hashï¼‰
3. ä½¿ç”¨ Export Modal ä¸­çš„ Copy æŒ‰é’®ï¼Œè€Œä¸æ˜¯æ‰‹åŠ¨å¤åˆ¶

::: tip URL hash é•¿åº¦
åˆ†äº« URL çš„ hash éƒ¨åˆ†é€šå¸¸æœ‰æ•°åƒä¸ªå­—ç¬¦ï¼Œæ‰‹åŠ¨å¤åˆ¶å®¹æ˜“é—æ¼ã€‚å»ºè®®ä½¿ç”¨ Copy æŒ‰é’®æˆ–å¤åˆ¶ â†’ ç²˜è´´ä¸¤æ¬¡éªŒè¯å®Œæ•´æ€§ã€‚
:::

### é—®é¢˜ 3ï¼šURL å¤ªé•¿ï¼Œæ— æ³•å‘é€

**ç°è±¡**ï¼šURL è¶…è¿‡é€šè®¯å·¥å…·çš„å­—ç¬¦é™åˆ¶ï¼ˆå¦‚å¾®ä¿¡ã€Slackï¼‰ã€‚

**åŸå› **ï¼šè®¡åˆ’å†…å®¹è¿‡é•¿æˆ–æ³¨é‡Šæ•°é‡è¿‡å¤šã€‚

**è§£å†³æ–¹æ³•**ï¼š
1. åˆ é™¤ä¸å¿…è¦çš„æ³¨é‡Š
2. å‡å°‘å›¾ç‰‡é™„ä»¶
3. è€ƒè™‘ä½¿ç”¨ Raw Diff å¯¼å‡ºå¹¶ä¿å­˜ä¸ºæ–‡ä»¶
4. ä½¿ç”¨ä»£ç è¯„å®¡åŠŸèƒ½ï¼ˆdiff æ¨¡å¼çš„å‹ç¼©ç‡æ›´é«˜ï¼‰

### é—®é¢˜ 4ï¼šåä½œè€…çœ‹ä¸åˆ°æˆ‘çš„å›¾ç‰‡

**ç°è±¡**ï¼šåˆ†äº« URL åŒ…å«å›¾ç‰‡è·¯å¾„ï¼Œä½†åä½œè€…æ‰“å¼€åæ˜¾ç¤º "Image not found"ã€‚

**åŸå› **ï¼šå›¾ç‰‡ä¿å­˜åœ¨æœ¬åœ° `/tmp/plannotator/` ç›®å½•ï¼Œåä½œè€…æ— æ³•è®¿é—®ã€‚

**è§£å†³æ–¹æ³•**ï¼š
- Plannotator çš„ URL åˆ†äº«ä¸æ”¯æŒè·¨è®¾å¤‡å›¾ç‰‡è®¿é—®
- å»ºè®®ä½¿ç”¨ Obsidian é›†æˆï¼Œå›¾ç‰‡ä¿å­˜åˆ° vault åå¯ä»¥åˆ†äº«
- æˆ–è€…æˆªå›¾å¹¶åµŒå…¥åˆ°æ³¨é‡Šä¸­ï¼ˆæ–‡å­—æè¿°ï¼‰

æºç ä½ç½®ï¼š`packages/server/index.ts:163`ï¼ˆå›¾ç‰‡ä¿å­˜è·¯å¾„ï¼‰

### é—®é¢˜ 5ï¼šåˆ†äº«åä¿®æ”¹äº†æ³¨é‡Šï¼ŒURL æœªæ›´æ–°

**ç°è±¡**ï¼šæ·»åŠ æ–°æ³¨é‡Šåï¼ŒExport Modal ä¸­çš„ URL æ²¡æœ‰å˜åŒ–ã€‚

**åŸå› **ï¼š`shareUrl` çŠ¶æ€æœªè‡ªåŠ¨åˆ·æ–°ï¼ˆç½•è§æƒ…å†µï¼Œé€šå¸¸æ˜¯ React çŠ¶æ€æ›´æ–°é—®é¢˜ï¼‰ã€‚

**è§£å†³æ–¹æ³•**ï¼š
1. å…³é—­ Export Modal
2. é‡æ–°æ‰“å¼€ Export Modal
3. URL åº”è¯¥è‡ªåŠ¨æ›´æ–°ä¸ºæœ€æ–°å†…å®¹

æºç ä½ç½®ï¼š`packages/ui/hooks/useSharing.ts:128`ï¼ˆ`refreshShareUrl` å‡½æ•°ï¼‰

## æœ¬è¯¾å°ç»“

**URL åˆ†äº«åŠŸèƒ½**è®©ä½ æ— éœ€åç«¯æœåŠ¡å™¨å³å¯åˆ†äº«è®¡åˆ’å’Œæ³¨é‡Šï¼š

- âœ… **æ— åç«¯**ï¼šæ•°æ®å‹ç¼©åœ¨ URL hash ä¸­ï¼Œä¸ä¾èµ–æœåŠ¡å™¨
- âœ… **éšç§å®‰å…¨**ï¼šæ•°æ®ä¸ä¸Šä¼ ï¼Œåªåœ¨æœ¬åœ°å’Œåä½œè€…ä¹‹é—´ä¼ é€’
- âœ… **ç®€æ´é«˜æ•ˆ**ï¼šä¸€é”®ç”Ÿæˆ URLï¼Œå¤åˆ¶ç²˜è´´å³å¯åˆ†äº«
- âœ… **åªè¯»æ¨¡å¼**ï¼šåä½œè€…å¯ä»¥æŸ¥çœ‹å’Œæ·»åŠ æ³¨é‡Šï¼Œä½†æ— æ³•æäº¤å†³ç­–

**æŠ€æœ¯åŸç†**ï¼š
1. **Deflate-raw å‹ç¼©**ï¼šå°† JSON æ•°æ®å‹ç¼©çº¦ 60-80%
2. **Base64 ç¼–ç **ï¼šå°†äºŒè¿›åˆ¶æ•°æ®è½¬æ¢ä¸ºæ–‡æœ¬
3. **URL å®‰å…¨å­—ç¬¦æ›¿æ¢**ï¼š`+` â†’ `-`ã€`/` â†’ `_`ã€`=` â†’ `''`
4. **Hash è§£æ**ï¼šå‰ç«¯è‡ªåŠ¨è§£å‹å¹¶æ¢å¤å†…å®¹

**é…ç½®é€‰é¡¹**ï¼š
- `PLANNOTATOR_SHARE=disabled`ï¼šç¦ç”¨åˆ†äº«åŠŸèƒ½
- é»˜è®¤å¯ç”¨ï¼šåˆ†äº«åŠŸèƒ½å¯ç”¨

## ä¸‹ä¸€è¯¾é¢„å‘Š

> ä¸‹ä¸€è¯¾æˆ‘ä»¬å­¦ä¹  **[Obsidian é›†æˆ](../obsidian-integration/)**ã€‚
>
> ä½ ä¼šå­¦åˆ°ï¼š
> - è‡ªåŠ¨æ£€æµ‹ Obsidian vaults
> - å°†æ‰¹å‡†çš„è®¡åˆ’ä¿å­˜åˆ° Obsidian
> - è‡ªåŠ¨ç”Ÿæˆ frontmatter å’Œæ ‡ç­¾
> - ç»“åˆ URL åˆ†äº«å’Œ Obsidian çŸ¥è¯†ç®¡ç†

## ä¸‹ä¸€è¯¾é¢„å‘Š

> ä¸‹ä¸€è¯¾æˆ‘ä»¬å­¦ä¹  **[Obsidian é›†æˆ](../obsidian-integration/)**ã€‚
>
> ä½ ä¼šå­¦åˆ°ï¼š
> - å¦‚ä½•é…ç½® Obsidian é›†æˆï¼Œè‡ªåŠ¨ä¿å­˜è®¡åˆ’åˆ° vault
> - ç†è§£ frontmatter å’Œæ ‡ç­¾ç”Ÿæˆæœºåˆ¶
> - åˆ©ç”¨ backlink æ„å»ºçŸ¥è¯†å›¾è°±

---

## é™„å½•ï¼šæºç å‚è€ƒ

<details>
<summary><strong>ç‚¹å‡»å±•å¼€æŸ¥çœ‹æºç ä½ç½®</strong></summary>

> æ›´æ–°æ—¶é—´ï¼š2026-01-24

| åŠŸèƒ½ | æ–‡ä»¶è·¯å¾„ | è¡Œå· |
|--- | --- | ---|
| å‹ç¼©æ•°æ®ï¼ˆdeflate + Base64ï¼‰ | [`packages/ui/utils/sharing.ts`](https://github.com/backnotprop/plannotator/blob/main/packages/ui/utils/sharing.ts#L30-L48) | 30-48 |
| è§£å‹æ•°æ® | [`packages/ui/utils/sharing.ts`](https://github.com/backnotprop/plannotator/blob/main/packages/ui/utils/sharing.ts#L53-L71) | 53-71 |
| è½¬æ¢æ³¨é‡Šæ ¼å¼ï¼ˆç²¾ç®€ï¼‰ | [`packages/ui/utils/sharing.ts`](https://github.com/backnotprop/plannotator/blob/main/packages/ui/utils/sharing.ts#L76-L95) | 76-95 |
| æ¢å¤æ³¨é‡Šæ ¼å¼ | [`packages/ui/utils/sharing.ts`](https://github.com/backnotprop/plannotator/blob/main/packages/ui/utils/sharing.ts#L102-L155) | 102-155 |
| ç”Ÿæˆåˆ†äº« URL | [`packages/ui/utils/sharing.ts`](https://github.com/backnotprop/plannotator/blob/main/packages/ui/utils/sharing.ts#L162-L175) | 162-175 |
| è§£æ URL hash | [`packages/ui/utils/sharing.ts`](https://github.com/backnotprop/plannotator/blob/main/packages/ui/utils/sharing.ts#L181-L194) | 181-194 |
| URL å¤§å°æ ¼å¼åŒ– | [`packages/ui/utils/sharing.ts`](https://github.com/backnotprop/plannotator/blob/main/packages/ui/utils/sharing.ts#L199-L205) | 199-205 |
| URL åˆ†äº« Hook | [`packages/ui/hooks/useSharing.ts`](https://github.com/backnotprop/plannotator/blob/main/packages/ui/hooks/useSharing.ts#L45-L155) | 45-155 |
| Export Modal UI | [`packages/ui/components/ExportModal.tsx`](https://github.com/backnotprop/plannotator/blob/main/packages/ui/components/ExportModal.tsx#L1-L196) | 1-196 |
| åˆ†äº«å¼€å…³é…ç½®ï¼ˆHookï¼‰ | [`apps/hook/server/index.ts`](https://github.com/backnotprop/plannotator/blob/main/apps/hook/server/index.ts#L44) | 44 |
| åˆ†äº«å¼€å…³é…ç½®ï¼ˆOpenCodeï¼‰ | [`apps/opencode-plugin/index.ts`](https://github.com/backnotprop/plannotator/blob/main/apps/opencode-plugin/index.ts#L50) | 50 |

**å…³é”®å¸¸é‡**ï¼š
- `SHARE_BASE_URL = 'https://share.plannotator.ai'`ï¼šåˆ†äº«é¡µé¢åŸºç¡€åŸŸå

**å…³é”®å‡½æ•°**ï¼š
- `compress(payload: SharePayload): Promise<string>`ï¼šå‹ç¼© payload ä¸º base64url å­—ç¬¦ä¸²
- `decompress(b64: string): Promise<SharePayload>`ï¼šè§£å‹ base64url å­—ç¬¦ä¸²ä¸º payload
- `toShareable(annotations: Annotation[]): ShareableAnnotation[]`ï¼šå°†å®Œæ•´æ³¨é‡Šè½¬æ¢ä¸ºç²¾ç®€æ ¼å¼
- `fromShareable(data: ShareableAnnotation[]): Annotation[]`ï¼šå°†ç²¾ç®€æ ¼å¼æ¢å¤ä¸ºå®Œæ•´æ³¨é‡Š
- `generateShareUrl(markdown, annotations, attachments): Promise<string>`ï¼šç”Ÿæˆå®Œæ•´çš„åˆ†äº« URL
- `parseShareHash(): Promise<SharePayload | null>`ï¼šè§£æå½“å‰ URL çš„ hash

**æ•°æ®ç±»å‹**ï¼š
```typescript
interface SharePayload {
  p: string;  // plan markdown
  a: ShareableAnnotation[];
  g?: string[];  // global attachments
}

type ShareableAnnotation =
  | ['D', string, string | null, string[]?]  // Deletion
  | ['R', string, string, string | null, string[]?]  // Replacement
  | ['C', string, string, string | null, string[]?]  // Comment
  | ['I', string, string, string | null, string[]?]  // Insertion
  | ['G', string, string | null, string[]?];  // Global Comment
```

</details>
