---
title: "Google Search: è®© Gemini æœç´¢ç½‘ç»œ | Antigravity"
sidebarTitle: "è®© Gemini ä¸Šç½‘æŸ¥èµ„æ–™"
subtitle: "Google Search Groundingï¼šè®© Gemini æœç´¢ç½‘ç»œä¿¡æ¯"
description: "å­¦ä¹ ä¸º Gemini å¯ç”¨ Google Search Groundingï¼Œè®©æ¨¡å‹æœç´¢å®æ—¶ç½‘ç»œä¿¡æ¯ã€‚æŒæ¡é…ç½®æ–¹å¼å’Œé˜ˆå€¼è°ƒèŠ‚æŠ€å·§ï¼Œå¹³è¡¡å‡†ç¡®æ€§ä¸å“åº”é€Ÿåº¦ã€‚"
tags:
  - "gemini"
  - "google-search"
  - "grounding"
  - "é…ç½®"
prerequisite:
  - "start-quick-install"
  - "start-first-request"
order: 3
---

# Google Search Groundingï¼šè®© Gemini æœç´¢ç½‘ç»œä¿¡æ¯

## å­¦å®Œä½ èƒ½åšä»€ä¹ˆ

- ä¸º Gemini æ¨¡å‹å¯ç”¨ Google Searchï¼Œè®© AI èƒ½å¤Ÿæœç´¢å®æ—¶ç½‘ç»œä¿¡æ¯
- è°ƒèŠ‚æœç´¢é˜ˆå€¼ï¼Œæ§åˆ¶æ¨¡å‹æœç´¢çš„é¢‘ç‡
- ç†è§£ Google Search Grounding çš„å·¥ä½œåŸç†å’Œé€‚ç”¨åœºæ™¯
- æ ¹æ®ä»»åŠ¡éœ€æ±‚é€‰æ‹©åˆé€‚çš„é…ç½®

## ä½ ç°åœ¨çš„å›°å¢ƒ

::: info ä»€ä¹ˆæ˜¯ Google Search Groundingï¼Ÿ

**Google Search Grounding** æ˜¯ Gemini çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œå®ƒå…è®¸æ¨¡å‹åœ¨éœ€è¦æ—¶è‡ªåŠ¨æœç´¢ Googleï¼Œè·å–å®æ—¶ä¿¡æ¯ï¼ˆå¦‚æ–°é—»ã€ç»Ÿè®¡æ•°æ®ã€äº§å“ä»·æ ¼ç­‰ï¼‰ï¼Œè€Œä¸æ˜¯å®Œå…¨ä¾èµ–è®­ç»ƒæ•°æ®ã€‚

:::

ä½ ç”¨ Gemini é—®"ä»Šå¤©å¤©æ°”å¦‚ä½•"æˆ–"æœ€æ–°ç‰ˆ VS Code ç‰ˆæœ¬å·"ï¼Œæ¨¡å‹å¯èƒ½å›ç­”ä¸å‡ºæ¥ï¼Œå› ä¸ºå®ƒçš„è®­ç»ƒæ•°æ®å·²ç»è¿‡æ—¶äº†ã€‚å¯ç”¨ Google Search Grounding åï¼Œæ¨¡å‹å¯ä»¥è‡ªå·±ä¸Šç½‘æŸ¥ç­”æ¡ˆï¼Œå°±åƒä½ ç”¨æµè§ˆå™¨ä¸€æ ·ã€‚

## ä»€ä¹ˆæ—¶å€™ç”¨è¿™ä¸€æ‹›

| åœºæ™¯ | æ˜¯å¦éœ€è¦å¯ç”¨ | åŸå›  |
| ---- | ------------ | ---- |
| ä»£ç ç”Ÿæˆã€ç¼–ç¨‹é—®é¢˜ | âŒ ä¸éœ€è¦ | ç¼–ç¨‹çŸ¥è¯†ç›¸å¯¹ç¨³å®šï¼Œè®­ç»ƒæ•°æ®è¶³å¤Ÿ |
| è·å–æœ€æ–°èµ„è®¯ï¼ˆæ–°é—»ã€ä»·æ ¼ã€ç‰ˆæœ¬ï¼‰ | âœ… å¼ºçƒˆæ¨è | éœ€è¦å®æ—¶æ•°æ® |
| äº‹å®æ ¸æŸ¥ï¼ˆå…·ä½“æ—¥æœŸã€ç»Ÿè®¡ï¼‰ | âœ… æ¨è | é¿å…æ¨¡å‹ç¼–é€ ä¿¡æ¯ |
| åˆ›æ„å†™ä½œã€å¤´è„‘é£æš´ | âŒ ä¸éœ€è¦ | ä¸éœ€è¦äº‹å®å‡†ç¡®æ€§ |
| æŠ€æœ¯æ–‡æ¡£æŸ¥è¯¢ | âœ… æ¨è | æŸ¥æ‰¾æœ€æ–° API æ–‡æ¡£ |

## æ ¸å¿ƒæ€è·¯

Google Search Grounding çš„æ ¸å¿ƒæ˜¯è®©æ¨¡å‹**åœ¨éœ€è¦æ—¶**è‡ªåŠ¨æœç´¢ï¼Œè€Œä¸æ˜¯æ¯æ¬¡éƒ½æœç´¢ã€‚æ’ä»¶é€šè¿‡æ³¨å…¥ `googleSearchRetrieval` å·¥å…·ï¼Œè®© Gemini èƒ½å¤Ÿè°ƒç”¨ Google æœç´¢ APIã€‚

::: tip å…³é”®æ¦‚å¿µ

- **Auto æ¨¡å¼**ï¼šæ¨¡å‹è‡ªå·±å†³å®šæ˜¯å¦æœç´¢ï¼ˆæ ¹æ®é˜ˆå€¼ï¼‰
- **é˜ˆå€¼ï¼ˆgrounding_thresholdï¼‰**ï¼šæ§åˆ¶æ¨¡å‹æœç´¢çš„"é—¨æ§›"ã€‚å€¼è¶Šå°ï¼Œæœç´¢è¶Šé¢‘ç¹

:::

## ğŸ’ å¼€å§‹å‰çš„å‡†å¤‡

::: warning å‰ç½®æ£€æŸ¥

åœ¨å¼€å§‹å‰ï¼Œè¯·ç¡®è®¤ï¼š

 - [ ] å·²å®Œæˆ [å¿«é€Ÿå®‰è£…](../../start/quick-install/)
 - [ ] å·²æ·»åŠ è‡³å°‘ä¸€ä¸ª Google è´¦æˆ·
 - [ ] å·²æˆåŠŸå‘èµ·é¦–æ¬¡è¯·æ±‚ï¼ˆå‚è€ƒ [é¦–æ¬¡è¯·æ±‚](../../start/first-request/)ï¼‰

:::

## è·Ÿæˆ‘åš

### ç¬¬ 1 æ­¥ï¼šæ£€æŸ¥é…ç½®æ–‡ä»¶ä½ç½®

æ’ä»¶çš„é…ç½®æ–‡ä»¶ä½äºï¼š

- **macOS/Linux**: `~/.config/opencode/antigravity.json`
- **Windows**: `%APPDATA%\opencode\antigravity.json`

å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œå…ˆåˆ›å»ºå®ƒï¼š

```bash
# macOS/Linux
cat > ~/.config/opencode/antigravity.json << 'EOF'
{
  "$schema": "https://raw.githubusercontent.com/NoeFabris/opencode-antigravity-auth/main/assets/antigravity.schema.json"
}
EOF
```

```powershell
# Windows
@"
{
  "$schema": "https://raw.githubusercontent.com/NoeFabris/opencode-antigravity-auth/main/assets/antigravity.schema.json"
}
"@ | Out-File -FilePath "$env:APPDATA\opencode\antigravity.json" -Encoding utf8
```

**ä½ åº”è¯¥çœ‹åˆ°**ï¼šé…ç½®æ–‡ä»¶å·²åˆ›å»ºï¼ŒåŒ…å« `$schema` å­—æ®µ

### ç¬¬ 2 æ­¥ï¼šå¯ç”¨ Google Search

åœ¨é…ç½®æ–‡ä»¶ä¸­æ·»åŠ  `web_search` é…ç½®ï¼š

```json
{
  "$schema": "https://raw.githubusercontent.com/NoeFabris/opencode-antigravity-auth/main/assets/antigravity.schema.json",
  "web_search": {
    "default_mode": "auto",
    "grounding_threshold": 0.3
  }
}
```

**é…ç½®è¯´æ˜**ï¼š

| å­—æ®µ | å€¼ | è¯´æ˜ |
| ---- | --- | ---- |
| `web_search.default_mode` | `"auto"` æˆ– `"off"` | å¯ç”¨æˆ–ç¦ç”¨ Google Searchï¼Œé»˜è®¤ `"off"` |
| `web_search.grounding_threshold` | `0.0` - `1.0` | æœç´¢é˜ˆå€¼ï¼Œé»˜è®¤ `0.3`ï¼Œä»…åœ¨ `auto` æ¨¡å¼ç”Ÿæ•ˆ |

**ä½ åº”è¯¥çœ‹åˆ°**ï¼šé…ç½®æ–‡ä»¶å·²æ›´æ–°ï¼ŒåŒ…å« `web_search` é…ç½®

### ç¬¬ 3 æ­¥ï¼šè°ƒæ•´æœç´¢é˜ˆå€¼ï¼ˆå¯é€‰ï¼‰

`grounding_threshold` æ§åˆ¶æ¨¡å‹æœç´¢çš„é¢‘ç‡ï¼š

| é˜ˆå€¼ | è¡Œä¸º | é€‚ç”¨åœºæ™¯ |
| ---- | ---- | -------- |
| `0.0 - 0.2` | é¢‘ç¹æœç´¢ï¼Œå‡ ä¹æ¯æ¬¡ä¸ç¡®å®šéƒ½æœ | éœ€è¦é«˜åº¦å‡†ç¡®çš„å®æ—¶æ•°æ® |
| `0.3`ï¼ˆé»˜è®¤ï¼‰ | é€‚ä¸­ï¼Œæ¨¡å‹éœ€è¦è¾ƒç¡®ä¿¡æ‰ä¼šæœ | æ—¥å¸¸ä½¿ç”¨ï¼Œå¹³è¡¡å‡†ç¡®æ€§å’Œé€Ÿåº¦ |
| `0.7 - 1.0` | å¾ˆå°‘æœç´¢ï¼Œåªåœ¨é«˜ç½®ä¿¡åº¦æ—¶æœ | å‡å°‘æœç´¢æ¬¡æ•°ï¼Œæå‡é€Ÿåº¦ |

::: tip ç»éªŒä¹‹è°ˆ

ä»é»˜è®¤å€¼ `0.3` å¼€å§‹ï¼Œå¦‚æœå‘ç°ï¼š
- **æ¨¡å‹æ²¡æœç´¢** â†’ é™ä½é˜ˆå€¼ï¼ˆå¦‚ `0.2`ï¼‰
- **æœç´¢å¤ªé¢‘ç¹ï¼Œå“åº”æ…¢** â†’ æé«˜é˜ˆå€¼ï¼ˆå¦‚ `0.5`ï¼‰

:::

**ä½ åº”è¯¥çœ‹åˆ°**ï¼šé˜ˆå€¼å·²è°ƒæ•´ï¼Œå¯æ ¹æ®å®é™…ä½¿ç”¨ä½“éªŒä¼˜åŒ–

### ç¬¬ 4 æ­¥ï¼šéªŒè¯é…ç½®

é‡æ–°å¯åŠ¨ OpenCodeï¼Œæˆ–é‡æ–°åŠ è½½é…ç½®ï¼ˆå¦‚æœæ”¯æŒï¼‰ï¼Œç„¶åå‘èµ·ä¸€ä¸ªéœ€è¦å®æ—¶ä¿¡æ¯çš„è¯·æ±‚ï¼š

```
ç”¨æˆ·è¾“å…¥ï¼š
VS Code æœ€æ–°ç‰ˆæœ¬æ˜¯å¤šå°‘ï¼Ÿ

ç³»ç»Ÿå›å¤ï¼ˆå¯ç”¨ Google Searchï¼‰ï¼š
VS Code çš„æœ€æ–°ç¨³å®šç‰ˆæœ¬æ˜¯ 1.96.4ï¼ˆæˆªè‡³ 2026 å¹´ 1 æœˆï¼‰...

[citation:1] â† å¼•ç”¨æ¥æºæ ‡è®°
```

**ä½ åº”è¯¥çœ‹åˆ°**ï¼š
- æ¨¡å‹å›ç­”åŒ…å«å¼•ç”¨æ¥æºï¼ˆ`[citation:1]` ç­‰ï¼‰
- å›ç­”å†…å®¹æ˜¯æœ€æ–°çš„ï¼Œä¸æ˜¯è®­ç»ƒæ•°æ®ä¸­çš„æ—§ç‰ˆæœ¬

### ç¬¬ 5 æ­¥ï¼šæµ‹è¯•ä¸åŒé˜ˆå€¼

å°è¯•è°ƒæ•´ `grounding_threshold`ï¼Œè§‚å¯Ÿæ¨¡å‹è¡Œä¸ºå˜åŒ–ï¼š

```json
// ä½é˜ˆå€¼ï¼ˆé¢‘ç¹æœç´¢ï¼‰
"grounding_threshold": 0.1

// é«˜é˜ˆå€¼ï¼ˆå¾ˆå°‘æœç´¢ï¼‰
"grounding_threshold": 0.7
```

æ¯æ¬¡è°ƒæ•´åï¼Œç”¨ç›¸åŒé—®é¢˜æµ‹è¯•ï¼Œè§‚å¯Ÿï¼š
- æ˜¯å¦æœç´¢ï¼ˆæŸ¥çœ‹å“åº”æ˜¯å¦æœ‰å¼•ç”¨ï¼‰
- æœç´¢æ¬¡æ•°ï¼ˆå¤šä¸ª `citation`ï¼‰
- å“åº”é€Ÿåº¦

**ä½ åº”è¯¥çœ‹åˆ°**ï¼š
- ä½é˜ˆå€¼ï¼šæœç´¢æ›´é¢‘ç¹ï¼Œä½†å“åº”ç¨æ…¢
- é«˜é˜ˆå€¼ï¼šæœç´¢æ›´å°‘ï¼Œä½†å¯èƒ½å›ç­”ä¸å‡†ç¡®

## æ£€æŸ¥ç‚¹ âœ…

::: details ç‚¹å‡»å±•å¼€éªŒè¯æ¸…å•

å®Œæˆä»¥ä¸‹æ£€æŸ¥ï¼Œç¡®è®¤é…ç½®æ­£ç¡®ï¼š

- [ ] é…ç½®æ–‡ä»¶åŒ…å« `web_search` é…ç½®
- [ ] `default_mode` è®¾ç½®ä¸º `"auto"`
- [ ] `grounding_threshold` åœ¨ `0.0` åˆ° `1.0` ä¹‹é—´
- [ ] å‘èµ·éœ€è¦å®æ—¶ä¿¡æ¯çš„è¯·æ±‚ï¼Œæ¨¡å‹è¿”å›åŒ…å«å¼•ç”¨
- [ ] è°ƒæ•´é˜ˆå€¼åï¼Œæ¨¡å‹æœç´¢è¡Œä¸ºæœ‰å˜åŒ–

å¦‚æœå…¨éƒ¨é€šè¿‡ï¼Œè¯´æ˜ Google Search Grounding å·²æ­£ç¡®å¯ç”¨ï¼

:::

## è¸©å‘æé†’

### é—®é¢˜ 1ï¼šæ¨¡å‹æ²¡æœ‰æœç´¢

**ç—‡çŠ¶**ï¼šå¯ç”¨ `auto` æ¨¡å¼åï¼Œæ¨¡å‹ä»ç„¶æ²¡æœ‰æœç´¢ï¼Œä¹Ÿæ²¡æœ‰å¼•ç”¨æ¥æºã€‚

**åŸå› **ï¼š
- é˜ˆå€¼å¤ªé«˜ï¼ˆå¦‚ `0.9`ï¼‰ï¼Œæ¨¡å‹éœ€è¦æé«˜ç¡®ä¿¡åº¦æ‰æœç´¢
- é—®é¢˜æœ¬èº«ä¸éœ€è¦æœç´¢ï¼ˆå¦‚ç¼–ç¨‹é—®é¢˜ï¼‰

**è§£å†³æ–¹æ³•**ï¼š
- é™ä½ `grounding_threshold` åˆ° `0.2` æˆ–æ›´ä½
- ç”¨æ˜ç¡®éœ€è¦å®æ—¶ä¿¡æ¯çš„é—®é¢˜æµ‹è¯•ï¼ˆå¦‚"ä»Šå¤©å¤©æ°”å¦‚ä½•"ã€"æœ€æ–°æ–°é—»"ï¼‰

### é—®é¢˜ 2ï¼šæœç´¢å¤ªé¢‘ç¹ï¼Œå“åº”æ…¢

**ç—‡çŠ¶**ï¼šæ¯ä¸ªé—®é¢˜éƒ½æœç´¢ï¼Œå“åº”æ—¶é—´æ˜æ˜¾å¢åŠ ã€‚

**åŸå› **ï¼š
- é˜ˆå€¼å¤ªä½ï¼ˆå¦‚ `0.1`ï¼‰ï¼Œæ¨¡å‹è¿‡äºé¢‘ç¹è§¦å‘æœç´¢
- é—®é¢˜ç±»å‹æœ¬èº«éœ€è¦å®æ—¶ä¿¡æ¯ï¼ˆå¦‚è‚¡ç¥¨ä»·æ ¼ã€æ–°é—»ï¼‰

**è§£å†³æ–¹æ³•**ï¼š
- æé«˜ `grounding_threshold` åˆ° `0.5` æˆ–æ›´é«˜
- å¦‚æœä»»åŠ¡ä¸éœ€è¦å®æ—¶ä¿¡æ¯ï¼Œå°† `default_mode` æ”¹ä¸º `"off"`

### é—®é¢˜ 3ï¼šé…ç½®æ–‡ä»¶æ ¼å¼é”™è¯¯

**ç—‡çŠ¶**ï¼šæ’ä»¶æŠ¥é”™ï¼Œæ— æ³•åŠ è½½é…ç½®ã€‚

**åŸå› **ï¼šJSON æ ¼å¼é”™è¯¯ï¼ˆå¦‚å¤šä½™çš„é€—å·ã€å¼•å·ä¸åŒ¹é…ï¼‰ã€‚

**è§£å†³æ–¹æ³•**ï¼šä½¿ç”¨ JSON éªŒè¯å·¥å…·æ£€æŸ¥é…ç½®æ–‡ä»¶ï¼Œç¡®ä¿æ ¼å¼æ­£ç¡®ã€‚

```bash
# éªŒè¯ JSON æ ¼å¼
cat ~/.config/opencode/antigravity.json | python3 -m json.tool
```

## æœ¬è¯¾å°ç»“

- **Google Search Grounding** è®© Gemini æ¨¡å‹èƒ½å¤Ÿæœç´¢å®æ—¶ç½‘ç»œä¿¡æ¯
- é€šè¿‡ `web_search.default_mode: "auto"` å¯ç”¨ï¼Œ`"off"` ç¦ç”¨
- `grounding_threshold` æ§åˆ¶æœç´¢é¢‘ç‡ï¼šå€¼è¶Šå°ï¼Œæœç´¢è¶Šé¢‘ç¹
- é»˜è®¤é˜ˆå€¼ `0.3` é€‚åˆå¤§å¤šæ•°åœºæ™¯ï¼Œå¯æ ¹æ®å®é™…ä½“éªŒè°ƒæ•´
- æ¨¡å‹ä¼šåœ¨å›ç­”ä¸­å¼•ç”¨æ¥æºï¼Œæ ‡è®°ä¸º `[citation:1]` ç­‰

## ä¸‹ä¸€è¯¾é¢„å‘Š

> ä¸‹ä¸€è¯¾æˆ‘ä»¬å­¦ä¹  **[åŒé…é¢ç³»ç»Ÿ](../dual-quota-system/)**ã€‚
>
> ä½ ä¼šå­¦åˆ°ï¼š
> - Antigravity å’Œ Gemini CLI ä¸¤ä¸ªç‹¬ç«‹é…é¢æ± å¦‚ä½•å·¥ä½œ
> - å¦‚ä½•åœ¨é…é¢æ± ä¹‹é—´åˆ‡æ¢ï¼Œæœ€å¤§åŒ–åˆ©ç”¨ç‡
> - é…é¢æ± åŒ–çš„æœ€ä½³å®è·µ

---

## é™„å½•ï¼šæºç å‚è€ƒ

<details>
<summary><strong>ç‚¹å‡»å±•å¼€æŸ¥çœ‹æºç ä½ç½®</strong></summary>

> æ›´æ–°æ—¶é—´ï¼š2026-01-23

| åŠŸèƒ½ | æ–‡ä»¶è·¯å¾„ | è¡Œå· |
| ---- | -------- | ---- |
| Google Search é…ç½® Schema | [`src/plugin/config/schema.ts`](https://github.com/NoeFabris/opencode-antigravity-auth/blob/main/src/plugin/config/schema.ts) | 303-319 |
| Google Search ç±»å‹å®šä¹‰ | [`src/plugin/transform/types.ts`](https://github.com/NoeFabris/opencode-antigravity-auth/blob/main/src/plugin/transform/types.ts) | 85-88 |
| Google Search æ³¨å…¥é€»è¾‘ | [`src/plugin/transform/gemini.ts`](https://github.com/NoeFabris/opencode-antigravity-auth/blob/main/src/plugin/transform/gemini.ts) | 402-419 |
| Google Search é…ç½®åŠ è½½ | [`src/plugin/config/loader.ts`](https://github.com/NoeFabris/opencode-antigravity-auth/blob/main/src/plugin/config/loader.ts) | 173-184 |
| Google Search é…ç½®åº”ç”¨ | [`src/plugin.ts`](https://github.com/NoeFabris/opencode-antigravity-auth/blob/main/src/plugin.ts) | 1194-1196 |

**å…³é”®é…ç½®é¡¹**ï¼š

- `web_search.default_mode`: `"auto"` æˆ– `"off"`ï¼Œé»˜è®¤ `"off"`
- `web_search.grounding_threshold`: `0.0` - `1.0`ï¼Œé»˜è®¤ `0.3`

**å…³é”®å‡½æ•°**ï¼š

- `applyGeminiTransforms()`ï¼šåº”ç”¨æ‰€æœ‰ Gemini è½¬æ¢ï¼ŒåŒ…æ‹¬ Google Search æ³¨å…¥
- `normalizeGeminiTools()`ï¼šè§„èŒƒåŒ–å·¥å…·æ ¼å¼ï¼Œä¿ç•™ `googleSearchRetrieval` å·¥å…·
- `wrapToolsAsFunctionDeclarations()`ï¼šå°†å·¥å…·åŒ…è£…ä¸º `functionDeclarations` æ ¼å¼

**å·¥ä½œåŸç†**ï¼š

1. æ’ä»¶ä»é…ç½®æ–‡ä»¶è¯»å– `web_search.default_mode` å’Œ `web_search.grounding_threshold`
2. å½“ `mode === "auto"` æ—¶ï¼Œåœ¨è¯·æ±‚çš„ `tools` æ•°ç»„ä¸­æ³¨å…¥ `googleSearchRetrieval` å·¥å…·ï¼š
   ```json
   {
     "googleSearchRetrieval": {
       "dynamicRetrievalConfig": {
         "mode": "MODE_DYNAMIC",
         "dynamicThreshold": 0.3  // grounding_threshold
       }
     }
   }
   ```
3. Gemini æ¨¡å‹æ ¹æ®é˜ˆå€¼å†³å®šæ˜¯å¦è°ƒç”¨æœç´¢å·¥å…·
4. æœç´¢ç»“æœä¼šåŒ…å«åœ¨å“åº”ä¸­ï¼Œå¹¶æ ‡è®°å¼•ç”¨æ¥æºï¼ˆ`[citation:1]` ç­‰ï¼‰

</details>
