---
title: "ç›£æ§æ’éšœ: è«‹æ±‚æ—¥èªŒåˆ†æ | Antigravity-Manager"
sidebarTitle: "è«‹æ±‚æ—¥èªŒæŸ¥éŒ¯"
subtitle: "ç›£æ§æ’éšœ: è«‹æ±‚æ—¥èªŒåˆ†æ"
description: "å­¸ç¿’ Antigravity Tools çš„ Proxy Monitor ç›£æ§æ’éšœã€‚é€éè«‹æ±‚æ—¥èªŒã€ç¯©é¸å’Œè©³æƒ…é‚„åŸåŠŸèƒ½ï¼Œå®šä½ 401/429/5xx éŒ¯èª¤èˆ‡æµå¼ä¸­æ–·å•é¡Œã€‚"
tags:
  - "é€²éš"
  - "ç›£æ§"
  - "æ’éšœ"
  - "Proxy"
  - "æ—¥èªŒ"
prerequisite:
  - "start-proxy-and-first-client"
  - "start-first-run-data"
  - "advanced-config"
order: 6
---

# Proxy Monitorï¼šè«‹æ±‚æ—¥èªŒã€ç¯©é¸ã€è©³æƒ…é‚„åŸèˆ‡åŒ¯å‡º

ä½ å·²ç¶“æŠŠæœ¬åœ°åä»£è·‘èµ·ä¾†äº†ï¼Œä½†ä¸€æ—¦å‡ºç¾ 401/429/500ã€æµå¼ä¸­æ–·ã€æˆ–è€…ã€Œæ€éº¼çªç„¶æ›äº†å¸³è™Ÿ/æ›äº†æ¨¡å‹ã€ï¼Œæ’éšœå°±å¾ˆå®¹æ˜“è®Šæˆç›²çŒœã€‚

é€™ç¯€èª²åªè¬›ä¸€ä»¶äº‹ï¼šç”¨ **Proxy Monitor** æŠŠæ¯æ¬¡å‘¼å«é‚„åŸæˆã€Œå¯è¦†ç›¤çš„è­‰æ“šã€ï¼Œè®“ä½ çŸ¥é“è«‹æ±‚å¾å“ªä¾†ã€æ‰“åˆ°å“ªå€‹ç«¯é»ã€ç”¨äº†å“ªå€‹å¸³è™Ÿã€æ¨¡å‹æœ‰æ²’æœ‰è¢«æ˜ å°„ã€ä»¥åŠ Token æ¶ˆè€—å¤§æ¦‚æ˜¯å¤šå°‘ã€‚

## å­¸å®Œä½ èƒ½åšä»€éº¼

- åœ¨ `/monitor` é é¢æ‰“é–‹/æš«åœéŒ„è£½ï¼Œä¸¦ç†è§£å®ƒæœƒä¸æœƒå½±éŸ¿ Token Stats
- ç”¨æœå°‹æ¡†ã€å¿«é€Ÿç¯©é¸ã€å¸³è™Ÿç¯©é¸ï¼Œå¿«é€Ÿå®šä½ä¸€æ¢è«‹æ±‚è¨˜éŒ„
- åœ¨è©³æƒ…å½ˆçª—è£¡æŸ¥çœ‹ä¸¦è¤‡è£½ Request/Response å ±æ–‡ï¼Œè¦†ç›¤å¤±æ•—åŸå› 
- çŸ¥é“ Proxy Monitor çš„è³‡æ–™è½ç›¤ä½ç½®ï¼ˆ`proxy_logs.db`ï¼‰èˆ‡æ¸…ç©ºè¡Œç‚º
- äº†è§£ç›®å‰ç‰ˆæœ¬ã€ŒåŒ¯å‡ºæ—¥èªŒã€çš„çœŸå¯¦èƒ½åŠ›é‚Šç•Œï¼ˆGUI vs å¾Œç«¯æŒ‡ä»¤ï¼‰

## ä½ ç¾åœ¨çš„å›°å¢ƒ

- ä½ åªçœ‹åˆ°ã€Œå‘¼å«å¤±æ•—/é€¾æ™‚ã€ï¼Œä½†ä¸çŸ¥é“åˆ°åº•å¤±æ•—åœ¨ä¸Šæ¸¸ã€ä»£ç†ã€é‚„æ˜¯å®¢æˆ¶ç«¯è¨­å®š
- ä½ æ‡·ç–‘è§¸ç™¼äº†æ¨¡å‹æ˜ å°„æˆ–å¸³è™Ÿè¼ªæ›¿ï¼Œä½†æ²’æœ‰è­‰æ“šéˆ
- ä½ æƒ³è¦†ç›¤ä¸€æ¢è«‹æ±‚çš„å®Œæ•´ payloadï¼ˆå°¤å…¶æ˜¯æµå¼/Thinkingï¼‰ï¼Œä½†æ—¥èªŒè£¡çœ‹ä¸åˆ°

## ä»€éº¼æ™‚å€™ç”¨é€™ä¸€æ‹›

- ä½ è¦æ’æŸ¥ï¼š401 é‘‘æ¬Šå¤±æ•—ã€429 é™æµã€5xx ä¸Šæ¸¸éŒ¯èª¤ã€æµå¼ä¸­æ–·
- ä½ æƒ³ç¢ºèªï¼šæŸæ¬¡è«‹æ±‚åˆ°åº•ç”¨äº†å“ªå€‹å¸³è™Ÿï¼ˆ`X-Account-Email`ï¼‰
- ä½ åœ¨åšæ¨¡å‹è·¯ç”±ç­–ç•¥ï¼Œæƒ³é©—è­‰ã€Œå®¢æˆ¶ç«¯æ¨¡å‹å -> å¯¦éš›æ˜ å°„æ¨¡å‹åã€

## ğŸ’ é–‹å§‹å‰çš„æº–å‚™

::: warning å‰ç½®æ¢ä»¶
Proxy Monitor è¨˜éŒ„çš„æ˜¯ã€Œåä»£æœå‹™æ”¶åˆ°çš„è«‹æ±‚ã€ã€‚æ‰€ä»¥ä½ è‡³å°‘è¦å…ˆè·‘é€šï¼š

- åä»£æœå‹™å·²å•Ÿå‹•ï¼Œä¸¦èƒ½å­˜å– `/healthz`
- ä½ çŸ¥é“ç›®å‰åä»£çš„ Base URL å’Œé€£æ¥åŸ 

å¦‚æœé‚„æ²’è·‘é€šï¼Œå…ˆçœ‹ **[å•Ÿå‹•æœ¬åœ°åä»£ä¸¦æ¥å…¥ç¬¬ä¸€å€‹å®¢æˆ¶ç«¯](/zh-tw/lbjlaq/Antigravity-Manager/start/proxy-and-first-client/)**ã€‚
:::

## ä»€éº¼æ˜¯ Proxy Monitorï¼Ÿ

**Proxy Monitor** æ˜¯ Antigravity Tools å…§å»ºçš„ã€Œè«‹æ±‚æ—¥èªŒçœ‹æ¿ã€ã€‚æ¯æ¬¡è«‹æ±‚é€²åˆ°æœ¬åœ°åä»£å¾Œï¼Œå®ƒæœƒè¨˜éŒ„æ™‚é–“ã€è·¯å¾‘ã€ç‹€æ…‹ç¢¼ã€è€—æ™‚ã€æ¨¡å‹èˆ‡å”å®šï¼Œä¸¦ç›¡é‡å¾å›æ‡‰è£¡æå– Token ç”¨é‡ï¼›ä½ é‚„èƒ½é»é–‹å–®æ¢è¨˜éŒ„æŸ¥çœ‹è«‹æ±‚èˆ‡å›æ‡‰å ±æ–‡ï¼Œç”¨å®ƒä¾†è¦†ç›¤å¤±æ•—åŸå› å’Œè·¯ç”±/å¸³è™Ÿé¸æ“‡çµæœã€‚

::: info è³‡æ–™è½ç›¤ä½ç½®
Proxy Monitor çš„æ—¥èªŒæœƒå¯«å…¥è³‡æ–™ç›®éŒ„ä¸‹çš„ SQLiteï¼š`proxy_logs.db`ã€‚è³‡æ–™ç›®éŒ„æ€éº¼æ‰¾ã€æ€éº¼å‚™ä»½ï¼Œå»ºè­°å…ˆè¤‡ç¿’ **[é¦–æ¬¡å•Ÿå‹•å¿…æ‡‚ï¼šè³‡æ–™ç›®éŒ„ã€æ—¥èªŒã€ç³»çµ±æ‰˜ç›¤èˆ‡è‡ªå‹•å•Ÿå‹•](/zh-tw/lbjlaq/Antigravity-Manager/start/first-run-data/)**ã€‚
:::

## æ ¸å¿ƒæ€è·¯ï¼šä½ éœ€è¦ç›¯ä½çš„ 6 å€‹æ¬„ä½

Proxy Monitor çš„ä¸€æ¢è¨˜éŒ„ï¼ˆå¾Œç«¯çµæ§‹é«” `ProxyRequestLog`ï¼‰è£¡ï¼Œæœ€å¯¦ç”¨çš„æ˜¯ä¸‹é¢é€™äº›æ¬„ä½ï¼š

| æ¬„ä½ | ä½ ç”¨å®ƒå›ç­”ä»€éº¼å•é¡Œ |
|--- | ---|
| `status` | é€™æ¬¡è«‹æ±‚æ˜¯æˆåŠŸé‚„æ˜¯å¤±æ•—ï¼ˆ200-399 vs å…¶ä»–ï¼‰ |
| `url` / `method` | ä½ åˆ°åº•æ‰“åˆ°äº†å“ªå€‹ç«¯é»ï¼ˆä¾‹å¦‚ `/v1/messages`ã€`/v1/chat/completions`ï¼‰ |
| `protocol` | é€™æ˜¯ OpenAI / Claude(Anthropic) / Gemini å“ªå¥—å”å®š |
| `account_email` | é€™æ¬¡è«‹æ±‚æœ€çµ‚ç”¨äº†å“ªå€‹å¸³è™Ÿï¼ˆä¾†è‡ª `X-Account-Email` å›æ‡‰æ¨™é ­ï¼‰ |
| `model` / `mapped_model` | å®¢æˆ¶ç«¯è«‹æ±‚çš„æ¨¡å‹åæœ‰æ²’æœ‰è¢«ã€Œè·¯ç”±/æ˜ å°„ã€æˆå¦ä¸€å€‹æ¨¡å‹ |
| `input_tokens` / `output_tokens` | é€™æ¬¡è«‹æ±‚çš„ Token ç”¨é‡ï¼ˆèƒ½æå–åˆ°æ‰æœ‰ï¼‰ |

::: tip å…ˆç”¨ã€Œæ‘˜è¦ã€ï¼Œéœ€è¦æ™‚å†é»ã€Œè©³æƒ…ã€
åˆ—è¡¨é åªå±•ç¤ºæ‘˜è¦ï¼ˆä¸å¸¶ request/response bodyï¼‰ï¼Œé»é–‹ä¸€æ¢è¨˜éŒ„æ‰æœƒå»å¾Œç«¯è¼‰å…¥å®Œæ•´è©³æƒ…ï¼Œé¿å…åˆ—è¡¨ä¸€æ¬¡æ€§æ‹‰å¤ªå¤šå¤§æ¬„ä½ã€‚
:::

## è·Ÿæˆ‘åšï¼šç”¨ä¸€æ¬¡å‘¼å«è·‘é€šã€Œç›£æ§é–‰ç’°ã€

### ç¬¬ 1 æ­¥ï¼šå…ˆè£½é€ ä¸€æ¢ã€Œä½ ç¢ºå®šæœƒå‡ºç¾ã€çš„è«‹æ±‚

**ç‚ºä»€éº¼**
Proxy Monitor åªè¨˜éŒ„åä»£æœå‹™æ”¶åˆ°çš„è«‹æ±‚ã€‚å…ˆç”¨ä¸€å€‹æœ€ç°¡å–®çš„è«‹æ±‚æŠŠã€Œæœ‰æ²’æœ‰è¨˜éŒ„ã€é€™ä»¶äº‹é©—è­‰æ‰ï¼Œå¾Œé¢æ‰è«‡ç¯©é¸å’Œè©³æƒ…ã€‚

::: code-group

```bash [macOS/Linux]
## 1) æ¢æ´»ï¼ˆä¸€å®šå­˜åœ¨çš„ç«¯é»ï¼‰
curl "http://127.0.0.1:PORT/healthz"

## 2) å†è«‹æ±‚ä¸€æ¬¡ modelsï¼ˆå¦‚æœä½ é–‹å•Ÿäº†é‘‘æ¬Šï¼Œè¨˜å¾—åŠ  headerï¼‰
curl "http://127.0.0.1:PORT/v1/models"
```

```powershell [Windows]
## 1) æ¢æ´»ï¼ˆä¸€å®šå­˜åœ¨çš„ç«¯é»ï¼‰
curl "http://127.0.0.1:PORT/healthz"

## 2) å†è«‹æ±‚ä¸€æ¬¡ modelsï¼ˆå¦‚æœä½ é–‹å•Ÿäº†é‘‘æ¬Šï¼Œè¨˜å¾—åŠ  headerï¼‰
curl "http://127.0.0.1:PORT/v1/models"
```

:::

**ä½ æ‡‰è©²çœ‹åˆ°**ï¼šçµ‚ç«¯è¿”å› `{"status":"ok"}`ï¼ˆæˆ–é¡ä¼¼ JSONï¼‰ï¼Œä»¥åŠ `/v1/models` çš„å›æ‡‰ï¼ˆæˆåŠŸæˆ– 401 éƒ½è¡Œï¼‰ã€‚

### ç¬¬ 2 æ­¥ï¼šé–‹å•Ÿ Monitor é é¢ä¸¦ç¢ºèªã€ŒéŒ„è£½ç‹€æ…‹ã€

**ç‚ºä»€éº¼**
Proxy Monitor æœ‰ã€ŒéŒ„è£½/æš«åœã€é–‹é—œã€‚ä½ éœ€è¦å…ˆç¢ºèªç›®å‰ç‹€æ…‹ï¼Œå¦å‰‡ä½ å¯èƒ½ä¸€ç›´åœ¨è«‹æ±‚ï¼Œä½†åˆ—è¡¨æ°¸é æ˜¯ç©ºçš„ã€‚

åœ¨ Antigravity Tools è£¡é–‹å•Ÿå´é‚Šæ¬„çš„ **API ç›£æ§çœ‹æ¿**ï¼ˆè·¯ç”±ç‚º `/monitor`ï¼‰ã€‚

é é¢é ‚éƒ¨æœƒæœ‰ä¸€å€‹å¸¶åœ“é»çš„æŒ‰éˆ•ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â— æ­£åœ¨éŒ„è£½   [æœå°‹æ¡†]  [é‡æ–°æ•´ç†] [æ¸…é™¤]      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

å¦‚æœä½ çœ‹åˆ°çš„æ˜¯ã€Œå·²æš«åœã€ï¼Œé»ä¸€ä¸‹åˆ‡æ›åˆ°ã€Œæ­£åœ¨éŒ„è£½ã€ã€‚

**ä½ æ‡‰è©²çœ‹åˆ°**ï¼šæŒ‰éˆ•ç‹€æ…‹è®Šæˆã€Œæ­£åœ¨éŒ„è£½ã€ï¼›åˆ—è¡¨è£¡é–‹å§‹å‡ºç¾å‰›æ‰çš„è«‹æ±‚è¨˜éŒ„ã€‚

### ç¬¬ 3 æ­¥ï¼šç”¨ã€Œæœå°‹ + å¿«é€Ÿç¯©é¸ã€å®šä½ä¸€æ¢è¨˜éŒ„

**ç‚ºä»€éº¼**
çœŸå¯¦æ’éšœæ™‚ï¼Œä½ é€šå¸¸åªè¨˜å¾—ä¸€å€‹ç‰‡æ®µï¼šè·¯å¾‘è£¡æœ‰ `messages`ï¼Œæˆ–è€…ç‹€æ…‹ç¢¼æ˜¯ `401`ï¼Œæˆ–è€…æ¨¡å‹åè£¡æœ‰ `gemini`ã€‚æœå°‹æ¡†å°±æ˜¯ç‚ºé€™ç¨®è¨˜æ†¶è¨­è¨ˆçš„ã€‚

Proxy Monitor çš„æœå°‹ï¼ŒæœƒæŠŠä½ çš„è¼¸å…¥ç•¶æˆä¸€å€‹ã€Œæ¨¡ç³Šé—œéµå­—ã€ï¼Œåœ¨å¾Œç«¯ç”¨ SQL `LIKE` åŒ¹é…é€™äº›æ¬„ä½ï¼š

- `url`
- `method`
- `model`
- `status`
- `account_email`

ä½ å¯ä»¥è©¦å¹¾å€‹å…¸å‹é—œéµå­—ï¼š

- `healthz`
- `models`
- `401`ï¼ˆå¦‚æœä½ å‰›å¥½è£½é€ äº†ä¸€å€‹ 401ï¼‰

ä¹Ÿå¯ä»¥é»ã€Œå¿«é€Ÿéæ¿¾ã€æŒ‰éˆ•ï¼š**åƒ…éŒ¯èª¤ / Chat / Gemini / Claude / ç¹ªåœ–**ã€‚

**ä½ æ‡‰è©²çœ‹åˆ°**ï¼šåˆ—è¡¨åªå‰©ä¸‹ä½ æœŸæœ›çš„é‚£ä¸€é¡è«‹æ±‚ã€‚

### ç¬¬ 4 æ­¥ï¼šé»é–‹è©³æƒ…ï¼Œé‚„åŸã€Œè«‹æ±‚å ±æ–‡ + å›æ‡‰å ±æ–‡ã€

**ç‚ºä»€éº¼**
åˆ—è¡¨åªå¤ å›ç­”ã€Œç™¼ç”Ÿäº†ä»€éº¼ã€ã€‚è¦å›ç­”ã€Œç‚ºä»€éº¼ã€ï¼Œä½ é€šå¸¸éœ€è¦çœ‹å®Œæ•´è«‹æ±‚/å›æ‡‰ payloadã€‚

é»é–‹ä»»æ„ä¸€æ¢è¨˜éŒ„ï¼Œæœƒå½ˆå‡ºè©³æƒ…è¦–çª—ã€‚ä½ å¯ä»¥é‡é»æª¢æŸ¥ï¼š

- `å”å®š`ï¼ˆOpenAI/Claude/Geminiï¼‰
- `ä½¿ç”¨æ¨¡å‹` èˆ‡ `æ˜ å°„æ¨¡å‹`
- `ä½¿ç”¨å¸³è™Ÿ`
- `Token æ¶ˆè€— (è¼¸å…¥/è¼¸å‡º)`

ç„¶å¾Œç”¨æŒ‰éˆ•è¤‡è£½ï¼š

- `è«‹æ±‚å ±æ–‡ (Request)`
- `å›æ‡‰å ±æ–‡ (Response)`

**ä½ æ‡‰è©²çœ‹åˆ°**ï¼šè©³æƒ…è£¡æœ‰å…©å¡Š JSONï¼ˆæˆ–æ–‡å­—ï¼‰é è¦½ï¼›è¤‡è£½å¾Œä½ å¯ä»¥è²¼åˆ°å·¥å–®/ç­†è¨˜è£¡åšè¦†ç›¤ã€‚

### ç¬¬ 5 æ­¥ï¼šéœ€è¦ã€Œå¾é›¶é–‹å§‹é‡ç¾ã€æ™‚ï¼Œæ¸…ç©ºæ—¥èªŒ

**ç‚ºä»€éº¼**
æ’éšœæ™‚æœ€æ€•ã€ŒèˆŠè³‡æ–™å¹²æ“¾åˆ¤æ–·ã€ã€‚æ¸…ç©ºå¾Œé‡ç¾ä¸€æ¬¡ï¼ŒæˆåŠŸ/å¤±æ•—æœƒéå¸¸æ¸…æ¥šã€‚

é»æ“Šé ‚éƒ¨çš„ã€Œæ¸…é™¤ã€æŒ‰éˆ•ï¼Œæœƒå½ˆå‡ºç¢ºèªæ¡†ã€‚

::: danger é€™æ˜¯ä¸å¯é€†æ“ä½œ
æ¸…é™¤æœƒåˆªé™¤ `proxy_logs.db` è£¡çš„æ‰€æœ‰è¨˜éŒ„ã€‚
:::

**ä½ æ‡‰è©²çœ‹åˆ°**ï¼šç¢ºèªå¾Œåˆ—è¡¨æ¸…ç©ºï¼Œçµ±è¨ˆæ•¸å­—å›åˆ° 0ã€‚

## æª¢æŸ¥é» âœ…

- [ ] ä½ èƒ½åœ¨ `/monitor` çœ‹åˆ°è‡ªå·±å‰›ç™¼å‡ºçš„ `/healthz` æˆ– `/v1/models` è¨˜éŒ„
- [ ] ä½ èƒ½ç”¨æœå°‹æ¡†æŠŠæŸæ¢è¨˜éŒ„ç¯©å‡ºä¾†ï¼ˆä¾‹å¦‚è¼¸å…¥ `healthz`ï¼‰
- [ ] ä½ èƒ½é»é–‹ä¸€æ¢è¨˜éŒ„çœ‹åˆ°è«‹æ±‚/å›æ‡‰å ±æ–‡ï¼Œä¸¦è¤‡è£½å‡ºä¾†
- [ ] ä½ çŸ¥é“æ¸…ç©ºæ—¥èªŒæœƒç›´æ¥åˆªé™¤æ‰€æœ‰æ­·å²è¨˜éŒ„

## è¸©å‘æé†’

| å ´æ™¯ | ä½ å¯èƒ½æœƒæ€éº¼ç†è§£ï¼ˆâŒï¼‰ | å¯¦éš›è¡¨ç¾ï¼ˆâœ“ï¼‰ |
|--- | --- | ---|
| "å·²æš«åœ"= å®Œå…¨æ²’æœ‰ç›£æ§é–‹éŠ· | ä»¥ç‚ºæš«åœå¾Œè«‹æ±‚å°±ä¸æœƒè¢«è§£æ | æš«åœåªå½±éŸ¿ã€Œæ˜¯å¦å¯«å…¥ Proxy Monitor æ—¥èªŒã€ã€‚ä½†è«‹æ±‚/å›æ‡‰è§£æï¼ˆåŒ…æ‹¬æµå¼è³‡æ–™çš„ SSE è§£æï¼‰ä»æœƒç™¼ç”Ÿï¼Œåªæ˜¯è§£æå¾Œçš„è³‡æ–™ä¸è¢«å„²å­˜ã€‚Token Stats ä¹Ÿä»æœƒè¨˜éŒ„ï¼ˆç„¡è«–ç›£æ§æ˜¯å¦å•Ÿç”¨ï¼‰ã€‚ |
| äºŒé€²ä½/å¤§å°åŒ…æ—¥èªŒç‚ºç©º | ä»¥ç‚ºæ˜¯ç›£æ§å£äº† | äºŒé€²ä½è«‹æ±‚/å›æ‡‰æœƒé¡¯ç¤ºç‚º `[Binary Request Data]` / `[Binary Response Data]`ã€‚å›æ‡‰é«”è¶…é 100MB æœƒæ¨™è¨˜ç‚º `[Response too large (>100MB)]`ï¼›è«‹æ±‚é«”è¶…éé™åˆ¶å‰‡ä¸è¨˜éŒ„ã€‚ |
| æƒ³ç”¨ Monitor æ‰¾åˆ°ã€Œèª°ç™¼èµ·äº†è«‹æ±‚ã€ | ä»¥ç‚ºèƒ½è¿½æº¯åˆ°å®¢æˆ¶ç«¯ç¨‹åº | Monitor è¨˜éŒ„çš„æ˜¯ HTTP å±¤è³‡è¨Šï¼ˆæ–¹æ³•/è·¯å¾‘/æ¨¡å‹/å¸³è™Ÿï¼‰ï¼Œä¸åŒ…å«ã€Œå‘¼å«æ–¹ç¨‹åºåã€ã€‚ä½ éœ€è¦çµåˆå®¢æˆ¶ç«¯è‡ªèº«æ—¥èªŒæˆ–ç³»çµ±ç¶²è·¯æŠ“åŒ…å®šä½ä¾†æºã€‚ |
| å•Ÿç”¨ç›£æ§æ™‚ Token Stats è³‡æ–™ç•°å¸¸ | ä»¥ç‚ºæ˜¯çµ±è¨ˆéŒ¯èª¤ | ç›£æ§å•Ÿç”¨æ™‚ï¼ŒToken Stats å¯èƒ½è¢«è¨˜éŒ„å…©æ¬¡ï¼ˆä¸€æ¬¡åœ¨ç›£æ§å‡½å¼é–‹é ­ï¼Œä¸€æ¬¡åœ¨éåŒæ­¥å¯«å…¥è³‡æ–™åº«æ™‚ï¼‰ã€‚é€™æ˜¯ç›®å‰ç‰ˆæœ¬çš„åŸå§‹ç¢¼è¡Œç‚ºã€‚ |
## åŒ¯å‡ºèˆ‡é•·æœŸç•™å­˜ï¼šå…ˆèªªæ¸…æ¥šèƒ½åŠ›é‚Šç•Œ

### 1) GUI è£¡ç›®å‰èƒ½åšä»€éº¼

åœ¨ç›®å‰ç‰ˆæœ¬çš„ Monitor UIï¼ˆ`ProxyMonitor.tsx`ï¼‰è£¡ï¼Œä½ å¯ä»¥ï¼š

- æœå°‹/ç¯©é¸/åˆ†é ç€è¦½
- é»é–‹è©³æƒ…æŸ¥çœ‹èˆ‡è¤‡è£½ payload
- æ¸…ç©ºå…¨éƒ¨æ—¥èªŒ

ä½† **æ²’æœ‰ç™¼ç¾ã€ŒåŒ¯å‡ºæŒ‰éˆ•ã€**ï¼ˆåŸå§‹ç¢¼è£¡æœªçœ‹åˆ°ç›¸é—œ UIï¼‰ã€‚

### 2) å¾Œç«¯å·²ç¶“æœ‰ä»€éº¼åŒ¯å‡ºèƒ½åŠ›ï¼ˆé©åˆäºŒæ¬¡é–‹ç™¼ï¼‰

å¾Œç«¯ Tauri æŒ‡ä»¤æä¾›äº†å…©ç¨®åŒ¯å‡ºæ–¹å¼ï¼š

- `export_proxy_logs(file_path)`ï¼šæŠŠè³‡æ–™åº«è£¡ã€Œå…¨éƒ¨æ—¥èªŒã€åŒ¯å‡ºç‚º JSON æª”æ¡ˆ
- `export_proxy_logs_json(file_path, json_data)`ï¼šæŠŠä½ å‚³å…¥çš„ JSON é™£åˆ—ç¾åŒ–å¾Œå¯«å…¥æª”æ¡ˆï¼ˆè¦æ±‚è¼¸å…¥å¿…é ˆæ˜¯é™£åˆ—æ ¼å¼ï¼‰

å¦‚æœä½ è¦äºŒæ¬¡é–‹ç™¼ GUIï¼Œæˆ–è€…å¯«ä¸€å€‹è‡ªå·±çš„å‘¼å«è…³æœ¬ï¼Œå¯ä»¥ç›´æ¥è¤‡ç”¨é€™äº›æŒ‡ä»¤ã€‚

### 3) æœ€æ¨¸ç´ çš„ã€ŒåŒ¯å‡ºã€ï¼šç›´æ¥å‚™ä»½ `proxy_logs.db`

å› ç‚º Proxy Monitor æœ¬è³ªæ˜¯ SQLiteï¼Œä½ ä¹Ÿå¯ä»¥æŠŠ `proxy_logs.db` ç•¶æˆã€Œæ’éšœè­‰æ“šåŒ…ã€ä¸€èµ·å‚™ä»½ï¼ˆä¾‹å¦‚é€£åŒ `token_stats.db`ï¼‰ã€‚è³‡æ–™ç›®éŒ„ä½ç½®è¦‹ **[é¦–æ¬¡å•Ÿå‹•å¿…æ‡‚](/zh-tw/lbjlaq/Antigravity-Manager/start/first-run-data/)**ã€‚

## æ¨è–¦é–±è®€

- æƒ³å¼„æ¸…æ¨¡å‹æ˜ å°„ï¼š**[æ¨¡å‹è·¯ç”±ï¼šè‡ªå®šç¾©æ˜ å°„ã€è¬ç”¨å­—å…ƒå„ªå…ˆé †åºèˆ‡é è¨­ç­–ç•¥](/zh-tw/lbjlaq/Antigravity-Manager/advanced/model-router/)**
- æƒ³æ’æŸ¥é‘‘æ¬Šå•é¡Œï¼š**[401/é‘‘æ¬Šå¤±æ•—ï¼šauth_modeã€Header ç›¸å®¹èˆ‡å®¢æˆ¶ç«¯è¨­å®šæ¸…å–®](/zh-tw/lbjlaq/Antigravity-Manager/faq/auth-401/)**
- æƒ³æŠŠ Monitor èˆ‡æˆæœ¬çµ±è¨ˆçµåˆï¼šä¸‹ä¸€ç¯€æœƒè¬› Token Statsï¼ˆ`token_stats.db`ï¼‰

## æœ¬èª²å°çµ

- Proxy Monitor çš„åƒ¹å€¼æ˜¯ã€Œå¯è¦†ç›¤ã€ï¼šè¨˜éŒ„ç‹€æ…‹ç¢¼/è·¯å¾‘/å”å®š/å¸³è™Ÿ/æ¨¡å‹æ˜ å°„/Token ç”¨é‡ï¼Œä¸¦æä¾›è«‹æ±‚è©³æƒ…
- æœå°‹èˆ‡å¿«é€Ÿç¯©é¸æ˜¯æ’éšœå…¥å£ï¼šå…ˆç¸®å°ç¯„åœï¼Œå†é»è©³æƒ…çœ‹ payload
- æ¸…ç©ºæ—¥èªŒæ˜¯ä¸å¯é€†æ“ä½œï¼›åŒ¯å‡ºç›®å‰æ›´åå‘ã€ŒäºŒæ¬¡é–‹ç™¼èƒ½åŠ›ã€å’Œã€Œå‚™ä»½è³‡æ–™åº«æª”æ¡ˆã€

## ä¸‹ä¸€èª²é å‘Š

> ä¸‹ä¸€èª²æˆ‘å€‘å­¸ç¿’ **[Token Statsï¼šæˆæœ¬è¦–è§’çš„çµ±è¨ˆå£å¾‘èˆ‡åœ–è¡¨è§£è®€](/zh-tw/lbjlaq/Antigravity-Manager/advanced/token-stats/)**ï¼ŒæŠŠã€Œæ„Ÿè¦ºè²´ã€è®Šæˆå¯é‡åŒ–çš„æœ€ä½³åŒ–ã€‚

---

## é™„éŒ„ï¼šåŸå§‹ç¢¼åƒè€ƒ

<details>
<summary><strong>é»æ“Šå±•é–‹æŸ¥çœ‹åŸå§‹ç¢¼ä½ç½®</strong></summary>

> æ›´æ–°æ™‚é–“ï¼š2026-01-23

| åŠŸèƒ½ | æª”æ¡ˆè·¯å¾‘ | è¡Œè™Ÿ |
|--- | --- | ---|
| Monitor é é¢å…¥å£ï¼ˆæ›è¼‰ ProxyMonitorï¼‰ | [`src/pages/Monitor.tsx`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src/pages/Monitor.tsx#L1-L12) | 1-12 |
| Monitor UIï¼šè¡¨æ ¼/ç¯©é¸/è©³æƒ…å½ˆçª— | [`src/components/proxy/ProxyMonitor.tsx`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src/components/proxy/ProxyMonitor.tsx#L13-L713) | 13-713 |
| UIï¼šè®€å–è¨­å®šä¸¦åŒæ­¥ enable_logging | [`src/components/proxy/ProxyMonitor.tsx`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src/components/proxy/ProxyMonitor.tsx#L174-L243) | 174-243 |
| UIï¼šåˆ‡æ›éŒ„è£½ï¼ˆå¯«å…¥ config + set_proxy_monitor_enabledï¼‰ | [`src/components/proxy/ProxyMonitor.tsx`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src/components/proxy/ProxyMonitor.tsx#L254-L267) | 254-267 |
| UIï¼šå³æ™‚äº‹ä»¶ç›£è½ï¼ˆproxy://requestï¼‰èˆ‡å»é‡ | [`src/components/proxy/ProxyMonitor.tsx`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src/components/proxy/ProxyMonitor.tsx#L273-L355) | 273-355 |
| UIï¼šæ¸…ç©ºæ—¥èªŒï¼ˆclear_proxy_logsï¼‰ | [`src/components/proxy/ProxyMonitor.tsx`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src/components/proxy/ProxyMonitor.tsx#L389-L403) | 389-403 |
| UIï¼šè¼‰å…¥å–®æ¢è©³æƒ…ï¼ˆget_proxy_log_detailï¼‰ | [`src/components/proxy/ProxyMonitor.tsx`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src/components/proxy/ProxyMonitor.tsx#L505-L519) | 505-519 |
| ç›£æ§ä¸­ä»‹è»Ÿé«”ï¼šæŠ“å–è«‹æ±‚/å›æ‡‰ã€è§£æ tokenã€å¯«å…¥ monitor | [`src-tauri/src/proxy/middleware/monitor.rs`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src-tauri/src/proxy/middleware/monitor.rs#L13-L337) | 13-337 |
| ProxyMonitorï¼šenabled é–‹é—œã€å¯« DBã€ç™¼äº‹ä»¶ | [`src-tauri/src/proxy/monitor.rs`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src-tauri/src/proxy/monitor.rs#L33-L194) | 33-194 |
| ä¼ºæœå™¨ç«¯æ›è¼‰ç›£æ§ä¸­ä»‹è»Ÿé«”ï¼ˆlayerï¼‰ | [`src-tauri/src/proxy/server.rs`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src-tauri/src/proxy/server.rs#L183-L194) | 183-194 |
| Tauri æŒ‡ä»¤ï¼šget/count/filter/detail/clear/export | [`src-tauri/src/commands/proxy.rs`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src-tauri/src/commands/proxy.rs#L180-L314) | 180-314 |
| SQLiteï¼šproxy_logs.db è·¯å¾‘ã€è¡¨çµæ§‹èˆ‡ç¯©é¸ SQL | [`src-tauri/src/modules/proxy_db.rs`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src-tauri/src/modules/proxy_db.rs#L1-L416) | 1-416 |
| ç›£æ§è¨­è¨ˆèªªæ˜ï¼ˆå¯èƒ½èˆ‡å¯¦ä½œæœ‰å·®ç•°ï¼Œä»¥åŸå§‹ç¢¼ç‚ºæº–ï¼‰ | [`docs/proxy-monitor-technical.md`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/docs/proxy-monitor-technical.md#L1-L53) | 1-53 |

**é—œéµå¸¸é‡**ï¼š
- `MAX_REQUEST_LOG_SIZE = 100 * 1024 * 1024`ï¼šç›£æ§ä¸­ä»‹è»Ÿé«”æœ€å¤§å¯è®€å–çš„è«‹æ±‚é«”ï¼ˆè¶…éæœƒè®€å–å¤±æ•—ï¼‰
- `MAX_RESPONSE_LOG_SIZE = 100 * 1024 * 1024`ï¼šç›£æ§ä¸­ä»‹è»Ÿé«”æœ€å¤§å¯è®€å–çš„å›æ‡‰é«”ï¼ˆç”¨æ–¼åœ–ç‰‡ç­‰å¤§å›æ‡‰ï¼‰

**é—œéµå‡½å¼/æŒ‡ä»¤**ï¼š
- `monitor_middleware(...)`ï¼šåœ¨ HTTP å±¤æ¡é›†è«‹æ±‚èˆ‡å›æ‡‰ï¼Œä¸¦å‘¼å« `monitor.log_request(...)`
- `ProxyMonitor::log_request(...)`ï¼šå¯«å…¥è¨˜æ†¶é«” + SQLiteï¼Œä¸¦é€é `proxy://request` äº‹ä»¶æ¨é€æ‘˜è¦
- `get_proxy_logs_count_filtered(filter, errors_only)` / `get_proxy_logs_filtered(...)`ï¼šåˆ—è¡¨é ç¯©é¸èˆ‡åˆ†é 
- `get_proxy_log_detail(log_id)`ï¼šè¼‰å…¥å–®æ¢æ—¥èªŒçš„å®Œæ•´ request/response body
- `export_proxy_logs(file_path)`ï¼šåŒ¯å‡ºå…¨é‡æ—¥èªŒåˆ° JSON æª”æ¡ˆï¼ˆç›®å‰ UI æœªæš´éœ²æŒ‰éˆ•ï¼‰

</details>
