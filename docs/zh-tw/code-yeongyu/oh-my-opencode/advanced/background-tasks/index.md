---
title: "å¾Œå°ä»»å‹™: ä¸¦è¡ŒåŸ·è¡Œå¤šå€‹ä»£ç† | oh-my-opencode"
sidebarTitle: "è®“å¤šå€‹ AI åŒæ™‚å¹¹æ´»"
subtitle: "å¾Œå°ä»»å‹™: ä¸¦è¡ŒåŸ·è¡Œå¤šå€‹ä»£ç† | oh-my-opencode"
description: "å­¸ç¿’ oh-my-opencode å¾Œå°ä»»å‹™ç³»çµ±çš„ä¸¦è¡ŒåŸ·è¡Œèƒ½åŠ›ã€‚æŒæ¡ä¸‰ç´šä¸¦è¡Œæ§åˆ¶ã€ä»»å‹™ç”Ÿå‘½é€±æœŸç®¡ç†ã€ä½¿ç”¨ delegate_task å’Œ background_output å·¥å…·ã€‚"
tags:
  - "background-tasks"
  - "parallel-execution"
  - "concurrency"
prerequisite:
  - "start-sisyphus-orchestrator"
order: 80
---

# å¾Œå°ä¸¦è¡Œä»»å‹™ï¼šåƒåœ˜éšŠä¸€æ¨£å·¥ä½œ

## å­¸å®Œä½ èƒ½åšä»€éº¼

- âœ… å•Ÿå‹•å¤šå€‹ä¸¦è¡Œå¾Œå°ä»»å‹™ï¼Œè®“ä¸åŒ AI ä»£ç†åŒæ™‚å·¥ä½œ
- âœ… é…ç½®ä¸¦è¡Œé™åˆ¶ï¼Œé¿å… API é™æµå’Œæˆæœ¬å¤±æ§
- âœ… ç²å–å¾Œå°ä»»å‹™çµæœï¼Œç„¡éœ€ç­‰å¾…å®Œæˆ
- âœ… å–æ¶ˆä»»å‹™ï¼Œé‡‹æ”¾è³‡æº

## ä½ ç¾åœ¨çš„å›°å¢ƒ

**åªæœ‰ä¸€å€‹äººåœ¨åšäº‹ï¼Ÿ**

æƒ³åƒä¸€ä¸‹é€™å€‹å ´æ™¯ï¼š
- ä½ éœ€è¦è®“ **Explore** ä»£ç†æŸ¥æ‰¾ç¨‹å¼ç¢¼åº«ä¸­çš„èªè­‰å¯¦ä½œ
- åŒæ™‚è®“ **Librarian** ä»£ç†ç ”ç©¶æœ€ä½³å¯¦è¸
- å†è®“ **Oracle** ä»£ç†å¯©æŸ¥æ¶æ§‹è¨­è¨ˆ

å¦‚æœæŒ‰é †åºåŸ·è¡Œï¼Œç¸½è€—æ™‚ = 10 åˆ†é˜ + 15 åˆ†é˜ + 8 åˆ†é˜ = **33 åˆ†é˜**

ä½†å¦‚æœèƒ½ä¸¦è¡Œå‘¢ï¼Ÿ3 å€‹ä»£ç†åŒæ™‚å·¥ä½œï¼Œç¸½è€—æ™‚ = **max(10, 15, 8) = 15 åˆ†é˜**ï¼Œç¯€çœäº† **54%** çš„æ™‚é–“ã€‚

**å•é¡Œ**ï¼šé è¨­æƒ…æ³ä¸‹ï¼ŒOpenCode ä¸€æ¬¡åªèƒ½è™•ç†ä¸€å€‹æœƒè©±ã€‚è¦å¯¦ç¾ä¸¦è¡Œï¼Œä½ éœ€è¦æ‰‹å‹•ç®¡ç†å¤šå€‹è¦–çª—æˆ–ç­‰å¾…ä»»å‹™å®Œæˆã€‚

**è§£æ±º**ï¼šoh-my-opencode çš„å¾Œå°ä»»å‹™ç³»çµ±å¯ä»¥åŒæ™‚åŸ·è¡Œå¤šå€‹ AI ä»£ç†ï¼Œä¸¦åœ¨å¾Œå°è¿½è¹¤å®ƒå€‘çš„é€²åº¦ï¼Œè®“ä½ å¯ä»¥ç¹¼çºŒå…¶ä»–å·¥ä½œã€‚

## ä»€éº¼æ™‚å€™ç”¨é€™ä¸€æ‹›

ä½¿ç”¨å¾Œå°ä»»å‹™ç³»çµ±å¯ä»¥æå‡æ•ˆç‡çš„å ´æ™¯ï¼š

| å ´æ™¯ | ç¤ºä¾‹ | åƒ¹å€¼ |
| --- | --- | --- |
| **ä¸¦è¡Œç ”ç©¶** | Explore æŸ¥æ‰¾å¯¦ä½œ + Librarian æŸ¥æ–‡ä»¶ | 3 å€é€Ÿåº¦å®Œæˆç ”ç©¶ |
| **å¤šå°ˆå®¶å¯©æŸ¥** | Oracle å¯©æŸ¥æ¶æ§‹ + Momus é©—è­‰è¨ˆç•« | å¿«é€Ÿç²å¾—å¤šè§’åº¦å›é¥‹ |
| **éåŒæ­¥ä»»å‹™** | æäº¤ Git commit æ™‚åŒæ™‚é€²è¡Œç¨‹å¼ç¢¼å¯©æŸ¥ | ä¸é˜»å¡ä¸»æµç¨‹ |
| **è³‡æºå—é™** | é™åˆ¶ä¸¦è¡Œæ•¸é¿å… API é™æµ | æ§åˆ¶æˆæœ¬å’Œç©©å®šæ€§ |

::: tip Ultrawork æ¨¡å¼
åœ¨æç¤ºè©ä¸­åŠ å…¥ `ultrawork` æˆ– `ulw`ï¼Œæœƒè‡ªå‹•å•Ÿå‹•æœ€å¤§æ•ˆèƒ½æ¨¡å¼ï¼ŒåŒ…æ‹¬æ‰€æœ‰å°ˆæ¥­ä»£ç†å’Œä¸¦è¡Œå¾Œå°ä»»å‹™ã€‚ç„¡éœ€æ‰‹å‹•é…ç½®ã€‚
:::

## ğŸ’ é–‹å§‹å‰çš„æº–å‚™

::: warning å‰ç½®æ¢ä»¶

é–‹å§‹æœ¬æ•™ç¨‹å‰ï¼Œè«‹ç¢ºä¿ï¼š
1. å·²å®‰è£ oh-my-opencodeï¼ˆè¦‹ [å®‰è£æ•™ç¨‹](../../start/installation/)ï¼‰
2. å·²å®ŒæˆåŸºç¤é…ç½®ï¼Œè‡³å°‘æœ‰ä¸€å€‹ AI Provider å¯ç”¨
3. äº†è§£ Sisyphus ç·¨æ’å™¨çš„åŸºç¤ç”¨æ³•ï¼ˆè¦‹ [Sisyphus æ•™ç¨‹](../sisyphus-orchestrator/)ï¼‰

:::

## æ ¸å¿ƒæ€è·¯

å¾Œå°ä»»å‹™ç³»çµ±çš„å·¥ä½œåŸç†å¯ä»¥æ¦‚æ‹¬ç‚ºä¸‰å€‹æ ¸å¿ƒæ¦‚å¿µï¼š

### 1. ä¸¦è¡ŒåŸ·è¡Œ

å¾Œå°ä»»å‹™ç³»çµ±å…è¨±ä½ åŒæ™‚å•Ÿå‹•å¤šå€‹ AI ä»£ç†ä»»å‹™ï¼Œæ¯å€‹ä»»å‹™åœ¨ç¨ç«‹çš„æœƒè©±ä¸­åŸ·è¡Œã€‚é€™æ„å‘³è‘—ï¼š

- **Explore** æŸ¥æ‰¾ç¨‹å¼ç¢¼
- **Librarian** æŸ¥é–±æ–‡ä»¶
- **Oracle** å¯©æŸ¥è¨­è¨ˆ

ä¸‰å€‹ä»»å‹™ä¸¦è¡ŒåŸ·è¡Œï¼Œç¸½è€—æ™‚ç­‰æ–¼æœ€æ…¢çš„é‚£å€‹ä»»å‹™ã€‚

### 2. ä¸¦è¡Œæ§åˆ¶

ç‚ºé¿å…åŒæ™‚å•Ÿå‹•å¤ªå¤šä»»å‹™å°è‡´ API é™æµæˆ–æˆæœ¬å¤±æ§ï¼Œç³»çµ±æä¾›äº†ä¸‰ç´šä¸¦è¡Œé™åˆ¶ï¼š

```
å„ªå…ˆç´šï¼šModel > Provider > Default

ç¤ºä¾‹é…ç½®ï¼š
modelConcurrency:     claude-opus-4-5 â†’ 2
providerConcurrency:  anthropic â†’ 3
defaultConcurrency:   æ‰€æœ‰ â†’ 5
```

**è¦å‰‡**ï¼š
- å¦‚æœæŒ‡å®šäº† model ç´šé™åˆ¶ï¼Œä½¿ç”¨è©²é™åˆ¶
- å¦å‰‡ï¼Œå¦‚æœæŒ‡å®šäº† provider ç´šé™åˆ¶ï¼Œä½¿ç”¨è©²é™åˆ¶
- å¦å‰‡ï¼Œä½¿ç”¨é è¨­é™åˆ¶ï¼ˆé è¨­å€¼ 5ï¼‰

### 3. è¼ªè©¢æ©Ÿåˆ¶

ç³»çµ±æ¯ 2 ç§’æª¢æŸ¥ä¸€æ¬¡ä»»å‹™ç‹€æ…‹ï¼Œåˆ¤æ–·ä»»å‹™æ˜¯å¦å®Œæˆã€‚å®Œæˆæ¢ä»¶ï¼š

- **æœƒè©± idle**ï¼ˆsession.idle äº‹ä»¶ï¼‰
- **ç©©å®šæ€§æª¢æ¸¬**ï¼šé€£çºŒ 3 æ¬¡è¼ªè©¢ï¼Œè¨Šæ¯æ•¸ä¸è®Š
- **TODO åˆ—è¡¨ç‚ºç©º**ï¼šæ‰€æœ‰ä»»å‹™éƒ½å·²å®Œæˆ

## è·Ÿæˆ‘åš

### ç¬¬ 1 æ­¥ï¼šå•Ÿå‹•å¾Œå°ä»»å‹™

ä½¿ç”¨ `delegate_task` å·¥å…·å•Ÿå‹•å¾Œå°ä»»å‹™ï¼š

```markdown
å•Ÿå‹•ä¸¦è¡Œå¾Œå°ä»»å‹™ï¼š

1. Explore æŸ¥æ‰¾èªè­‰å¯¦ä½œ
2. Librarian ç ”ç©¶æœ€ä½³å¯¦è¸
3. Oracle å¯©æŸ¥æ¶æ§‹è¨­è¨ˆ

ä¸¦è¡ŒåŸ·è¡Œï¼š
```

**ç‚ºä»€éº¼**
é€™æ˜¯å±•ç¤ºå¾Œå°ä»»å‹™æœ€ç¶“å…¸çš„ä½¿ç”¨å ´æ™¯ã€‚3 å€‹ä»»å‹™å¯ä»¥åŒæ™‚é€²è¡Œï¼Œå¤§å¹…ç¯€çœæ™‚é–“ã€‚

**ä½ æ‡‰è©²çœ‹åˆ°**
ç³»çµ±æœƒå›å‚³ 3 å€‹ä»»å‹™ IDï¼š

```
Background task launched successfully.

Task ID: bg_abc123
Session ID: sess_xyz789
Description: Explore: æŸ¥æ‰¾èªè­‰å¯¦ä½œ
Agent: explore
Status: pending
...

Background task launched successfully.

Task ID: bg_def456
Session ID: sess_uvwx012
Description: Librarian: ç ”ç©¶æœ€ä½³å¯¦è¸
Agent: librarian
Status: pending
...
```

::: info ä»»å‹™ç‹€æ…‹èªªæ˜
- **pending**ï¼šæ’éšŠç­‰å¾…ä¸¦è¡Œæ§½
- **running**ï¼šæ­£åœ¨åŸ·è¡Œ
- **completed**ï¼šå·²å®Œæˆ
- **error**ï¼šå‡ºéŒ¯
- **cancelled**ï¼šå·²å–æ¶ˆ
:::

### ç¬¬ 2 æ­¥ï¼šæª¢æŸ¥ä»»å‹™ç‹€æ…‹

ä½¿ç”¨ `background_output` å·¥å…·æŸ¥çœ‹ä»»å‹™ç‹€æ…‹ï¼š

```markdown
æŸ¥çœ‹ bg_abc123 çš„ç‹€æ…‹ï¼š
```

**ç‚ºä»€éº¼**
äº†è§£ä»»å‹™æ˜¯å¦å®Œæˆæˆ–ä»åœ¨åŸ·è¡Œã€‚é è¨­ä¸ç­‰å¾…ï¼Œç«‹å³å›å‚³ç‹€æ…‹ã€‚

**ä½ æ‡‰è©²çœ‹åˆ°**
å¦‚æœä»»å‹™ä»åœ¨åŸ·è¡Œï¼š

```
## Task Status

| Field | Value |
| --- | --- |
| Task ID | `bg_abc123` |
| Description | Explore: æŸ¥æ‰¾èªè­‰å¯¦ä½œ |
| Agent | explore |
| Status | **running** |
| Duration | 2m 15s |
| Session ID | `sess_xyz789` |

> **Note**: No need to wait explicitly - system will notify you when this task completes.

## Original Prompt

æŸ¥æ‰¾ src/auth ç›®éŒ„ä¸‹çš„èªè­‰å¯¦ä½œï¼ŒåŒ…æ‹¬ç™»å…¥ã€è¨»å†Šã€Token ç®¡ç†ç­‰
```

å¦‚æœä»»å‹™å·²å®Œæˆï¼š

```
Task Result

Task ID: bg_abc123
Description: Explore: æŸ¥æ‰¾èªè­‰å¯¦ä½œ
Duration: 5m 32s
Session ID: sess_xyz789

---

æ‰¾åˆ°äº† 3 å€‹èªè­‰å¯¦ä½œï¼š
1. `src/auth/login.ts` - JWT èªè­‰
2. `src/auth/register.ts` - ä½¿ç”¨è€…è¨»å†Š
3. `src/auth/token.ts` - Token é‡æ–°æ•´ç†
...
```

### ç¬¬ 3 æ­¥ï¼šé…ç½®ä¸¦è¡Œæ§åˆ¶

ç·¨è¼¯ `~/.config/opencode/oh-my-opencode.json`ï¼š

```jsonc
{
  "$schema": "https://code-yeongyu.github.io/oh-my-opencode/schema.json",

  "background_task": {
    // Provider ç´šä¸¦è¡Œé™åˆ¶ï¼ˆæ¨è–¦è¨­å®šï¼‰
    "providerConcurrency": {
      "anthropic": 3,     // Anthropic æ¨¡å‹æœ€å¤šåŒæ™‚ 3 å€‹
      "openai": 2,         // OpenAI æ¨¡å‹æœ€å¤šåŒæ™‚ 2 å€‹
      "google": 2          // Google æ¨¡å‹æœ€å¤šåŒæ™‚ 2 å€‹
    },

    // Model ç´šä¸¦è¡Œé™åˆ¶ï¼ˆå„ªå…ˆç´šæœ€é«˜ï¼‰
    "modelConcurrency": {
      "claude-opus-4-5": 2,    // Opus 4.5 æœ€å¤šåŒæ™‚ 2 å€‹
      "gpt-5.2": 2              // GPT 5.2 æœ€å¤šåŒæ™‚ 2 å€‹
    },

    // é è¨­ä¸¦è¡Œé™åˆ¶ï¼ˆç•¶ä¸Šé¢éƒ½æ²’é…ç½®æ™‚ä½¿ç”¨ï¼‰
    "defaultConcurrency": 3
  }
}
```

**ç‚ºä»€éº¼**
ä¸¦è¡Œæ§åˆ¶æ˜¯é¿å…æˆæœ¬å¤±æ§çš„é—œéµã€‚å¦‚æœä½ æ²’æœ‰è¨­å®šé™åˆ¶ï¼ŒåŒæ™‚å•Ÿå‹• 10 å€‹ Opus 4.5 ä»»å‹™ï¼Œå¯èƒ½æœƒç¬é–“æ¶ˆè€—å¤§é‡ API é…é¡ã€‚

::: tip æ¨è–¦è¨­å®š
å°æ–¼å¤§å¤šæ•¸å ´æ™¯ï¼Œæ¨è–¦è¨­å®šï¼š
- `providerConcurrency.anthropic: 3`
- `providerConcurrency.openai: 2`
- `defaultConcurrency: 5`
:::

**ä½ æ‡‰è©²çœ‹åˆ°**
é…ç½®ç”Ÿæ•ˆå¾Œï¼Œå•Ÿå‹•å¾Œå°ä»»å‹™æ™‚ï¼š
- å¦‚æœå·²é”åˆ°ä¸¦è¡Œé™åˆ¶ï¼Œä»»å‹™æœƒé€²å…¥ **pending** ç‹€æ…‹æ’éšŠ
- ä¸€æ—¦æœ‰ä»»å‹™å®Œæˆï¼Œæ’éšŠçš„ä»»å‹™æœƒè‡ªå‹•å•Ÿå‹•

### ç¬¬ 4 æ­¥ï¼šå–æ¶ˆä»»å‹™

ä½¿ç”¨ `background_cancel` å·¥å…·å–æ¶ˆä»»å‹™ï¼š

```markdown
å–æ¶ˆæ‰€æœ‰å¾Œå°ä»»å‹™ï¼š
```

**ç‚ºä»€éº¼**
æœ‰æ™‚ä»»å‹™å¡ä½æˆ–ä¸å†éœ€è¦ï¼Œå¯ä»¥ä¸»å‹•å–æ¶ˆé‡‹æ”¾è³‡æºã€‚

**ä½ æ‡‰è©²çœ‹åˆ°**

```
Cancelled 3 background task(s):

| Task ID | Description | Status | Session ID |
| --- | --- | --- | --- |
| `bg_abc123` | Explore: æŸ¥æ‰¾èªè­‰å¯¦ä½œ | running | `sess_xyz789` |
| `bg_def456` | Librarian: ç ”ç©¶æœ€ä½³å¯¦è¸ | running | `sess_uvwx012` |
| `bg_ghi789` | Oracle: å¯©æŸ¥æ¶æ§‹è¨­è¨ˆ | pending | (not started) |

## Continue Instructions

To continue a cancelled task, use:

    delegate_task(session_id="<session_id>", prompt="Continue: <your follow-up>")

Continuable sessions:
- `sess_xyz789` (Explore: æŸ¥æ‰¾èªè­‰å¯¦ä½œ)
- `sess_uvwx012` (Librarian: ç ”ç©¶æœ€ä½³å¯¦è¸)
```

## æª¢æŸ¥é» âœ…

ç¢ºèªä½ ç†è§£äº†ä»¥ä¸‹è¦é»ï¼š

- [ ] èƒ½å•Ÿå‹•å¤šå€‹ä¸¦è¡Œå¾Œå°ä»»å‹™
- [ ] ç†è§£ä»»å‹™ç‹€æ…‹ï¼ˆpendingã€runningã€completedï¼‰
- [ ] é…ç½®äº†åˆç†çš„ä¸¦è¡Œé™åˆ¶
- [ ] èƒ½æŸ¥çœ‹å’Œç²å–ä»»å‹™çµæœ
- [ ] èƒ½å–æ¶ˆä¸éœ€è¦çš„ä»»å‹™

## è¸©å‘æé†’

### å‘ 1ï¼šå¿˜è¨˜é…ç½®ä¸¦è¡Œé™åˆ¶

**ç—‡ç‹€**ï¼šå•Ÿå‹•å¤ªå¤šä»»å‹™ï¼ŒAPI é…é¡ç¬é–“è€—ç›¡ï¼Œæˆ–è§¸ Rate Limitã€‚

**è§£æ±º**ï¼šåœ¨ `oh-my-opencode.json` ä¸­é…ç½® `providerConcurrency` æˆ– `defaultConcurrency`ã€‚

### å‘ 2ï¼šè¼ªè©¢æª¢æŸ¥çµæœå¤ªé »ç¹

**ç—‡ç‹€**ï¼šæ¯éš”å¹¾ç§’å°±å‘¼å« `background_output` æª¢æŸ¥ä»»å‹™ç‹€æ…‹ï¼Œå¢åŠ ä¸å¿…è¦çš„é–‹éŠ·ã€‚

**è§£æ±º**ï¼šç³»çµ±æœƒè‡ªå‹•é€šçŸ¥ä½ ä»»å‹™å®Œæˆã€‚åªæœ‰åœ¨ç¢ºå¯¦éœ€è¦ä¸­é–“çµæœæ™‚æ‰æ‰‹å‹•æª¢æŸ¥ã€‚

### å‘ 3ï¼šä»»å‹™é€¾æ™‚

**ç—‡ç‹€**ï¼šä»»å‹™åŸ·è¡Œè¶…é 30 åˆ†é˜å¾Œè¢«è‡ªå‹•å–æ¶ˆã€‚

**åŸå› **ï¼šå¾Œå°ä»»å‹™æœ‰ 30 åˆ†é˜çš„ TTLï¼ˆé€¾æ™‚æ™‚é–“ï¼‰ã€‚

**è§£æ±º**ï¼šå¦‚æœéœ€è¦é•·æ™‚é–“ä»»å‹™ï¼Œè€ƒæ…®æ‹†åˆ†ç‚ºå¤šå€‹å­ä»»å‹™ï¼Œæˆ–ä½¿ç”¨ `delegate_task(background=false)` å‰å°åŸ·è¡Œã€‚

### å‘ 4ï¼šPending ä»»å‹™ä¸€ç›´ä¸å•Ÿå‹•

**ç—‡ç‹€**ï¼šä»»å‹™ç‹€æ…‹ä¸€ç›´æ˜¯ `pending`ï¼Œä¸é€²å…¥ `running`ã€‚

**åŸå› **ï¼šä¸¦è¡Œé™åˆ¶å·²æ»¿ï¼Œæ²’æœ‰å¯ç”¨æ§½ã€‚

**è§£æ±º**ï¼š
- ç­‰å¾…ç¾æœ‰ä»»å‹™å®Œæˆ
- å¢åŠ ä¸¦è¡Œé™åˆ¶é…ç½®
- å–æ¶ˆä¸å¿…è¦çš„ä»»å‹™é‡‹æ”¾æ§½

## æœ¬èª²å°çµ

å¾Œå°ä»»å‹™ç³»çµ±è®“ä½ å¯ä»¥åƒçœŸå¯¦åœ˜éšŠä¸€æ¨£å·¥ä½œï¼Œå¤šå€‹ AI ä»£ç†ä¸¦è¡ŒåŸ·è¡Œä»»å‹™ï¼š

1. **å•Ÿå‹•ä¸¦è¡Œä»»å‹™**ï¼šä½¿ç”¨ `delegate_task` å·¥å…·
2. **æ§åˆ¶ä¸¦è¡Œ**ï¼šé…ç½® `providerConcurrency`ã€`modelConcurrency`ã€`defaultConcurrency`
3. **ç²å–çµæœ**ï¼šä½¿ç”¨ `background_output` å·¥å…·ï¼ˆç³»çµ±æœƒè‡ªå‹•é€šçŸ¥ï¼‰
4. **å–æ¶ˆä»»å‹™**ï¼šä½¿ç”¨ `background_cancel` å·¥å…·

**æ ¸å¿ƒè¦å‰‡**ï¼š
- æ¯ 2 ç§’è¼ªè©¢ä¸€æ¬¡ä»»å‹™ç‹€æ…‹
- é€£çºŒ 3 æ¬¡ç©©å®šæˆ– idle å‰‡ä»»å‹™å®Œæˆ
- ä»»å‹™ 30 åˆ†é˜å¾Œè‡ªå‹•é€¾æ™‚
- å„ªå…ˆç´šï¼šmodelConcurrency > providerConcurrency > defaultConcurrency

## ä¸‹ä¸€èª²é å‘Š

> ä¸‹ä¸€èª²æˆ‘å€‘å­¸ç¿’ **[LSP èˆ‡ AST-Grepï¼šç¨‹å¼ç¢¼é‡æ§‹åˆ©å™¨](../lsp-ast-tools/)**ã€‚
>
> ä½ æœƒå­¸åˆ°ï¼š
> - å¦‚ä½•ä½¿ç”¨ LSP å·¥å…·é€²è¡Œç¨‹å¼ç¢¼å°è¦½å’Œé‡æ§‹
> - å¦‚ä½•ä½¿ç”¨ AST-Grep é€²è¡Œç²¾ç¢ºçš„æ¨¡å¼æœå°‹å’Œæ›¿æ›
> - LSP å’Œ AST-Grep çš„çµåˆä½¿ç”¨æœ€ä½³å¯¦è¸

---

## é™„éŒ„ï¼šåŸå§‹ç¢¼åƒè€ƒ

<details>
<summary><strong>é»é¸å±•é–‹æŸ¥çœ‹åŸå§‹ç¢¼ä½ç½®</strong></summary>

> æ›´æ–°æ™‚é–“ï¼š2026-01-26

| åŠŸèƒ½ | æª”æ¡ˆè·¯å¾‘ | è¡Œè™Ÿ |
| --- | --- | --- |
| å¾Œå°ä»»å‹™ç®¡ç†å™¨ | [`src/features/background-agent/manager.ts`](https://github.com/code-yeongyu/oh-my-opencode/blob/main/src/features/background-agent/manager.ts) | 1-1378 |
| ä¸¦è¡Œæ§åˆ¶ | [`src/features/background-agent/concurrency.ts`](https://github.com/code-yeongyu/oh-my-opencode/blob/main/src/features/background-agent/concurrency.ts) | 1-138 |
| delegate_task å·¥å…· | [`src/tools/background-task/tools.ts`](https://github.com/code-yeongyu/oh-my-opencode/blob/main/src/tools/background-task/tools.ts) | 51-119 |
| background_output å·¥å…· | [`src/tools/background-task/tools.ts`](https://github.com/code-yeongyu/oh-my-opencode/blob/main/src/tools/background-task/tools.ts) | 320-384 |
| background_cancel å·¥å…· | [`src/tools/background-task/tools.ts`](https://github.com/code-yeongyu/oh-my-opencode/blob/main/src/tools/background-task/tools.ts) | 386-514 |

**é—œéµå¸¸æ•¸**ï¼š
- `TASK_TTL_MS = 30 * 60 * 1000`ï¼šä»»å‹™é€¾æ™‚æ™‚é–“ï¼ˆ30 åˆ†é˜ï¼‰
- `MIN_STABILITY_TIME_MS = 10 * 1000`ï¼šç©©å®šæ€§æª¢æ¸¬å•Ÿå‹•æ™‚é–“ï¼ˆ10 ç§’ï¼‰
- `DEFAULT_STALE_TIMEOUT_MS = 180_000`ï¼šé è¨­é€¾æ™‚æ™‚é–“ï¼ˆ3 åˆ†é˜ï¼‰
- `MIN_IDLE_TIME_MS = 5000`ï¼šå¿½ç•¥æ—©æœŸ idle çš„æœ€å°æ™‚é–“ï¼ˆ5 ç§’ï¼‰

**é—œéµé¡åˆ¥**ï¼š
- `BackgroundManager`ï¼šå¾Œå°ä»»å‹™ç®¡ç†å™¨ï¼Œè² è²¬å•Ÿå‹•ã€è¿½è¹¤ã€è¼ªè©¢ã€å®Œæˆä»»å‹™
- `ConcurrencyManager`ï¼šä¸¦è¡Œæ§åˆ¶ç®¡ç†å™¨ï¼Œå¯¦ä½œä¸‰ç´šå„ªå…ˆç´šï¼ˆmodel > provider > defaultï¼‰

**é—œéµå‡½å¼**ï¼š
- `BackgroundManager.launch()`ï¼šå•Ÿå‹•å¾Œå°ä»»å‹™
- `BackgroundManager.pollRunningTasks()`ï¼šæ¯ 2 ç§’è¼ªè©¢ä»»å‹™ç‹€æ…‹ï¼ˆç¬¬ 1182 è¡Œï¼‰
- `BackgroundManager.tryCompleteTask()`ï¼šå®‰å…¨å®Œæˆä»»å‹™ï¼Œé˜²æ­¢ç«¶æ…‹æ¢ä»¶ï¼ˆç¬¬ 909 è¡Œï¼‰
- `ConcurrencyManager.getConcurrencyLimit()`ï¼šç²å–ä¸¦è¡Œé™åˆ¶ï¼ˆç¬¬ 24 è¡Œï¼‰
- `ConcurrencyManager.acquire()` / `ConcurrencyManager.release()`ï¼šç²å–/é‡‹æ”¾ä¸¦è¡Œæ§½ï¼ˆç¬¬ 41ã€71 è¡Œï¼‰

</details>
