---
title: "MCP μ—”λ“ν¬μΈνΈ: λ„κµ¬ λ…Έμ¶ | Antigravity-Manager"
sidebarTitle: "Claudeκ°€ z.ai λ¥λ ¥μ„ μ‚¬μ©"
subtitle: "MCP μ—”λ“ν¬μΈνΈ: Web Search/Reader/Visionμ„ νΈμ¶ κ°€λ¥ν• λ„κµ¬λ΅ λ…Έμ¶"
description: "Antigravity Managerμ MCP μ—”λ“ν¬μΈνΈ κµ¬μ„±μ„ ν•™μµν•©λ‹λ‹¤. Web Search/Reader/Vision ν™μ„±ν™”, λ„κµ¬ νΈμ¶ κ²€μ¦, μ™Έλ¶€ ν΄λΌμ΄μ–ΈνΈ μ—°κ²° λ° μΌλ°μ μΈ μ¤λ¥ λ¬Έμ  ν•΄κ²° λ°©λ²•μ„ λ§μ¤ν„°ν•©λ‹λ‹¤."
tags:
  - "MCP"
  - "Web Search"
  - "Web Reader"
  - "Vision"
  - "z.ai"
  - "Antigravity Tools"
prerequisite:
  - "start-proxy-and-first-client"
  - "start-add-account"
order: 6
---
# MCP μ—”λ“ν¬μΈνΈ: Web Search/Reader/Visionμ„ νΈμ¶ κ°€λ¥ν• λ„κµ¬λ΅ λ…Έμ¶

μ΄ **MCP μ—”λ“ν¬μΈνΈ**λ¥Ό μ‚¬μ©ν•μ—¬ z.aiμ κ²€μƒ‰, μ½κΈ°, μ‹κ° λ¥λ ¥μ„ μ™Έλ¶€ MCP ν΄λΌμ΄μ–ΈνΈμ— λ…Έμ¶ν•©λ‹λ‹¤. "μ›κ²© λ¦¬λ²„μ¤ ν”„λ΅μ‹"μ™€ "λ‚΄μ¥ μ„λ²„"μ μ°¨μ΄λ¥Ό λ…ν™•ν νμ•…ν•κ³  μ΄λ¬ν• μ—”λ“ν¬μΈνΈλ¥Ό ν™μ„±ν™” λ° νΈμ¶ν•λ” λ°©λ²•μ„ ν•™μµν•©λ‹λ‹¤.

## ν•™μµ ν›„ ν•  μ μλ” κ²ƒ

- μ„Έ κ°€μ§€ MCP μ—”λ“ν¬μΈνΈμ μ‘λ™ μ›λ¦¬ μ΄ν•΄(μ›κ²© λ¦¬λ²„μ¤ ν”„λ΅μ‹ vs λ‚΄μ¥ μ„λ²„)
- Antigravity Toolsμ—μ„ Web Search/Web Reader/Vision MCP μ—”λ“ν¬μΈνΈ ν™μ„±ν™”
- μ™Έλ¶€ MCP ν΄λΌμ΄μ–ΈνΈ(μ: Claude Desktop, Cursor)κ°€ λ΅μ»¬ κ²μ΄νΈμ›¨μ΄λ¥Ό ν†µν•΄ μ΄λ¬ν• λ¥λ ¥μ„ νΈμ¶
- μ„Έμ… κ΄€λ¦¬(Vision MCP) λ° μΈμ¦ λ¨λΈ λ§μ¤ν„°

## ν„μ¬ μ§λ©΄ν• λ¬Έμ 

λ§μ€ AI λ„κµ¬κ°€ MCP(Model Context Protocol)λ¥Ό μ§€μ›ν•κΈ° μ‹μ‘ν–μ§€λ§ μ—…μ¤νΈλ¦Ό API Keyμ™€ URLμ„ κµ¬μ„±ν•΄μ•Ό ν•©λ‹λ‹¤. z.aiμ MCP μ„λ²„λ„ κ°•λ ¥ν• λ¥λ ¥(κ²€μƒ‰, μ½κΈ°, μ‹κ° λ¶„μ„)μ„ μ κ³µν•μ§€λ§ μ§μ ‘ κµ¬μ„±ν•λ©΄ κ° ν΄λΌμ΄μ–ΈνΈμ— z.ai Keyλ¥Ό λ…Έμ¶ν•΄μ•Ό ν•©λ‹λ‹¤.

Antigravity Toolsμ μ†”λ£¨μ…μ€ λ΅μ»¬ κ²μ΄νΈμ›¨μ΄ λ λ²¨μ—μ„ z.ai Keyλ¥Ό ν†µν•© κ΄€λ¦¬ν•κ³  MCP μ—”λ“ν¬μΈνΈλ¥Ό λ…Έμ¶ν•λ©° ν΄λΌμ΄μ–ΈνΈλ” λ΅μ»¬ κ²μ΄νΈμ›¨μ΄μ—λ§ μ—°κ²°ν•λ©΄ λκ³  z.ai Keyλ¥Ό μ• ν•„μ”κ°€ μ—†μµλ‹λ‹¤.

## μ΄ λ°©λ²•μ„ μ‚¬μ©ν•λ” κ²½μ°

- μ—¬λ¬ MCP ν΄λΌμ΄μ–ΈνΈ(Claude Desktop, Cursor, μμ²΄ κ°λ° λ„κµ¬)κ°€ μκ³  ν†µν•©λ z.ai Key μ„ΈνΈλ¥Ό μ‚¬μ©ν•κ³  μ‹¶μ
- z.aiμ Web Search/Web Reader/Vision λ¥λ ¥μ„ λ„κµ¬λ΅ AIμ— λ…Έμ¶ν•κ³  μ‹¶μ
- μ—¬λ¬ κ³³μ—μ„ λ°λ³µμ μΌλ΅ κµ¬μ„±ν•κ³  z.ai Keyλ¥Ό μν™ν•κ³  μ‹¶μ§€ μ•μ

## π’ μ‹μ‘ μ „ μ¤€λΉ„

::: warning μ „μ  μ΅°κ±΄
- μ΄λ―Έ Antigravity Toolsμ "API Proxy" νμ΄μ§€μ—μ„ λ¦¬λ²„μ¤ ν”„λ΅μ‹ μ„λΉ„μ¤λ¥Ό μ‹μ‘ν•¨
- μ΄λ―Έ z.ai API Key νλ“(z.ai μ½μ†”μ—μ„)
- λ¦¬λ²„μ¤ ν”„λ΅μ‹ ν¬νΈ μ•κΈ°(κΈ°λ³Έκ°’ `8045`)
:::

::: info MCPλ€ λ¬΄μ—‡μ…λ‹κΉ?
MCP(Model Context Protocol)λ” AI ν΄λΌμ΄μ–ΈνΈκ°€ μ™Έλ¶€ λ„κµ¬/λ°μ΄ν„° μ†μ¤λ¥Ό νΈμ¶ν•  μ μλ” κ°λ°©ν• ν”„λ΅ν† μ½μ…λ‹λ‹¤.

μ „ν•μ μΈ MCP μƒνΈμ‘μ© νλ¦„:
1. ν΄λΌμ΄μ–ΈνΈ(μ: Claude Desktop)κ°€ MCP Serverμ— `tools/list` μ”μ²­μ„ λ³΄λ‚΄ μ‚¬μ© κ°€λ¥ν• λ„κµ¬ λ©λ΅ νλ“
2. ν΄λΌμ΄μ–ΈνΈκ°€ μ»¨ν…μ¤νΈμ— λ”°λΌ λ„κµ¬λ¥Ό μ„ νƒν•κ³  `tools/call` μ”μ²­ μ „μ†΅
3. MCP Serverκ°€ λ„κµ¬λ¥Ό μ‹¤ν–‰ν•κ³  κ²°κ³Ό λ°ν™(ν…μ¤νΈ, μ΄λ―Έμ§€, λ°μ΄ν„° λ“±)

Antigravity Toolsλ” μ„Έ κ°€μ§€ MCP μ—”λ“ν¬μΈνΈλ¥Ό μ κ³µν•©λ‹λ‹¤:
- **μ›κ²© λ¦¬λ²„μ¤ ν”„λ΅μ‹**: z.ai MCP μ„λ²„λ΅ μ§μ ‘ μ „λ‹¬(Web Search/Web Reader)
- **λ‚΄μ¥ μ„λ²„**: λ΅μ»¬μ—μ„ JSON-RPC 2.0 ν”„λ΅ν† μ½ κµ¬ν„, λ„κµ¬ νΈμ¶ μ²λ¦¬(Vision)
:::

## MCP μ—”λ“ν¬μΈνΈλ€?

**MCP μ—”λ“ν¬μΈνΈ**λ” Antigravity Toolsκ°€ λ…Έμ¶ν•λ” HTTP λΌμ°νΈ μ„ΈνΈλ΅ μ™Έλ¶€ MCP ν΄λΌμ΄μ–ΈνΈκ°€ z.aiμ λ¥λ ¥μ„ νΈμ¶ν•  μ μμΌλ©° Antigravity Toolsκ°€ ν†µν•©μ μΌλ΅ μΈμ¦ λ° κµ¬μ„±μ„ κ΄€λ¦¬ν•©λ‹λ‹¤.

### μ—”λ“ν¬μΈνΈ λ¶„λ¥

| μ—”λ“ν¬μΈνΈ μ ν• | κµ¬ν„ λ°©μ‹ | λ΅μ»¬ κ²½λ΅ | μ—…μ¤νΈλ¦Ό λ€μƒ |
| --- | --- | --- | --- |
| **Web Search** | μ›κ²© λ¦¬λ²„μ¤ ν”„λ΅μ‹ | `/mcp/web_search_prime/mcp` | `https://api.z.ai/api/mcp/web_search_prime/mcp` |
| **Web Reader** | μ›κ²© λ¦¬λ²„μ¤ ν”„λ΅μ‹ | `/mcp/web_reader/mcp` | `https://api.z.ai/api/mcp/web_reader/mcp` |
| **Vision MCP** | λ‚΄μ¥ μ„λ²„(JSON-RPC 2.0) | `/mcp/zai-mcp-server/mcp` | λ‚΄λ¶€μ—μ„ z.ai PaaS API νΈμ¶ |

### ν•µμ‹¬ μ°¨μ΄

::: info μ›κ²© λ¦¬λ²„μ¤ ν”„λ΅μ‹ vs λ‚΄μ¥ μ„λ²„
**μ›κ²© λ¦¬λ²„μ¤ ν”„λ΅μ‹**(Web Search/Web Reader):
- ν”„λ΅μ‹λ” λ¶€λ¶„ μ”μ²­ ν—¤λ”(`content-type`, `accept`, `user-agent`)λ¥Ό μ μ§€ν•κ³  `Authorization` ν—¤λ”λ¥Ό μ£Όμ…
- ν”„λ΅μ‹λ” μ—…μ¤νΈλ¦Ό μ‘λ‹µ λ³Έλ¬Έ λ° μƒνƒ μ½”λ“λ¥Ό μ „λ‹¬ν•μ§€λ§ `CONTENT_TYPE` μ‘λ‹µ ν—¤λ”λ§ μ μ§€
- μƒνƒ μ—†μ, μ„Έμ… κ΄€λ¦¬ ν•„μ” μ—†μ

**λ‚΄μ¥ μ„λ²„**(Vision MCP):
- JSON-RPC 2.0 ν”„λ΅ν† μ½ μ™„μ „ κµ¬ν„(`initialize`, `tools/list`, `tools/call`)
- μƒνƒ μμ: μ„Έμ… μƒμ„±(`mcp-session-id`), GET μ—”λ“ν¬μΈνΈλ” SSE keepalive λ°ν™
- λ„κµ¬ λ΅μ§μ€ λ΅μ»¬μ—μ„ κµ¬ν„λλ©° z.ai PaaS APIλ¥Ό νΈμ¶ν•μ—¬ μ‹κ° λ¶„μ„ μν–‰
:::

## ν•µμ‹¬ μ•„μ΄λ””μ–΄

Antigravity Toolsμ MCP μ—”λ“ν¬μΈνΈλ” λ‹¤μ μ„¤κ³„ μ›μΉ™μ„ λ”°λ¦…λ‹λ‹¤:

1. **ν†µν•© μΈμ¦**: Antigravityμ—μ„ z.ai Key κ΄€λ¦¬, ν΄λΌμ΄μ–ΈνΈ κµ¬μ„± λ¶ν•„μ”
2. **μ¨μ¤ν”„ κ°€λ¥**: μ„Έ μ—”λ“ν¬μΈνΈκ°€ λ…λ¦½μ μΌλ΅ ν™μ„±ν™”/λΉ„ν™μ„±ν™” κ°€λ¥
3. **μ„Έμ… κ²©λ¦¬**: Vision MCPλ” `mcp-session-id`λ΅ λ‹¤λ¥Έ ν΄λΌμ΄μ–ΈνΈ κ²©λ¦¬
4. **μ¤λ¥ ν¬λ…**: μ—…μ¤νΈλ¦Ό μ‘λ‹µ λ³Έλ¬Έ λ° μƒνƒ μ½”λ“λ¥Ό κ·Έλ€λ΅ μ „λ‹¬(μ‘λ‹µ ν—¤λ” ν•„ν„°λ§)

### μΈμ¦ λ¨λΈ

```
MCP ν΄λΌμ΄μ–ΈνΈ β†’ Antigravity λ΅μ»¬ ν”„λ΅μ‹ β†’ z.ai μ—…μ¤νΈλ¦Ό
                β†“
            [μ„ νƒ μ‚¬ν•­] proxy.auth_mode
                β†“
            [μλ™] z.ai Key μ£Όμ…
```

Antigravity Toolsμ ν”„λ΅μ‹ λ―Έλ“¤μ›¨μ–΄(`src-tauri/src/proxy/middleware/auth.rs`)λ” `proxy.auth_mode`λ¥Ό ν™•μΈν•©λ‹λ‹¤. μΈμ¦μ„ ν™μ„±ν™”ν•λ©΄ ν΄λΌμ΄μ–ΈνΈκ°€ API Keyλ¥Ό ν΄λ€ν•΄μ•Ό ν•©λ‹λ‹¤.

**μ¤‘μ”**: `proxy.auth_mode`κ°€ μ–΄λ–»λ“  z.ai Keyλ” ν”„λ΅μ‹μ—μ„ μλ™μΌλ΅ μ£Όμ…λλ©° ν΄λΌμ΄μ–ΈνΈλ” κµ¬μ„±ν•  ν•„μ”κ°€ μ—†μµλ‹λ‹¤.

## λ”°λΌ ν•΄ λ³΄κΈ°

### 1λ‹¨κ³„: z.ai κµ¬μ„± λ° MCP κΈ°λ¥ ν™μ„±ν™”

**μ΄μ **
λ¨Όμ € z.ai κΈ°λ³Έ κµ¬μ„±μ΄ μ¬λ°”λ¥Έμ§€ ν™•μΈν• λ‹¤μ MCP μ—”λ“ν¬μΈνΈλ¥Ό ν•λ‚μ”© ν™μ„±ν™”ν•©λ‹λ‹¤.

1. Antigravity Tools μ—΄κΈ°, **API Proxy** νμ΄μ§€ μ§„μ…
2. **z.ai κµ¬μ„±** μΉ΄λ“ μ°ΎκΈ°, ν™•μ¥ ν΄λ¦­
3. λ‹¤μ ν•„λ“ κµ¬μ„±:

```yaml
 # z.ai κµ¬μ„±
base_url: "https://api.z.ai/api/anthropic"  # z.ai Anthropic νΈν™ μ—”λ“ν¬μΈνΈ
api_key: "z.ai-api-key"                    # z.ai μ½μ†”μ—μ„ νλ“
enabled: true                              # z.ai ν™μ„±ν™”
```

4. **MCP κµ¬μ„±** ν•μ„ μΉ΄λ“ μ°ΎκΈ°, λ‹¤μ κµ¬μ„±:

```yaml
 # MCP κµ¬μ„±
enabled: true                              # MCP λ§μ¤ν„° μ¤μ„μΉ ν™μ„±ν™”
web_search_enabled: true                    # Web Search ν™μ„±ν™”
web_reader_enabled: true                    # Web Reader ν™μ„±ν™”
vision_enabled: true                        # Vision MCP ν™μ„±ν™”
```

**λ‹¤μμ„ λ³΄μ•„μ•Ό ν•©λ‹λ‹¤**: κµ¬μ„± μ €μ¥ ν›„ νμ΄μ§€ ν•λ‹¨μ— "λ΅μ»¬ MCP μ—”λ“ν¬μΈνΈ" λ©λ΅μ΄ λ‚νƒ€λ‚λ©° μ„Έ μ—”λ“ν¬μΈνΈμ μ „μ²΄ URLμ΄ ν‘μ‹λ©λ‹λ‹¤.

### 2λ‹¨κ³„: Web Search μ—”λ“ν¬μΈνΈ κ²€μ¦

**μ΄μ **
Web Searchλ” μ›κ²© λ¦¬λ²„μ¤ ν”„λ΅μ‹μ΄λ―€λ΅ κ°€μ¥ κ°„λ‹¨ν•λ©° κΈ°λ³Έ κµ¬μ„± κ²€μ¦μ— μ ν•©ν•©λ‹λ‹¤.

```bash
 # 1) λ¨Όμ € Web Search μ—”λ“ν¬μΈνΈκ°€ μ κ³µν•λ” λ„κµ¬ λ‚μ—΄(λ„κµ¬ μ΄λ¦„μ€ μ‹¤μ  λ°ν™μ„ κΈ°μ¤€)
curl -X POST http://127.0.0.1:8045/mcp/web_search_prime/mcp \
  -H "Content-Type: application/json" \
  -d '{
    "jsonrpc": "2.0",
    "method": "tools/list",
    "id": 1
  }'
```

**λ‹¤μμ„ λ³΄μ•„μ•Ό ν•©λ‹λ‹¤**: `tools` λ¦¬μ¤νΈκ°€ ν¬ν•¨λ JSON μ‘λ‹µμ„ λ°ν™ν•©λ‹λ‹¤.

::: tip tools/call κ³„μ† κ²€μ¦(μ„ νƒ μ‚¬ν•­)
`tools[].name` λ° `tools[].inputSchema`λ¥Ό μ–»μ€ ν›„ schemaμ— λ”°λΌ `tools/call` μ”μ²­μ„ μ΅°ν•©ν•  μ μμµλ‹λ‹¤(λ§¤κ°λ³€μλ” schemaλ¥Ό κΈ°μ¤€μΌλ΅ ν•λ©° ν•„λ“ μ¶”μΈ΅ κΈμ§€).
:::

::: tip μ—”λ“ν¬μΈνΈλ¥Ό μ°Ύμ„ μ μ—†μ?
`404 Not Found`λ¥Ό μμ‹ ν•λ©΄ λ‹¤μμ„ ν™•μΈν•μ„Έμ”:
1. `proxy.zai.mcp.enabled`κ°€ `true`μΈμ§€
2. `proxy.zai.mcp.web_search_enabled`κ°€ `true`μΈμ§€
3. λ¦¬λ²„μ¤ ν”„λ΅μ‹ μ„λΉ„μ¤κ°€ μ‹¤ν–‰ μ¤‘μΈμ§€
:::

### 3λ‹¨κ³„: Web Reader μ—”λ“ν¬μΈνΈ κ²€μ¦

**μ΄μ **
Web Readerλ„ μ›κ²© λ¦¬λ²„μ¤ ν”„λ΅μ‹μ΄μ§€λ§ λ§¤κ°λ³€μ λ° λ°ν™ ν•μ‹μ΄ λ‹¤λ¥΄λ©° ν”„λ΅μ‹κ°€ λ‹¤λ¥Έ μ—”λ“ν¬μΈνΈλ¥Ό μ¬λ°”λ¥΄κ² μ²λ¦¬ν•λ”μ§€ κ²€μ¦ν•©λ‹λ‹¤.

```bash
 # 2) Web Reader μ—”λ“ν¬μΈνΈκ°€ μ κ³µν•λ” λ„κµ¬ λ‚μ—΄
curl -X POST http://127.0.0.1:8045/mcp/web_reader/mcp \
  -H "Content-Type: application/json" \
  -d '{
    "jsonrpc": "2.0",
    "method": "tools/list",
    "id": 2
  }'
```

**λ‹¤μμ„ λ³΄μ•„μ•Ό ν•©λ‹λ‹¤**: `tools` λ¦¬μ¤νΈκ°€ ν¬ν•¨λ JSON μ‘λ‹µμ„ λ°ν™ν•©λ‹λ‹¤.

### 4λ‹¨κ³„: Vision MCP μ—”λ“ν¬μΈνΈ κ²€μ¦(μ„Έμ… κ΄€λ¦¬)

**μ΄μ **
Vision MCPλ” λ‚΄μ¥ μ„λ²„μ΄λ©° μ„Έμ… μƒνƒκ°€ μμΌλ―€λ΅ λ¨Όμ € `initialize`ν• λ‹¤μ λ„κµ¬λ¥Ό νΈμ¶ν•΄μ•Ό ν•©λ‹λ‹¤.

#### 4.1 μ„Έμ… μ΄κΈ°ν™”

```bash
 # 1) initialize μ”μ²­ μ „μ†΅
curl -X POST http://127.0.0.1:8045/mcp/zai-mcp-server/mcp \
  -H "Content-Type: application/json" \
  -d '{
    "jsonrpc": "2.0",
    "method": "initialize",
    "params": {
      "protocolVersion": "2024-11-05"
    },
    "id": 1
  }'
```

**λ‹¤μμ„ λ³΄μ•„μ•Ό ν•©λ‹λ‹¤**: μ‘λ‹µμ— `mcp-session-id` ν—¤λ”κ°€ ν¬ν•¨λμ–΄ μμΌλ©° μ΄ IDλ¥Ό μ €μ¥ν•©λ‹λ‹¤.

```json
{
  "jsonrpc": "2.0",
  "result": {
    "protocolVersion": "2024-11-05",
    "capabilities": { "tools": {} },
    "serverInfo": {
      "name": "zai-mcp-server",
      "version": "<app-version>"
    }
  },
  "id": 1
}
```

::: info μ•λ¦Ό
`serverInfo.version`μ€ Rustμ `env!("CARGO_PKG_VERSION")`μ—μ„ μ¤λ©° λ³ΈμΈμ μ‹¤μ  μ„¤μΉ λ²„μ „μ„ κΈ°μ¤€μΌλ΅ ν•©λ‹λ‹¤.
:::

μ‘λ‹µ ν—¤λ”:
```
mcp-session-id: uuid-v4-string
```

#### 4.2 λ„κµ¬ λ©λ΅ νλ“

```bash
 # 2) tools/list μ”μ²­ μ „μ†΅(μ„Έμ… ID ν¬ν•¨)
curl -X POST http://127.0.0.1:8045/mcp/zai-mcp-server/mcp \
  -H "Content-Type: application/json" \
  -H "mcp-session-id: μ„Έμ…ID" \
  -d '{
    "jsonrpc": "2.0",
    "method": "tools/list",
    "id": 2
  }'
```

**λ‹¤μμ„ λ³΄μ•„μ•Ό ν•©λ‹λ‹¤**: 8κ° λ„κµ¬μ μ •μλ¥Ό λ°ν™ν•©λ‹λ‹¤(`ui_to_artifact`, `extract_text_from_screenshot`, `diagnose_error_screenshot` λ“±).

#### 4.3 λ„κµ¬ νΈμ¶

```bash
 # 3) analyze_image λ„κµ¬ νΈμ¶
curl -X POST http://127.0.0.1:8045/mcp/zai-mcp-server/mcp \
  -H "Content-Type: application/json" \
  -H "mcp-session-id: μ„Έμ…ID" \
  -d '{
    "jsonrpc": "2.0",
    "method": "tools/call",
    "params": {
      "name": "analyze_image",
      "arguments": {
        "image_source": "https://example.com/image.jpg",
        "prompt": "μ΄λ―Έμ§€ λ‚΄μ© μ„¤λ…"
      }
    },
    "id": 3
  }'
```

**λ‹¤μμ„ λ³΄μ•„μ•Ό ν•©λ‹λ‹¤**: μ΄λ―Έμ§€ λ¶„μ„ κ²°κ³Όμ ν…μ¤νΈ μ„¤λ…μ„ λ°ν™ν•©λ‹λ‹¤.

::: danger μ„Έμ… ID μ¤‘μ”
Vision MCPμ λ¨λ“  μ”μ²­(`initialize` μ μ™Έ)μ€ `mcp-session-id` ν—¤λ”λ¥Ό ν΄λ€ν•΄μ•Ό ν•©λ‹λ‹¤.

μ„Έμ… IDλ” `initialize` μ‘λ‹µμ—μ„ λ°ν™λλ©° ν›„μ† μ”μ²­μ€ λ™μΌν• IDλ¥Ό μ‚¬μ©ν•΄μ•Ό ν•©λ‹λ‹¤. μ„Έμ…μ΄ μ†μ‹¤λλ©΄ λ‹¤μ‹ `initialize`ν•΄μ•Ό ν•©λ‹λ‹¤.
:::

### 5λ‹¨κ³„: SSE keepalive ν…μ¤νΈ(μ„ νƒ μ‚¬ν•­)

**μ΄μ **
Vision MCPμ GET μ—”λ“ν¬μΈνΈλ” SSE(Server-Sent Events) μ¤νΈλ¦Όμ„ λ°ν™ν•λ©° μ—°κ²°μ„ ν™μ„± μƒνƒλ΅ μ μ§€ν•λ” λ° μ‚¬μ©λ©λ‹λ‹¤.

```bash
 # 4) GET μ—”λ“ν¬μΈνΈ νΈμ¶(SSE μ¤νΈλ¦Ό νλ“)
curl -N http://127.0.0.1:8045/mcp/zai-mcp-server/mcp \
  -H "mcp-session-id: μ„Έμ…ID"
```

**λ‹¤μμ„ λ³΄μ•„μ•Ό ν•©λ‹λ‹¤**: 15μ΄λ§λ‹¤ `event: ping` λ©”μ‹μ§€λ¥Ό λ°›μΌλ©° ν•μ‹μ€ λ‹¤μκ³Ό κ°™μµλ‹λ‹¤:

```
event: ping
data: keepalive

event: ping
data: keepalive
...
```

## μ²΄ν¬ν¬μΈνΈ β…

### κµ¬μ„± ν™•μΈ

- [ ] `proxy.zai.enabled`κ°€ `true`μ„
- [ ] `proxy.zai.api_key`κ°€ κµ¬μ„±λμ—μ(λΉ„μ–΄ μμ§€ μ•μ)
- [ ] `proxy.zai.mcp.enabled`κ°€ `true`μ„
- [ ] μµμ† ν•λ‚μ MCP μ—”λ“ν¬μΈνΈκ°€ ν™μ„±ν™”λ¨(`web_search_enabled` / `web_reader_enabled` / `vision_enabled`)
- [ ] λ¦¬λ²„μ¤ ν”„λ΅μ‹ μ„λΉ„μ¤κ°€ μ‹¤ν–‰ μ¤‘

### κΈ°λ¥ κ²€μ¦

- [ ] Web Search μ—”λ“ν¬μΈνΈκ°€ κ²€μƒ‰ κ²°κ³Όλ¥Ό λ°ν™
- [ ] Web Reader μ—”λ“ν¬μΈνΈκ°€ μ›Ή νμ΄μ§€ λ‚΄μ©μ„ λ°ν™
- [ ] Vision MCP μ—”λ“ν¬μΈνΈκ°€ μ„±κ³µμ μΌλ΅ `initialize`ν•κ³  `mcp-session-id`λ¥Ό νλ“
- [ ] Vision MCP μ—”λ“ν¬μΈνΈκ°€ λ„κµ¬ λ©λ΅μ„ λ°ν™(8κ° λ„κµ¬)
- [ ] Vision MCP μ—”λ“ν¬μΈνΈκ°€ μ„±κ³µμ μΌλ΅ λ„κµ¬λ¥Ό νΈμ¶ν•κ³  κ²°κ³Όλ¥Ό λ°ν™

## Vision MCP λ„κµ¬ μ”μ•½

| λ„κµ¬ μ΄λ¦„ | κΈ°λ¥ | ν•„μ λ§¤κ°λ³€μ | μμ‹ μ‹λ‚λ¦¬μ¤ |
| --- | --- | --- | --- |
| `ui_to_artifact` | UI μ¤ν¬λ¦°μƒ·μ„ μ½”λ“/ν”„λ΅¬ν”„νΈ/μ‚¬μ–‘/μ„¤λ…μΌλ΅ λ³€ν™ | `image_source`, `output_type`, `prompt` | λ””μμΈ μ΄μ•μ—μ„ ν”„λ΅ νΈμ—”λ“ μ½”λ“ μƒμ„± |
| `extract_text_from_screenshot` | μ¤ν¬λ¦°μƒ·μ—μ„ ν…μ¤νΈ/μ½”λ“ μ¶”μ¶(OCRκ³Ό μ μ‚¬) | `image_source`, `prompt` | μ¤λ¥ λ΅κ·Έ μ¤ν¬λ¦°μƒ· μ½κΈ° |
| `diagnose_error_screenshot` | μ¤λ¥ μ¤ν¬λ¦°μƒ· μ§„λ‹¨(μ¤νƒ μ¶”μ , λ΅κ·Έ) | `image_source`, `prompt` | λ°νƒ€μ„ μ¤λ¥ λ¶„μ„ |
| `understand_technical_diagram` | μ•„ν‚¤ν…μ²/νλ¦„/UML/ER λ‹¤μ΄μ–΄κ·Έλ¨ λ¶„μ„ | `image_source`, `prompt` | μ‹μ¤ν… μ•„ν‚¤ν…μ² λ‹¤μ΄μ–΄κ·Έλ¨ μ΄ν•΄ |
| `analyze_data_visualization` | μ°¨νΈ/λ€μ‹λ³΄λ“ λ¶„μ„ | `image_source`, `prompt` | λ€μ‹λ³΄λ“μ—μ„ νΈλ λ“ μ¶”μ¶ |
| `ui_diff_check` | λ‘ UI μ¤ν¬λ¦°μƒ· λΉ„κµ λ° μ°¨μ΄μ  λ³΄κ³  | `expected_image_source`, `actual_image_source`, `prompt` | μ‹κ°μ  νκ·€ ν…μ¤νΈ |
| `analyze_image` | μΌλ° μ΄λ―Έμ§€ λ¶„μ„ | `image_source`, `prompt` | μ΄λ―Έμ§€ λ‚΄μ© μ„¤λ… |
| `analyze_video` | λΉ„λ””μ¤ λ‚΄μ© λ¶„μ„ | `video_source`, `prompt` | λΉ„λ””μ¤ μ¥λ©΄ λ¶„μ„ |

::: info λ§¤κ°λ³€μ μ„¤λ…
- `image_source`: λ΅μ»¬ νμΌ κ²½λ΅(μ: `/tmp/screenshot.png`) λλ” μ›κ²© URL(μ: `https://example.com/image.jpg`)
- `video_source`: λ΅μ»¬ νμΌ κ²½λ΅ λλ” μ›κ²© URL(MP4, MOV, M4V μ§€μ›)
- `output_type`(`ui_to_artifact`): `code` / `prompt` / `spec` / `description`
:::

## ν”Όν•΄μ•Ό ν•  ν•¨μ •

### 404 Not Found

**ν„μƒ**: MCP μ—”λ“ν¬μΈνΈ νΈμ¶ μ‹ `404 Not Found` λ°ν™.

**μ›μΈ**:
1. μ—”λ“ν¬μΈνΈ ν™μ„±ν™”λμ§€ μ•μ(ν•΄λ‹Ή `*_enabled`κ°€ `false`)
2. λ¦¬λ²„μ¤ ν”„λ΅μ‹ μ„λΉ„μ¤ μ‹μ‘λμ§€ μ•μ
3. URL κ²½λ΅ μ¤λ¥(`/mcp/` μ ‘λ‘μ‚¬ μ£Όμ)

**ν•΄κ²°**:
1. `proxy.zai.mcp.enabled` λ° ν•΄λ‹Ή `*_enabled` κµ¬μ„± ν™•μΈ
2. λ¦¬λ²„μ¤ ν”„λ΅μ‹ μ„λΉ„μ¤ μƒνƒ ν™•μΈ
3. URL κ²½λ΅ ν•μ‹ ν™•μΈ(μ: `/mcp/web_search_prime/mcp`)

### 400 Bad Request: Missing Mcp-Session-Id

**ν„μƒ**: Vision MCP νΈμ¶ μ‹(`initialize` μ μ™Έ) `400 Bad Request` λ°ν™.

- GET μ—”λ“ν¬μΈνΈ: μ ν…μ¤νΈ `Missing Mcp-Session-Id` λ°ν™
- POST μ—”λ“ν¬μΈνΈ: JSON-RPC μ¤λ¥ `{"error":{"code":-32000,"message":"Bad Request: missing Mcp-Session-Id"}}` λ°ν™

**μ›μΈ**: μ”μ²­ ν—¤λ”μ— `mcp-session-id`κ°€ μ—†κ±°λ‚ IDκ°€ λ¬΄ν¨ν•¨.

**ν•΄κ²°**:
1. `initialize` μ”μ²­μ΄ μ„±κ³µν–λ”μ§€ ν™•μΈν•κ³  μ‘λ‹µ ν—¤λ”μ—μ„ `mcp-session-id` νλ“
2. ν›„μ† μ”μ²­(`tools/list`, `tools/call`, SSE keepalive)λ” λ¨λ‘ ν•΄λ‹Ή ν—¤λ”λ¥Ό ν΄λ€ν•΄μ•Ό ν•¨
3. μ„Έμ…μ΄ μ†μ‹¤λ κ²½μ°(μ: μ„λΉ„μ¤ μ¬μ‹μ‘) λ‹¤μ‹ `initialize`ν•΄μ•Ό ν•¨

### z.ai is not configured

**ν„μƒ**: `400 Bad Request`λ¥Ό λ°ν™ν•λ©° `z.ai is not configured` λ©”μ‹μ§€.

**μ›μΈ**: `proxy.zai.enabled`κ°€ `false`μ΄κ±°λ‚ `api_key`κ°€ λΉ„μ–΄ μμ.

**ν•΄κ²°**:
1. `proxy.zai.enabled`κ°€ `true`μΈμ§€ ν™•μΈ
2. `proxy.zai.api_key`κ°€ κµ¬μ„±λμ—λ”μ§€ ν™•μΈ(λΉ„μ–΄ μμ§€ μ•μ)

### μ—…μ¤νΈλ¦Ό μ”μ²­ μ‹¤ν¨

**ν„μƒ**: `502 Bad Gateway` λλ” λ‚΄λ¶€ μ¤λ¥ λ°ν™.

**μ›μΈ**:
1. z.ai API Keyκ°€ λ¬΄ν¨ν•κ±°λ‚ λ§λ£λ¨
2. λ„¤νΈμ›ν¬ μ—°κ²° λ¬Έμ (μ—…μ¤νΈλ¦Ό ν”„λ΅μ‹ ν•„μ”)
3. z.ai μ„λ²„ μ¤λ¥

**ν•΄κ²°**:
1. z.ai API Keyκ°€ μ¬λ°”λ¥Έμ§€ ν™•μΈ
2. `proxy.upstream_proxy` κµ¬μ„± ν™•μΈ(z.ai μ•΅μ„Έμ¤μ— ν”„λ΅μ‹κ°€ ν•„μ”ν• κ²½μ°)
3. λ΅κ·Έλ¥Ό ν™•μΈν•μ—¬ μƒμ„Έν• μ¤λ¥ μ •λ³΄ νλ“

## μ™Έλ¶€ MCP ν΄λΌμ΄μ–ΈνΈμ™€ ν†µν•©

### Claude Desktop κµ¬μ„± μμ‹

Claude Desktopμ MCP ν΄λΌμ΄μ–ΈνΈ κµ¬μ„± νμΌ(`~/.config/claude/claude_desktop_config.json`):

```json
{
  "mcpServers": {
    "antigravity-vision": {
      "command": "node",
      "args": [
        "/path/to/mcp-client-wrapper.js",
        "--endpoint",
        "http://127.0.0.1:8045/mcp/zai-mcp-server/mcp"
      ]
    },
    "antigravity-web-search": {
      "command": "node",
      "args": [
        "/path/to/mcp-client-wrapper.js",
        "--endpoint",
        "http://127.0.0.1:8045/mcp/web_search_prime/mcp"
      ]
    }
  }
}
```

::: tip Claude Desktopμ μ ν•
Claude Desktopμ MCP ν΄λΌμ΄μ–ΈνΈλ” `stdio`λ΅ ν†µμ‹ ν•΄μ•Ό ν•©λ‹λ‹¤. HTTP μ—”λ“ν¬μΈνΈλ¥Ό μ§μ ‘ μ‚¬μ©ν•λ©΄ `stdio`λ¥Ό HTTP μ”μ²­μΌλ΅ λ³€ν™ν•λ” wrapper μ¤ν¬λ¦½νΈλ¥Ό μ‘μ„±ν•΄μ•Ό ν•©λ‹λ‹¤.

λλ” HTTP MCPλ¥Ό μ§€μ›ν•λ” ν΄λΌμ΄μ–ΈνΈ(μ: Cursor)λ¥Ό μ‚¬μ©ν•μ„Έμ”.
:::

### HTTP MCP ν΄λΌμ΄μ–ΈνΈ(μ: Cursor)

ν΄λΌμ΄μ–ΈνΈκ°€ HTTP MCPλ¥Ό μ§€μ›ν•λ©΄ μ—”λ“ν¬μΈνΈ URLμ„ μ§μ ‘ κµ¬μ„±ν•  μ μμµλ‹λ‹¤:

```yaml
 # Cursor MCP κµ¬μ„±
mcpServers:
  - name: antigravity-vision
    url: http://127.0.0.1:8045/mcp/zai-mcp-server/mcp
  - name: antigravity-web-search
    url: http://127.0.0.1:8045/mcp/web_search_prime/mcp
```

## μ΄ μμ—… μ”μ•½

Antigravity Toolsμ MCP μ—”λ“ν¬μΈνΈλ” z.aiμ λ¥λ ¥μ„ νΈμ¶ κ°€λ¥ν• λ„κµ¬λ΅ λ…Έμ¶ν•λ©° λ‘ κ°€μ§€ μ ν•μΌλ΅ λ‚λ‰©λ‹λ‹¤:
- **μ›κ²© λ¦¬λ²„μ¤ ν”„λ΅μ‹**(Web Search/Web Reader): κ°„λ‹¨ν• μ „λ‹¬, μƒνƒ μ—†μ
- **λ‚΄μ¥ μ„λ²„**(Vision MCP): JSON-RPC 2.0 μ™„μ „ κµ¬ν„, μ„Έμ… κ΄€λ¦¬ ν¬ν•¨

ν•µμ‹¬ ν¬μΈνΈ:
1. ν†µν•© μΈμ¦: z.ai Keyλ” Antigravityμ—μ„ κ΄€λ¦¬ν•λ©° ν΄λΌμ΄μ–ΈνΈλ” κµ¬μ„±ν•  ν•„μ” μ—†μ
2. μ¨μ¤ν”„ κ°€λ¥: μ„Έ μ—”λ“ν¬μΈνΈκ°€ λ…λ¦½μ μΌλ΅ ν™μ„±ν™”/λΉ„ν™μ„±ν™” κ°€λ¥
3. μ„Έμ… κ²©λ¦¬: Vision MCPλ” `mcp-session-id`λ΅ ν΄λΌμ΄μ–ΈνΈ κ²©λ¦¬
4. μ μ—°ν• ν†µν•©: MCP ν”„λ΅ν† μ½μ„ μ§€μ›ν•λ” λ¨λ“  ν΄λΌμ΄μ–ΈνΈ μ§€μ›

## λ‹¤μ μμ—… μκ³ 

> λ‹¤μ μμ—…μ—μ„λ” **[Cloudflared μ›ν΄λ¦­ ν„°λ„](/ko/lbjlaq/Antigravity-Manager/platforms/cloudflared/)**λ¥Ό ν•™μµν•©λ‹λ‹¤.
>
> ν•™μµν•κ² λ  λ‚΄μ©:
> - Cloudflared ν„°λ„μ„ μ›ν΄λ¦­μΌλ΅ μ„¤μΉ λ° μ‹μ‘ν•λ” λ°©λ²•
> - quick λ¨λ“ vs auth λ¨λ“μ μ°¨μ΄
> - λ΅μ»¬ APIλ¥Ό κ³µκ° λ„¤νΈμ›ν¬μ— μ•μ „ν•κ² λ…Έμ¶ν•λ” λ°©λ²•

---

## λ¶€λ΅: μ†μ¤μ½”λ“ μ°Έμ΅°

<details>
<summary><strong>ν΄λ¦­ν•μ—¬ μ†μ¤μ½”λ“ μ„μΉ ν™•μΈ</strong></summary>

> μ—…λ°μ΄νΈ μ‹κ°„: 2026-01-23

| κΈ°λ¥ | νμΌ κ²½λ΅ | ν–‰ λ²νΈ |
| --- | --- | --- |
| Web Search μ—”λ“ν¬μΈνΈ | [`src-tauri/src/proxy/handlers/mcp.rs`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src-tauri/src/proxy/handlers/mcp.rs#L115-L135) | 115-135 |
| Web Reader μ—”λ“ν¬μΈνΈ | [`src-tauri/src/proxy/handlers/mcp.rs`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src-tauri/src/proxy/handlers/mcp.rs#L137-L157) | 137-157 |
| Vision MCP μ—”λ“ν¬μΈνΈ(λ©”μΈ μ—”νΈλ¦¬) | [`src-tauri/src/proxy/handlers/mcp.rs`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src-tauri/src/proxy/handlers/mcp.rs#L376-L397) | 376-397 |
| Vision MCP initialize μ²λ¦¬ | [`src-tauri/src/proxy/handlers/mcp.rs`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src-tauri/src/proxy/handlers/mcp.rs#L271-L293) | 271-293 |
| Vision MCP tools/list μ²λ¦¬ | [`src-tauri/src/proxy/handlers/mcp.rs`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src-tauri/src/proxy/handlers/mcp.rs#L311-L314) | 311-314 |
| Vision MCP tools/call μ²λ¦¬ | [`src-tauri/src/proxy/handlers/mcp.rs`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src-tauri/src/proxy/handlers/mcp.rs#L315-L363) | 315-363 |
| Vision MCP μ„Έμ… μƒνƒ κ΄€λ¦¬ | [`src-tauri/src/proxy/zai_vision_mcp.rs`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src-tauri/src/proxy/zai_vision_mcp.rs#L1-L42) | 1-42 |
| Vision MCP λ„κµ¬ μ •μ | [`src-tauri/src/proxy/zai_vision_tools.rs`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src-tauri/src/proxy/zai_vision_tools.rs#L166-L271) | 166-271 |
| Vision MCP λ„κµ¬ νΈμ¶ κµ¬ν„ | [`src-tauri/src/proxy/zai_vision_tools.rs`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src-tauri/src/proxy/zai_vision_tools.rs#L273-L400) | 273-400 |
| λΌμ°ν… λ“±λ΅ | [`src-tauri/src/proxy/server.rs`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src-tauri/src/proxy/server.rs#L157-L169) | 157-169 |
| μΈμ¦ λ―Έλ“¤μ›¨μ–΄ | [`src-tauri/src/proxy/middleware/auth.rs`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src-tauri/src/proxy/middleware/auth.rs#L1-L78) | 1-78 |
| MCP κµ¬μ„± UI | [`src/pages/ApiProxy.tsx`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src/pages/ApiProxy.tsx#L1304-L1357) | 1304-1357 |
| μ €μ¥μ† λ‚΄ μ„¤λ… λ¬Έμ„ | [`docs/zai/mcp.md`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/docs/zai/mcp.md#L1-L57) | 1-57 |

**ν•µμ‹¬ μƒμ**:
- `ZAI_PAAZ_CHAT_COMPLETIONS_URL = "https://api.z.ai/api/paas/v4/chat/completions"`: z.ai PaaS API μ—”λ“ν¬μΈνΈ(Vision λ„κµ¬ νΈμ¶μ©)

**ν•µμ‹¬ ν•¨μ**:
- `handle_web_search_prime()`: Web Search μ—”λ“ν¬μΈνΈμ μ›κ²© λ¦¬λ²„μ¤ ν”„λ΅μ‹ μ²λ¦¬
- `handle_web_reader()`: Web Reader μ—”λ“ν¬μΈνΈμ μ›κ²© λ¦¬λ²„μ¤ ν”„λ΅μ‹ μ²λ¦¬
- `handle_zai_mcp_server()`: Vision MCP μ—”λ“ν¬μΈνΈμ λ¨λ“  λ©”μ„λ“ μ²λ¦¬(GET/POST/DELETE)
- `mcp_session_id()`: μ”μ²­ ν—¤λ”μ—μ„ `mcp-session-id` μ¶”μ¶
- `forward_mcp()`: μΌλ° MCP μ „λ‹¬ ν•¨μ(μΈμ¦ μ£Όμ… λ° μ—…μ¤νΈλ¦Ό μ „λ‹¬)
- `tool_specs()`: Vision MCPμ λ„κµ¬ μ •μ λ©λ΅ λ°ν™
- `call_tool()`: μ§€μ •λ Vision MCP λ„κµ¬ μ‹¤ν–‰

</details>
