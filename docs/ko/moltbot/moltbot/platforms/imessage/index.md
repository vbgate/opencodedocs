---
title: "iMessage ì±„ë„ êµ¬ì„±: ì„¤ì¹˜, ê¶Œí•œ ì„¤ì • ë° ë‹¤ì¤‘ ê³„ì • ì§€ì› | Clawdbot íŠœí† ë¦¬ì–¼"
sidebarTitle: "iMessageë¡œ ì±„íŒ…í•˜ê¸°"
subtitle: "iMessage ì±„ë„ êµ¬ì„±"
description: "Clawdbotì˜ iMessage ì±„ë„ì„ êµ¬ì„±í•©ë‹ˆë‹¤(macOS ì „ìš©). íŠœí† ë¦¬ì–¼ì€ imsg CLI ì„¤ì¹˜, ê¶Œí•œ ì„¤ì •, ë¡œì»¬/ì›ê²© Mac êµ¬ì„±, ë‹¤ì¤‘ ê³„ì • ì§€ì›, DM/ê·¸ë£¹ ì•¡ì„¸ìŠ¤ ì œì–´, ë©”ì‹œì§€ ì „ì†¡ ë° ìƒì„¸í•œ ë¬¸ì œ í•´ê²°ì„ ë‹¤ë£¹ë‹ˆë‹¤."
tags:
  - "platforms"
  - "imessage"
  - "macos"
prerequisite:
  - "start-getting-started"
order: 130
---

# iMessage ì±„ë„ êµ¬ì„±

## í•™ìŠµ ì™„ë£Œ í›„ í•  ìˆ˜ ìˆëŠ” ê²ƒ

- macOSì—ì„œ iMessageë¥¼ í†µí•´ AI ì–´ì‹œìŠ¤í„´íŠ¸ì™€ 1:1 ê°œì¸ ì±„íŒ…
- iMessage ê·¸ë£¹ì—ì„œ AI ì–´ì‹œìŠ¤í„´íŠ¸ ì‚¬ìš©(@ë©˜ì…˜ ì§€ì›)
- ë´‡ IDë¥¼ ë¶„ë¦¬í•˜ê¸° ìœ„í•´ ì „ìš© Mac ì‚¬ìš©ì êµ¬ì„±
- SSH/Tailscaleì„ í†µí•´ ì›ê²© Macì˜ iMessageì— ì•¡ì„¸ìŠ¤
- DM í˜ì–´ë§ ë° ê·¸ë£¹ í—ˆìš© ëª©ë¡ ì•¡ì„¸ìŠ¤ ì œì–´ ë§ˆìŠ¤í„°

## í˜„ì¬ ê²ªê³  ìˆëŠ” ë¬¸ì œ

macOSì—ì„œ iMessageë¥¼ í†µí•´ AI ì–´ì‹œìŠ¤í„´íŠ¸ì™€ ìƒí˜¸ì‘ìš©í•˜ê³  ì‹¶ì§€ë§Œ ë‹¤ìŒ ë°©ë²•ì„ ëª¨ë¦…ë‹ˆë‹¤:

- `imsg` CLI ë„êµ¬ ì„¤ì¹˜ ë° êµ¬ì„±
- Clawdbotì— ì „ì²´ ë””ìŠ¤í¬ ì•¡ì„¸ìŠ¤ ë° ìë™í™” ê¶Œí•œ ë¶€ì—¬
- iMessage ê²Œì´íŠ¸ì›¨ì´ë¡œ ë¡œì»¬ ë˜ëŠ” ì›ê²© Mac êµ¬ì„±
- ì—¬ëŸ¬ iMessage ê³„ì • ì„¤ì •
- ë´‡ì— ëˆ„ê°€ ë©”ì‹œì§€ë¥¼ ë³´ë‚¼ ìˆ˜ ìˆëŠ”ì§€ ì œì–´

## ì–¸ì œ ì´ ë°©ë²•ì„ ì‚¬ìš©í•´ì•¼ í•˜ë‚˜ìš”

**iMessage ì±„ë„ ì‚¬ìš©ì— ì í•©í•œ ì‹œë‚˜ë¦¬ì˜¤**:

- ì£¼ë¡œ macOSì—ì„œ iMessageë¥¼ ì‚¬ìš©
- ë¡œì»¬ iMessageë¥¼ ì‚¬ìš©í•˜ê³  ì‹¶ìŒ(ì œ3ì ì„œë²„ì— ì˜ì¡´í•˜ì§€ ì•ŠìŒ)
- iMessageë¥¼ í†µí•´ AI ì–´ì‹œìŠ¤í„´íŠ¸ì™€ í…ìŠ¤íŠ¸ ë° ë¯¸ë””ì–´ ìƒí˜¸ì‘ìš© í•„ìš”
- ë‹¤ë¥¸ ì±„ë„(WhatsApp, Telegram)ê³¼ ë™ì¼í•œ ëŒ€í™” í™˜ê²½ ìœ ì§€í•˜ê³  ì‹¶ìŒ

**ì í•©í•˜ì§€ ì•Šì€ ì‹œë‚˜ë¦¬ì˜¤**:

- macOSê°€ ì•„ë‹Œ ì‹œìŠ¤í…œ(iMessage ì±„ë„ì€ macOSë§Œ ì§€ì›)
- í¬ë¡œìŠ¤ í”Œë«í¼ ë™ê¸°í™” í•„ìš”(WebChat, Telegram ê³ ë ¤)
- ê·¸ë£¹ @ë©˜ì…˜ ê¸°ëŠ¥ í•„ìš”(iMessageì—ëŠ” ì›ë˜ ë©˜ì…˜ ë©”ì»¤ë‹ˆì¦˜ì´ ì—†ìœ¼ë©° ìˆ˜ë™ êµ¬ì„± í•„ìš”)

## í•µì‹¬ ê°œë…

iMessage ì±„ë„ì˜ ì›Œí¬í”Œë¡œìš°:

```mermaid
sequenceDiagram
    participant User as ì‚¬ìš©ì
    participant iMsg as Messages ì•±
    participant IMsg as imsg CLI
    participant Clawdbot as Clawdbot ê²Œì´íŠ¸ì›¨ì´

    User->>iMsg: ë©”ì‹œì§€ ì†¡ìˆ˜ì‹ 
    iMsg->>IMsg: chat.db ê°ì‹œ
    IMsg->>Clawdbot: stdioë¥¼ í†µí•œ JSON-RPC
    Clawdbot->>Clawdbot: ê¶Œí•œ í™•ì¸ (DM/ê·¸ë£¹)
    Clawdbot->>Clawdbot: ë©”ì‹œì§€ ì²˜ë¦¬ (Agent)
    Clawdbot->>IMsg: ì‘ë‹µ ì†¡ì‹  (JSON-RPC)
    IMsg->>iMsg: ìë™í™” ê¶Œí•œ
    iMsg->>User: íšŒì‹  í‘œì‹œ
```

**í•µì‹¬ ê°œë…**:

| ê°œë… | ì„¤ëª… |
|--- | ---|
| **imsg CLI** | stdioë¥¼ í†µí•œ JSON-RPCë¡œ Messagesì™€ ìƒí˜¸ì‘ìš©í•˜ëŠ” ì œ3ì ë„êµ¬ |
| **ì „ì²´ ë””ìŠ¤í¬ ì•¡ì„¸ìŠ¤** | Clawdbotì´ Messages chat.dbë¥¼ ì½ë„ë¡ í—ˆìš©í•˜ëŠ” macOS ê¶Œí•œ |
| **ìë™í™” ê¶Œí•œ** | imsgê°€ ìë™í™” APIë¥¼ í†µí•´ ë©”ì‹œì§€ë¥¼ ë³´ë‚¼ ìˆ˜ ìˆë„ë¡ í—ˆìš©í•˜ëŠ” macOS ê¶Œí•œ |
| **chat_id** | ë¼ìš°íŒ… ë° ëŒ€í™” ì„¸ë¶„í™”ì— ì‚¬ìš©ë˜ëŠ” ì•ˆì •ì ì¸ ì±„íŒ… ì‹ë³„ì |
| **í˜ì–´ë§** | ê¸°ë³¸ DM ë³´í˜¸ ë©”ì»¤ë‹ˆì¦˜, ë‚¯ì„  ë°œì‹ ìëŠ” ìŠ¹ì¸ í•„ìš” |

::: tip
iMessage ì±„ë„ì€ Messages APIë¥¼ ì§ì ‘ í˜¸ì¶œí•˜ëŠ” ëŒ€ì‹  `imsg` CLIë¥¼ í†µí•´ êµ¬í˜„ë©ë‹ˆë‹¤. `imsg`ëŠ” stdioë¥¼ í†µí•œ JSON-RPCë¡œ Clawdbotê³¼ í†µì‹ í•˜ë¯€ë¡œ ì›ê²© Macì—ì„œ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤(SSHë¥¼ í†µí•´).
:::

## ğŸ’ ì‹œì‘ ì „ ì¤€ë¹„

ë‹¤ìŒì„ ì™„ë£Œí–ˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”:

- âœ… [ë¹ ë¥¸ ì‹œì‘](../../start/getting-started/)ì„ ì™„ë£Œí•˜ê³  Clawdbotì„ ì„¤ì¹˜
- âœ… Gatewayê°€ ì‹¤í–‰ ì¤‘(`clawdbot gateway --port 18789`)
- âœ… macOSì—ì„œ Messagesì— ë¡œê·¸ì¸(iMessage í™œì„±í™”)
- âœ… Homebrew ì•¡ì„¸ìŠ¤ ê¶Œí•œ ìˆìŒ(`imsg` ì„¤ì¹˜ìš©)

::: warning
iMessage ì±„ë„ì€ macOSë§Œ ì§€ì›í•©ë‹ˆë‹¤. Gatewayê°€ macOSì—ì„œ ì‹¤í–‰ë˜ê³  ìˆê±°ë‚˜ SSH/Tailscaleì„ í†µí•´ ì›ê²© Macì— ì—°ê²°ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”.
:::

## ë”°ë¼í•´ ë³´ì„¸ìš”

### 1ë‹¨ê³„: imsg CLI ì„¤ì¹˜

**ì´ìœ **
`imsg`ëŠ” iMessage ì±„ë„ì˜ í•µì‹¬ ì˜ì¡´ì„±ì´ë©°, stdioë¥¼ í†µí•œ JSON-RPCë¡œ Messages ì•±ê³¼ ìƒí˜¸ì‘ìš©í•©ë‹ˆë‹¤.

1. Homebrewë¡œ ì„¤ì¹˜:
    ```bash
    brew install steipete/tap/imsg
    ```

**ë‹¤ìŒì„ ë³¼ ìˆ˜ ìˆì–´ì•¼ í•©ë‹ˆë‹¤**:
- ì„¤ì¹˜ ì„±ê³µ í›„ `imsg` ëª…ë ¹ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŒ
- `imsg --version` ì‹¤í–‰ ì‹œ ë²„ì „ ì •ë³´ í‘œì‹œ

**ì„¤ì¹˜ í™•ì¸**:

```bash
# imsgë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ”ì§€ í…ŒìŠ¤íŠ¸
imsg chats --limit 1
```

**ë‹¤ìŒì„ ë³¼ ìˆ˜ ìˆì–´ì•¼ í•©ë‹ˆë‹¤**:
- ìµœì†Œ í•˜ë‚˜ì˜ ì±„íŒ… ê¸°ë¡ ì¶œë ¥(ìˆëŠ” ê²½ìš°)
- ë˜ëŠ” ì „ì²´ ë””ìŠ¤í¬ ì•¡ì„¸ìŠ¤ ê¶Œí•œ ë¶€ì—¬ í•„ìš” ë©”ì‹œì§€

### 2ë‹¨ê³„: ì „ì²´ ë””ìŠ¤í¬ ì•¡ì„¸ìŠ¤ ê¶Œí•œ ë¶€ì—¬

**ì´ìœ **
Clawdbotì€ ìƒˆ ë©”ì‹œì§€ë¥¼ ê°ì‹œí•˜ê¸° ìœ„í•´ Messagesì˜ `chat.db` ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì½ì–´ì•¼ í•©ë‹ˆë‹¤.

1. **ì‹œìŠ¤í…œ ì„¤ì •** > **ê°œì¸ ì •ë³´ ë³´ì•ˆ ë° ë³´ì•ˆ** ì—´ê¸°
2. **ì „ì²´ ë””ìŠ¤í¬ ì•¡ì„¸ìŠ¤** í´ë¦­
3. **+** í´ë¦­í•˜ì—¬ ë‹¤ìŒ ì•± ì¶”ê°€:
    - `/Applications/Clawdbot.app`(macOS ì•±ì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš°)
    - `/usr/local/bin/imsg` ë˜ëŠ” `imsg`ì˜ ì‹¤ì œ ê²½ë¡œ
4. Gateway ì¬ì‹œì‘

::: warning
ê¶Œí•œ ë³€ê²½ í›„ ë°˜ë“œì‹œ Gatewayë¥¼ ì¬ì‹œì‘í•´ì•¼ íš¨ë ¥ì´ ë°œìƒí•©ë‹ˆë‹¤!
:::

**ë‹¤ìŒì„ ë³¼ ìˆ˜ ìˆì–´ì•¼ í•©ë‹ˆë‹¤**:
- Gateway ì‹œì‘ ë¡œê·¸ì— ê¶Œí•œ ì˜¤ë¥˜ ì—†ìŒ
- `imsg chats --limit 1`ì´ ì •ìƒì ìœ¼ë¡œ ì±„íŒ… ëª©ë¡ì„ ì¶œë ¥

### 3ë‹¨ê³„: ìë™í™” ê¶Œí•œ ë¶€ì—¬

**ì´ìœ **
`imsg`ëŠ” Apple Events ìë™í™” APIë¥¼ í†µí•´ ë©”ì‹œì§€ë¥¼ ë³´ë‚´ë©° ì‚¬ìš©ì ìŠ¹ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.

1. ë©”ì‹œì§€ë¥¼ ì²˜ìŒ ë³´ë‚¼ ë•Œ macOSì— ê¶Œí•œ í”„ë¡¬í”„íŠ¸ê°€ í‘œì‹œë©ë‹ˆë‹¤
2. **í—ˆìš©** ë˜ëŠ” **í™•ì¸** í´ë¦­
3. ì „ìš© Mac ì‚¬ìš©ìë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš° í•´ë‹¹ ì‚¬ìš©ì ì„¸ì…˜ì—ì„œ í…ŒìŠ¤íŠ¸ë¥¼ í•œ ë²ˆ ì‹¤í–‰

**ìë™í™” ê¶Œí•œ í…ŒìŠ¤íŠ¸**:

```bash
# í…ŒìŠ¤íŠ¸ ë©”ì‹œì§€ ì „ì†¡(ì‹¤ì œ ìˆ˜ì‹ ìë¡œ ëŒ€ì²´)
imsg send --to "+15555550123" "Test message"
```

**ë‹¤ìŒì„ ë³¼ ìˆ˜ ìˆì–´ì•¼ í•©ë‹ˆë‹¤**:
- macOS ê¶Œí•œ í”„ë¡¬í”„íŠ¸ í‘œì‹œ(ì²˜ìŒ)
- ê¶Œí•œ ë¶€ì—¬ í›„ ë©”ì‹œì§€ ì„±ê³µì ìœ¼ë¡œ ì „ì†¡
- Messages ì•±ì— í…ŒìŠ¤íŠ¸ ë©”ì‹œì§€ í‘œì‹œ

### 4ë‹¨ê³„: Clawdbot êµ¬ì„±

**ì´ìœ **
Clawdbotì— ì‚¬ìš©í•  `imsg` ê²½ë¡œ ë° Messages ë°ì´í„°ë² ì´ìŠ¤ ìœ„ì¹˜ë¥¼ ì•Œë ¤ì¤ë‹ˆë‹¤.

**ë°©ë²• A: ê°„ë‹¨í•œ êµ¬ì„±(ë¡œì»¬ Mac)**

`~/.clawdbot/clawdbot.json` í¸ì§‘:

```json5
{
  channels: {
    imessage: {
      enabled: true,
      cliPath: "/usr/local/bin/imsg",
      dbPath: "/Users/<your-username>/Library/Messages/chat.db",
      dmPolicy: "pairing",
      groupPolicy: "allowlist"
    }
  }
}
```

::: info
`<your-username>`ì„ ì‹¤ì œ macOS ì‚¬ìš©ì ì´ë¦„ìœ¼ë¡œ ëŒ€ì²´í•˜ì„¸ìš”.
:::

**ë°©ë²• B: ë‹¤ì¤‘ ê³„ì • êµ¬ì„±**

```json5
{
  channels: {
    imessage: {
      enabled: true,
      accounts: {
        main: {
          name: "Main Account",
          enabled: true,
          cliPath: "/usr/local/bin/imsg",
          dbPath: "/Users/alice/Library/Messages/chat.db"
        },
        bot: {
          name: "Bot Account",
          enabled: true,
          cliPath: "/path/to/imsg-bot-wrapper",  // 5ë‹¨ê³„ ì°¸ì¡°
          dbPath: "/Users/botuser/Library/Messages/chat.db"
        }
      }
    }
  }
}
```

**Gateway ì¬ì‹œì‘**:

```bash
clawdbot gateway restart
```

**ë‹¤ìŒì„ ë³¼ ìˆ˜ ìˆì–´ì•¼ í•©ë‹ˆë‹¤**:
- Gatewayê°€ ì‹œì‘ë˜ê³  "iMessage default: enabled, configured, ..." í‘œì‹œ
- ê¶Œí•œ ë˜ëŠ” ê²½ë¡œ ì˜¤ë¥˜ ë¡œê·¸ ì—†ìŒ

### 5ë‹¨ê³„: í…ŒìŠ¤íŠ¸ ë©”ì‹œì§€ ì „ì†¡

**ì´ìœ **
êµ¬ì„±ì´ ì˜¬ë°”ë¥¸ì§€ ë©”ì‹œì§€ê°€ ì •ìƒì ìœ¼ë¡œ ì „ë‹¬ë˜ëŠ”ì§€ í™•ì¸í•©ë‹ˆë‹¤.

1. CLIë¥¼ ì‚¬ìš©í•˜ì—¬ í…ŒìŠ¤íŠ¸ ë©”ì‹œì§€ ì „ì†¡:
    ```bash
    clawdbot message --to imessage:+15555550123 "Hello from Clawdbot!"
    ```

**ë‹¤ìŒì„ ë³¼ ìˆ˜ ìˆì–´ì•¼ í•©ë‹ˆë‹¤**:
- Messages ì•±ì— ë©”ì‹œì§€ ìˆ˜ì‹ 
- Gateway ë¡œê·¸ì— ë©”ì‹œì§€ ì „ì†¡ë¨ í‘œì‹œ
- AI ëª¨ë¸ì„ êµ¬ì„±í•œ ê²½ìš° AI ì‘ë‹µ ìˆ˜ì‹ 

::: info
`imessage:+15555550123` í˜•ì‹ì€ ì „í™”ë²ˆí˜¸ `+15555550123`ë¡œ iMessage ì±„ë„ì„ í†µí•´ ì „ì†¡í•¨ì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. ì´ë©”ì¼ ì£¼ì†Œ `imessage:user@example.com`ë„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
:::

## ì²´í¬í¬ì¸íŠ¸ âœ…

êµ¬ì„± ì„±ê³µ ì—¬ë¶€ í™•ì¸:

```bash
# ì±„ë„ ìƒíƒœ í™•ì¸
clawdbot channels status

# ë‹¤ìŒì„ í‘œì‹œí•´ì•¼ í•¨:
# iMessage default: enabled, configured, rpc listening
```

::: info
ì˜¤ë¥˜ê°€ í‘œì‹œë˜ë©´ `clawdbot channels status --probe`ë¥¼ ì‹¤í–‰í•˜ì—¬ ìì„¸í•œ ì§„ë‹¨ ì •ë³´ë¥¼ í™•ì¸í•˜ì„¸ìš”.
:::

## ê³ ê¸‰ êµ¬ì„±

### ì „ìš© Mac ì‚¬ìš©ì êµ¬ì„±(ì„ íƒ ì‚¬í•­)

ë³„ë„ì˜ iMessage IDë¥¼ ì‚¬ìš©í•˜ê³  ì‹¶ì€ ê²½ìš°(ê°œì¸ Messagesë¥¼ ì˜¤ì—¼ì‹œí‚¤ì§€ ì•ŠìŒ), ì „ìš© Mac ì‚¬ìš©ìë¥¼ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**ë‹¨ê³„**:

1. **ì „ìš© Apple ID ë§Œë“¤ê¸°**:
    - [appleid.apple.com](https://appleid.apple.com) ë°©ë¬¸
    - ìƒˆ Apple ID ë§Œë“¤ê¸°(ì˜ˆ: `my-cool-bot@icloud.com`)

2. **macOS ì‚¬ìš©ì ë§Œë“¤ê¸°**:
    - **ì‹œìŠ¤í…œ ì„¤ì •** > **ì‚¬ìš©ì ë° ê·¸ë£¹** ì—´ê¸°
    - **+** í´ë¦­í•˜ì—¬ ìƒˆ ì‚¬ìš©ì ë§Œë“¤ê¸°(ì˜ˆ: `botuser`)
    - ìë™ ë¡œê·¸ì¸ ë˜ëŠ” ì•”í˜¸ ì €ì¥ ì„¤ì •

3. **ì „ìš© iMessage ê³„ì •ì— ë¡œê·¸ì¸**:
    - `botuser` ì‚¬ìš©ìë¡œ ì „í™˜
    - Messages ì•± ì—´ê¸°
    - ì „ìš© Apple IDë¡œ iMessageì— ë¡œê·¸ì¸

4. **ì›ê²© ë¡œê·¸ì¸ í™œì„±í™”**:
    - **ì‹œìŠ¤í…œ ì„¤ì •** > **ì¼ë°˜** > **ê³µìœ ** ì—´ê¸°
    - **ì›ê²© ë¡œê·¸ì¸** í™œì„±í™”

5. **SSH ë¹„ë°€ë²ˆí˜¸ ì—†ëŠ” ë¡œê·¸ì¸ ì„¤ì •**:
    ```bash
    # ë©”ì¸ ì‚¬ìš©ìì—ì„œ SSH í…ŒìŠ¤íŠ¸
    ssh botuser@localhost true

    # ì•”í˜¸ê°€ í•„ìš”í•œ ê²½ìš° SSH í‚¤ êµ¬ì„±:
    ssh-keygen -t ed25519
    ssh-copy-id botuser@localhost
    ```

6. **SSH wrapper ìŠ¤í¬ë¦½íŠ¸ ë§Œë“¤ê¸°**:

    `~/.clawdbot/scripts/imsg-bot` ë§Œë“¤ê¸°(`chmod +x`):

    ```bash
    #!/usr/bin/env bash
    set -euo pipefail

    # ëŒ€í™”í˜• SSHë¥¼ í•œ ë²ˆ ì‹¤í–‰í•˜ì—¬ í˜¸ìŠ¤íŠ¸ í‚¤ ìˆ˜ë½:
    #   ssh botuser@localhost true
    exec /usr/bin/ssh -o BatchMode=yes -o ConnectTimeout=5 -T botuser@localhost \
      "/usr/local/bin/imsg" "$@"
    ```

7. **Clawdbot êµ¬ì„±**:

    ```json5
    {
      channels: {
        imessage: {
          enabled: true,
          accounts: {
            bot: {
              name: "Bot",
              enabled: true,
              cliPath: "/Users/<your-username>/.clawdbot/scripts/imsg-bot",
              dbPath: "/Users/botuser/Library/Messages/chat.db"
            }
          }
        }
      }
    }
    ```

::: tip
ì²˜ìŒ êµ¬ì„±í•  ë•Œ `botuser` ì„¸ì…˜ì—ì„œ `imsg chats --limit 1` ë˜ëŠ” `imsg send ...`ë¥¼ í•œ ë²ˆ ì‹¤í–‰í•˜ì—¬ ìë™í™” ê¶Œí•œì„ ë¶€ì—¬í•˜ì„¸ìš”.
:::

### ì›ê²© Mac êµ¬ì„±(ì„ íƒ ì‚¬í•­)

Gatewayê°€ Linux/VMì—ì„œ ì‹¤í–‰ë˜ì§€ë§Œ iMessageê°€ Macì—ì„œ í•„ìš”í•œ ê²½ìš° SSH ì›ê²© ì—°ê²°ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**ì•„í‚¤í…ì²˜**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          SSH (imsg rpc)          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Gateway í˜¸ìŠ¤íŠ¸ (Linux/VM)     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ Mac with Messages + imsg â”‚
â”‚ - clawdbot gateway           â”‚          SCP (attachments)        â”‚ - Messages signed in     â”‚
â”‚ - channels.imessage.cliPath  â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ - Remote Login enabled   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â–²
               â”‚ Tailscale tailnet (hostname or 100.x.y.z)
               â–¼
         user@remote-mac
```

**êµ¬ì„± ë‹¨ê³„**:

1. **SSH wrapper ë§Œë“¤ê¸°**(`~/.clawdbot/scripts/imsg-ssh`):

    ```bash
    #!/usr/bin/env bash
    exec ssh -T bot@remote-mac imsg "$@"
    ```

2. **Clawdbot êµ¬ì„±**:

    ```json5
    {
      channels: {
        imessage: {
          enabled: true,
          cliPath: "/Users/<your-username>/.clawdbot/scripts/imsg-ssh",
          remoteHost: "bot@remote-mac",
          includeAttachments: true,
          dbPath: "/Users/bot/Library/Messages/chat.db"
        }
      }
    }
    ```

::: info
`remoteHost`ëŠ” SCP ì²¨ë¶€ íŒŒì¼ ì „ì†¡ì— ì‚¬ìš©ë©ë‹ˆë‹¤. ì„¤ì •í•˜ì§€ ì•Šìœ¼ë©´ Clawdbotì´ SSH ëª…ë ¹ì—ì„œ ìë™ìœ¼ë¡œ ê°ì§€í•˜ë ¤ê³  ì‹œë„í•©ë‹ˆë‹¤. ëª…ì‹œì  êµ¬ì„±ì´ ë” ì‹ ë¢°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
:::

**Tailscale êµ¬ì„± ì˜ˆì‹œ**:

```bash
# SSH wrapper
#!/usr/bin/env bash
exec ssh -T bot@mac-mini.tailnet-1234.ts.net imsg "$@"
```

```json5
{
  channels: {
    imessage: {
      enabled: true,
      cliPath: "~/.clawdbot/scripts/imsg-ssh",
      remoteHost: "bot@mac-mini.tailnet-1234.ts.net",
      includeAttachments: true,
      dbPath: "/Users/bot/Library/Messages/chat.db"
    }
  }
}
```

## êµ¬ì„± ìƒì„¸

### ê¸°ë³¸ êµ¬ì„±

| êµ¬ì„± í•­ëª© | íƒ€ì… | ê¸°ë³¸ê°’ | ì„¤ëª… |
|--- | --- | --- | ---|
| `enabled` | boolean | false | iMessage ì±„ë„ í™œì„±í™” ì—¬ë¶€ |
| `cliPath` | string | "imsg" | imsg CLI ê²½ë¡œ(SSH wrapper ê°€ëŠ¥) |
| `dbPath` | string | - | Messages chat.db ê²½ë¡œ |
| `remoteHost` | string | - | SSH í˜¸ìŠ¤íŠ¸(SCP ì²¨ë¶€ íŒŒì¼ ì „ì†¡ìš©) |

### DM ì •ì±…

| êµ¬ì„± í•­ëª© | íƒ€ì… | ê¸°ë³¸ê°’ | ì„¤ëª… |
|--- | --- | --- | ---|
| `dmPolicy` | "pairing"|"allowlist"|"open"|"disabled" | "pairing" | DM ì•¡ì„¸ìŠ¤ ì •ì±… |
| `allowFrom` | array | [] | í—ˆìš©ëœ ë°œì‹ ì ëª©ë¡(handles, ì´ë©”ì¼, E.164, `chat_id:*`) |

**ìƒˆ ë°œì‹ ì í˜ì–´ë§**:

```bash
# ëŒ€ê¸° ì¤‘ì¸ í˜ì–´ë§ ì½”ë“œ ë‚˜ì—´
clawdbot pairing list imessage

# í˜ì–´ë§ ìŠ¹ì¸
clawdbot pairing approve imessage <CODE>
```

::: tip
iMessageì—ëŠ” ì‚¬ìš©ì ì´ë¦„ ê°œë…ì´ ì—†ìœ¼ë©° handles(ì „í™”ë²ˆí˜¸ ë˜ëŠ” ì´ë©”ì¼ ì£¼ì†Œ) ë˜ëŠ” chat targets(`chat_id`, `chat_guid`, `chat_identifier`)ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.
:::

### ê·¸ë£¹ ì •ì±…

| êµ¬ì„± í•­ëª© | íƒ€ì… | ê¸°ë³¸ê°’ | ì„¤ëª… |
|--- | --- | --- | ---|
| `groupPolicy` | "allowlist"|"open"|"disabled" | "allowlist" | ê·¸ë£¹ ì•¡ì„¸ìŠ¤ ì •ì±… |
| `groupAllowFrom` | array | [] | ê·¸ë£¹ì—ì„œ AIë¥¼ íŠ¸ë¦¬ê±°í•  ìˆ˜ ìˆëŠ” ë°œì‹ ì |
| `groups` | object | {} | chat_idë³„ ê·¸ë£¹ êµ¬ì„± |

**ê·¸ë£¹ êµ¬ì„± ì˜ˆì‹œ**:

```json5
{
  channels: {
    imessage: {
      groupPolicy: "allowlist",
      groupAllowFrom: ["+15555550123", "alice@example.com"],
      groups: {
        "42": {
          requireMention: false,
          allowFrom: ["bob@example.com"]
        }
      }
    }
  }
}
```

### ë¯¸ë””ì–´ ë° í…ìŠ¤íŠ¸ ì œí•œ

| êµ¬ì„± í•­ëª© | íƒ€ì… | ê¸°ë³¸ê°’ | ì„¤ëª… |
|--- | --- | --- | ---|
| `includeAttachments` | boolean | false | ì²¨ë¶€ íŒŒì¼ì„ ì»¨í…ìŠ¤íŠ¸ì— í¬í•¨í• ì§€ ì—¬ë¶€ |
| `mediaMaxMb` | number | 16 | ìµœëŒ€ ë¯¸ë””ì–´ íŒŒì¼ í¬ê¸°(MB) |
| `textChunkLimit` | number | 4000 | ë°œì‹  í…ìŠ¤íŠ¸ ì²­í¬ í¬ê¸°(ë¬¸ì) |
| `chunkMode` | "length"|"newline" | "length" | ì²­í¬ ëª¨ë“œ: ê¸¸ì´ë³„ ë˜ëŠ” ë¹ˆ ì¤„ë³„ |

### ê¸°ë¡

| êµ¬ì„± í•­ëª© | íƒ€ì… | ê¸°ë³¸ê°’ | ì„¤ëª… |
|--- | --- | --- | ---|
| `historyLimit` | number | - | ê·¸ë£¹ ìµœëŒ€ ê¸°ë¡ ë©”ì‹œì§€ ìˆ˜(0ì€ ë¹„í™œì„±í™”) |
| `dmHistoryLimit` | number | - | DM ê¸°ë¡ ì œí•œ(ì‚¬ìš©ì í„´ ìˆ˜) |
| `dms["<handle>"].historyLimit` | number | - | handleë³„ DM ê¸°ë¡ ì œí•œ ë®ì–´ì“°ê¸° |

## ë¬¸ì œ í•´ê²°

### imsg rpc ëª…ë ¹ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ìŒ

**ì¦ìƒ**: Gateway ë¡œê·¸ì— "imsg CLI does not support 'rpc' subcommand" í‘œì‹œ

**ì›ì¸**: `imsg` ë²„ì „ì´ ë„ˆë¬´ ì˜¤ë˜ë˜ì–´ `rpc` í•˜ìœ„ ëª…ë ¹ì„ ì§€ì›í•˜ì§€ ì•ŠìŒ

**í•´ê²° ë°©ë²•**:

1. `imsg` ì—…ë°ì´íŠ¸:
    ```bash
    brew upgrade steipete/tap/imsg
    ```

2. ë²„ì „ í™•ì¸:
    ```bash
    imsg rpc --help
    ```

### ì „ì²´ ë””ìŠ¤í¬ ì•¡ì„¸ìŠ¤ ê¶Œí•œ ë¬¸ì œ

**ì¦ìƒ**: `imsg chats --limit 1`ì— ì¶œë ¥ì´ ì—†ê±°ë‚˜ "Permission denied" ì˜¤ë¥˜

**í•´ê²° ë°©ë²•**:

1. Clawdbotê³¼ `imsg`ë¥¼ ì „ì²´ ë””ìŠ¤í¬ ì•¡ì„¸ìŠ¤ì— ì¶”ê°€í–ˆëŠ”ì§€ í™•ì¸
2. Gateway ì¬ì‹œì‘
3. ë¬¸ì œê°€ ì§€ì†ë˜ë©´ Mac ì¬ì‹œì‘ ì‹œë„

### ìë™í™” ê¶Œí•œ ë¬¸ì œ

**ì¦ìƒ**: ë©”ì‹œì§€ë¥¼ ë³´ë‚¼ ë•Œ ë°˜ì‘ì´ ì—†ê³  Gateway ë¡œê·¸ì— ì‹œê°„ ì´ˆê³¼ í‘œì‹œ

**ì›ì¸**: macOSì—ì„œ ìë™í™” ê¶Œí•œì„ ë¶€ì—¬í•˜ì§€ ì•ŠìŒ

**í•´ê²° ë°©ë²•**:

1. Messages ì•±ì—ì„œ ë©”ì‹œì§€ë¥¼ ìˆ˜ë™ìœ¼ë¡œ ì „ì†¡
2. macOSì— ê¶Œí•œ í”„ë¡¬í”„íŠ¸ê°€ í‘œì‹œë˜ì–´ì•¼ í•¨
3. **í—ˆìš©** í´ë¦­
4. ì „ìš© Mac ì‚¬ìš©ìë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš° í•´ë‹¹ ì‚¬ìš©ìë¡œ ì „í™˜í•˜ì—¬ ë‹¨ê³„ ë°˜ë³µ

### ì›ê²© Mac ì—°ê²° ì‹¤íŒ¨

**ì¦ìƒ**: SSH wrapper ì‹œê°„ ì´ˆê³¼ ë˜ëŠ” ì—°ê²° ê±°ë¶€

**í•´ê²° ë°©ë²•**:

1. SSH ì—°ê²° í…ŒìŠ¤íŠ¸:
    ```bash
    ssh -T bot@remote-mac imsg --version
    ```

2. ì›ê²© ë¡œê·¸ì¸ì´ í™œì„±í™”ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸(ì›ê²© Mac)

3. ë°©í™”ë²½ ë° í¬íŠ¸ ì„¤ì • í™•ì¸

4. Tailscaleë¥¼ ì‚¬ìš©í•˜ì—¬ ë‚´ë¶€ ë„¤íŠ¸ì›Œí¬ í„°ë„ë§ ë‹¨ìˆœí™”

## ìš”ì•½

- `imsg` CLI ë„êµ¬ ì„¤ì¹˜ ì™„ë£Œ
- ì „ì²´ ë””ìŠ¤í¬ ì•¡ì„¸ìŠ¤ ë° ìë™í™” ê¶Œí•œ êµ¬ì„±
- ë¡œì»¬ ë° ì›ê²© Mac êµ¬ì„± ë°©ë²• í•™ìŠµ
- DM í˜ì–´ë§ ë° ê·¸ë£¹ í—ˆìš© ëª©ë¡ ë©”ì»¤ë‹ˆì¦˜ ë§ˆìŠ¤í„°
- chat_id, chat_guid, chat_identifier ì°¨ì´ì  ì´í•´
- 1:1 ë° ê·¸ë£¹ ë©”ì‹œì§€ í…ŒìŠ¤íŠ¸ ì™„ë£Œ

## ë‹¤ìŒ ê³¼ì • ì˜ˆê³ 

> ë‹¤ìŒ ê³¼ì •ì—ì„œëŠ” **[LINE ì±„ë„](../line/)**ì„ í•™ìŠµí•©ë‹ˆë‹¤.
>
> ë‹¤ìŒì„ ë°°ìš°ê²Œ ë©ë‹ˆë‹¤:
> - LINE Messaging API ìê²© ì¦ëª… ê°€ì ¸ì˜¤ê¸° ë°©ë²•
> - LINE Bot ì›¹í›… ì—”ë“œí¬ì¸íŠ¸ êµ¬ì„±
> - LINE ì±„ë„ì˜ ë©”ì‹œì§€ í˜•ì‹ ë° ì œí•œ ì‚¬í•­
> - iMessage ì±„ë„ê³¼ì˜ êµ¬ì„± ì°¨ì´ì 

---

## ë¶€ë¡: ì†ŒìŠ¤ ì½”ë“œ ì°¸ì¡°

<details>
<summary><strong>í´ë¦­í•˜ì—¬ ì†ŒìŠ¤ ì½”ë“œ ìœ„ì¹˜ í¼ì¹˜ê¸°</strong></summary>

> ì—…ë°ì´íŠ¸ ë‚ ì§œ: 2026-01-27

| ê¸°ëŠ¥ | íŒŒì¼ ê²½ë¡œ | í–‰ ë²ˆí˜¸ |
|--- | --- | ---|
| iMessage êµ¬ì„± íƒ€ì… ì •ì˜ | [`src/config/types.imessage.ts`](https://github.com/moltbot/moltbot/blob/main/src/config/types.imessage.ts) | 1-80 |
| iMessage ê³„ì • êµ¬ë¬¸ ë¶„ì„ | [`src/imessage/accounts.ts`](https://github.com/moltbot/moltbot/blob/main/src/imessage/accounts.ts) | 1-83 |
| iMessage í”„ë¡œë¸Œ | [`src/imessage/probe.ts`](https://github.com/moltbot/moltbot/blob/main/src/imessage/probe.ts) | 1-92 |
| iMessage ì „ì†¡ | [`src/imessage/send.ts`](https://github.com/moltbot/moltbot/blob/main/src/imessage/send.ts) | 1-135 |
| iMessage ëª¨ë‹ˆí„°ë§ ì œê³µì | [`src/imessage/monitor/monitor-provider.ts`](https://github.com/moltbot/moltbot/blob/main/src/imessage/monitor/monitor-provider.ts) | 1-600+ |
| ëŒ€ìƒ ì£¼ì†Œ êµ¬ë¬¸ ë¶„ì„ | [`src/imessage/targets.ts`](https://github.com/moltbot/moltbot/blob/main/src/imessage/targets.ts) | 1-200+ |
| ì˜¨ë³´ë”© ì–´ëŒ‘í„° | [`src/channels/plugins/onboarding/imessage.ts`](https://github.com/moltbot/moltbot/blob/main/src/channels/plugins/onboarding/imessage.ts) | 1-262 |
| iMessage ë¬¸ì„œ | [`docs/channels/imessage.md`](https://github.com/moltbot/moltbot/blob/main/docs/channels/imessage.md) | 1-262 |

**í•µì‹¬ íƒ€ì…**:
- `IMessageConfig`: ì™„ì „í•œ iMessage êµ¬ì„± ì¸í„°í˜ì´ìŠ¤
- `IMessageAccountConfig`: ë‹¨ì¼ ê³„ì • êµ¬ì„±
- `IMessageService`: "imessage" | "sms" | "auto"
- `IMessageTargetKind`: "chat_id" | "chat_guid" | "chat_identifier" | "handle"

**í•µì‹¬ êµ¬ì„± í•„ë“œ**:
- `cliPath`: imsg CLI ê²½ë¡œ, ë¡œì»¬ ê²½ë¡œ ë˜ëŠ” SSH wrapper ìŠ¤í¬ë¦½íŠ¸ì¼ ìˆ˜ ìˆìŒ
- `dbPath`: Messages chat.db ë°ì´í„°ë² ì´ìŠ¤ ê²½ë¡œ
- `remoteHost`: SSH í˜¸ìŠ¤íŠ¸(SCP ì²¨ë¶€ íŒŒì¼ ì „ì†¡ìš©), ìë™ ê°ì§€ ë˜ëŠ” ëª…ì‹œì  êµ¬ì„±
- `dmPolicy`: ê¸°ë³¸ "pairing", ë‚¯ì„  DM ì•¡ì„¸ìŠ¤ ì œì–´
- `groupPolicy`: ê·¸ë£¹ ì•¡ì„¸ìŠ¤ ì •ì±…, "allowlist" ë˜ëŠ” "open"
- `groups`: `chat_id`ë³„ ê·¸ë£¹ êµ¬ì„±, ì„¸ë¶„í™”ëœ ëŒ€í™” ë° ì‚¬ìš©ì ì§€ì • ì •ì±… ì§€ì›

**í•µì‹¬ í•¨ìˆ˜**:
- `probeIMessage()`: imsg CLIë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆê³  rpc í•˜ìœ„ ëª…ë ¹ì„ ì§€ì›í•˜ëŠ”ì§€ í”„ë¡œë¸Œ(`probe.ts`)
- `sendMessageIMessage()`: iMessage ë©”ì‹œì§€ ì „ì†¡, í…ìŠ¤íŠ¸ ë° ë¯¸ë””ì–´ ì§€ì›(`send.ts`)
- `monitorIMessageProvider()`: iMessage ì´ë²¤íŠ¸ ìŠ¤íŠ¸ë¦¼ ëª¨ë‹ˆí„°ë§(`monitor-provider.ts`)
- `parseIMessageTarget()`: ëŒ€ìƒ ì£¼ì†Œ êµ¬ë¬¸ ë¶„ì„(chat_id, handle, ì´ë©”ì¼ ë“±)(`targets.ts`)

**í†µì‹  ë©”ì»¤ë‹ˆì¦˜**:
- `imsg rpc` í•˜ìœ„ ëª…ë ¹ì„ í†µí•´ stdioë¥¼ í†µí•œ JSON-RPC í†µì‹  êµ¬í˜„
- ê° ê³„ì •ì—ëŠ” ë…ë¦½ì ì¸ RPC í´ë¼ì´ì–¸íŠ¸ ì¸ìŠ¤í„´ìŠ¤ ìˆìŒ(`createIMessageRpcClient`)
- ë©”ì‹œì§€ ì´ë²¤íŠ¸ëŠ” `monitor-provider.ts`ë¥¼ í†µí•´ Gatewayë¡œ ìŠ¤íŠ¸ë¦¬ë°ë¨
- ë©”ì‹œì§€ ì „ì†¡ ì‹œ `chat_id`(ê¶Œì¥), `chat_guid`, `chat_identifier` ë˜ëŠ” ì§ì ‘ handle ì§€ì›

**ë‹¤ì¤‘ ê³„ì • ì§€ì›**:
- `channels.imessage.accounts` ë§µì„ ì‚¬ìš©í•˜ì—¬ ì—¬ëŸ¬ ê³„ì • êµ¬ì„±
- ê° ê³„ì •ì€ ë…ë¦½ì ì¸ `cliPath`, `dbPath` ë° ì •ì±… êµ¬ì„± ìˆìŒ
- ê¸°ë³¸ ê³„ì • IDëŠ” "default"ì´ë©° `accountId` í•„ë“œë¡œ ì§€ì • ê°€ëŠ¥

</details>
