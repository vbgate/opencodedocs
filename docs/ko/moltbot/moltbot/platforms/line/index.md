---
title: "LINE ì±„ë„ ì„¤ì • ë° ì‚¬ìš© | Clawdbot íŠœí† ë¦¬ì–¼"
sidebarTitle: "LINEì—ì„œ AI ì‚¬ìš©í•˜ê¸°"
subtitle: "LINE ì±„ë„ ì„¤ì • ë° ì‚¬ìš©"
description: "Clawdbotì˜ LINE ì±„ë„ì„ ì„¤ì •í•˜ê³  ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì„ í•™ìŠµí•©ë‹ˆë‹¤. ë³¸ íŠœí† ë¦¬ì–¼ì€ LINE Messaging API í†µí•©, Webhook ì„¤ì •, ì•¡ì„¸ìŠ¤ ì œì–´, ë¦¬ì¹˜ ë¯¸ë””ì–´ ë©”ì‹œì§€(Flex í…œí”Œë¦¿, ë¹ ë¥¸ ì‘ë‹µ, Rich Menu) ë° ì¼ë°˜ì ì¸ ë¬¸ì œ í•´ê²° ê¸°ë²•ì„ ë‹¤ë£¹ë‹ˆë‹¤."
tags:
  - "LINE"
  - "Messaging API"
  - "ì±„ë„ ì„¤ì •"
prerequisite:
  - "start-gateway-startup"
order: 140
---

# LINE ì±„ë„ ì„¤ì • ë° ì‚¬ìš©

## í•™ìŠµ í›„ ë‹¬ì„±í•  ìˆ˜ ìˆëŠ” ê²ƒ

ë³¸ íŠœí† ë¦¬ì–¼ì„ ì™„ë£Œí•˜ë©´ ë‹¤ìŒì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:

- âœ… LINE Messaging API ì±„ë„ ìƒì„± ë° ìê²© ì¦ëª… íšë“
- âœ… Clawdbotì˜ LINE í”ŒëŸ¬ê·¸ì¸ ë° Webhook êµ¬ì„±
- âœ… DM í˜ì–´ë§, ê·¸ë£¹ ì•¡ì„¸ìŠ¤ ì œì–´ ë° ë¯¸ë””ì–´ ì œí•œ ì„¤ì •
- âœ… ë¦¬ì¹˜ ë¯¸ë””ì–´ ë©”ì‹œì§€ ì „ì†¡(Flex ì¹´ë“œ, ë¹ ë¥¸ ì‘ë‹µ, ìœ„ì¹˜ ì •ë³´)
- âœ… LINE ì±„ë„ì˜ ì¼ë°˜ì ì¸ ë¬¸ì œ í•´ê²°

## í˜„ì¬ ê²ªê³  ìˆëŠ” ë¬¸ì œ

ë‹¤ìŒê³¼ ê°™ì€ ê³ ë¯¼ì´ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤:

- "LINEì„ í†µí•´ AI ì–´ì‹œìŠ¤í„´íŠ¸ì™€ ëŒ€í™”í•˜ê³  ì‹¶ì€ë° ì–´ë–»ê²Œ í†µí•©í• ê¹Œ?"
- "LINE Messaging APIì˜ Webhookì„ ì–´ë–»ê²Œ êµ¬ì„±í• ê¹Œ?"
- "LINEì´ Flex ë©”ì‹œì§€ì™€ ë¹ ë¥¸ ì‘ë‹µì„ ì§€ì›í• ê¹Œ?"
- "LINEì„ í†µí•´ AI ì–´ì‹œìŠ¤í„´íŠ¸ì— ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆëŠ” ì‚¬ëŒì„ ì–´ë–»ê²Œ ì œì–´í• ê¹Œ?"

ì¢‹ì€ ì†Œì‹: **Clawdbotì€ Messaging APIì˜ ëª¨ë“  í•µì‹¬ ê¸°ëŠ¥ì„ ì§€ì›í•˜ëŠ” ì™„ì „í•œ LINE í”ŒëŸ¬ê·¸ì¸ì„ ì œê³µí•©ë‹ˆë‹¤**.

## ì–¸ì œ ì‚¬ìš©í•˜ë©´ ì¢‹ì€ê°€

ë‹¤ìŒì´ í•„ìš”í•  ë•Œ:

- ğŸ“± **LINEì—ì„œ** AI ì–´ì‹œìŠ¤í„´íŠ¸ì™€ ëŒ€í™”
- ğŸ¨ **ë¦¬ì¹˜ ë¯¸ë””ì–´ ë©”ì‹œì§€ ì‚¬ìš©** (Flex ì¹´ë“œ, ë¹ ë¥¸ ì‘ë‹µ, Rich Menu)
- ğŸ”’ **ì•¡ì„¸ìŠ¤ ê¶Œí•œ ì œì–´** (DM í˜ì–´ë§, ê·¸ë£¹ í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸)
- ğŸŒ **LINEì„ ê¸°ì¡´** ì›Œí¬í”Œë¡œìš°ì— í†µí•©

## í•µì‹¬ ê°œë…

LINE ì±„ë„ì€ **LINE Messaging API**ë¥¼ í†µí•´ í†µí•©ë˜ë©°, Webhookì„ ì‚¬ìš©í•˜ì—¬ ì´ë²¤íŠ¸ë¥¼ ìˆ˜ì‹ í•˜ê³  ë©”ì‹œì§€ë¥¼ ì „ì†¡í•©ë‹ˆë‹¤.

```
LINE ì‚¬ìš©ì
    â”‚
    â–¼ (ë©”ì‹œì§€ ì „ì†¡)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  LINE Platform  â”‚
â”‚  (Messaging API)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ (Webhook POST)
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Clawdbot       â”‚
â”‚  Gateway        â”‚
â”‚  /line/webhook   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ (AI í˜¸ì¶œ)
         â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚ Agent  â”‚
     â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
         â”‚ (ì‘ë‹µ)
         â–¼
     LINE ì‚¬ìš©ì
```

**í•µì‹¬ ê°œë…**:

| ê°œë… | ì—­í•  |
|--- | ---|
| **Channel Access Token** | ë©”ì‹œì§€ ì „ì†¡ì„ ìœ„í•œ ì¸ì¦ í† í° |
| **Channel Secret** | Webhook ì„œëª…ì„ ê²€ì¦í•˜ê¸° ìœ„í•œ ë¹„ë°€ í‚¤ |
| **Webhook URL** | Clawdbotì´ LINE ì´ë²¤íŠ¸ë¥¼ ìˆ˜ì‹ í•˜ëŠ” ì—”ë“œí¬ì¸íŠ¸(HTTPS í•„ìˆ˜) |
| **DM Policy** | ì•Œ ìˆ˜ ì—†ëŠ” ë°œì‹ ìì˜ ì•¡ì„¸ìŠ¤ ì •ì±…(pairing/allowlist/open/disabled) |
| **Rich Menu** | LINEì˜ ê³ ì • ë©”ë‰´, ì‚¬ìš©ìê°€ í´ë¦­í•˜ì—¬ ì‘ì—…ì„ ë¹ ë¥´ê²Œ íŠ¸ë¦¬ê±° |

## ğŸ’ ì‹œì‘ ì „ ì¤€ë¹„

### í•„ìš”í•œ ê³„ì • ë° ë„êµ¬

| í•­ëª© | ìš”êµ¬ì‚¬í•­ | íšë“ ë°©ë²• |
|--- | --- | ---|
| **LINE Developers ê³„ì •** | ë¬´ë£Œ ë“±ë¡ | https://developers.line.biz/console/ |
| **LINE Provider** | Provider ë° Messaging API channel ìƒì„± | LINE Console |
| **HTTPS ì„œë²„** | Webhookì€ HTTPS í•„ìˆ˜ | ngrok, Cloudflare Tunnel, Tailscale Serve/Funnel |

::: tip ì¶”ì²œ ë…¸ì¶œ ë°©ë²•
ë¡œì»¬ ê°œë°œ ì¤‘ì¸ ê²½ìš° ë‹¤ìŒì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
- **ngrok**: `ngrok http 18789`
- **Tailscale Funnel**: `gateway.tailscale.mode = "funnel"`
- **Cloudflare Tunnel**: ë¬´ë£Œì´ê³  ì•ˆì •ì 
:::

## ë”°ë¼í•˜ê¸°

### 1ë‹¨ê³„: LINE í”ŒëŸ¬ê·¸ì¸ ì„¤ì¹˜

**ì´ìœ **
LINE ì±„ë„ì€ í”ŒëŸ¬ê·¸ì¸ì„ í†µí•´ êµ¬í˜„ë˜ë¯€ë¡œ ë¨¼ì € ì„¤ì¹˜í•´ì•¼ í•©ë‹ˆë‹¤.

```bash
clawdbot plugins install @clawdbot/line
```

**ì˜ˆìƒ ê²°ê³¼**:
```
âœ“ Installed @clawdbot/line plugin
```

::: tip ë¡œì»¬ ê°œë°œ
ì†ŒìŠ¤ ì½”ë“œì—ì„œ ì‹¤í–‰ ì¤‘ì¸ ê²½ìš° ë¡œì»¬ ì„¤ì¹˜ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:
```bash
clawdbot plugins install ./extensions/line
```
:::

### 2ë‹¨ê³„: LINE Messaging API Channel ìƒì„±

**ì´ìœ **
Clawdbotë¥¼ êµ¬ì„±í•˜ë ¤ë©´ `Channel Access Token`ê³¼ `Channel Secret`ì´ í•„ìš”í•©ë‹ˆë‹¤.

#### 2.1 LINE Developers Console ë¡œê·¸ì¸

ë°©ë¬¸: https://developers.line.biz/console/

#### 2.2 Provider ìƒì„±(ì—†ëŠ” ê²½ìš°)

1. "Create new provider" í´ë¦­
2. Provider ì´ë¦„ ì…ë ¥(ì˜ˆ: `Clawdbot`)
3. "Create" í´ë¦­

#### 2.3 Messaging API Channel ì¶”ê°€

1. Providerì—ì„œ "Add channel" â†’ "Messaging API" ì„ íƒ
2. Channel ì •ë³´ ì„¤ì •:
   - Channel name: `Clawdbot AI Assistant`
   - Channel description: `Personal AI assistant powered by Clawdbot`
   - Category: `Communication`
   - Subcategory: `Bot`
3. "Agree" ì²´í¬ â†’ "Create" í´ë¦­

#### 2.4 Webhook í™œì„±í™”

1. Channel ì„¤ì • í˜ì´ì§€ì—ì„œ "Messaging API" íƒ­ ì°¾ê¸°
2. "Use webhook" ìŠ¤ìœ„ì¹˜ í´ë¦­ â†’ ONìœ¼ë¡œ ì„¤ì •
3. ë‹¤ìŒ ì •ë³´ ë³µì‚¬:

| í•­ëª© | ìœ„ì¹˜ | ì˜ˆì‹œ |
|--- | --- | ---|
| **Channel Access Token** | Basic settings â†’ Channel access token (long-lived) | `eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...` |
| **Channel Secret** | Basic settings â†’ Channel secret | `1a2b3c4d5e6f7g8h9i0j1k2l3m4n5o6p7` |

::: warning ìê²© ì¦ëª… ì•ˆì „í•˜ê²Œ ë³´ê´€!
Channel Access Tokenê³¼ Channel Secretì€ ë¯¼ê°í•œ ì •ë³´ì´ë¯€ë¡œ ì•ˆì „í•˜ê²Œ ë³´ê´€í•˜ê³  ê³µê°œ ì €ì¥ì†Œì— ë…¸ì¶œí•˜ì§€ ë§ˆì„¸ìš”.
:::

### 3ë‹¨ê³„: Clawdbotì˜ LINE ì±„ë„ êµ¬ì„±

**ì´ìœ **
Messaging APIë¥¼ ì‚¬ìš©í•˜ì—¬ ë©”ì‹œì§€ë¥¼ ì „ì†¡í•˜ê³  ìˆ˜ì‹ í•˜ë„ë¡ Gatewayë¥¼ êµ¬ì„±í•©ë‹ˆë‹¤.

#### ë°©ë²• A: ëª…ë ¹ì¤„ë¡œ êµ¬ì„±

```bash
clawdbot configure
```

ë§ˆë²•ì‚¬ê°€ ë‹¤ìŒì„ ì§ˆë¬¸í•©ë‹ˆë‹¤:
- LINE ì±„ë„ í™œì„±í™” ì—¬ë¶€
- Channel Access Token
- Channel Secret
- DM ì •ì±…(ê¸°ë³¸ê°’ `pairing`)

#### ë°©ë²• B: êµ¬ì„± íŒŒì¼ ì§ì ‘ í¸ì§‘

`~/.clawdbot/clawdbot.json` í¸ì§‘:

```json5
{
  channels: {
    line: {
      enabled: true,
      channelAccessToken: "YOUR_CHANNEL_ACCESS_TOKEN",
      channelSecret: "YOUR_CHANNEL_SECRET",
      dmPolicy: "pairing",
      groupPolicy: "allowlist"
    }
  }
}
```

::: tip í™˜ê²½ ë³€ìˆ˜ ì‚¬ìš©
í™˜ê²½ ë³€ìˆ˜ë¥¼ í†µí•´ì„œë„ êµ¬ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤(ê¸°ë³¸ ê³„ì •ì—ë§Œ ìœ íš¨):
```bash
export LINE_CHANNEL_ACCESS_TOKEN="your_token_here"
export LINE_CHANNEL_SECRET="your_secret_here"
```
:::

#### ë°©ë²• C: íŒŒì¼ì„ ì‚¬ìš©í•˜ì—¬ ìê²© ì¦ëª… ì €ì¥

ìê²© ì¦ëª…ì„ ë³„ë„ì˜ íŒŒì¼ì— ì €ì¥í•˜ëŠ” ê²ƒì´ ë” ì•ˆì „í•©ë‹ˆë‹¤:

```json5
{
  channels: {
    line: {
      enabled: true,
      tokenFile: "/path/to/line-token.txt",
      secretFile: "/path/to/line-secret.txt",
      dmPolicy: "pairing"
    }
  }
}
```

### 4ë‹¨ê³„: Webhook URL ì„¤ì •

**ì´ìœ **
LINEì—ì„œ Clawdbotìœ¼ë¡œ ë©”ì‹œì§€ ì´ë²¤íŠ¸ë¥¼ í‘¸ì‹œí•˜ë ¤ë©´ Webhook URLì´ í•„ìš”í•©ë‹ˆë‹¤.

#### 4.1 ì™¸ë¶€ì—ì„œ Gatewayì— ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆëŠ”ì§€ í™•ì¸

ë¡œì»¬ì—ì„œ ê°œë°œ ì¤‘ì¸ ê²½ìš° í„°ë„ ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤:

```bash
# ngrok ì‚¬ìš©
ngrok http 18789

# ì¶œë ¥ì— HTTPS URLì´ í‘œì‹œë©ë‹ˆë‹¤. ì˜ˆ:
# Forwarding: https://abc123.ngrok.io -> http://localhost:18789
```

#### 4.2 LINE Consoleì—ì„œ Webhook URL ì„¤ì •

1. Messaging API ì„¤ì • í˜ì´ì§€ì—ì„œ "Webhook settings" ì°¾ê¸°
2. Webhook URL ì…ë ¥:
   ```
   https://your-gateway-host/line/webhook
   ```
   - ê¸°ë³¸ ê²½ë¡œ: `/line/webhook`
   - `channels.line.webhookPath`ë¡œ ì‚¬ìš©ì ì •ì˜ ê°€ëŠ¥
3. "Verify" í´ë¦­ â†’ LINEì´ Gatewayì— ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆëŠ”ì§€ í™•ì¸

**ì˜ˆìƒ ê²°ê³¼**:
```
âœ“ Webhook URL verification succeeded
```

#### 4.3 í•„ìš”í•œ ì´ë²¤íŠ¸ ìœ í˜• í™œì„±í™”

Webhook settingsì—ì„œ ë‹¤ìŒ ì´ë²¤íŠ¸ë¥¼ ì²´í¬:

| ì´ë²¤íŠ¸ | ìš©ë„ |
|--- | ---|
| **Message event** | ì‚¬ìš©ìê°€ ë³´ë‚¸ ë©”ì‹œì§€ ìˆ˜ì‹  |
| **Follow event** | ì‚¬ìš©ìê°€ Botì„ ì¹œêµ¬ë¡œ ì¶”ê°€ |
| **Unfollow event** | ì‚¬ìš©ìê°€ Botì„ ì œê±° |
| **Join event** | Botì´ ê·¸ë£¹ì— ì°¸ê°€ |
| **Leave event** | Botì´ ê·¸ë£¹ì—ì„œ ë‚˜ê° |
| **Postback event** | ë¹ ë¥¸ ì‘ë‹µ ë° ë²„íŠ¼ í´ë¦­ |

### 5ë‹¨ê³„: Gateway ì‹œì‘

**ì´ìœ **
LINEì˜ Webhook ì´ë²¤íŠ¸ë¥¼ ìˆ˜ì‹ í•˜ë ¤ë©´ Gatewayê°€ ì‹¤í–‰ ì¤‘ì´ì–´ì•¼ í•©ë‹ˆë‹¤.

```bash
clawdbot gateway --verbose
```

**ì˜ˆìƒ ê²°ê³¼**:
```
âœ“ Gateway listening on ws://127.0.0.1:18789
âœ“ LINE webhook server started on /line/webhook
âœ“ LINE plugin initialized
```

### 6ë‹¨ê³„: LINE ì±„ë„ í…ŒìŠ¤íŠ¸

**ì´ìœ **
êµ¬ì„±ì´ ì˜¬ë°”ë¥¸ì§€ í™•ì¸í•˜ê³  AI ì–´ì‹œìŠ¤í„´íŠ¸ê°€ ì •ìƒì ìœ¼ë¡œ ì‘ë‹µí•˜ëŠ”ì§€ í…ŒìŠ¤íŠ¸í•©ë‹ˆë‹¤.

#### 6.1 Botì„ ì¹œêµ¬ë¡œ ì¶”ê°€

1. LINE Console â†’ Messaging API â†’ Channel settings
2. "Basic ID" ë˜ëŠ” "QR Code" ë³µì‚¬
3. LINE ì•±ì—ì„œ ê²€ìƒ‰í•˜ê±°ë‚˜ QR Codeë¥¼ ìŠ¤ìº”í•˜ì—¬ Botì„ ì¹œêµ¬ë¡œ ì¶”ê°€

#### 6.2 í…ŒìŠ¤íŠ¸ ë©”ì‹œì§€ ì „ì†¡

LINEì—ì„œ Botì— ë©”ì‹œì§€ ì „ì†¡:
```
ì•ˆë…•, ì˜¤ëŠ˜ ë‚ ì”¨ ìš”ì•½í•´ ì¤˜.
```

**ì˜ˆìƒ ê²°ê³¼**:
- Botì´ "typing" ìƒíƒœ í‘œì‹œ(typing indicators êµ¬ì„±ëœ ê²½ìš°)
- AI ì–´ì‹œìŠ¤í„´íŠ¸ê°€ ì‘ë‹µì„ ìŠ¤íŠ¸ë¦¬ë°ìœ¼ë¡œ ë°˜í™˜
- ë©”ì‹œì§€ê°€ LINEì— ì˜¬ë°”ë¥´ê²Œ í‘œì‹œ

### 7ë‹¨ê³„: DM í˜ì–´ë§ í™•ì¸(ì„ íƒ ì‚¬í•­)

**ì´ìœ **
ê¸°ë³¸ `dmPolicy="pairing"`ì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš° ì•Œ ìˆ˜ ì—†ëŠ” ë°œì‹ ìëŠ” ë¨¼ì € ìŠ¹ì¸ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.

#### ìŠ¹ì¸ ëŒ€ê¸° ì¤‘ì¸ í˜ì–´ë§ ìš”ì²­ ë³´ê¸°

```bash
clawdbot pairing list line
```

**ì˜ˆìƒ ê²°ê³¼**:
```
Pending pairing requests for LINE:
  CODE: ABC123 - User ID: U1234567890abcdef1234567890ab
```

#### í˜ì–´ë§ ìš”ì²­ ìŠ¹ì¸

```bash
clawdbot pairing approve line ABC123
```

**ì˜ˆìƒ ê²°ê³¼**:
```
âœ“ Approved pairing request for LINE user U1234567890abcdef1234567890ab
```

::: info DM ì •ì±… ì„¤ëª…
- `pairing`(ê¸°ë³¸ê°’): ì•Œ ìˆ˜ ì—†ëŠ” ë°œì‹ ìê°€ í˜ì–´ë§ ì½”ë“œë¥¼ ë°›ìœ¼ë©°, ìŠ¹ì¸ë  ë•Œê¹Œì§€ ë©”ì‹œì§€ê°€ ë¬´ì‹œë¨
- `allowlist`: í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ì˜ ì‚¬ìš©ìë§Œ ë©”ì‹œì§€ ì „ì†¡ ê°€ëŠ¥
- `open`: ëˆ„êµ¬ë‚˜ ë©”ì‹œì§€ë¥¼ ì „ì†¡í•  ìˆ˜ ìˆìŒ(ì‹ ì¤‘í•˜ê²Œ ì‚¬ìš©)
- `disabled`: ê°œì¸ ë©”ì‹œì§€ ë¹„í™œì„±í™”
:::

## ì²´í¬í¬ì¸íŠ¸ âœ…

êµ¬ì„±ì´ ì˜¬ë°”ë¥¸ì§€ í™•ì¸:

| í™•ì¸ í•­ëª© | í™•ì¸ ë°©ë²• | ì˜ˆìƒ ê²°ê³¼ |
|--- | --- | ---|
| **í”ŒëŸ¬ê·¸ì¸ ì„¤ì¹˜ë¨** | `clawdbot plugins list` | `@clawdbot/line` í‘œì‹œ |
| **êµ¬ì„± ìœ íš¨í•¨** | `clawdbot doctor` | LINE ê´€ë ¨ ì˜¤ë¥˜ ì—†ìŒ |
| **Webhook ì ‘ê·¼ ê°€ëŠ¥** | LINE Console í™•ì¸ | `âœ“ Verification succeeded` |
| **Bot ì•¡ì„¸ìŠ¤ ê°€ëŠ¥** | LINEì—ì„œ ì¹œêµ¬ ì¶”ê°€ ë° ë©”ì‹œì§€ ì „ì†¡ | AI ì–´ì‹œìŠ¤í„´íŠ¸ ì •ìƒ ì‘ë‹µ |
| **í˜ì–´ë§ ë©”ì»¤ë‹ˆì¦˜** | ìƒˆ ì‚¬ìš©ìë¡œ DM ì „ì†¡ | í˜ì–´ë§ ì½”ë“œ ìˆ˜ì‹ (pairing ì •ì±… ì‚¬ìš© ì‹œ) |

## ì¼ë°˜ì ì¸ ë¬¸ì œ

### ì¼ë°˜ì ì¸ ë¬¸ì œ 1: Webhook í™•ì¸ ì‹¤íŒ¨

**ì¦ìƒ**:
```
Webhook URL verification failed
```

**ì›ì¸**:
- Webhook URLì´ HTTPSê°€ ì•„ë‹˜
- Gatewayê°€ ì‹¤í–‰ë˜ì§€ ì•Šì•˜ê±°ë‚˜ í¬íŠ¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŒ
- ë°©í™”ë²½ì´ ì¸ë°”ìš´ë“œ ì—°ê²°ì„ ì°¨ë‹¨

**í•´ê²° ë°©ë²•**:
1. HTTPS ì‚¬ìš© í™•ì¸: `https://your-gateway-host/line/webhook`
2. Gateway ì‹¤í–‰ í™•ì¸: `clawdbot gateway status`
3. í¬íŠ¸ í™•ì¸: `netstat -an | grep 18789`
4. í„°ë„ ì„œë¹„ìŠ¤ ì‚¬ìš©(ngrok/Tailscale/Cloudflare)

### ì¼ë°˜ì ì¸ ë¬¸ì œ 2: ë©”ì‹œì§€ ìˆ˜ì‹  ë¶ˆê°€

**ì¦ìƒ**:
- Webhook í™•ì¸ ì„±ê³µ
- í•˜ì§€ë§Œ Botì— ë©”ì‹œì§€ë¥¼ ë³´ë‚´ë„ ì‘ë‹µ ì—†ìŒ

**ì›ì¸**:
- Webhook ê²½ë¡œ êµ¬ì„± ì˜¤ë¥˜
- ì´ë²¤íŠ¸ ìœ í˜•ì´ í™œì„±í™”ë˜ì§€ ì•ŠìŒ
- êµ¬ì„± íŒŒì¼ì˜ `channelSecret`ì´ ì¼ì¹˜í•˜ì§€ ì•ŠìŒ

**í•´ê²° ë°©ë²•**:
1. `channels.line.webhookPath`ê°€ LINE Consoleê³¼ ì¼ì¹˜í•˜ëŠ”ì§€ í™•ì¸
2. LINE Consoleì—ì„œ "Message event" í™œì„±í™” í™•ì¸
3. `channelSecret`ì´ ì˜¬ë°”ë¥´ê²Œ ë³µì‚¬ë˜ì—ˆëŠ”ì§€ í™•ì¸(ì—¬ë¶„ ê³µë°± ì—†ìŒ)

### ì¼ë°˜ì ì¸ ë¬¸ì œ 3: ë¯¸ë””ì–´ ë‹¤ìš´ë¡œë“œ ì‹¤íŒ¨

**ì¦ìƒ**:
```
Error downloading LINE media: size limit exceeded
```

**ì›ì¸**:
- ë¯¸ë””ì–´ íŒŒì¼ì´ ê¸°ë³¸ ì œí•œ(10MB)ì„ ì´ˆê³¼

**í•´ê²° ë°©ë²•**:
êµ¬ì„±ì—ì„œ ì œí•œ ëŠ˜ë¦¬ê¸°:
```json5
{
  channels: {
    line: {
      mediaMaxMb: 25  // LINE ê³µì‹ ì œí•œ 25MB
    }
  }
}
```

### ì¼ë°˜ì ì¸ ë¬¸ì œ 4: ê·¸ë£¹ ë©”ì‹œì§€ ì‘ë‹µ ì—†ìŒ

**ì¦ìƒ**:
- DM ì •ìƒ
- ê·¸ë£¹ì—ì„œ ë©”ì‹œì§€ë¥¼ ë³´ë‚´ë„ ì‘ë‹µ ì—†ìŒ

**ì›ì¸**:
- ê¸°ë³¸ `groupPolicy="allowlist"`, ê·¸ë£¹ì´ í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ì— ì—†ìŒ
- ê·¸ë£¹ì—ì„œ @mention Botí•˜ì§€ ì•ŠìŒ

**í•´ê²° ë°©ë²•**:
1. êµ¬ì„±ì— ê·¸ë£¹ IDë¥¼ í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ì— ì¶”ê°€:
```json5
{
  channels: {
    line: {
      groupAllowFrom: ["C1234567890abcdef1234567890ab"]
    }
  }
}
```

2. ë˜ëŠ” ê·¸ë£¹ì—ì„œ @mention Bot: `@Clawdbot ì´ ì‘ì—… ì²˜ë¦¬í•´ ì¤˜`

## ê³ ê¸‰ ê¸°ëŠ¥

### ë¦¬ì¹˜ ë¯¸ë””ì–´ ë©”ì‹œì§€(Flex í…œí”Œë¦¿ ë° ë¹ ë¥¸ ì‘ë‹µ)

Clawdbotì€ Flex ì¹´ë“œ, ë¹ ë¥¸ ì‘ë‹µ, ìœ„ì¹˜ ì •ë³´ ë“± LINEì˜ ë¦¬ì¹˜ ë¯¸ë””ì–´ ë©”ì‹œì§€ë¥¼ ì§€ì›í•©ë‹ˆë‹¤.

#### ë¹ ë¥¸ ì‘ë‹µ ì „ì†¡

```json5
{
  text: "ì˜¤ëŠ˜ ì–´ë–¤ ê²ƒì„ ë„ì™€ë“œë¦´ê¹Œìš”?",
  channelData: {
    line: {
      quickReplies: ["ë‚ ì”¨ í™•ì¸", "ì•Œë¦¼ ì„¤ì •", "ì½”ë“œ ìƒì„±"]
    }
  }
}
```

#### Flex ì¹´ë“œ ì „ì†¡

```json5
{
  text: "ìƒíƒœ ì¹´ë“œ",
  channelData: {
    line: {
      flexMessage: {
        altText: "ì„œë²„ ìƒíƒœ",
        contents: {
          type: "bubble",
          body: {
            type: "box",
            contents: [
              {
                type: "text",
                text: "CPU: 45%"
              },
              {
                type: "text",
                text: "Memory: 2.1GB"
              }
            ]
          }
        }
      }
    }
  }
}
```

#### ìœ„ì¹˜ ì •ë³´ ì „ì†¡

```json5
{
  text: "ì´ê²ƒì€ ì œ ì‚¬ë¬´ì‹¤ ìœ„ì¹˜ì…ë‹ˆë‹¤",
  channelData: {
    line: {
      location: {
        title: "Office",
        address: "123 Main St, San Francisco",
        latitude: 37.7749,
        longitude: -122.4194
      }
    }
  }
}
```

### Rich Menu(ê³ ì • ë©”ë‰´)

Rich MenuëŠ” LINEì˜ ê³ ì • ë©”ë‰´ë¡œ, ì‚¬ìš©ìê°€ í´ë¦­í•˜ì—¬ ì‘ì—…ì„ ë¹ ë¥´ê²Œ íŠ¸ë¦¬ê±°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```bash
# Rich Menu ìƒì„±
clawdbot line rich-menu create

# ë©”ë‰´ ì´ë¯¸ì§€ ì—…ë¡œë“œ
clawdbot line rich-menu upload --image /path/to/menu.png

# ê¸°ë³¸ ë©”ë‰´ë¡œ ì„¤ì •
clawdbot line rich-menu set-default --rich-menu-id <MENU_ID>
```

::: info Rich Menu ì œí•œ
- ì´ë¯¸ì§€ í¬ê¸°: 2500x1686 ë˜ëŠ” 2500x843 í”½ì…€
- ì´ë¯¸ì§€ í˜•ì‹: PNG ë˜ëŠ” JPEG
- ìµœëŒ€ 10ê°œ ë©”ë‰´ í•­ëª©
:::

### Markdown ë³€í™˜

Clawdbotì€ Markdown í˜•ì‹ì„ LINEì´ ì§€ì›í•˜ëŠ” í˜•ì‹ìœ¼ë¡œ ìë™ ë³€í™˜í•©ë‹ˆë‹¤:

| Markdown | LINE ë³€í™˜ ê²°ê³¼ |
|--- | ---|
| ì½”ë“œ ë¸”ë¡ | Flex ì¹´ë“œ |
| í‘œ | Flex ì¹´ë“œ |
| ë§í¬ | ìë™ ê°ì§€ ë° Flex ì¹´ë“œë¡œ ë³€í™˜ |
| êµµê²Œ/ê¸°ìš¸ì„ê¼´ | ì œê±°ë¨(LINEì—ì„œ ì§€ì›í•˜ì§€ ì•ŠìŒ) |

::: tip í˜•ì‹ ìœ ì§€
LINEì€ Markdown í˜•ì‹ì„ ì§€ì›í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ Clawdbotì€ Flex ì¹´ë“œë¡œ ë³€í™˜í•˜ë ¤ê³  ì‹œë„í•©ë‹ˆë‹¤. ìˆœìˆ˜ í…ìŠ¤íŠ¸ë¥¼ ì›í•˜ë©´ êµ¬ì„±ì—ì„œ ìë™ ë³€í™˜ì„ ë¹„í™œì„±í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
:::

## ìš”ì•½

ë³¸ íŠœí† ë¦¬ì–¼ì—ì„œëŠ” ë‹¤ìŒì„ ë‹¤ë£¨ì—ˆìŠµë‹ˆë‹¤:

1. âœ… LINE í”ŒëŸ¬ê·¸ì¸ ì„¤ì¹˜
2. âœ… LINE Messaging API Channel ìƒì„±
3. âœ… Webhook ë° ìê²© ì¦ëª… êµ¬ì„±
4. âœ… ì•¡ì„¸ìŠ¤ ì œì–´ ì„¤ì •(DM í˜ì–´ë§, ê·¸ë£¹ í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸)
5. âœ… ë¦¬ì¹˜ ë¯¸ë””ì–´ ë©”ì‹œì§€ ì „ì†¡(Flex, ë¹ ë¥¸ ì‘ë‹µ, ìœ„ì¹˜)
6. âœ… Rich Menu ì‚¬ìš©
7. âœ… ì¼ë°˜ì ì¸ ë¬¸ì œ í•´ê²°

LINE ì±„ë„ì€ í’ë¶€í•œ ë©”ì‹œì§€ ìœ í˜•ê³¼ ìƒí˜¸ ì‘ìš© ë°©ì‹ì„ ì œê³µí•˜ë©°, LINEì—ì„œ ê°œì¸í™”ëœ AI ì–´ì‹œìŠ¤í„´íŠ¸ ê²½í—˜ì„ êµ¬ì¶•í•˜ëŠ” ë° ë§¤ìš° ì í•©í•©ë‹ˆë‹¤.

---

## ë‹¤ìŒ ê³¼ì • ì˜ˆê³ 

> ë‹¤ìŒ ê³¼ì •ì—ì„œëŠ” **[WebChat ì¸í„°í˜ì´ìŠ¤](../webchat/)**ë¥¼ í•™ìŠµí•©ë‹ˆë‹¤.
>
> í•™ìŠµí•  ë‚´ìš©:
> - ë¸Œë¼ìš°ì €ë¥¼ í†µí•´ WebChat ì¸í„°í˜ì´ìŠ¤ ì•¡ì„¸ìŠ¤ ë°©ë²•
> - WebChatì˜ í•µì‹¬ ê¸°ëŠ¥(ì„¸ì…˜ ê´€ë¦¬, ì²¨ë¶€ íŒŒì¼ ì—…ë¡œë“œ, Markdown ì§€ì›)
> - ì›ê²© ì•¡ì„¸ìŠ¤ êµ¬ì„±(SSH í„°ë„, Tailscale)
> - WebChatê³¼ ë‹¤ë¥¸ ì±„ë„ì˜ ì°¨ì´ì  ì´í•´

---

## ë¶€ë¡: ì†ŒìŠ¤ ì½”ë“œ ì°¸ì¡°

<details>
<summary><strong>í´ë¦­í•˜ì—¬ ì†ŒìŠ¤ ì½”ë“œ ìœ„ì¹˜ í™•ì¸</strong></summary>

> ì—…ë°ì´íŠ¸ ì‹œê°„: 2026-01-27

| ê¸°ëŠ¥ | íŒŒì¼ ê²½ë¡œ | í–‰ ë²ˆí˜¸ |
|--- | --- | ---|
| LINE Bot í•µì‹¬ êµ¬í˜„ | [`src/line/bot.ts`](https://github.com/clawdbot/clawdbot/blob/main/src/line/bot.ts) | 27-83 |
| êµ¬ì„± Schema ì •ì˜ | [`src/line/config-schema.ts`](https://github.com/clawdbot/clawdbot/blob/main/src/line/config-schema.ts) | 1-54 |
| Webhook ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ | [`src/line/bot-handlers.ts`](https://github.com/clawdbot/clawdbot/blob/main/src/line/bot-handlers.ts) | 1-100 |
| ë©”ì‹œì§€ ì „ì†¡ ê¸°ëŠ¥ | [`src/line/send.ts`](https://github.com/clawdbot/clawdbot/blob/main/src/line/send.ts) | - |
| Flex í…œí”Œë¦¿ ìƒì„± | [`src/line/flex-templates.ts`](https://github.com/clawdbot/clawdbot/blob/main/src/line/flex-templates.ts) | - |
| Rich Menu ì‘ì—… | [`src/line/rich-menu.ts`](https://github.com/clawdbot/clawdbot/blob/main/src/line/rich-menu.ts) | - |
| Template ë©”ì‹œì§€ | [`src/line/template-messages.ts`](https://github.com/clawdbot/clawdbot/blob/main/src/line/template-messages.ts) | - |
| Markdownì„ LINEìœ¼ë¡œ ë³€í™˜ | [`src/line/markdown-to-line.ts`](https://github.com/clawdbot/clawdbot/blob/main/src/line/markdown-to-line.ts) | - |
| Webhook ì„œë²„ | [`src/line/webhook.ts`](https://github.com/clawdbot/clawdbot/blob/main/src/line/webhook.ts) | - |

**í•µì‹¬ êµ¬ì„± í•„ë“œ**:
- `channelAccessToken`: LINE Channel Access Token(`config-schema.ts:19`)
- `channelSecret`: LINE Channel Secret(`config-schema.ts:20`)
- `dmPolicy`: DM ì•¡ì„¸ìŠ¤ ì •ì±…(`config-schema.ts:26`)
- `groupPolicy`: ê·¸ë£¹ ì•¡ì„¸ìŠ¤ ì •ì±…(`config-schema.ts:27`)
- `mediaMaxMb`: ë¯¸ë””ì–´ í¬ê¸° ì œí•œ(`config-schema.ts:28`)
- `webhookPath`: ì‚¬ìš©ì ì •ì˜ Webhook ê²½ë¡œ(`config-schema.ts:29`)

**í•µì‹¬ í•¨ìˆ˜**:
- `createLineBot()`: LINE Bot ì¸ìŠ¤í„´ìŠ¤ ìƒì„±(`bot.ts:27`)
- `handleLineWebhookEvents()`: LINE Webhook ì´ë²¤íŠ¸ ì²˜ë¦¬(`bot-handlers.ts:100`)
- `sendMessageLine()`: LINE ë©”ì‹œì§€ ì „ì†¡(`send.ts`)
- `createFlexMessage()`: Flex ë©”ì‹œì§€ ìƒì„±(`send.ts:20`)
- `createQuickReplyItems()`: ë¹ ë¥¸ ì‘ë‹µ ìƒì„±(`send.ts:21`)

**ì§€ì›ë˜ëŠ” DM ì •ì±…**:
- `open`: ê°œë°©í˜• ì•¡ì„¸ìŠ¤
- `allowlist`: í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ ëª¨ë“œ
- `pairing`: í˜ì–´ë§ ëª¨ë“œ(ê¸°ë³¸ê°’)
- `disabled`: ë¹„í™œì„±í™”

**ì§€ì›ë˜ëŠ” ê·¸ë£¹ ì •ì±…**:
- `open`: ê°œë°©í˜• ì•¡ì„¸ìŠ¤
- `allowlist`: í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸ ëª¨ë“œ(ê¸°ë³¸ê°’)
- `disabled`: ë¹„í™œì„±í™”

</details>
