---
title: "–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è OAuth: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–≤–æ–≥–æ –≤—Ö–æ–¥–∞ | Antigravity"
sidebarTitle: "–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∑–∞ 5 –º–∏–Ω—É—Ç"
subtitle: "–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è OAuth 2.0 PKCE: –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–µ—Ä–≤–æ–≥–æ –≤—Ö–æ–¥–∞"
description: "–ò–∑—É—á–∏—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ OAuth 2.0 PKCE, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –ø–µ—Ä–≤—ã–π –≤—Ö–æ–¥ –≤ –ø–ª–∞–≥–∏–Ω Antigravity. –û—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–ø—É—Å–∫ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ OAuth-—Å–µ—Ä–≤–µ—Ä–∞, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é Google, –ø–æ–ª—É—á–µ–Ω–∏–µ Project ID –∏ —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤."
tags:
  - "OAuth"
  - "–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è"
  - "PKCE"
  - "–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç"
prerequisite:
  - "start-quick-install"
order: 3
---

# –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è OAuth 2.0 PKCE: –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–µ—Ä–≤–æ–≥–æ –≤—Ö–æ–¥–∞

## –ß–µ–º—É –≤—ã –Ω–∞—É—á–∏—Ç–µ—Å—å

- –ü–æ–Ω—è—Ç—å –º–µ—Ö–∞–Ω–∏–∑–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ OAuth 2.0 PKCE
- –í—ã–ø–æ–ª–Ω–∏—Ç—å –ø–µ—Ä–≤—ã–π –≤—Ö–æ–¥ –≤ –ø–ª–∞–≥–∏–Ω, –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ API Antigravity
- –ü–æ–Ω—è—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –º–µ—Ö–∞–Ω–∏–∑–º –ø–æ–ª—É—á–µ–Ω–∏—è –∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è Project ID
- –£–∑–Ω–∞—Ç—å –æ–± –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–æ–≤

## –í–∞—à–∞ —Ç–µ–∫—É—â–∞—è –ø—Ä–æ–±–ª–µ–º–∞

–í—ã —É—Å—Ç–∞–Ω–æ–≤–∏–ª–∏ –ø–ª–∞–≥–∏–Ω, –Ω–∞—Å—Ç—Ä–æ–∏–ª–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π, –Ω–æ –µ—â—ë –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –µ–≥–æ. –ö–∞–∂–¥—ã–π —Ä–∞–∑ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ `opencode run` –ø–æ—è–≤–ª—è–µ—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ "—Ç—Ä–µ–±—É–µ—Ç—Å—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è", –Ω–æ –≤—ã –Ω–µ –∑–Ω–∞–µ—Ç–µ:

- –ß—Ç–æ —Ç–∞–∫–æ–µ OAuth? –ó–∞—á–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–∞–∫–æ–π —Å–ª–æ–∂–Ω—ã–π —Å–ø–æ—Å–æ–± –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏?
- –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏? –≠—Ç–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ?
- –ß—Ç–æ –Ω—É–∂–Ω–æ –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –≤—Ö–æ–¥–∞? –ö–∞–∫–∏–µ –µ—Å—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç—ã?
- –ß—Ç–æ –¥–µ–ª–∞—Ç—å, –∫–æ–≥–¥–∞ —Ç–æ–∫–µ–Ω –∏—Å—Ç–µ–∫–∞–µ—Ç? –ù—É–∂–Ω–æ –ª–∏ —Å–Ω–æ–≤–∞ –≤—Ö–æ–¥–∏—Ç—å?

## –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–æ—Ç –º–µ—Ç–æ–¥

- **–ü–æ—Å–ª–µ –ø–µ—Ä–≤–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–ª–∞–≥–∏–Ω–∞**: –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞ –ø–µ—Ä–µ–¥ –ø–µ—Ä–≤—ã–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º
- **–ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤–æ–π —É—á—ë—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏**: –ü—Ä–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ —Ä–æ—Ç–∞—Ü–∏–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —É—á—ë—Ç–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π —Ç—Ä–µ–±—É–µ—Ç—Å—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∫–∞–∂–¥–æ–π –∏–∑ –Ω–∏—Ö
- **–ü–æ—Å–ª–µ –∏—Å—Ç–µ—á–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞**: –ï—Å–ª–∏ —É—á—ë—Ç–Ω–∞—è –∑–∞–ø–∏—Å—å –±—ã–ª–∞ –æ—Ç–æ–∑–≤–∞–Ω–∞ –∏–ª–∏ –ø–∞—Ä–æ–ª—å –∏–∑–º–µ–Ω—ë–Ω, —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- **–ü—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –Ω–∞ –Ω–æ–≤–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ**: –ü—Ä–∏ –º–∏–≥—Ä–∞—Ü–∏–∏ —É—á—ë—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–Ω–æ–≤–∞ –≤–æ–π—Ç–∏ –Ω–∞ –Ω–æ–≤–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ

## üéí –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞

::: warning –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ, —á—Ç–æ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:

1. **–ü–ª–∞–≥–∏–Ω —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω**: –°–º. [–ë—ã—Å—Ç—Ä–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞](/ru/NoeFabris/opencode-antigravity-auth/start/quick-install/)
2. **–ú–æ–¥–µ–ª—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞**: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ `~/.config/opencode/opencode.json`
3. **–î–æ—Å—Ç—É–ø–Ω–∞ —É—á—ë—Ç–Ω–∞—è –∑–∞–ø–∏—Å—å Google**: –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —É—á—ë—Ç–Ω—É—é –∑–∞–ø–∏—Å—å —Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º –¥–æ–≤–µ—Ä–∏–µ–º, –∏–∑–±–µ–≥–∞–π—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ç–æ–ª—å–∫–æ —á—Ç–æ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö —É—á—ë—Ç–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π

:::

## –û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è

### –ß—Ç–æ —Ç–∞–∫–æ–µ OAuth 2.0 PKCE?

**OAuth 2.0** (Open Authorization 2.0) ‚Äî —ç—Ç–æ –ø—Ä–æ—Ç–æ–∫–æ–ª –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å—Ç–æ—Ä–æ–Ω–Ω–∏–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º (—ç—Ç–æ–º—É –ø–ª–∞–≥–∏–Ω—É) –ø–æ–ª—É—á–∞—Ç—å –¥–æ—Å—Ç—É–ø –∫ API Google –±–µ–∑ –ø—Ä—è–º–æ–≥–æ –ø–æ–ª—É—á–µ–Ω–∏—è –ø–∞—Ä–æ–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

**PKCE** (Proof Key for Code Exchange) ‚Äî —ç—Ç–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ OAuth 2.0, —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–µ –¥–ª—è –ø—É–±–ª–∏—á–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, CLI-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤). –û–Ω–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –∞—Ç–∞–∫–∏ –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ –∫–æ–¥–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —Å –ø–æ–º–æ—â—å—é —Å–ª–µ–¥—É—é—â–∏—Ö –º–µ—Ö–∞–Ω–∏–∑–º–æ–≤:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  –ú–µ—Ö–∞–Ω–∏–∑–º –∑–∞—â–∏—Ç—ã PKCE                                        ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  1. –ö–ª–∏–µ–Ω—Ç –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø–∞—Ä—É –∫–ª—é—á–µ–π:                            ‚îÇ
‚îÇ     - code_verifier (—Å–ª—É—á–∞–π–Ω–∞—è —Å—Ç—Ä–æ–∫–∞, —Å–µ–∫—Ä–µ—Ç–Ω–∞—è)                ‚îÇ
‚îÇ     - code_challenge (—Ö–µ—à verifier, –æ—Ç–∫—Ä—ã—Ç–∞—è)                  ‚îÇ
‚îÇ  2. URL –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —Å–æ–¥–µ—Ä–∂–∏—Ç code_challenge                   ‚îÇ
‚îÇ  3. –°–µ—Ä–≤–µ—Ä –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –ø–æ–ª—É—á–∞–µ—Ç code, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç verifier ‚îÇ
‚îÇ  4. –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –Ω–µ –º–æ–∂–µ—Ç –æ–±–º–µ–Ω—è—Ç—å –ø–µ—Ä–µ—Ö–≤–∞—á–µ–Ω–Ω—ã–π code        ‚îÇ
‚îÇ     –Ω–∞ —Ç–æ–∫–µ–Ω –±–µ–∑ verifier                                    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

::: info

**PKCE vs —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–π OAuth**

–¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–π OAuth –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `client_secret` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ª–∏–Ω–Ω–æ—Å—Ç–∏, –Ω–æ —ç—Ç–æ —Ç—Ä–µ–±—É–µ—Ç, —á—Ç–æ–±—ã –∫–ª–∏–µ–Ω—Ç –º–æ–≥ –±–µ–∑–æ–ø–∞—Å–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á. CLI-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –Ω–µ –º–æ–≥—É—Ç –æ–±–µ—Å–ø–µ—á–∏—Ç—å —ç—Ç–æ, –ø–æ—ç—Ç–æ–º—É PKCE –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º—ã–π `verifier` –≤–º–µ—Å—Ç–æ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∫–ª—é—á–∞, —á—Ç–æ —Ç–∞–∫ –∂–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ, –Ω–æ –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∑–∞—Ä–∞–Ω–µ–µ —Ö—Ä–∞–Ω–∏–º—ã—Ö —Å–µ–∫—Ä–µ—Ç–æ–≤.

:::

### –û–±–∑–æ—Ä –ø—Ä–æ—Ü–µ—Å—Å–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

```mermaid
sequenceDiagram
    participant U as –¢–µ—Ä–º–∏–Ω–∞–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    participant O as OAuth-—Å–µ—Ä–≤–µ—Ä
    participant G as –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ Google
    participant A as API Antigravity

    U->>O: 1. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–∞—Ä—ã –∫–ª—é—á–µ–π PKCE
    U->>G: 2. –û—Ç–∫—Ä—ã—Ç–∏–µ URL –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (—Å challenge)
    G->>O: 3. –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    O->>U: 4. –û–±—Ä–∞—Ç–Ω—ã–π –≤—ã–∑–æ–≤ code (localhost:51121)
    U->>O: 5. –û–±–º–µ–Ω —Ç–æ–∫–µ–Ω–∞ (—Å verifier)
    O->>U: 6. –í–æ–∑–≤—Ä–∞—Ç access_token + refresh_token
    U->>A: 7. –ü–æ–ª—É—á–µ–Ω–∏–µ Project ID
    U->>U: 8. –•—Ä–∞–Ω–µ–Ω–∏–µ —É—á—ë—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏
```

## –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

### –®–∞–≥ 1: –ó–∞–ø—É—Å–∫ –≤—Ö–æ–¥–∞ OAuth

**–ó–∞—á–µ–º**

–ö–æ–º–∞–Ω–¥–∞ `opencode auth login` –∑–∞–ø—É—Å–∫–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω—ã–π OAuth-—Å–µ—Ä–≤–µ—Ä, –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç URL –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏ –æ–∂–∏–¥–∞–µ—Ç –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –æ—Ç Google.

**–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã**:

```bash
opencode auth login
```

**–ß—Ç–æ –≤—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å**:

```
üîë Initializing Antigravity OAuth...
üìã Starting local OAuth server on http://127.0.0.1:51121
üåê Opening browser for authorization...

If the browser doesn't open, visit this URL manually:
https://accounts.google.com/o/oauth2/v2/auth?client_id=...&code_challenge=...
```

::: tip

**–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ä–µ–¥—ã**

–ü–ª–∞–≥–∏–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å—Ä–µ–¥—É –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:

| –°—Ä–µ–¥–∞ | –ê–¥—Ä–µ—Å –ø—Ä–∏–≤—è–∑–∫–∏ | –ü—Ä–∏—á–∏–Ω–∞ |
|--- | --- | ---|
| –õ–æ–∫–∞–ª—å–Ω–∞—è macOS/Linux/Windows | `127.0.0.1` | –°–∞–º—ã–π –±–µ–∑–æ–ø–∞—Å–Ω—ã–π, –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è |
| WSL / Docker / SSH —É–¥–∞–ª—ë–Ω–Ω—ã–π | `0.0.0.0` | –ü–æ–∑–≤–æ–ª—è–µ—Ç –±—Ä–∞—É–∑–µ—Ä—É —Å —Ö–æ—Å—Ç–∞ –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø |

–í—ã –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å –ø–æ–º–æ—â—å—é –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è `OPENCODE_ANTIGRAVITY_OAUTH_BIND`.

:::

### –®–∞–≥ 2: –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –≤ –±—Ä–∞—É–∑–µ—Ä–µ

**–ó–∞—á–µ–º**

–°—Ç—Ä–∞–Ω–∏—Ü–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ Google –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è (Scope), –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã–µ –ø–ª–∞–≥–∏–Ω–æ–º, –∫–æ—Ç–æ—Ä—ã–µ —Ç—Ä–µ–±—É—é—Ç –≤–∞—à–µ–≥–æ —è–≤–Ω–æ–≥–æ —Å–æ–≥–ª–∞—Å–∏—è.

**–ß—Ç–æ –≤—ã —É–≤–∏–¥–∏—Ç–µ**:

–°—Ç—Ä–∞–Ω–∏—Ü–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ Google OAuth, –æ—Ç–æ–±—Ä–∞–∂–∞—é—â–∞—è:
- –ó–∞–ø—Ä–∞—à–∏–≤–∞—é—â–∞—è —Å—Ç–æ—Ä–æ–Ω–∞: Antigravity Auth Plugin
- –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è:
  - –ü—Ä–æ—Å–º–æ—Ç—Ä –≤–∞—à–µ–≥–æ –∞–¥—Ä–µ—Å–∞ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –ø–æ—á—Ç—ã
  - –ü—Ä–æ—Å–º–æ—Ç—Ä –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –≤–∞—à–µ–º –ø—Ä–æ—Ñ–∏–ª–µ
  - –î–æ—Å—Ç—É–ø –∫ –ø—Ä–æ–µ–∫—Ç–∞–º –≤–∞—à–µ–π –æ–±–ª–∞—á–Ω–æ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
  - –î–æ—Å—Ç—É–ø –∫ –∂—É—Ä–Ω–∞–ª–∞–º –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ Google Cloud

**–î–µ–π—Å—Ç–≤–∏—è**:

1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –æ–∂–∏–¥–∞–Ω–∏—è–º (–Ω–µ—Ç —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π, –≤—ã—Ö–æ–¥—è—â–∏—Ö –∑–∞ —Ä–∞–º–∫–∏)
2. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "–†–∞–∑—Ä–µ—à–∏—Ç—å" –∏–ª–∏ "–ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å"
3. –î–æ–∂–¥–∏—Ç–µ—Å—å –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã –Ω–∞ `http://localhost:51121/oauth-callback`

**–ß—Ç–æ –≤—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å**:

```html
<!DOCTYPE html>
<html>
  <!-- ... -->
  <h1>All set!</h1>
  <p>You've successfully authenticated with Antigravity.</p>
  <!-- ... -->
</html>
```

::: warning

**–ü—Ä–æ–±–ª–µ–º–∞ –∑–∞–∫—Ä—ã—Ç–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏**

–ï—Å–ª–∏ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –±—Ä–∞—É–∑–µ—Ä –Ω–µ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –ø—Ä–æ—Å—Ç–æ –∑–∞–∫—Ä–æ–π—Ç–µ –≤–∫–ª–∞–¥–∫—É –≤—Ä—É—á–Ω—É—é. –≠—Ç–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –±—Ä–∞—É–∑–µ—Ä–∞ –∏ –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.

:::

### –®–∞–≥ 3: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –æ–±–º–µ–Ω —Ç–æ–∫–µ–Ω–∞ –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ Project ID

**–ó–∞—á–µ–º**

–ö–æ–¥ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ ‚Äî —ç—Ç–æ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —É—á—ë—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ –æ–±–º–µ–Ω—è—Ç—å –Ω–∞ –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–π `refresh_token`, –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –ø–æ–ª—É—á–∞—è `Project ID`, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞ Antigravity.

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ**:

–ü–ª–∞–≥–∏–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç —Å–ª–µ–¥—É—é—â–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (–±–µ–∑ –≤–∞—à–µ–≥–æ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞):

1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ PKCE**: –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∫–æ–¥–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —Å –ø–æ–º–æ—â—å—é `code_verifier`
2. **–û–±–º–µ–Ω —Ç–æ–∫–µ–Ω–∞**: –û—Ç–ø—Ä–∞–≤–∫–∞ POST-–∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ `oauth2.googleapis.com/token`

   ```typescript
   // –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥: src/antigravity/oauth.ts:209
   POST https://oauth2.googleapis.com/token
   Content-Type: application/x-www-form-urlencoded

   {
     client_id: "...",
     client_secret: "...",
     code: "–ö–æ–¥ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏",
     grant_type: "authorization_code",
     redirect_uri: "http://localhost:51121/oauth-callback",
     code_verifier: "PKCE verifier"
   }
   ```

3. **–ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ**: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–¥—Ä–µ—Å–∞ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –ø–æ—á—Ç—ã

   ```typescript
   // –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥: src/antigravity/oauth.ts:231
   GET https://www.googleapis.com/oauth2/v1/userinfo?alt=json
   Authorization: Bearer {access_token}
   ```

4. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ Project ID**: –ü–æ–ø—ã—Ç–∫–∞ –ø–æ–ª—É—á–∏—Ç—å –≤–∞—à –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞ –∏–∑ API Antigravity

   ```typescript
   // –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥: src/antigravity/oauth.ts:131
   // –ü–æ–ø—ã—Ç–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∫–æ–Ω–µ—á–Ω—ã—Ö —Ç–æ—á–µ–∫ –≤ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ
   - https://cloudcode-pa.googleapis.com/v1internal:loadCodeAssist (prod)
   - https://daily-cloudcode-pa.sandbox.googleapis.com/v1internal:loadCodeAssist (daily)
   - https://autopush-cloudcode-pa.sandbox.googleapis.com/v1internal:loadCodeAssist (autopush)
   ```

5. **–•—Ä–∞–Ω–µ–Ω–∏–µ —É—á—ë—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏**: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ `~/.config/opencode/antigravity-accounts.json`

   ```json
   {
     "version": 3,
     "accounts": [
       {
         "email": "your.email@gmail.com",
         "refreshToken": "1//0g...|rising-fact-p41fc",
         "projectId": "rising-fact-p41fc",
         "addedAt": 1737609600000,
         "lastUsed": 1737609600000
       }
     ]
   }
   ```

::: details

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ Project ID**

Project ID ‚Äî —ç—Ç–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞ Google Cloud, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è, –∫ –∫–∞–∫–æ–º—É –ø—Ä–æ–µ–∫—Ç—É –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –≤—ã–∑–æ–≤ API. Antigravity –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–≤–æ—Ç—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ Project ID.

- **–£—Å–ø–µ—à–Ω–æ–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–∞—à –Ω–∞—Å—Ç–æ—è—â–∏–π Project ID (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
- **–ù–µ—É–¥–∞—á–Ω–æ–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Project ID –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (`rising-fact-p41fc`)

:::

**–ß—Ç–æ –≤—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å**:

```
‚úÖ Authentication successful
üìß Account: your.email@gmail.com
üÜî Project ID: rising-fact-p41fc
üíæ Saved to: ~/.config/opencode/antigravity-accounts.json
```

### –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞—è —Ç–æ—á–∫–∞ ‚úÖ

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è —É—á—ë—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏**:

```bash
cat ~/.config/opencode/antigravity-accounts.json
```

**–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥**:

```json
{
  "version": 3,
  "accounts": [
    {
      "email": "your.email@gmail.com",
      "refreshToken": "1//0g...|rising-fact-p41fc",
      "projectId": "rising-fact-p41fc",
      "addedAt": 1737609600000,
      "lastUsed": 1737609600000
    }
  ]
}
```

::: tip

**–§–æ—Ä–º–∞—Ç —Ö—Ä–∞–Ω–µ–Ω–∏—è —É—á—ë—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏**

–§–æ—Ä–º–∞—Ç –ø–æ–ª—è `refreshToken`: `{refresh_token}|{project_id}`, —ç—Ç–æ—Ç –¥–∏–∑–∞–π–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–∫–µ–Ω –∏ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞ –≤ –æ–¥–Ω–æ–º –ø–æ–ª–µ, —É–ø—Ä–æ—â–∞—è –ª–æ–≥–∏–∫—É —Ö—Ä–∞–Ω–µ–Ω–∏—è.

:::

## –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –æ –ø—Ä–æ–±–ª–µ–º–∞—Ö

### –ü—Ä–æ–±–ª–µ–º–∞ 1: –ü–æ—Ä—Ç –∑–∞–Ω—è—Ç

**–°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ**:

```
‚ùå Port 51121 is already in use.
Another process is occupying this port.
```

**–ü—Ä–∏—á–∏–Ω–∞**: –î—Ä—É–≥–æ–π –ø—Ä–æ—Ü–µ—Å—Å OpenCode –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∏–ª–∏ –¥—Ä—É–≥–æ–π –ø—Ä–æ–≥—Ä–∞–º–º–∞ –∑–∞–Ω—è–ª–∞ –ø–æ—Ä—Ç.

**–†–µ—à–µ–Ω–∏–µ**:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏ –∑–∞–≤–µ—Ä—à–∏—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å, –∑–∞–Ω–∏–º–∞—é—â–∏–π –ø–æ—Ä—Ç:

   ```bash
   # macOS/Linux
   lsof -ti:51121 | xargs kill -9

   # Windows
   netstat -ano | findstr :51121
   taskkill /PID <PID> /F
   ```

2. –°–Ω–æ–≤–∞ –∑–∞–ø—É—Å—Ç–∏—Ç–µ `opencode auth login`

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –ë—Ä–∞—É–∑–µ—Ä –Ω–µ –æ—Ç–∫—Ä—ã–ª—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

**–ü—Ä–∏—á–∏–Ω–∞**: –í —Å—Ä–µ–¥–µ WSL, Docker –∏–ª–∏ —É–¥–∞–ª—ë–Ω–Ω–æ–π —Å—Ä–µ–¥–µ `localhost` –Ω–µ —Ä–∞–≤–µ–Ω –∞–¥—Ä–µ—Å—É —Ö–æ—Å—Ç–∞.

**–†–µ—à–µ–Ω–∏–µ**:

–ü–ª–∞–≥–∏–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç —Å—Ä–µ–¥—É –∏ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç URL –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞:

```
üåê Opening browser for authorization...

If the browser doesn't open, visit this URL manually:
https://accounts.google.com/o/oauth2/v2/auth?...
```

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ URL –∏ –æ—Ç–∫—Ä–æ–π—Ç–µ –µ–≥–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ —Ö–æ—Å—Ç–∞.

### –ü—Ä–æ–±–ª–µ–º–∞ 3: –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å Project ID

**–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞—é—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ**:

```
‚ö†Ô∏è Failed to resolve Antigravity project via loadCodeAssist
Using default project ID: rising-fact-p41fc
```

**–ü—Ä–∏—á–∏–Ω–∞**: –î–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã—Ö —É—á—ë—Ç–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π –∏–ª–∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π API `loadCodeAssist` –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω.

**–†–µ—à–µ–Ω–∏–µ**:

1. –ï—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ —Ç–æ–ª—å–∫–æ –º–æ–¥–µ–ª–∏ Antigravity (—Å —Å—É—Ñ—Ñ–∏–∫—Å–æ–º `:antigravity`), –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Project ID –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
2. –ï—Å–ª–∏ –≤–∞–º –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–æ–¥–µ–ª–∏ Gemini CLI (–Ω–∞–ø—Ä–∏–º–µ—Ä, `gemini-2.5-pro`), –≤—Ä—É—á–Ω—É—é –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ Project ID:

   ```json
   // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ ~/.config/opencode/antigravity-accounts.json
   {
     "accounts": [
       {
         "email": "your.email@gmail.com",
         "refreshToken": "1//0g...|your-custom-project-id",
         "projectId": "your-custom-project-id"
       }
     ]
   }
   ```

   –®–∞–≥–∏ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è Project ID:
   - –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ [Google Cloud Console](https://console.cloud.google.com/)
   - –°–æ–∑–¥–∞–π—Ç–µ –∏–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç
   - –í–∫–ª—é—á–∏—Ç–µ **Gemini for Google Cloud API**
   - –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞ (—Ñ–æ—Ä–º–∞—Ç: `rising-fact-p41fc`)

### –ü—Ä–æ–±–ª–µ–º–∞ 4: –û—à–∏–±–∫–∞ invalid_grant

**–°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ**:

```
‚ùå Token exchange failed: invalid_grant
```

**–ü—Ä–∏—á–∏–Ω—ã**:
- –ö–æ–¥ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏—Å—Ç—ë–∫ (–æ–±—ã—á–Ω–æ —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è 10 –º–∏–Ω—É—Ç)
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–æ–∑–≤–∞–ª –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø–æ—Å–ª–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- –ò–∑–º–µ–Ω—ë–Ω –ø–∞—Ä–æ–ª—å —É—á—ë—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏ –∏–ª–∏ –∏–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞–Ω–æ —Å–æ–±—ã—Ç–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

**–†–µ—à–µ–Ω–∏–µ**: –°–Ω–æ–≤–∞ –∑–∞–ø—É—Å—Ç–∏—Ç–µ `opencode auth login`

## –ú–µ—Ö–∞–Ω–∏–∑–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–æ–≤

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: –í–∞–º –Ω–µ –Ω—É–∂–Ω–æ –±–µ—Å–ø–æ–∫–æ–∏—Ç—å—Å—è –æ–± –∏—Å—Ç–µ—á–µ–Ω–∏–∏ —Ç–æ–∫–µ–Ω–∞.

–ü–ª–∞–≥–∏–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–∏—Ç —Ç–æ–∫–µ–Ω—ã –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —Å–ª—É—á–∞—è—Ö:

| –£—Å–ª–æ–≤–∏–µ –∑–∞–ø—É—Å–∫–∞ | –î–µ–π—Å—Ç–≤–∏–µ | –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –≤ –∏—Å—Ö–æ–¥–Ω–æ–º –∫–æ–¥–µ |
|--- | --- | ---|
| –ó–∞ 60 —Å–µ–∫—É–Ω–¥ –¥–æ –∏—Å—Ç–µ—á–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞ | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ | `src/plugin/auth.ts:33` |
| –ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ 401 Unauthorized | –ü–æ–ø—ã—Ç–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è | `src/plugin/auth.ts:33` |
| –ü—Ä–∏ –Ω–µ—É–¥–∞—á–Ω–æ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ | –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Å–Ω–æ–≤–∞ –≤–æ–π—Ç–∏ | `src/plugin.ts:995` |

**–õ–æ–≥–∏–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è**:

```typescript
// –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥: src/plugin/auth.ts:33
export function accessTokenExpired(auth: OAuthAuthDetails): boolean {
  // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞ 60 —Å–µ–∫—É–Ω–¥ –¥–æ –∏—Å—Ç–µ—á–µ–Ω–∏—è (—É—á—ë—Ç —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è —á–∞—Å–æ–≤)
  return auth.expires <= Date.now() + 60 * 1000;
}
```

## –ò—Ç–æ–≥–∏ —É—Ä–æ–∫–∞

–ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã –ø—Ä–æ—Ü–µ—Å—Å–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ OAuth 2.0 PKCE:

1. **–ú–µ—Ö–∞–Ω–∏–∑–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ PKCE**: –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π `verifier` –≤–º–µ—Å—Ç–æ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∫–ª—é—á–∞, –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø–µ—Ä–µ—Ö–≤–∞—Ç –∫–æ–¥–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
2. **–õ–æ–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞**: –ü—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–µ `localhost:51121`, –ø—Ä–∏—ë–º –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –æ—Ç Google
3. **–û–±–º–µ–Ω —Ç–æ–∫–µ–Ω–∞**: –û–±–º–µ–Ω –∫–æ–¥–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–∞ `access_token` –∏ `refresh_token`
4. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π Project ID**: –ü–æ–ø—ã—Ç–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –∏–∑ API Antigravity, –ø—Ä–∏ –Ω–µ—É–¥–∞—á–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
5. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞ 60 —Å–µ–∫—É–Ω–¥ –¥–æ –∏—Å—Ç–µ—á–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞, –±–µ–∑ —Ä—É—á–Ω–æ–≥–æ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞
6. **–•—Ä–∞–Ω–µ–Ω–∏–µ —É—á—ë—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏**: –í—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `~/.config/opencode/antigravity-accounts.json`

–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ —Å–¥–µ–ª–∞—Ç—å –ø–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å –∫ –º–æ–¥–µ–ª–∏!

## –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –æ–±–∑–æ—Ä —Å–ª–µ–¥—É—é—â–µ–≥–æ —É—Ä–æ–∫–∞

> –ù–∞ —Å–ª–µ–¥—É—é—â–µ–º —É—Ä–æ–∫–µ –º—ã –∏–∑—É—á–∏–º **[–ü–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å –∫ –º–æ–¥–µ–ª–∏](/ru/NoeFabris/opencode-antigravity-auth/start/first-request/)**.
>
> –í—ã —É–∑–Ω–∞–µ—Ç–µ:
> - –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `opencode run` –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–∞
> - –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
> - –ü–æ–Ω–∏–º–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –º–æ–¥–µ–ª–µ–π

---

## –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: –°—Å—ã–ª–∫–∏ –Ω–∞ –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥

<details>
<summary><strong>–ù–∞–∂–º–∏—Ç–µ, —á—Ç–æ–±—ã —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –∏ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–æ–¥–∞</strong></summary>

> –í—Ä–µ–º—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è: 2026-01-23

| –§—É–Ω–∫—Ü–∏—è | –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É | –ù–æ–º–µ—Ä —Å—Ç—Ä–æ–∫–∏ |
|--- | --- | ---|
| –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–µ–π PKCE | [`src/antigravity/oauth.ts`](https://github.com/NoeFabris/opencode-antigravity-auth/blob/main/src/antigravity/oauth.ts#L91-L113) | 91-113  |
| –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ URL –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ | [`src/antigravity/oauth.ts`](https://github.com/NoeFabris/opencode-antigravity-auth/blob/main/src/antigravity/oauth.ts#L91-L113) | 91-113  |
| –û–±–º–µ–Ω —Ç–æ–∫–µ–Ω–∞ | [`src/antigravity/oauth.ts`](https://github.com/NoeFabris/opencode-antigravity-auth/blob/main/src/antigravity/oauth.ts#L201-L270) | 201-270 |
| –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ | [`src/antigravity/oauth.ts`](https://github.com/NoeFabris/opencode-antigravity-auth/blob/main/src/antigravity/oauth.ts#L231-L242) | 231-242 |
| –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ Project ID | [`src/antigravity/oauth.ts`](https://github.com/NoeFabris/opencode-antigravity-auth/blob/main/src/antigravity/oauth.ts#L131-L196) | 131-196 |
| –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ä–µ–¥—ã | [`src/plugin/server.ts`](https://github.com/NoeFabris/opencode-antigravity-auth/blob/main/src/plugin/server.ts#L31-L134) | 31-134  |
| –°–µ—Ä–≤–µ—Ä –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ OAuth | [`src/plugin/server.ts`](https://github.com/NoeFabris/opencode-antigravity-auth/blob/main/src/plugin/server.ts#L140-L366) | 140-366 |
| –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å—Ç–µ—á–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞ | [`src/plugin/auth.ts`](https://github.com/NoeFabris/opencode-antigravity-auth/blob/main/src/plugin/auth.ts#L33-L38) | 33-38   |
| –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –∏—Å—Ç–µ—á–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞ | [`src/plugin/auth.ts`](https://github.com/NoeFabris/opencode-antigravity-auth/blob/main/src/plugin/auth.ts#L45-L52) | 45-52   |

**–ö–ª—é—á–µ–≤—ã–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã**:
- `ANTIGRAVITY_CLIENT_ID`: –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∫–ª–∏–µ–Ω—Ç–∞ OAuth (`constants.ts:4`)
- `ANTIGRAVITY_CLIENT_SECRET`: –°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á –∫–ª–∏–µ–Ω—Ç–∞ OAuth (`constants.ts:9`)
- `ANTIGRAVITY_REDIRECT_URI`: –ê–¥—Ä–µ—Å –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ OAuth `http://localhost:51121/oauth-callback` (`constants.ts:25`)
- `ANTIGRAVITY_SCOPES`: –°–ø–∏—Å–æ–∫ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã—Ö —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π (`constants.ts:14-20`)
- `ANTIGRAVITY_DEFAULT_PROJECT_ID`: –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `rising-fact-p41fc` (`constants.ts:71`)

**–ö–ª—é—á–µ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏**:
- `authorizeAntigravity()`: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–∞—Ä—ã –∫–ª—é—á–µ–π PKCE –∏ URL –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (`oauth.ts:91`)
- `exchangeAntigravity()`: –û–±–º–µ–Ω –∫–æ–¥–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–∞ —Ç–æ–∫–µ–Ω –¥–æ—Å—Ç—É–ø–∞ (`oauth.ts:201`)
- `fetchProjectID()`: –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ –∏–∑ API Antigravity (`oauth.ts:131`)
- `startOAuthListener()`: –ó–∞–ø—É—Å–∫ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ OAuth-—Å–µ—Ä–≤–µ—Ä–∞ (`server.ts:140`)
- `accessTokenExpired()`: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å—Ç–µ—á–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞ (`auth.ts:33`)

**–í–∞–∂–Ω—ã–µ –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞**:
- PKCE –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∞–ª–≥–æ—Ä–∏—Ç–º —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è S256 (`oauth.ts:100`)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞ 60 —Å–µ–∫—É–Ω–¥ –¥–æ –∏—Å—Ç–µ—á–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞ (`auth.ts:3`)
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –æ—Ñ–ª–∞–π–Ω-–¥–æ—Å—Ç—É–ø–∞ (`access_type=offline`) (`oauth.ts:105`)
- –ü–æ—Ä—è–¥–æ–∫ –æ—Ç–∫–∞—Ç–∞ –∫–æ–Ω–µ—á–Ω—ã—Ö —Ç–æ—á–µ–∫ Project ID: prod ‚Üí daily ‚Üí autopush (`oauth.ts:141-143`)

</details>
