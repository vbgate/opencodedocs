---
title: "–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏: –ú–µ—Ö–∞–Ω–∏–∑–º –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è | opencode-md-table-formatter"
sidebarTitle: "–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–∫–æ—Ä–æ—Å—Ç–∏ —Ç–∞–±–ª–∏—Ü"
subtitle: "–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏: –ú–µ—Ö–∞–Ω–∏–∑–º –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è | opencode-md-table-formatter"
description: "–ò–∑—É—á–∏—Ç–µ –º–µ—Ö–∞–Ω–∏–∑–º –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ opencode-md-table-formatter. –ì–ª—É–±–æ–∫–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö widthCache, –ø—Ä–æ—Ü–µ—Å—Å–∞ –ø–æ–∏—Å–∫–∞ –≤ –∫—ç—à–µ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –º–µ—Ö–∞–Ω–∏–∑–º–∞ –æ—á–∏—Å—Ç–∫–∏. –û—Å–≤–æ–µ–Ω–∏–µ –º–µ—Ç–æ–¥–∞ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è —á–µ—Ä–µ–∑ Map –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π, —Å–Ω–∏–∂–µ–Ω–∏—è –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ CPU –∏ –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ç–∞–±–ª–∏—Ü."
tags:
  - "–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏"
  - "–ú–µ—Ö–∞–Ω–∏–∑–º –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è"
  - "–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏"
prerequisite:
  - "start-features"
order: 80
---

# –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏: –ú–µ—Ö–∞–Ω–∏–∑–º –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

## –ß—Ç–æ –≤—ã —É–∑–Ω–∞–µ—Ç–µ

- –ö–∞–∫ –º–µ—Ö–∞–Ω–∏–∑–º –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –ø–ª–∞–≥–∏–Ω–∞ –ø–æ–≤—ã—à–∞–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –°—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö widthCache –∏ —Å–ø–æ—Å–æ–±—ã –µ—ë –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- –£—Å–ª–æ–≤–∏—è —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—á–∏—Å—Ç–∫–∏ –∫—ç—à–∞
- –ö–∞–∫ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

## –í–∞—à–∞ —Ç–µ–∫—É—â–∞—è —Å–∏—Ç—É–∞—Ü–∏—è

–í–æ–∑–º–æ–∂–Ω–æ, –≤–∞–º –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ:

> –ö–∞–∫ –ø–ª–∞–≥–∏–Ω –±—ã—Å—Ç—Ä–æ –≤—ã—á–∏—Å–ª—è–µ—Ç —à–∏—Ä–∏–Ω—É —Ç–∞–±–ª–∏—Ü? –ü–æ—á–µ–º—É –æ–±—Ä–∞–±–æ—Ç–∫–∞ –±–æ–ª—å—à–∏—Ö —Ç–∞–±–ª–∏—Ü –æ—Å—Ç–∞—ë—Ç—Å—è –ø–ª–∞–≤–Ω–æ–π? –ö–∞–∫ —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω –º–µ—Ö–∞–Ω–∏–∑–º –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è?

–í —ç—Ç–æ–º —É—Ä–æ–∫–µ –º—ã –ø–æ–¥—Ä–æ–±–Ω–æ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –≤–Ω—É—Ç—Ä–µ–Ω–Ω—é—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –ø–ª–∞–≥–∏–Ω–∞ –∏ –ø–æ–º–æ–∂–µ–º –≤–∞–º –ø–æ–Ω—è—Ç—å –∫–æ–Ω—Ü–µ–ø—Ü–∏—é –¥–∏–∑–∞–π–Ω–∞ –º–µ—Ö–∞–Ω–∏–∑–º–∞ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

## –û—Å–Ω–æ–≤–Ω–∞—è –∫–æ–Ω—Ü–µ–ø—Ü–∏—è

### –ó–∞—á–µ–º –Ω—É–∂–Ω–æ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ?

–ü—Ä–∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ —Ç–∞–±–ª–∏—Ü Markdown –ø–ª–∞–≥–∏–Ω—É –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã—á–∏—Å–ª–∏—Ç—å **–æ—Ç–æ–±—Ä–∞–∂–∞–µ–º—É—é —à–∏—Ä–∏–Ω—É** (display width) –∫–∞–∂–¥–æ–π —è—á–µ–π–∫–∏. –≠—Ç–æ—Ç —Ä–∞—Å—á—ë—Ç –≤–∫–ª—é—á–∞–µ—Ç:

1. **–£–¥–∞–ª–µ–Ω–∏–µ —Å–∏–º–≤–æ–ª–æ–≤ Markdown**: —Ç–∞–∫–∏—Ö –∫–∞–∫ `**–∂–∏—Ä–Ω—ã–π**`, `*–∫—É—Ä—Å–∏–≤*`, `~~–∑–∞—á—ë—Ä–∫–Ω—É—Ç—ã–π~~`
2. **–ó–∞—â–∏—Ç–∞ –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ –∫–æ–¥–∞**: —Å–∏–º–≤–æ–ª—ã Markdown –≤–Ω—É—Ç—Ä–∏ `` `–∫–æ–¥` `` –æ—Å—Ç–∞—é—Ç—Å—è –Ω–µ–∏–∑–º–µ–Ω–Ω—ã–º–∏
3. **–í—ã–∑–æ–≤ `Bun.stringWidth()`**: –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–π —à–∏—Ä–∏–Ω—ã Unicode-—Å–∏–º–≤–æ–ª–æ–≤ (–≤–∫–ª—é—á–∞—è Emoji –∏ –∫–∏—Ç–∞–π—Å–∫–∏–µ –∏–µ—Ä–æ–≥–ª–∏—Ñ—ã)

**–ü—Ä–æ–±–ª–µ–º–∞**: –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —è—á–µ–π–∫–∏ –º–æ–∂–µ—Ç –ø–æ–≤—Ç–æ—Ä—è—Ç—å—Å—è –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤ –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∞—Ö), –∏ –∫–∞–∂–¥—ã–π —Ä–∞–∑ –≤—ã–ø–æ–ª–Ω—è—Ç—å —ç—Ç–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏ –±—É–¥–µ—Ç –º–µ–¥–ª–µ–Ω–Ω–æ.

**–†–µ—à–µ–Ω–∏–µ**: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫—ç—à–∞ (Map) –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è "—Ç–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ ‚Üí –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–∞—è —à–∏—Ä–∏–Ω–∞" –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –∫—ç—à–∞

–ü–ª–∞–≥–∏–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–≤–µ –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫—ç—à–µ–º:

### widthCache

```typescript
const widthCache = new Map<string, number>()
```

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–π —à–∏—Ä–∏–Ω—ã —Å—Ç—Ä–æ–∫

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞**:
- **Key**: –∏—Å—Ö–æ–¥–Ω–æ–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —è—á–µ–π–∫–∏ (–≤–∫–ª—é—á–∞—è –≤–µ—Å—å —Å–∏–Ω—Ç–∞–∫—Å–∏—Å Markdown)
- **Value**: –≤—ã—á–∏—Å–ª–µ–Ω–Ω–∞—è –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–∞—è —à–∏—Ä–∏–Ω–∞ (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–º–≤–æ–ª–æ–≤)

**–ü—Ä–∏–º–µ—Ä**:

| –ò—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç (Key) | –û—Ç–æ–±—Ä–∞–∂–∞–µ–º–∞—è —à–∏—Ä–∏–Ω–∞ (Value) | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ |
| --- | --- | --- |
| `**–ò–º—è**` | 4 | –®–∏—Ä–∏–Ω–∞ –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è `**` —Ä–∞–≤–Ω–∞ 4 |
| `*–í–æ–∑—Ä–∞—Å—Ç*` | 4 | –®–∏—Ä–∏–Ω–∞ –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è `*` —Ä–∞–≤–Ω–∞ 4 |
| `` `status` `` | 8 | –°–∏–º–≤–æ–ª—ã –∫–æ–¥–∞ —Ç–æ–∂–µ —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –≤ —à–∏—Ä–∏–Ω–µ |
| `–ß–∂–∞–Ω –°–∞–Ω` | 4 | –®–∏—Ä–∏–Ω–∞ –∫–∏—Ç–∞–π—Å–∫–æ–≥–æ —Å–∏–º–≤–æ–ª–∞ —Ä–∞–≤–Ω–∞ 1 |

### cacheOperationCount

```typescript
let cacheOperationCount = 0
```

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –æ–ø–µ—Ä–∞—Ü–∏–π –∫—ç—à–∞ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—á–∏—Å—Ç–∫–∏

**–ü–æ—Ä–æ–≥ –æ—á–∏—Å—Ç–∫–∏**:
- –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–ø–µ—Ä–∞—Ü–∏–π > 100 –∏–ª–∏
- –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π –≤ –∫—ç—à–µ > 1000

## –ü—Ä–æ—Ü–µ—Å—Å –ø–æ–∏—Å–∫–∞ –≤ –∫—ç—à–µ

### –§—É–Ω–∫—Ü–∏—è calculateDisplayWidth

–ö–æ–≥–¥–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã—á–∏—Å–ª–∏—Ç—å —à–∏—Ä–∏–Ω—É —è—á–µ–π–∫–∏, –ø–ª–∞–≥–∏–Ω –≤—ã–∑—ã–≤–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é `calculateDisplayWidth()`, –∫–æ—Ç–æ—Ä–∞—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å–ª–µ–¥—É—é—â–∏–π –ø—Ä–æ—Ü–µ—Å—Å:

<details>
<summary><strong>üìñ –ü—Ä–æ—Å–º–æ—Ç—Ä –ø–æ–ª–Ω–æ–≥–æ –∫–æ–¥–∞</strong></summary>

```typescript
function calculateDisplayWidth(text: string): number {
  if (widthCache.has(text)) {
    return widthCache.get(text)!  // –ü–æ–ø–∞–¥–∞–Ω–∏–µ –≤ –∫—ç—à, –ø—Ä—è–º–æ–π –≤–æ–∑–≤—Ä–∞—Ç
  }

  const width = getStringWidth(text)  // –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–π —à–∏—Ä–∏–Ω—ã
  widthCache.set(text, width)          // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –∫—ç—à
  return width
}
```

</details>

**–î–∏–∞–≥—Ä–∞–º–º–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞**:

```mermaid
graph TD
    A[–ù–∞—á–∞–ª–æ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —à–∏—Ä–∏–Ω—ã] --> B{–ï—Å—Ç—å –≤ –∫—ç—à–µ?}
    B -->|–î–∞| C[–í–µ—Ä–Ω—É—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ –∫—ç—à–∞]
    B -->|–ù–µ—Ç| D[–í—ã–∑–≤–∞—Ç—å getStringWidth]
    D --> E[–£–¥–∞–ª–∏—Ç—å —Å–∏–º–≤–æ–ª—ã Markdown]
    E --> F[–í—ã–∑–≤–∞—Ç—å Bun.stringWidth]
    F --> G[–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ widthCache]
    G --> C
    C --> H[–í–µ—Ä–Ω—É—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ —à–∏—Ä–∏–Ω—ã]
```

**–†–∞–∑–±–æ—Ä —à–∞–≥–æ–≤**:

| –®–∞–≥ | –û–ø–µ—Ä–∞—Ü–∏—è | –í—Ä–µ–º–µ–Ω–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å |
| --- | --- | --- |
| 1 | –ü—Ä–æ–≤–µ—Ä–∫–∞ `widthCache.has(text)` | O(1) |
| 2 | –ü–æ–ø–∞–¥–∞–Ω–∏–µ –≤ –∫—ç—à ‚Üí –ø—Ä—è–º–æ–π –≤–æ–∑–≤—Ä–∞—Ç | O(1) |
| 3 | –ü—Ä–æ–º–∞—Ö –∫—ç—à–∞ ‚Üí –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ —à–∏—Ä–∏–Ω—ã | O(n) |
| 4 | –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –∫—ç—à | O(1) |

**–ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã**:
- **–ü—Ä–∏ –ø–æ–ø–∞–¥–∞–Ω–∏–∏ –≤ –∫—ç—à**: –ø—Ä—è–º–æ–π –≤–æ–∑–≤—Ä–∞—Ç –±–µ–∑ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π (O(1))
- **–ü—Ä–∏ –ø—Ä–æ–º–∞—Ö–µ –∫—ç—à–∞**: –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–ª–Ω–æ–π –ª–æ–≥–∏–∫–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —à–∏—Ä–∏–Ω—ã (O(n))
- **–•—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞**: –∫–ª—é—á ‚Äî –ø–æ–ª–Ω—ã–π Markdown-—Ç–µ–∫—Å—Ç –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è

## –ú–µ—Ö–∞–Ω–∏–∑–º –æ—á–∏—Å—Ç–∫–∏ –∫—ç—à–∞

### –ó–∞—á–µ–º –Ω—É–∂–Ω–æ –æ—á–∏—â–∞—Ç—å –∫—ç—à?

–•–æ—Ç—è –∫—ç—à –º–æ–∂–µ—Ç –ø–æ–≤—ã—Å–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –æ–Ω –∑–∞–Ω–∏–º–∞–µ—Ç –ø–∞–º—è—Ç—å. –ë–µ–∑ –æ—á–∏—Å—Ç–∫–∏:
- **–ù–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π —Ä–æ—Å—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–∞–º—è—Ç–∏**: –∫–∞–∂–¥–æ–µ –Ω–æ–≤–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —è—á–µ–π–∫–∏ –∫—ç—à–∏—Ä—É–µ—Ç—Å—è
- **–í–æ–∑–º–æ–∂–Ω–æ–µ –Ω–∞–ª–∏—á–∏–µ –Ω–µ–Ω—É–∂–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö**: —Å—Ç–∞—Ä–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ç–∞–±–ª–∏—Ü –º–æ–∂–µ—Ç –±–æ–ª—å—à–µ –Ω–µ –ø–æ–Ω–∞–¥–æ–±–∏—Ç—å—Å—è

### –£—Å–ª–æ–≤–∏—è —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—á–∏—Å—Ç–∫–∏

–ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–ª–∞–≥–∏–Ω –≤—ã–∑—ã–≤–∞–µ—Ç `incrementOperationCount()` –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—á—ë—Ç—á–∏–∫–∞ –æ–ø–µ—Ä–∞—Ü–∏–π:

<details>
<summary><strong>üìñ –ü—Ä–æ—Å–º–æ—Ç—Ä –∫–æ–¥–∞ –æ—á–∏—Å—Ç–∫–∏</strong></summary>

```typescript
function incrementOperationCount() {
  cacheOperationCount++

  if (cacheOperationCount > 100 || widthCache.size > 1000) {
    cleanupCache()
  }
}

function cleanupCache() {
  widthCache.clear()
  cacheOperationCount = 0
}
```

</details>

**–£—Å–ª–æ–≤–∏—è —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è** (–≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ª—é–±–æ–≥–æ —É—Å–ª–æ–≤–∏—è):

| –£—Å–ª–æ–≤–∏–µ | –ü–æ—Ä–æ–≥ | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ |
| --- | --- | --- |
| –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–ø–µ—Ä–∞—Ü–∏–π | > 100 –æ–ø–µ—Ä–∞—Ü–∏–π —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è | –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ —á–∞—Å—Ç–æ–≥–æ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è –æ—á–∏—Å—Ç–∫–∏ |
| –ó–∞–ø–∏—Å–∏ –≤ –∫—ç—à–µ | > 1000 —è—á–µ–µ–∫ | –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ —á—Ä–µ–∑–º–µ—Ä–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–∞–º—è—Ç–∏ |

**–°—Ç—Ä–∞—Ç–µ–≥–∏—è –æ—á–∏—Å—Ç–∫–∏**:
- **–ü–æ–ª–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞**: `widthCache.clear()` —É–¥–∞–ª—è–µ—Ç –≤–µ—Å—å –∫—ç—à
- **–°–±—Ä–æ—Å —Å—á—ë—Ç—á–∏–∫–∞**: `cacheOperationCount = 0`

::: info –í—Ä–µ–º—è –æ—á–∏—Å—Ç–∫–∏

–û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç **–ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è**, –∞ –Ω–µ –≤–æ –≤—Ä–µ–º—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è. –≠—Ç–æ –Ω–µ –ø—Ä–µ—Ä—ã–≤–∞–µ—Ç —Ç–µ–∫—É—â—É—é –æ–ø–µ—Ä–∞—Ü–∏—é —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.

:::

## –≠—Ñ—Ñ–µ–∫—Ç –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –ê–Ω–∞–ª–∏–∑ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –ø–æ–ø–∞–¥–∞–Ω–∏–π –≤ –∫—ç—à

–ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º —Ç–∞–±–ª–∏—Ü—É 5 —Å—Ç–æ–ª–±—Ü–æ–≤ √ó 10 —Å—Ç—Ä–æ–∫, –≥–¥–µ:

- **–ü–æ–≤—Ç–æ—Ä—è—é—â–µ–µ—Å—è —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ**: –Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –ø–æ–≤—Ç–æ—Ä—è—é—Ç—Å—è 11 —Ä–∞–∑ –≤ —Å—Ç—Ä–æ–∫–µ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–π –∏ –¥–∞–Ω–Ω—ã—Ö
- **–£–Ω–∏–∫–∞–ª—å–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ**: —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∫–∞–∂–¥–æ–π —è—á–µ–π–∫–∏ —Ä–∞–∑–ª–∏—á–Ω–æ

**–≠—Ñ—Ñ–µ–∫—Ç –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è**:

| –°—Ü–µ–Ω–∞—Ä–∏–π | –ë–µ–∑ –∫—ç—à–∞ | –° –∫—ç—à–µ–º | –£–ª—É—á—à–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ |
| --- | --- | --- | --- |
| 5 —Å—Ç–æ–ª–±—Ü–æ–≤ √ó 10 —Å—Ç—Ä–æ–∫ (–±–µ–∑ –ø–æ–≤—Ç–æ—Ä–æ–≤) | 50 –≤—ã—á–∏—Å–ª–µ–Ω–∏–π | 50 –≤—ã—á–∏—Å–ª–µ–Ω–∏–π | –ù–µ—Ç |
| 5 —Å—Ç–æ–ª–±—Ü–æ–≤ √ó 10 —Å—Ç—Ä–æ–∫ (–ø–æ–≤—Ç–æ—Ä –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤) | 50 –≤—ã—á–∏—Å–ª–µ–Ω–∏–π | 10 –≤—ã—á–∏—Å–ª–µ–Ω–∏–π + 40 –ø–æ–ø–∞–¥–∞–Ω–∏–π –≤ –∫—ç—à | ~80% |

### –§–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –≤–ª–∏—è–Ω–∏–µ

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è**:

1. **–°–Ω–∏–∂–µ–Ω–∏–µ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞—Ç—Ä–∞—Ç**: –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è —Å–∏–º–≤–æ–ª–æ–≤ Markdown –∏ –≤—ã–∑–æ–≤–∞ `Bun.stringWidth()`
2. **–°–Ω–∏–∂–µ–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ CPU**: `getStringWidth()` –≤–∫–ª—é—á–∞–µ—Ç –∑–∞–º–µ–Ω—É —Ä–µ–≥—É–ª—è—Ä–Ω—ã—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏–π –∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ Unicode, —á—Ç–æ —Ä–µ—Å—É—Ä—Å–æ—ë–º–∫–æ
3. **–ü–æ–≤—ã—à–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ –æ—Ç–∫–ª–∏–∫–∞**: –±–æ–ª–µ–µ –∑–∞–º–µ—Ç–Ω–æ –¥–ª—è —Ç–∞–±–ª–∏—Ü —Å –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è —è—á–µ–µ–∫

**–ü—Ä–∏–º–µ—Ä—ã —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤**:

| –°—Ü–µ–Ω–∞—Ä–∏–π | –≠—Ñ—Ñ–µ–∫—Ç –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è |
| --- | --- |
| –¢–∞–±–ª–∏—Ü–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è, —Å–æ–∑–¥–∞–Ω–Ω–∞—è AI | ‚úÖ –ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç (–º–Ω–æ–≥–æ –ø–æ–≤—Ç–æ—Ä—è—é—â–µ–≥–æ—Å—è —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ –≤ —Å—Ç–æ–ª–±—Ü–∞—Ö) |
| –ü—Ä–æ—Å—Ç–∞—è –æ–¥–Ω–æ—Å—Ç—Ä–æ—á–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ | ‚ö™ –£–º–µ—Ä–µ–Ω–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç (—É–Ω–∏–∫–∞–ª—å–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ) |
| –¢–∞–±–ª–∏—Ü–∞ —Å –≤–ª–æ–∂–µ–Ω–Ω—ã–º Markdown | ‚úÖ –ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç (–≤—ã—Å–æ–∫–∏–µ –∑–∞—Ç—Ä–∞—Ç—ã –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–µ —Å–∏–º–≤–æ–ª–æ–≤) |

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

::: tip –°–æ–≤–µ—Ç—ã –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

–ï—Å–ª–∏ –≤–∞–º –Ω—É–∂–Ω–æ –¥–∞–ª—å–Ω–µ–π—à–µ–µ –ø–æ–≤—ã—à–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, —Ä–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ:

1. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ—Ä–æ–≥–æ–≤ –∫—ç—à–∞**: —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∫–∞ –ø–æ—Ä–æ–≥–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π `100` –æ–ø–µ—Ä–∞—Ü–∏–π –∏ `1000` –∑–∞–ø–∏—Å–µ–π –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–º —Ä–∞–∑–º–µ—Ä–æ–º —Ç–∞–±–ª–∏—Ü
2. **LRU-–∫—ç—à**: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –≤—ã—Ç–µ—Å–Ω–µ–Ω–∏—è –¥–∞–≤–Ω–æ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ (Least Recently Used) –≤–º–µ—Å—Ç–æ –ø–æ–ª–Ω–æ–π –æ—á–∏—Å—Ç–∫–∏
3. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏**: –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –ø–æ–ø–∞–¥–∞–Ω–∏–π –≤ –∫—ç—à –∏ –∞–Ω–∞–ª–∏–∑–∞ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–π —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

:::

## –†–µ–∑—é–º–µ —É—Ä–æ–∫–∞

–ü–ª–∞–≥–∏–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–µ—Ö–∞–Ω–∏–∑–º –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è `widthCache` –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:

- **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è**: `Map<string, number>` –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –∏—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å—Ç –≤ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º—É—é —à–∏—Ä–∏–Ω—É
- **–ü—Ä–æ—Ü–µ—Å—Å –ø–æ–∏—Å–∫–∞**: —Å–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –∫—ç—à ‚Üí –ø—Ä–∏ –ø—Ä–æ–º–∞—Ö–µ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è
- **–ú–µ—Ö–∞–Ω–∏–∑–º –æ—á–∏—Å—Ç–∫–∏**: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –ø—Ä–∏ > 100 –æ–ø–µ—Ä–∞—Ü–∏–π –∏–ª–∏ > 1000 –∑–∞–ø–∏—Å–µ–π
- **–ü–æ–≤—ã—à–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏**: —Å–Ω–∏–∂–µ–Ω–∏–µ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –∏ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ CPU

–≠—Ç–æ—Ç –º–µ—Ö–∞–Ω–∏–∑–º –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø–ª–∞–≤–Ω—É—é —Ä–∞–±–æ—Ç—É –ø–ª–∞–≥–∏–Ω–∞ –¥–∞–∂–µ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ —Å–ª–æ–∂–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü –∏ —è–≤–ª—è–µ—Ç—Å—è –∫–ª—é—á–µ–≤–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

## –ê–Ω–æ–Ω—Å —Å–ª–µ–¥—É—é—â–µ–≥–æ —É—Ä–æ–∫–∞

> –í —Å–ª–µ–¥—É—é—â–µ–º —É—Ä–æ–∫–µ –º—ã –∏–∑—É—á–∏–º **[–ñ—É—Ä–Ω–∞–ª –∏–∑–º–µ–Ω–µ–Ω–∏–π: –ò—Å—Ç–æ—Ä–∏—è –≤–µ—Ä—Å–∏–π –∏ –∑–∞–ø–∏—Å–∏ –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö](../../changelog/release-notes/)**.
>
> –í—ã —É–∑–Ω–∞–µ—Ç–µ:
> - –ò—Å—Ç–æ—Ä–∏—é —ç–≤–æ–ª—é—Ü–∏–∏ –≤–µ—Ä—Å–∏–π –ø–ª–∞–≥–∏–Ω–∞
> - –ó–∞–ø–∏—Å–∏ –æ –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏—è—Ö –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è—Ö
> - –ö–∞–∫ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–ª–∞–≥–∏–Ω–∞

---

## –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: –°—Å—ã–ª–∫–∏ –Ω–∞ –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥

<details>
<summary><strong>–ù–∞–∂–º–∏—Ç–µ, —á—Ç–æ–±—ã —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –∏ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–æ–¥–∞</strong></summary>

> –û–±–Ω–æ–≤–ª–µ–Ω–æ: 2026-01-26

| –§—É–Ω–∫—Ü–∏—è | –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É | –ù–æ–º–µ—Ä —Å—Ç—Ä–æ–∫–∏ |
| --- | --- | --- |
| –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ widthCache | [`source/franlol/opencode-md-table-formatter/index.ts`](https://github.com/franlol/opencode-md-table-formatter/blob/main/index.ts#L6) | 6 |
| –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ cacheOperationCount | [`source/franlol/opencode-md-table-formatter/index.ts`](https://github.com/franlol/opencode-md-table-formatter/blob/main/index.ts#L7) | 7 |
| –§—É–Ω–∫—Ü–∏—è calculateDisplayWidth | [`source/franlol/opencode-md-table-formatter/index.ts`](https://github.com/franlol/opencode-md-table-formatter/blob/main/index.ts#L151-L159) | 151-159 |
| –§—É–Ω–∫—Ü–∏—è incrementOperationCount | [`source/franlol/opencode-md-table-formatter/blob/main/index.ts`](https://github.com/franlol/opencode-md-table-formatter/blob/main/index.ts#L219-L225) | 219-225 |
| –§—É–Ω–∫—Ü–∏—è cleanupCache | [`source/franlol/opencode-md-table-formatter/index.ts`](https://github.com/franlol/opencode-md-table-formatter/blob/main/index.ts#L227-L230) | 227-230 |

**–ö–ª—é—á–µ–≤—ã–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã**:
- `widthCache = new Map<string, number>()`Ôºö–°—Ç—Ä—É–∫—Ç—É—Ä–∞ Map –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–π —à–∏—Ä–∏–Ω—ã —Å—Ç—Ä–æ–∫
- `cacheOperationCount = 0`Ôºö–°—á—ë—Ç—á–∏–∫ –æ–ø–µ—Ä–∞—Ü–∏–π –∫—ç—à–∞

**–ö–ª—é—á–µ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏**:
- `calculateDisplayWidth(text: string): number`Ôºö–í—ã—á–∏—Å–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–π —à–∏—Ä–∏–Ω—ã (—Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º), —Å–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫—ç—à, –∑–∞—Ç–µ–º –≤—ã—á–∏—Å–ª—è–µ—Ç
- `incrementOperationCount(): void`Ôºö–£–≤–µ–ª–∏—á–µ–Ω–∏–µ —Å—á—ë—Ç—á–∏–∫–∞ –æ–ø–µ—Ä–∞—Ü–∏–π, –∑–∞–ø—É—Å–∫ —É—Å–ª–æ–≤–Ω–æ–π –æ—á–∏—Å—Ç–∫–∏
- `cleanupCache(): void`Ôºö–û—á–∏—Å—Ç–∫–∞ widthCache –∏ —Å–±—Ä–æ—Å —Å—á—ë—Ç—á–∏–∫–∞

</details>
