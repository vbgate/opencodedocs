---
title: "Anthropic: –°–æ–≤–º–µ—Å—Ç–∏–º—ã–π API | Antigravity-Manager"
sidebarTitle: "–ü—É—Å—Ç—å Claude Code –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ª–æ–∫–∞–ª—å–Ω—ã–π —à–ª—é–∑"
subtitle: "Anthropic: –°–æ–≤–º–µ—Å—Ç–∏–º—ã–π API"
description: "–ò–∑—É—á–∏—Ç–µ API Anthropic Antigravity-Manager. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Base URL Claude Code, —Ä–µ–∞–ª–∏–∑—É–π—Ç–µ –¥–∏–∞–ª–æ–≥ —Å –ø–æ–º–æ—â—å—é /v1/messages, –ø–æ–π–º–∏—Ç–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –∏ –ø–µ—Ä–µ—Ö–≤–∞—Ç warmup."
tags:
  - "anthropic"
  - "claude"
  - "claude-code"
  - "proxy"
prerequisite:
  - "start-proxy-and-first-client"
order: 2
---
# API, —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π —Å Anthropic: /v1/messages –∏ –∫–ª—é—á–µ–≤—ã–µ –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã Claude Code

–ß—Ç–æ–±—ã –ø–æ–∑–≤–æ–ª–∏—Ç—å Claude Code –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–π —à–ª—é–∑, –Ω–æ –Ω–µ –º–µ–Ω—è—Ç—å –µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ Anthropic, –ø—Ä–æ—Å—Ç–æ —É–∫–∞–∂–∏—Ç–µ Base URL –Ω–∞ Antigravity Tools, –∞ –∑–∞—Ç–µ–º —Ä–µ–∞–ª–∏–∑—É–π—Ç–µ –æ–¥–∏–Ω –∑–∞–ø—Ä–æ—Å —Å –ø–æ–º–æ—â—å—é `/v1/messages`.

## –ß—Ç–æ —Ç–∞–∫–æ–µ API, —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π —Å Anthropic?

**API, —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π —Å Anthropic** –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ –∫–æ–Ω–µ—á–Ω—ã–º —Ç–æ—á–∫–∞–º –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ Anthropic Messages, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º—ã–º Antigravity Tools. –û–Ω –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã `/v1/messages`, –≤—ã–ø–æ–ª–Ω—è–µ—Ç –æ—á–∏—Å—Ç–∫—É –ø–∞–∫–µ—Ç–æ–≤, –∏–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—é –ø–æ—Ç–æ–∫–∞ –∏ —Ä–æ—Ç–∞—Ü–∏—é –ø–æ–≤—Ç–æ—Ä–æ–≤ –ª–æ–∫–∞–ª—å–Ω–æ, –∞ –∑–∞—Ç–µ–º –ø–µ—Ä–µ—Å—ã–ª–∞–µ—Ç –∑–∞–ø—Ä–æ—Å –Ω–∞ –≤—ã—à–µ—Å—Ç–æ—è—â–∏–π —É—Ä–æ–≤–µ–Ω—å, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—â–∏–π —Ä–µ–∞–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏.

## –ß–µ–º—É –≤—ã –Ω–∞—É—á–∏—Ç–µ—Å—å

- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å Claude Code (–∏–ª–∏ –ª—é–±–æ–π –∫–ª–∏–µ–Ω—Ç Anthropic Messages) —Å –ø–æ–º–æ—â—å—é –∫–æ–Ω–µ—á–Ω–æ–π —Ç–æ—á–∫–∏ `/v1/messages` Antigravity Tools
- –†–∞–∑–æ–±—Ä–∞—Ç—å—Å—è –≤ —Ç–æ–º, –∫–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å Base URL –∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å —Å–ª–µ–ø—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ 401/404
- –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–æ—Ç–æ–∫–∞ –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π SSE; –µ—Å–ª–∏ –Ω–µ –Ω—É–∂–Ω–æ, –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å JSON
- –ó–Ω–∞—Ç—å, –∫–∞–∫–∏–µ ¬´–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Ç–æ–∫–æ–ª–∞¬ª –¥–µ–ª–∞–µ—Ç –ø—Ä–æ–∫—Å–∏ –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ (–ø–µ—Ä–µ—Ö–≤–∞—Ç warmup, –æ—á–∏—Å—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π, –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∏)

## –¢–µ–∫—É—â–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

–í—ã —Ö–æ—Ç–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Claude Code/Anthropic SDK, –Ω–æ —Å–µ—Ç—å, –∞–∫–∫–∞—É–Ω—Ç—ã, –∫–≤–æ—Ç—ã, –ª–∏–º–∏—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ–ª–∞—é—Ç –¥–∏–∞–ª–æ–≥ –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–º; –≤—ã —É–∂–µ –∑–∞–ø—É—Å—Ç–∏–ª–∏ Antigravity Tools –∫–∞–∫ –ª–æ–∫–∞–ª—å–Ω—ã–π —à–ª—é–∑, –Ω–æ —á–∞—Å—Ç–æ –∑–∞—Å—Ç—Ä–µ–≤–∞–µ—Ç–µ –Ω–∞ —ç—Ç–∏—Ö –ø—Ä–æ–±–ª–µ–º–∞—Ö:

- Base URL –Ω–∞–ø–∏—Å–∞–Ω –∫–∞–∫ `.../v1` –∏–ª–∏ –∫–ª–∏–µ–Ω—Ç ¬´–¥—É–±–ª–∏—Ä—É–µ—Ç –ø—É—Ç—å¬ª, —á—Ç–æ –Ω–∞–ø—Ä—è–º—É—é –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ 404
- –í–∫–ª—é—á–∏–ª–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –ø—Ä–æ–∫—Å–∏, –Ω–æ –Ω–µ –∑–Ω–∞–µ—Ç–µ, –∫–∞–∫–æ–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–ª–∏–µ–Ω—Ç –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ key, –≤ –∏—Ç–æ–≥–µ 401
- –§–æ–Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏ warmup/summary Claude Code —Ç–∏—Ö–æ —Å—ä–µ–¥–∞—é—Ç –∫–≤–æ—Ç—É

## –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–æ—Ç –º–µ—Ç–æ–¥

- –í—ã —Ö–æ—Ç–∏—Ç–µ –ø–æ–¥–∫–ª—é—á–∏—Ç—å **Claude Code CLI** –∏ –Ω–∞–¥–µ–µ—Ç–µ—Å—å, —á—Ç–æ –æ–Ω ¬´–ø–æ –ø—Ä–æ—Ç–æ–∫–æ–ª—É Anthropic¬ª –Ω–∞–ø—Ä—è–º—É—é –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ –ª–æ–∫–∞–ª—å–Ω–æ–º—É —à–ª—é–∑—É
- –í–∞—à –∫–ª–∏–µ–Ω—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ Anthropic Messages API (`/v1/messages`), –∏ –≤—ã –Ω–µ —Ö–æ—Ç–∏—Ç–µ –º–µ–Ω—è—Ç—å –∫–æ–¥

## üéí –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞

::: warning –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è
–≠—Ç–æ—Ç —É—Ä–æ–∫ –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç, —á—Ç–æ –≤—ã —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–ª–∏ –±–∞–∑–æ–≤—ã–π —Ü–∏–∫–ª –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ–∫—Å–∏ (–º–æ–∂–µ—Ç–µ –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ `/healthz`, –∑–Ω–∞–µ—Ç–µ –ø–æ—Ä—Ç –ø—Ä–æ–∫—Å–∏ –∏ –≤–∫–ª—é—á–µ–Ω–∞ –ª–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è). –ï—Å–ª–∏ –µ—â—ë –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ, —Å–Ω–∞—á–∞–ª–∞ –ø—Ä–æ—á–∏—Ç–∞–π—Ç–µ **[–ó–∞–ø—É—Å–∫ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ–∫—Å–∏ –∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø–µ—Ä–≤–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞](/ru/lbjlaq/Antigravity-Manager/start/proxy-and-first-client/)**.
:::

–í–∞–º –Ω—É–∂–Ω–æ –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å —Ç—Ä–∏ –≤–µ—â–∏:

1. –ê–¥—Ä–µ—Å –ø—Ä–æ–∫—Å–∏ (–ø—Ä–∏–º–µ—Ä: `http://127.0.0.1:8045`)
2. –í–∫–ª—é—á–µ–Ω–∞ –ª–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø—Ä–æ–∫—Å–∏ (–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π `proxy.api_key`)
3. –ö–ª–∏–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –∑–∞–ø—Ä–æ—Å—ã Anthropic Messages (Claude Code / curl –ø–æ–¥–æ–π–¥—ë—Ç)

## –û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è

**API, —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π —Å Anthropic** –≤ Antigravity Tools —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –Ω–∞–±–æ—Ä—É —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤: `POST /v1/messages`, `POST /v1/messages/count_tokens`, `GET /v1/models/claude` (—Å–º. –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ Router –≤ `src-tauri/src/proxy/server.rs`).

–°—Ä–µ–¥–∏ –Ω–∏—Ö `/v1/messages` ‚Äî —ç—Ç–æ ¬´–≥–ª–∞–≤–Ω—ã–π –≤—Ö–æ–¥¬ª, –ø—Ä–æ–∫—Å–∏ –ø–µ—Ä–µ–¥ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–π –æ—Ç–ø—Ä–∞–≤–∫–æ–π –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ –≤—ã—à–µ—Å—Ç–æ—è—â–∏–π —É—Ä–æ–≤–µ–Ω—å –≤—ã–ø–æ–ª–Ω–∏—Ç –∫—É—á—É —Å–æ–≤–º–µ—Å—Ç–∏–º—ã—Ö –æ–±—Ä–∞–±–æ—Ç–æ–∫:

- –û—á–∏—Å—Ç–∫–∞ –ø–æ–ª–µ–π, –Ω–µ –ø—Ä–∏–Ω–∏–º–∞–µ–º—ã—Ö –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–º, –≤ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏—è—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, `cache_control`)
- –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –æ–¥–Ω–æ–π —Ä–æ–ª–∏, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –Ω–µ—É–¥–∞—á–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ ¬´—á–µ—Ä–µ–¥–æ–≤–∞–Ω–∏–µ —Ä–æ–ª–µ–π¬ª
- –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –ø–∞–∫–µ—Ç–æ–≤ warmup Claude Code –∏ –ø—Ä—è–º–æ–π –≤–æ–∑–≤—Ä–∞—Ç –∏–º–∏—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞, —á—Ç–æ–±—ã —É–º–µ–Ω—å—à–∏—Ç—å —Ç—Ä–∞—Ç—É –∫–≤–æ—Ç—ã
- –ü–æ–≤—Ç–æ—Ä –∏ —Ä–æ—Ç–∞—Ü–∏—è –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–∏–ø–∞ –æ—à–∏–±–∫–∏ (–¥–æ 3 –ø–æ–ø—ã—Ç–æ–∫), —á—Ç–æ–±—ã –ø–æ–≤—ã—Å–∏—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –¥–ª–∏–Ω–Ω—ã—Ö —Å–µ–∞–Ω—Å–æ–≤

## –ü–æ—à–∞–≥–æ–≤–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ

### –®–∞–≥ 1: –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ, —á—Ç–æ Base URL –Ω–∞–ø–∏—Å–∞–Ω —Ç–æ–ª—å–∫–æ –¥–æ –ø–æ—Ä—Ç–∞

**–ó–∞—á–µ–º**
`/v1/messages` ‚Äî —ç—Ç–æ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–∞—Ä—à—Ä—É—Ç –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –ø—Ä–æ–∫—Å–∏, –Ω–∞–ø–∏—Å–∞–Ω–∏–µ Base URL –∫–∞–∫ `.../v1` –ª–µ–≥–∫–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ —Ç–æ–º—É, —á—Ç–æ –∫–ª–∏–µ–Ω—Ç —Å–Ω–æ–≤–∞ —Å–∫–ª–µ–∏—Ç `/v1/messages`, –≤ –∏—Ç–æ–≥–µ –ø–æ–ª—É—á–∏—Ç—Å—è `.../v1/v1/messages`.

–í—ã –º–æ–∂–µ—Ç–µ —Å–Ω–∞—á–∞–ª–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å curl –¥–ª—è –ø—Ä—è–º–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏:

```bash
#–ß—Ç–æ –≤—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:{"status":"ok"}
curl -sS "http://127.0.0.1:8045/healthz"
```

### –®–∞–≥ 2: –ï—Å–ª–∏ –≤—ã –≤–∫–ª—é—á–∏–ª–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é, —Å–Ω–∞—á–∞–ª–∞ –∑–∞–ø–æ–º–Ω–∏—Ç–µ —ç—Ç–∏ 3 –∑–∞–≥–æ–ª–æ–≤–∫–∞

**–ó–∞—á–µ–º**
–ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–µ –ü–û –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø—Ä–æ–∫—Å–∏ –±–µ—Ä—ë—Ç key –∏–∑ `Authorization`, `x-api-key`, `x-goog-api-key`; –µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è, –Ω–æ –∑–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç, –±—É–¥–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω—ã–π 401.

::: info –ö–∞–∫–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –ø—Ä–æ–∫—Å–∏?
`Authorization: Bearer <key>`, `x-api-key: <key>`, `x-goog-api-key: <key>` –≤—Å–µ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å (—Å–º. `src-tauri/src/proxy/middleware/auth.rs`).
:::

### –®–∞–≥ 3: –ü—Ä—è–º–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ Claude Code CLI –∫ –ª–æ–∫–∞–ª—å–Ω–æ–º—É —à–ª—é–∑—É

**–ó–∞—á–µ–º**
Claude Code –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–æ—Ç–æ–∫–æ–ª Anthropic Messages; —É–∫–∞–∑–∞–≤ –µ–≥–æ Base URL –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—ã–π —à–ª—é–∑, –º–æ–∂–Ω–æ –ø–æ–≤—Ç–æ—Ä–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–æ—Ç –∫–æ–Ω—Ç—Ä–∞–∫—Ç `/v1/messages`.

–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å—Ä–µ–¥—ã –ø–æ –ø—Ä–∏–º–µ—Ä—É README:

```bash
export ANTHROPIC_API_KEY="sk-antigravity"
export ANTHROPIC_BASE_URL="http://127.0.0.1:8045"
claude
```

**–ß—Ç–æ –≤—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å**: Claude Code –º–æ–∂–µ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è, –∏ –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—É—á–∏—Ç—å –æ—Ç–≤–µ—Ç.

### –®–∞–≥ 4: –°–Ω–∞—á–∞–ª–∞ –ø–µ—Ä–µ—á–∏—Å–ª–∏—Ç–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –º–æ–¥–µ–ª–∏ (–¥–ª—è curl/SDK)

**–ó–∞—á–µ–º**
–†–∞–∑–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç—ã –ø–µ—Ä–µ–¥–∞–¥—É—Ç `model` –∫–∞–∫ –µ—Å—Ç—å; —Å–Ω–∞—á–∞–ª–∞ –ø–æ–ª—É—á–∏—Ç–µ —Å–ø–∏—Å–æ–∫ –º–æ–¥–µ–ª–µ–π, —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫ –±—É–¥–µ—Ç –Ω–∞–º–Ω–æ–≥–æ –±—ã—Å—Ç—Ä–µ–µ.

```bash
curl -sS "http://127.0.0.1:8045/v1/models/claude" | jq
```

**–ß—Ç–æ –≤—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å**: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è JSON —Å `object: "list"`, –≥–¥–µ `data[].id` ‚Äî —ç—Ç–æ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã –º–æ–¥–µ–ª–µ–π.

### –®–∞–≥ 5: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ curl –¥–ª—è –≤—ã–∑–æ–≤–∞ /v1/messages (–Ω–µ–ø–æ—Ç–æ–∫–æ–≤—ã–π)

**–ó–∞—á–µ–º**
–≠—Ç–æ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–∞—è —Ü–µ–ø–æ—á–∫–∞: –±–µ–∑ Claude Code —Ç–æ–∂–µ –º–æ–∂–Ω–æ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å, –≥–¥–µ –∏–º–µ–Ω–Ω–æ –æ—à–∏–±–∫–∞ –≤ ¬´–º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è + –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è + —Ç–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞¬ª.

```bash
curl -i "http://127.0.0.1:8045/v1/messages" \
  -H "Content-Type: application/json" \
  -H "x-api-key: sk-antigravity" \
  -d '{
    "model": "<–≤—ã–±–µ—Ä–∏—Ç–µ –æ–¥–∏–Ω –∏–∑ /v1/models/claude>",
    "max_tokens": 128,
    "messages": [
      {"role": "user", "content": "–ü—Ä–∏–≤–µ—Ç, –∫—Ä–∞—Ç–∫–æ –ø—Ä–µ–¥—Å—Ç–∞–≤—å—Å—è"}
    ]
  }'
```

**–ß—Ç–æ –≤—ã –¥–æ–ª–∂–Ω—ã –≤–∏–¥–µ—Ç—å**:

- HTTP 200
- –í –∑–∞–≥–æ–ª–æ–≤–∫–µ –æ—Ç–≤–µ—Ç–∞ –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å—Å—è `X-Account-Email` –∏ `X-Mapped-Model` (–¥–ª—è —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –Ω–µ–ø–æ–ª–∞–¥–æ–∫)
- –¢–µ–ª–æ –æ—Ç–≤–µ—Ç–∞ ‚Äî —ç—Ç–æ JSON –≤ —Å—Ç–∏–ª–µ Anthropic Messages (`type: "message"`)

### –®–∞–≥ 6: –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–æ—Ç–æ–∫–∞ –≤–∫–ª—é—á–∏—Ç–µ `stream: true`

**–ó–∞—á–µ–º**
Claude Code –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å SSE; –≤—ã —Ç–∞–∫–∂–µ –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å curl –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ—Ç–æ–∫–∞ SSE, –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—è, —á—Ç–æ –º–µ–∂–¥—É –Ω–∏–º–∏ –Ω–µ—Ç –ø—Ä–æ–±–ª–µ–º —Å –ø—Ä–æ–∫—Å–∏/–±—É—Ñ–µ—Ä–æ–º.

```bash
curl -N "http://127.0.0.1:8045/v1/messages" \
  -H "Content-Type: application/json" \
  -H "x-api-key: sk-antigravity" \
  -d '{
    "model": "<–≤—ã–±–µ—Ä–∏—Ç–µ –æ–¥–∏–Ω –∏–∑ /v1/models/claude>",
    "max_tokens": 128,
    "stream": true,
    "messages": [
      {"role": "user", "content": "–û–±—ä—è—Å–Ω–∏ –≤ 3 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è—Ö, —á—Ç–æ —Ç–∞–∫–æ–µ –ª–æ–∫–∞–ª—å–Ω—ã–π –ø—Ä–æ–∫—Å–∏-—à–ª—é–∑"}
    ]
  }'
```

**–ß—Ç–æ –≤—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å**: –°—Ç—Ä–æ–∫–∏ —Å–æ–±—ã—Ç–∏–π SSE (`event: message_start`, `event: content_block_delta` –∏ —Ç.–¥.).

## –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ —Ç–æ—á–∫–∏ ‚úÖ

- `GET /healthz` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `{"status":"ok"}`
- `GET /v1/models/claude` –º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å `data[].id`
- `POST /v1/messages` –º–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å 200 (–Ω–µ–ø–æ—Ç–æ–∫–æ–≤—ã–π JSON –∏–ª–∏ –ø–æ—Ç–æ–∫–æ–≤—ã–π SSE, –≤—ã–±–µ—Ä–∏—Ç–µ –æ–¥–∏–Ω –∏–∑ –¥–≤—É—Ö)

## –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏

### 1) –ù–µ –ø–∏—à–∏—Ç–µ Base URL –∫–∞–∫ `.../v1`

–ü—Ä–∏–º–µ—Ä Claude Code ‚Äî `ANTHROPIC_BASE_URL="http://127.0.0.1:8045"`, –ø–æ—Ç–æ–º—É —á—Ç–æ –º–∞—Ä—à—Ä—É—Ç –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –ø—Ä–æ–∫—Å–∏ —É–∂–µ —Å–æ–¥–µ—Ä–∂–∏—Ç `/v1/messages`.

### 2) –ï—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è, –Ω–æ `proxy.api_key` –ø—É—Å—Ç, –±—É–¥–µ—Ç –ø—Ä—è–º–æ–π –æ—Ç–∫–∞–∑

–ö–æ–≥–¥–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø—Ä–æ–∫—Å–∏ –≤–∫–ª—é—á–µ–Ω–∞, –Ω–æ `api_key` –ø—É—Å—Ç, –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–µ –ü–û –Ω–∞–ø—Ä—è–º—É—é –≤–µ—Ä–Ω—ë—Ç 401 (—Å–º. –ª–æ–≥–∏–∫—É –∑–∞—â–∏—Ç—ã –≤ `src-tauri/src/proxy/middleware/auth.rs`).

### 3) `/v1/messages/count_tokens` –≤ –ø—É—Ç–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é ‚Äî —ç—Ç–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è-–∑–∞–≥–ª—É—à–∫–∞

–ö–æ–≥–¥–∞ –ø–µ—Ä–µ—Å—ã–ª–∫–∞ z.ai –Ω–µ –≤–∫–ª—é—á–µ–Ω–∞, —ç—Ç–∞ –∫–æ–Ω–µ—á–Ω–∞—è —Ç–æ—á–∫–∞ –Ω–∞–ø—Ä—è–º—É—é –≤–µ—Ä–Ω—ë—Ç `input_tokens: 0, output_tokens: 0` (—Å–º. `handle_count_tokens`). –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –µ—ë –¥–ª—è –æ—Ü–µ–Ω–∫–∏ —Ä–µ–∞–ª—å–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤.

### 4) –í—ã —è–≤–Ω–æ –Ω–µ –≤–∫–ª—é—á–∏–ª–∏ –ø–æ—Ç–æ–∫, –Ω–æ –≤–∏–¥–∏—Ç–µ, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä ¬´–≤–Ω—É—Ç—Ä–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç SSE¬ª

–£ `/v1/messages` –ø—Ä–æ–∫—Å–∏ –µ—Å—Ç—å —Å–æ–≤–º–µ—Å—Ç–∏–º–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è: –∫–æ–≥–¥–∞ –∫–ª–∏–µ–Ω—Ç –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –ø–æ—Ç–æ–∫–∞, —Å–µ—Ä–≤–µ—Ä –º–æ–∂–µ—Ç **–≤–Ω—É—Ç—Ä–∏ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ—Ç–æ–∫** –∏ –∑–∞—Ç–µ–º —Å–æ–±—Ä–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ JSON –∏ –≤–µ—Ä–Ω—É—Ç—å (—Å–º. –ª–æ–≥–∏–∫—É `force_stream_internally` –≤ `handle_messages`).

## –ò—Ç–æ–≥ —É—Ä–æ–∫–∞

- –ß—Ç–æ–±—ã Claude Code/–∫–ª–∏–µ–Ω—Ç Anthropic —Ä–∞–±–æ—Ç–∞–ª, –ø–æ —Å—É—Ç–∏ –Ω—É–∂–Ω–æ 3 –≤–µ—â–∏: Base URL, –∑–∞–≥–æ–ª–æ–≤–æ–∫ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏, —Ç–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ `/v1/messages`
- –ß—Ç–æ–±—ã ¬´–ø—Ä–æ—Ç–æ–∫–æ–ª —Ä–∞–±–æ—Ç–∞–ª + –¥–ª–∏–Ω–Ω—ã–π —Å–µ–∞–Ω—Å —Å—Ç–∞–±–∏–ª–µ–Ω¬ª, –ø—Ä–æ–∫—Å–∏ –æ—á–∏—Å—Ç–∏—Ç –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è, –ø–µ—Ä–µ—Ö–≤–∞—Ç–∏—Ç warmup –∏ –ø—Ä–∏ –Ω–µ—É–¥–∞—á–µ –ø–æ–≤—Ç–æ—Ä–∏—Ç/—Ä–æ—Ç–∏—Ä—É–µ—Ç –∞–∫–∫–∞—É–Ω—Ç—ã
- `count_tokens` —Å–µ–π—á–∞—Å –Ω–µ –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –∫–∞–∫ —Ä–µ–∞–ª—å–Ω—ã–π –∫—Ä–∏—Ç–µ—Ä–∏–π (–µ—Å–ª–∏ –≤—ã –Ω–µ –≤–∫–ª—é—á–∏–ª–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –ø—É—Ç—å –ø–µ—Ä–µ—Å—ã–ª–∫–∏)

## –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —Å–ª–µ–¥—É—é—â–µ–≥–æ —É—Ä–æ–∫–∞

> –í —Å–ª–µ–¥—É—é—â–µ–º —É—Ä–æ–∫–µ –º—ã –∏–∑—É—á–∏–º **[–ù–∞—Ç–∏–≤–Ω—ã–π API Gemini: /v1beta/models –∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫–æ–Ω–µ—á–Ω—ã—Ö —Ç–æ—á–µ–∫ Google SDK](/ru/lbjlaq/Antigravity-Manager/platforms/gemini/)**.

---

## –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –ø–æ –∏—Å—Ö–æ–¥–Ω–æ–º—É –∫–æ–¥—É

<details>
<summary><strong>–ù–∞–∂–º–∏—Ç–µ, —á—Ç–æ–±—ã —Ä–∞—Å–∫—Ä—ã—Ç—å —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–æ–¥–∞</strong></summary>

> –û–±–Ω–æ–≤–ª–µ–Ω–æ: 2026-01-23

| –§—É–Ω–∫—Ü–∏—è | –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É | –°—Ç—Ä–æ–∫–∏ |
| --- | --- | --- |
| –ú–∞—Ä—à—Ä—É—Ç—ã –ø—Ä–æ–∫—Å–∏: `/v1/messages` / `count_tokens` / `models/claude` | [`src-tauri/src/proxy/server.rs`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src-tauri/src/proxy/server.rs#L120-L193) | 120-193 |
| –ì–ª–∞–≤–Ω—ã–π –≤—Ö–æ–¥ Anthropic: `handle_messages` (–≤–∫–ª—é—á–∞—è –ø–µ—Ä–µ—Ö–≤–∞—Ç warmup –∏ —Ü–∏–∫–ª –ø–æ–≤—Ç–æ—Ä–æ–≤) | [`src-tauri/src/proxy/handlers/claude.rs`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src-tauri/src/proxy/handlers/claude.rs#L240-L1140) | 240-1140 |
| –°–ø–∏—Å–æ–∫ –º–æ–¥–µ–ª–µ–π: `GET /v1/models/claude` | [`src-tauri/src/proxy/handlers/claude.rs`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src-tauri/src/proxy/handlers/claude.rs#L1163-L1183) | 1163-1183 |
| `count_tokens` (–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 0, –∫–æ–≥–¥–∞ z.ai –Ω–µ –≤–∫–ª—é—á—ë–Ω) | [`src-tauri/src/proxy/handlers/claude.rs`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src-tauri/src/proxy/handlers/claude.rs#L1186-L1210) | 1186-1210 |
| –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏ –∏–º–∏—Ç–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞ warmup | [`src-tauri/src/proxy/handlers/claude.rs`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src-tauri/src/proxy/handlers/claude.rs#L1375-L1493) | 1375-1493 |
| –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏: `Authorization`/`x-api-key`/`x-goog-api-key` | [`src-tauri/src/proxy/middleware/auth.rs`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src-tauri/src/proxy/middleware/auth.rs#L14-L77) | 14-77 |
| –û—á–∏—Å—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–∞: —É–¥–∞–ª–µ–Ω–∏–µ `cache_control` | [`src-tauri/src/proxy/mappers/claude/request.rs`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src-tauri/src/proxy/mappers/claude/request.rs#L68-L148) | 68-148 |
| –û—á–∏—Å—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–∞: –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –æ–¥–Ω–æ–π —Ä–æ–ª–∏ | [`src-tauri/src/proxy/mappers/claude/request.rs`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src-tauri/src/proxy/mappers/claude/request.rs#L253-L296) | 253-296 |
| –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è Claude -> Gemini v1internal: `transform_claude_request_in()` | [`src-tauri/src/proxy/mappers/claude/request.rs`](https://github.com/lbjlaq/Antigravity-Manager/blob/main/src-tauri/src/proxy/mappers/claude/request.rs#L332-L618) | 332-618 |

**–ö–ª—é—á–µ–≤—ã–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã**:
- `MAX_RETRY_ATTEMPTS = 3`: –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–≤—Ç–æ—Ä–æ–≤ –¥–ª—è `/v1/messages`

</details>
